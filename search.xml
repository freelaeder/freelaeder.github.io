<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>== 和 ===</title>
    <url>/archives/93ae9a14.html</url>
    <content><![CDATA[<h1 id="面试官：-和-区别，分别在什么情况使用"><a href="#面试官：-和-区别，分别在什么情况使用" class="headerlink" title="面试官：== 和 ===区别，分别在什么情况使用"></a>面试官：== 和 ===区别，分别在什么情况使用</h1><p> <img src="https://static.vue-js.com/51b208f0-68df-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、等于操作符"><a href="#一、等于操作符" class="headerlink" title="一、等于操作符"></a>一、等于操作符</h2><p>等于操作符用两个等于号（ == ）表示，如果操作数相等，则会返回 <code>true</code></p>
<p>前面文章，我们提到在<code>JavaScript</code>中存在隐式转换。等于操作符（==）在比较中会先进行类型转换，再确定操作数是否相等</p>
<p>遵循以下规则：</p>
<p>如果任一操作数是布尔值，则将其转换为数值再比较是否相等</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> result1 = (<span class="literal">true</span> == <span class="number">1</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>如果一个操作数是字符串，另一个操作数是数值，则尝试将字符串转换为数值，再比较是否相等</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> result1 = (<span class="string">&quot;55&quot;</span> == <span class="number">55</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>如果一个操作数是对象，另一个操作数不是，则调用对象的 <code>valueOf()</code>方法取得其原始值，再根据前面的规则进行比较</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">valueOf</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="number">1</span>&#125;&#125;</span><br><span class="line"><span class="keyword">let</span> result1 = (obj == <span class="number">1</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p><code>null</code>和<code>undefined</code>相等</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> result1 = (<span class="literal">null</span> == <span class="literal">undefined</span> ); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>如果有任一操作数是 <code>NaN</code> ，则相等操作符返回 <code>false</code> </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> result1 = (<span class="literal">NaN</span> == <span class="literal">NaN</span> ); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>如果两个操作数都是对象，则比较它们是不是同一个对象。如果两个操作数都指向同一个对象，则相等操作符返回<code>true</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let obj1 = &#123;name:&quot;xxx&quot;&#125;</span><br><span class="line">let obj2 = &#123;name:&quot;xxx&quot;&#125;</span><br><span class="line">let result1 = (obj1 == obj2 ); // false</span><br></pre></td></tr></table></figure>
<p>下面进一步做个小结：</p>
<ul>
<li>两个都为简单类型，字符串和布尔值都会转换成数值，再比较</li>
<li><p>简单类型与引用类型比较，对象转化成其原始类型的值，再比较</p>
</li>
<li><p>两个都为引用类型，则比较它们是否指向同一个对象</p>
</li>
<li><p>null 和 undefined 相等</p>
</li>
<li>存在 NaN 则返回 false</li>
</ul>
<h2 id="二、全等操作符"><a href="#二、全等操作符" class="headerlink" title="二、全等操作符"></a>二、全等操作符</h2><p>全等操作符由 3 个等于号（ === ）表示，只有两个操作数在不转换的前提下相等才返回 <code>true</code>。即类型相同，值也需相同</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> result1 = (<span class="string">&quot;55&quot;</span> === <span class="number">55</span>); <span class="comment">// false，不相等，因为数据类型不同</span></span><br><span class="line"><span class="keyword">let</span> result2 = (<span class="number">55</span> === <span class="number">55</span>); <span class="comment">// true，相等，因为数据类型相同值也相同</span></span><br></pre></td></tr></table></figure>
<p><code>undefined</code> 和 <code>null</code> 与自身严格相等</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> result1 = (<span class="literal">null</span> === <span class="literal">null</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="keyword">let</span> result2 = (<span class="literal">undefined</span> === <span class="literal">undefined</span>)  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<h2 id="三、区别"><a href="#三、区别" class="headerlink" title="三、区别"></a>三、区别</h2><p>相等操作符（==）会做类型转换，再进行值的比较，全等运算符不会做类型转换</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> result1 = (<span class="string">&quot;55&quot;</span> === <span class="number">55</span>); <span class="comment">// false，不相等，因为数据类型不同</span></span><br><span class="line"><span class="keyword">let</span> result2 = (<span class="number">55</span> === <span class="number">55</span>); <span class="comment">// true，相等，因为数据类型相同值也相同</span></span><br></pre></td></tr></table></figure>
<p><code>null</code> 和 <code>undefined</code> 比较，相等操作符（==）为<code>true</code>，全等为<code>false</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> result1 = (<span class="literal">null</span> == <span class="literal">undefined</span> ); <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> result2 = (<span class="literal">null</span>  === <span class="literal">undefined</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>相等运算符隐藏的类型转换，会带来一些违反直觉的结果</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span> == <span class="string">&#x27;0&#x27;</span> <span class="comment">// false</span></span><br><span class="line"><span class="number">0</span> == <span class="string">&#x27;&#x27;</span> <span class="comment">// true</span></span><br><span class="line"><span class="number">0</span> == <span class="string">&#x27;0&#x27;</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="literal">false</span> == <span class="string">&#x27;false&#x27;</span> <span class="comment">// false</span></span><br><span class="line"><span class="literal">false</span> == <span class="string">&#x27;0&#x27;</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="literal">false</span> == <span class="literal">undefined</span> <span class="comment">// false</span></span><br><span class="line"><span class="literal">false</span> == <span class="literal">null</span> <span class="comment">// false</span></span><br><span class="line"><span class="literal">null</span> == <span class="literal">undefined</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27; \t\r\n&#x27;</span> == <span class="number">0</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>但在比较<code>null</code>的情况的时候，我们一般使用相等操作符<code>==</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(obj.x == <span class="literal">null</span>)&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;1&quot;</span>);  <span class="comment">//执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>等同于下面写法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(obj.x === <span class="literal">null</span> || obj.x === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用相等操作符（==）的写法明显更加简洁了</p>
<p>所以，除了在比较对象属性为<code>null</code>或者<code>undefined</code>的情况下，我们可以使用相等操作符（==），其他情况建议一律使用全等操作符（===）</p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>== 和 ===</tag>
        <tag>js面试</tag>
      </tags>
  </entry>
  <entry>
    <title>Es6</title>
    <url>/archives/42b82995.html</url>
    <content><![CDATA[<h2 id="ES6语法"><a href="#ES6语法" class="headerlink" title="ES6语法"></a>ES6语法</h2><p><div id="chakhsu" class="blog-title"></div> <script> var chakhsu = function (r) { function t() { return b[Math.floor(Math.random() * b.length)] } function e() { return String.fromCharCode(94 * Math.random() + 33) } function n(r) { for (var n = document.createDocumentFragment(), i = 0; r > i; i++) { var l = document.createElement("span"); l.textContent = e(), l.style.color = t(), n.appendChild(l) } return n } function i() { var t = o[c.skillI]; c.step ? c.step-- : (c.step = g, c.prefixP < l.length ? (c.prefixP >= 0 && (c.text += l[c.prefixP]), c.prefixP++) : "forward" === c.direction ? c.skillP < t.length ? (c.text += t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction = "backward", c.delay = a) : c.skillP > 0 ? (c.text = c.text.slice(0, -1), c.skillP--) : (c.skillI = (c.skillI + 1) % o.length, c.direction = "forward")), r.textContent = c.text, r.appendChild(n(c.prefixP < l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d) } /*以下内容自定义修改*/ var l = "这个世界", o = ["没什么好畏惧的，反正我们只来一次。", ].map(function (r) { return r + "" }), a = 2, g = 1, s = 5, d = 75, b = ["rgb(110,64,170)", "rgb(150,61,179)", "rgb(191,60,175)", "rgb(228,65,157)", "rgb(254,75,131)", "rgb(255,94,99)", "rgb(255,120,71)", "rgb(251,150,51)", "rgb(226,183,47)", "rgb(198,214,60)", "rgb(175,240,91)", "rgb(127,246,88)", "rgb(82,246,103)", "rgb(48,239,130)", "rgb(29,223,163)", "rgb(26,199,194)", "rgb(35,171,216)", "rgb(54,140,225)", "rgb(76,110,219)", "rgb(96,84,200)"], c = {text: "", prefixP: -s, skillI: 0, skillP: 0, direction: "forward", delay: a, step: g}; i() }; chakhsu(document.getElementById('chakhsu')); </script> <div></p>
<p>
  <span class='gold'>正则表达式</span>
</p>

<hr>
<p><img src="/img/zheng.png" alt=""></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">       <span class="comment">// 正则表达式  RegExp对象    数字，字符，字母</span></span><br><span class="line">       <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/\w/</span>);  </span><br><span class="line"></span><br><span class="line">       <span class="comment">// 字面量  不加引号</span></span><br><span class="line">       <span class="keyword">var</span> reg1 = <span class="regexp">/^abc/</span>;  <span class="comment">// 包含abc 返回true，无关顺序  ^ 起始位置  </span></span><br><span class="line">       <span class="keyword">var</span> reg2 = <span class="regexp">/love$/</span>   <span class="comment">//   $ 终止位置写在最后</span></span><br><span class="line">       <span class="comment">// test 检测是否合格</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// console.log(reg.test(&#x27;w&#x27;));     </span></span><br><span class="line">       <span class="comment">// console.log(reg);</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 校验数据，数据要加引号 。返回ture 或false； boolean值</span></span><br><span class="line">       <span class="keyword">var</span> r = reg.test(<span class="string">&#x27;l&#x27;</span>);  </span><br><span class="line">       <span class="built_in">console</span>.log(r);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">var</span> s = reg1.test(<span class="string">&#x27;abcda&#x27;</span>);</span><br><span class="line">       <span class="built_in">console</span>.log(s);  <span class="comment">//  true </span></span><br><span class="line">      </span><br><span class="line">       <span class="keyword">let</span> s1 = <span class="built_in">console</span>.log(reg2.test(<span class="string">&#x27;display&#x27;</span>));   <span class="comment">// false</span></span><br><span class="line">       </span><br><span class="line">       <span class="comment">//1.5 精确匹配love 以love开始，以love结束</span></span><br><span class="line"></span><br><span class="line">       <span class="keyword">var</span> reg2 = <span class="regexp">/^love$/</span></span><br><span class="line"></span><br><span class="line">       <span class="built_in">console</span>.log(reg2.test(<span class="string">&#x27;love&#x27;</span>));  <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg2.test(<span class="string">&#x27;lovelove&#x27;</span>));  <span class="comment">/* false */</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 1.6字符类 []表示有一系列可供选择，只要匹配其中一个就可以</span></span><br><span class="line"></span><br><span class="line">       <span class="keyword">var</span> reg3 = <span class="regexp">/[agree]/</span>;</span><br><span class="line"></span><br><span class="line">       <span class="built_in">console</span>.log(reg3.test(<span class="string">&#x27;a&#x27;</span>)) <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg3.test(<span class="string">&#x27;ag&#x27;</span>))  <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg3.test(<span class="string">&#x27;ea&#x27;</span>))  <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg3.test(<span class="string">&#x27;ra&#x27;</span>))  <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg3.test(<span class="string">&#x27;agre&#x27;</span>))  <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg3.test(<span class="string">&#x27;aree&#x27;</span>))  <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg3.test(<span class="string">&#x27;aee&#x27;</span>))  <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg3.test(<span class="string">&#x27;zl&#x27;</span>))  <span class="comment">/* false */</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 1.7  a || b|| c 其他都是false</span></span><br><span class="line">       <span class="keyword">var</span> reg4 = <span class="regexp">/^[abc]$/</span>;</span><br><span class="line">       <span class="built_in">console</span>.log(reg4.test(<span class="string">&#x27;a&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg4.test(<span class="string">&#x27;b&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg4.test(<span class="string">&#x27;c&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg4.test(<span class="string">&#x27;ab&#x27;</span>)); <span class="comment">/* false */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg4.test(<span class="string">&#x27;ac&#x27;</span>)); <span class="comment">/* false */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg4.test(<span class="string">&#x27;abc&#x27;</span>)); <span class="comment">/* false */</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 1.8  26个小写英文字母，任何多个 </span></span><br><span class="line">       <span class="keyword">let</span>  reg5 = <span class="regexp">/[a-z]/</span>   <span class="comment">/* 大写 /[A-Z]/ 同理 */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg5.test(<span class="string">&#x27;sdfa&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg5.test(<span class="string">&#x27;Z&#x27;</span>)); <span class="comment">/* false  */</span></span><br><span class="line">       <span class="comment">// 1.9  26个小写英文字母，只有一个 </span></span><br><span class="line">       <span class="keyword">let</span> reg6 = <span class="regexp">/^[a-z]$/</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg6.test(<span class="string">&#x27;a&#x27;</span>));  <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg6.test(<span class="string">&#x27;sdfa&#x27;</span>)); <span class="comment">/* false */</span></span><br><span class="line">       <span class="built_in">console</span>.log(reg6.test(<span class="string">&#x27;Z&#x27;</span>)); <span class="comment">/* false  */</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 2.0 26个英文字母 包含大小写 任何多个</span></span><br><span class="line">       <span class="keyword">let</span> re2 = <span class="regexp">/[a-zA-Z]/</span></span><br><span class="line">       <span class="built_in">console</span>.log(re2.test(<span class="string">&#x27;asZk&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 2.0 26个英文字母 包含大小写 只有一个</span></span><br><span class="line">       <span class="keyword">let</span> re3 = <span class="regexp">/^[a-zA-Z]$/</span></span><br><span class="line">       <span class="built_in">console</span>.log(re3.test(<span class="string">&#x27;asZk&#x27;</span>)); <span class="comment">/* false */</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 2.0 26个英文字母 [^] 扩号里，取反</span></span><br><span class="line">       <span class="keyword">let</span> re4 = <span class="regexp">/[^a-zA-Z]$/</span></span><br><span class="line">       <span class="built_in">console</span>.log(re4.test(<span class="string">&#x27;asZk&#x27;</span>)); <span class="comment">/* false */</span></span><br><span class="line">       <span class="built_in">console</span>.log(re4.test(<span class="string">&#x27;1&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line">       </span><br><span class="line">        <span class="comment">// 2.1 只匹配数字  满足有数字即可</span></span><br><span class="line">       <span class="keyword">let</span> re5 = <span class="regexp">/\d/</span></span><br><span class="line">       <span class="built_in">console</span>.log(re5.test(<span class="string">&#x27;sdf&#x27;</span>));  <span class="comment">/* false */</span></span><br><span class="line">       <span class="built_in">console</span>.log(re5.test(<span class="string">&#x27;sdf&#x27;</span>));  <span class="comment">/* false */</span></span><br><span class="line">       <span class="built_in">console</span>.log(re5.test(<span class="string">&#x27;sA&#x27;</span>));  <span class="comment">/* false */</span></span><br><span class="line">       <span class="built_in">console</span>.log(re5.test(<span class="string">&#x27;sdS2&#x27;</span>));  <span class="comment">/* ture */</span></span><br><span class="line">       </span><br><span class="line">        <span class="comment">// 2.2 量词符</span></span><br><span class="line">       <span class="comment">// 2.2.1   * 相当于 &gt;= 0,可以出现0 次或多次</span></span><br><span class="line">       <span class="comment">// 2.2.2   + 相当于 &gt;= 1,可以出现1 次或多次</span></span><br><span class="line">       <span class="keyword">let</span> re6 = <span class="regexp">/a*/</span></span><br><span class="line">       <span class="built_in">console</span>.log(re6.test(<span class="string">&#x27;a&#x27;</span>)); <span class="comment">/* true*/</span></span><br><span class="line">       <span class="built_in">console</span>.log(re6.test(<span class="string">&#x27;aaa&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(re6.test(<span class="string">&#x27;b&#x27;</span>)); <span class="comment">/* ture */</span></span><br><span class="line">       <span class="built_in">console</span>.log(re6.test(<span class="string">&#x27;ab&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line"></span><br><span class="line">       <span class="keyword">let</span> re7 = <span class="regexp">/a+/</span></span><br><span class="line">       <span class="built_in">console</span>.log(re6.test(<span class="string">&#x27;&#x27;</span>)); <span class="comment">/* true*/</span></span><br><span class="line">       <span class="built_in">console</span>.log(re6.test(<span class="string">&#x27;aaa&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line">       <span class="built_in">console</span>.log(re6.test(<span class="string">&#x27;b&#x27;</span>)); <span class="comment">/* ture */</span></span><br><span class="line">       <span class="built_in">console</span>.log(re6.test(<span class="string">&#x27;ab&#x27;</span>)); <span class="comment">/* true */</span></span><br><span class="line"></span><br><span class="line">   &lt;/script&gt;</span><br><span class="line">      </span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='label'>简单用户输入验证</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tabs]</span><br><span class="line"></span><br><span class="line">[tab title=<span class="string">&quot;css&quot;</span>]</span><br><span class="line"> span &#123;</span><br><span class="line">            <span class="attr">color</span>: #aaa;</span><br><span class="line">            font-size: 14px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .right &#123;</span><br><span class="line">            <span class="attr">color</span>: green;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .wrong &#123;</span><br><span class="line">            <span class="attr">color</span>: red;</span><br><span class="line">        &#125;</span><br><span class="line">[/tab]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[tab title=<span class="string">&quot;js&quot;</span>]</span><br><span class="line">  <span class="keyword">let</span> btn = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;input&#x27;</span>);</span><br><span class="line">        <span class="keyword">let</span> span = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;span&#x27;</span>);</span><br><span class="line">        <span class="keyword">let</span> reg = <span class="regexp">/^[a-zA-Z]&#123;6,10&#125;/</span>;</span><br><span class="line">        btn.addEventListener(<span class="string">&#x27;blur&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">let</span> text = btn.value;</span><br><span class="line">            <span class="keyword">if</span> (reg.test(text)) &#123;</span><br><span class="line">                span.style.color = <span class="string">&#x27;blue&#x27;</span></span><br><span class="line">                span.innerText =<span class="string">&#x27;right&#x27;</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                span.classList.add(<span class="string">&#x27;wrong&#x27;</span>)</span><br><span class="line">                span.innerText=<span class="string">&#x27;wrong&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">[/tab]</span><br><span class="line"></span><br><span class="line">[/tabs]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>
  <span class='wram'>面向对象</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;success&quot;</span> outline=<span class="string">&quot;1&quot;</span>]面向对象[/tag]</span><br><span class="line">[collapse title=<span class="string">&quot;面向对象用户校验&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span><br><span class="line"> &lt;script&gt;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">            <span class="function"><span class="title">constructor</span>(<span class="params">opt</span>)</span> &#123;</span><br><span class="line">                <span class="built_in">Object</span>.assign(<span class="built_in">this</span>, opt);</span><br><span class="line">                <span class="built_in">this</span>.ipt();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="title">ipt</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> that = <span class="built_in">this</span>;</span><br><span class="line">                <span class="built_in">this</span>.btn.addEventListener(<span class="string">&#x27;blur&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="built_in">this</span>, <span class="string">&#x27;this&#x27;</span>); <span class="comment">/*此时this指向 btn，绑定事件，给谁绑定就是谁  */</span></span><br><span class="line">                    <span class="built_in">console</span>.log(that, <span class="string">&#x27;that&#x27;</span>); <span class="comment">/* 此时的that指向传递的数据 */</span></span><br><span class="line">                    <span class="keyword">let</span> text = <span class="built_in">this</span>.value;</span><br><span class="line">                    <span class="keyword">let</span> flag = that.reg.test(text);</span><br><span class="line">                    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                        that.span.style.color = <span class="string">&#x27;blue&#x27;</span>;</span><br><span class="line">                        that.span.innerText = <span class="string">&#x27;right&#x27;</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        that.span.style.color = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">                        that.span.innerText = <span class="string">&#x27;wrong&#x27;</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> ex = <span class="keyword">new</span> Test(&#123;</span><br><span class="line">            <span class="attr">btn</span>: <span class="built_in">document</span>.querySelector(<span class="string">&#x27;input&#x27;</span>),</span><br><span class="line">            <span class="attr">span</span>: <span class="built_in">document</span>.querySelector(<span class="string">&#x27;span&#x27;</span>),</span><br><span class="line">            <span class="attr">reg</span>: <span class="regexp">/^[a-zA-Z-]&#123;6,10&#125;/</span>,</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='gold'>替换部分敏感词汇</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;danger&quot;</span> outline]替换部分敏感词汇[/tag]</span><br><span class="line">[collapse title=<span class="string">&quot;replace&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span><br><span class="line">  &lt;input type=<span class="string">&quot;text&quot;</span>&gt;</span><br><span class="line">   <span class="xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>enter<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">   <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">let</span> test = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;input&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">let</span> btn = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;button&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">let</span> div = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;div&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="keyword">let</span> tests = test.value;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            tests = tests.replace(<span class="regexp">/tmd|TMD|黃色|sb你妈的|fw/g</span>, <span class="string">&#x27;**&#x27;</span>); <span class="comment">/* g代表全部匹配  */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            div.innerText = tests;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='green'>扩展运算符</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;info&quot;</span> outline]扩展运算符[/tag]</span><br><span class="line"></span><br><span class="line">[collapse title=<span class="string">&quot;...扩展运算符&quot;</span>]</span><br><span class="line">&lt;span&gt;&lt;<span class="regexp">/span&gt;&lt;span&gt;&lt;/</span>span&gt;<span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">	<span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="keyword">let</span> arry = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		arry1 = [<span class="string">&#x27;qw&#x27;</span>, <span class="number">23</span>, <span class="number">32</span>];</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="comment">// 添加数组arry1</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">		arry.push(...arry1)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="built_in">console</span>.log(arry);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="comment">/*  [1, 2, 3, &quot;qw&quot;, 23, 32]  */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">		</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="built_in">console</span>.log(...arry);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="comment">/* 1 2 3 &quot;qw&quot; 23 32  */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="keyword">let</span> span = <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;span&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="built_in">console</span>.log(span);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="built_in">console</span>.log(...span);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="keyword">var</span> obj = &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">			<span class="number">1</span>: <span class="string">&#x27;东风&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">			<span class="number">2</span>: <span class="string">&#x27;东西&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">			<span class="number">3</span>: <span class="string">&#x27;东得&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">			<span class="number">4</span>: <span class="string">&#x27;东&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">			<span class="attr">length</span>: <span class="number">5</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">		&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="comment">// 将为数组转化成数组，第二个参数是函数</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="keyword">let</span> arr2 = <span class="built_in">Array</span>.from(obj, <span class="function"><span class="params">item</span> =&gt;</span> item + <span class="string">&#x27;sd&#x27;</span>)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="built_in">console</span>.log(arr2);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">		<span class="comment">// [&quot;undefinedsd&quot;, &quot;东风sd&quot;, &quot;东西sd&quot;, &quot;东得sd&quot;, &quot;东sd&quot;]</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='aqua'>find</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;info&quot;</span>]find[/tag]</span><br><span class="line">[collapse title=<span class="string">&quot;find&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span><br><span class="line">&lt;script&gt;</span><br><span class="line">		<span class="comment">//字面量 筛选数据，</span></span><br><span class="line">		<span class="keyword">var</span> arr = [</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;a&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">90</span> &#125;,</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;b&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">93</span> &#125;,</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;c&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">20</span> &#125;,</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;d&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">100</span> &#125;,</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;e&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">100</span> &#125;,</span><br><span class="line">		];</span><br><span class="line">		<span class="comment">// 遍历同时执行回调函数 找到目标后不再继续查找， 退出循环</span></span><br><span class="line">		<span class="keyword">var</span> res = arr.find(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123; <span class="keyword">return</span> item.score == <span class="number">100</span> &#125;);</span><br><span class="line">		<span class="built_in">console</span>.log(res); <span class="comment">/* name：d */</span></span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='purp'>findIndex</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;warn&quot;</span>]findIndex[/tag]</span><br><span class="line">		<span class="comment">//字面量 筛选数据，查找下标</span></span><br><span class="line">		<span class="keyword">var</span> arr = [</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;a&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">10</span> &#125;,</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;b&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">93</span> &#125;,</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;c&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">20</span> &#125;,</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;d&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">100</span> &#125;,</span><br><span class="line">			&#123; <span class="attr">name</span>: <span class="string">&#x27;e&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">100</span> &#125;,</span><br><span class="line">		];</span><br><span class="line">		<span class="comment">// 遍历同时执行回调函数 找到目标后不再继续查找， 退出循环</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// var res = arr.findIndex(function (item) &#123; return item.score == 100 &#125;);</span></span><br><span class="line">		<span class="comment">// 箭头函数</span></span><br><span class="line">		<span class="keyword">var</span> res = arr.findIndex(<span class="function"><span class="params">item</span> =&gt;</span> item.score == <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">console</span>.log(res); <span class="comment">/* 3 下标3*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='purps'>includes</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 查找数据是否存在 存在true ，不存在 false</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">34</span>, <span class="literal">NaN</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr.includes(<span class="literal">NaN</span>));  <span class="comment">/* true */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr.indexOf(<span class="literal">NaN</span>));  <span class="comment">/* -1 */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr.indexOf(<span class="number">12</span>));   <span class="comment">/* 返回下标，无法识别NaN，返回-1 */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str =<span class="string">&#x27; hello world&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(str.includes(<span class="string">&#x27;hello&#x27;</span>));</span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='pink'>startsWidth</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;success&quot;</span>]startsWith[/tag]</span><br><span class="line">[collapse title=<span class="string">&quot;startsWith&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span><br><span class="line">&lt;script&gt;</span><br><span class="line">		<span class="comment">// 查找字符串以什么开始，结束，返回值boolean</span></span><br><span class="line">		<span class="keyword">var</span> str = <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line">		<span class="comment">// start</span></span><br><span class="line">		<span class="built_in">console</span>.log(str.startsWith(<span class="string">&#x27;h&#x27;</span>));  <span class="comment">/* true */</span></span><br><span class="line">		<span class="built_in">console</span>.log(str.startsWith(<span class="string">&#x27;H&#x27;</span>)); <span class="comment">/* false */</span></span><br><span class="line">		<span class="comment">// end</span></span><br><span class="line">		<span class="built_in">console</span>.log(str.endsWith(<span class="string">&#x27;d&#x27;</span>));</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='black'>Set</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;danger&quot;</span> outline]<span class="built_in">Set</span>[/tag]</span><br><span class="line">[collapse title=<span class="string">&quot;Set结构&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span><br><span class="line">	&lt;script&gt;</span><br><span class="line">		<span class="comment">// Set 结构不是数组</span></span><br><span class="line">		<span class="comment">/* 数组去重  只会针对基本数据类型，number boolean,string,null,undefined */</span></span><br><span class="line">		<span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="number">50</span>, <span class="number">34</span>, <span class="number">23</span>, <span class="number">12</span>, <span class="number">10</span>];</span><br><span class="line">		<span class="keyword">var</span> res = <span class="keyword">new</span> <span class="built_in">Set</span>(arr);</span><br><span class="line">		<span class="built_in">console</span>.log(res);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 数组长度</span></span><br><span class="line">		<span class="built_in">console</span>.log(res.size); <span class="comment">/* 7 */</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 添加数据 </span></span><br><span class="line">		res.add(<span class="string">&#x27;你好&#x27;</span>)</span><br><span class="line">			.add(<span class="string">&#x27;欧文得&#x27;</span>)</span><br><span class="line">		<span class="built_in">console</span>.log(res);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 删除</span></span><br><span class="line">		res.delete(<span class="string">&#x27;你好&#x27;</span>)</span><br><span class="line">		<span class="built_in">console</span>.log(res);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 包含</span></span><br><span class="line">		<span class="built_in">console</span>.log(res.has(<span class="number">10</span>));  <span class="comment">/* true */</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 清除所有数据  不需要传递参数</span></span><br><span class="line">		<span class="comment">// res.clear();</span></span><br><span class="line">		<span class="comment">// console.log(res);</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 转化数组</span></span><br><span class="line">		<span class="comment">// var res1 = Array.from(res);</span></span><br><span class="line">		<span class="comment">// console.log(res1[1]);</span></span><br><span class="line">		<span class="comment">// console.log(...res1);</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 简写  去重，返回数组</span></span><br><span class="line">		<span class="built_in">console</span>.log([... <span class="keyword">new</span> <span class="built_in">Set</span>(arr)]);</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(arr)));</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='blue'>深拷贝和浅拷贝</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;primary&quot;</span> outline]深拷贝和浅拷贝[/tag]</span><br><span class="line">[collapse title=<span class="string">&quot;深拷贝和浅拷贝&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">        <span class="comment">// 浅拷贝 将原数组或原对象的引用（指针）直接赋值给新对象</span></span><br><span class="line">        <span class="comment">// 注意：新对象，由于拷贝的是同一个指针，指向同一个内存中的同一个空间，会相互影响</span></span><br><span class="line">        <span class="keyword">var</span> o = &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;war&#x27;</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> obj = o;</span><br><span class="line">        obj.name = <span class="string">&#x27;peace&#x27;</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(o);  <span class="comment">/* peace */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 深拷贝  创建的新对象和数组，将各项属性的值，是值而不是指针</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> o = &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;war&#x27;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 方式一：手动复制实现深拷贝</span></span><br><span class="line">        <span class="keyword">var</span> obj = &#123; <span class="attr">name</span>: o.name &#125;; <span class="comment">/* 开辟新的空间 */</span></span><br><span class="line">        obj.name = <span class="string">&#x27;peace&#x27;</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(o);  <span class="comment">/* war */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 方式二：  无法解决多层的拷贝</span></span><br><span class="line">        <span class="keyword">var</span> r = &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">var</span> s = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 给 s 赋值 r 的各个属性</span></span><br><span class="line">        <span class="built_in">Object</span>.assign(s, r);</span><br><span class="line">        s.name = <span class="string">&#x27;world&#x27;</span>;  <span class="comment">/* 重复的属性，后面的会覆盖前者 */</span></span><br><span class="line">        <span class="built_in">console</span>.log(s); <span class="comment">/* world */</span></span><br><span class="line">        <span class="built_in">console</span>.log(r);<span class="comment">/* hello */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 方式三： </span></span><br><span class="line">        <span class="keyword">var</span> test = &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;我的&#x27;</span>,</span><br><span class="line">            <span class="attr">info</span>: &#123;</span><br><span class="line">                <span class="attr">age</span>: <span class="number">21</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">arr</span>: [<span class="number">10</span>, <span class="number">20</span>],</span><br><span class="line">            <span class="attr">fn</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="number">100</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 函数无法实现深拷贝，原因：函数无法转化字符串</span></span><br><span class="line">        <span class="keyword">var</span> r = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(test));</span><br><span class="line">        r.info.age = <span class="number">20</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(test); <span class="comment">/* 21 */</span></span><br><span class="line">        <span class="built_in">console</span>.log(r);  <span class="comment">/* 20 */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 递归</span></span><br><span class="line">        <span class="comment">/*思路：</span></span><br><span class="line"><span class="comment">        1，判断数据类型</span></span><br><span class="line"><span class="comment">        2，遍历数组和对象，  </span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">var</span> tests = &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;你的&#x27;</span>,</span><br><span class="line">            <span class="attr">info</span>: &#123;</span><br><span class="line">                <span class="attr">age</span>: <span class="number">21</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">arr</span>: [<span class="number">10</span>, <span class="number">20</span>],</span><br><span class="line">            <span class="attr">fn</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="number">100</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">say</span> :<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">deepCopy</span>(<span class="params">test</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 判断是否是基本数据类型 是=&gt;return</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> test !== <span class="string">&#x27;object&#x27;</span> || test == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 判断test的数据类型</span></span><br><span class="line">            <span class="keyword">let</span> result = test.__proto__.constructor == <span class="string">&#x27;Object&#x27;</span> ? &#123;&#125; : [];</span><br><span class="line">            <span class="comment">// console.log(result);</span></span><br><span class="line">            <span class="comment">// 遍历对象test（对象|数组）</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> test) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> test[key] == <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">                    <span class="comment">// test[key] 是对象或数组</span></span><br><span class="line">                    result[key] = deepCopy(test[key])</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    result[key] = test[key];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> rs = deepCopy(tests);</span><br><span class="line">        rs.name = <span class="string">&#x27;我的啊&#x27;</span></span><br><span class="line">        rs.say()</span><br><span class="line">        <span class="built_in">console</span>.log(rs);</span><br><span class="line">        <span class="built_in">console</span>.log(tests);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='blues'>数据类型严格校验</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;success&quot;</span> outline=<span class="string">&quot;1&quot;</span>]数据类型严格校验[/tag]</span><br><span class="line">[collapse title=<span class="string">&quot;isType&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span><br><span class="line">&lt;script&gt;</span><br><span class="line">        <span class="comment">// 1 数据类型</span></span><br><span class="line">        <span class="comment">// 简单数据类型:string,Boolean,number,undefined,null</span></span><br><span class="line">        <span class="comment">// 复杂数据类型:Object,Array,Function</span></span><br><span class="line">        <span class="comment">// 严格校验数据类型</span></span><br><span class="line">        <span class="comment">//  基础</span></span><br><span class="line">        <span class="keyword">var</span> r = <span class="built_in">Object</span>.prototype.toString.call(<span class="literal">null</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">null</span>);  <span class="comment">/* object */</span></span><br><span class="line">        <span class="built_in">console</span>.log(r.slice(<span class="number">8</span>, r.length - <span class="number">1</span>).toLowerCase());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 封装</span></span><br><span class="line">        <span class="comment">// function isType(content) &#123;</span></span><br><span class="line">        <span class="comment">//     let r = Object.prototype.toString.call(content);</span></span><br><span class="line">        <span class="comment">//     return r.slice(8, r.length - 1).toLowerCase();</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 闭包高度优化 </span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">isType</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">content</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(content) == <span class="string">`[object <span class="subst">$&#123;type&#125;</span>]`</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> util = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        [<span class="string">&#x27;Array&#x27;</span>, <span class="string">&#x27;Object&#x27;</span>, <span class="string">&#x27;Boolean&#x27;</span>, <span class="string">&#x27;Null&#x27;</span>, <span class="string">&#x27;Undefined&#x27;</span>, <span class="string">&#x27;Number&#x27;</span>, <span class="string">&#x27;Date&#x27;</span>, <span class="string">&#x27;Function&#x27;</span>, <span class="string">&#x27;String&#x27;</span>].forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">            util[<span class="string">`is<span class="subst">$&#123;item&#125;</span>`</span>] = isType(item);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// var util = &#123;</span></span><br><span class="line">        <span class="comment">//     isArray :function(con)&#123;&#125;,</span></span><br><span class="line">        <span class="comment">//     isObject :function(con)&#123;&#125;,</span></span><br><span class="line">        <span class="comment">//     isNumber :function(con)&#123;&#125;,</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="built_in">console</span>.log(util.isDate(<span class="keyword">new</span> <span class="built_in">Date</span>())); <span class="comment">/* true */</span></span><br><span class="line">        <span class="built_in">console</span>.log(util.isArray([]));  <span class="comment">/* true */</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span> &#123;&#125;); <span class="comment">/* Object */</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span> []); <span class="comment">/* Object */</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">Object</span>); <span class="comment">/* function */</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">Function</span>); <span class="comment">/* function */</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">Array</span>); <span class="comment">/* function */</span></span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure>
<hr>
<p>
  <span class='just'>数组操作</span>
</p>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tag type=<span class="string">&quot;danger&quot;</span> outline]数组操作[/tag]</span><br><span class="line">[collapse title=<span class="string">&quot;数组操作部分&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(arr);  <span class="comment">/*  [empty × 10] */</span></span><br><span class="line">        <span class="built_in">console</span>.log(arr.length);  <span class="comment">/* 长度为10的空数组 */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> arrs = [<span class="number">100</span>];</span><br><span class="line">        <span class="comment">// 添加  从后添加 push</span></span><br><span class="line">        <span class="comment">//push(): 可以接收任意数量的参数，把它们逐个添加到数组末尾，并返回修改后数组的长度。 </span></span><br><span class="line">        <span class="comment">//pop()：数组末尾移除最后一项，减少数组的 length 值，然后返回移除的项。</span></span><br><span class="line">        <span class="keyword">var</span> r = arrs.push(<span class="number">200</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(r, <span class="string">&#x27;r&#x27;</span>); <span class="comment">/* 返回数组的新length  2*/</span></span><br><span class="line">        <span class="built_in">console</span>.log(arrs, <span class="string">&#x27;arrs&#x27;</span>);  <span class="comment">/* [100, 200] */</span></span><br><span class="line">        <span class="keyword">var</span> r = arrs.pop()</span><br><span class="line">        <span class="built_in">console</span>.log(r, <span class="string">&#x27;r&#x27;</span>); <span class="comment">/* 返回删掉的数据 100*/</span></span><br><span class="line">        <span class="built_in">console</span>.log(arrs, <span class="string">&#x27;arrs&#x27;</span>);  <span class="comment">/* [] */</span></span><br><span class="line">        <span class="comment">// 删除</span></span><br><span class="line">        <span class="comment">// shift()：删除原数组第一项，并返回删除元素的值；如果数组为空则返回undefined 。</span></span><br><span class="line">        <span class="keyword">var</span> r = arrs.shift();</span><br><span class="line">        <span class="built_in">console</span>.log(r, <span class="string">&#x27;r&#x27;</span>); <span class="comment">/* 返回删掉的数据 100*/</span></span><br><span class="line">        <span class="built_in">console</span>.log(arrs, <span class="string">&#x27;arrs&#x27;</span>);  <span class="comment">/* [] */</span></span><br><span class="line">        <span class="comment">//unshift:将参数添加到原数组开头，并返回数组的长度 。</span></span><br><span class="line">        <span class="keyword">var</span> r = arrs.unshift(<span class="number">122</span>, <span class="number">12</span>, <span class="number">23</span>)</span><br><span class="line">        <span class="built_in">console</span>.log(r, <span class="string">&#x27;r&#x27;</span>); <span class="comment">/* 返回新的数组length 4*/</span></span><br><span class="line">        <span class="built_in">console</span>.log(arrs, <span class="string">&#x27;arrs&#x27;</span>);  <span class="comment">/* [122, 12, 23, 100] */</span></span><br><span class="line">        <span class="keyword">var</span> re = arrs.splice(<span class="number">1</span>, <span class="number">0</span>, <span class="number">200</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(re); <span class="comment">/* 空的数组 */</span></span><br><span class="line">        <span class="built_in">console</span>.log(arrs);</span><br><span class="line">        <span class="comment">// 第一个参数当前操作的下标,</span></span><br><span class="line">        <span class="comment">// 第二个参数,1,删掉一个,2,删掉2个,0,代表添加</span></span><br><span class="line">        <span class="comment">// 第三个参数,替换的数据</span></span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure>
<ol>
<li>js中，call(),apply(),bind()的作用？共同点？<br><em>共同点：都会改变this指向；不同点：call和apply会调用函数，可以改变函数内部的this指向；call传递参数用逗号分开，apply用数组传递参数；bind，不会立即调用函数，可以改变函数内部this指向，一般用在定时器中</em></li>
</ol>
<hr>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>BFC</title>
    <url>/archives/c5a97815.html</url>
    <content><![CDATA[<h1 id="面试官：谈谈你对BFC的理解？"><a href="#面试官：谈谈你对BFC的理解？" class="headerlink" title="面试官：谈谈你对BFC的理解？"></a>面试官：谈谈你对BFC的理解？</h1><p><img src="https://static.vue-js.com/c3d68290-9511-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>我们在页面布局的时候，经常出现以下情况：</p>
<ul>
<li>这个元素高度怎么没了？</li>
<li>这两栏布局怎么没法自适应？</li>
<li>这两个元素的间距怎么有点奇怪的样子？</li>
<li>……</li>
</ul>
<p>原因是元素之间相互的影响，导致了意料之外的情况，这里就涉及到<code>BFC</code>概念</p>
<p><code>BFC</code>（Block Formatting Context），即块级格式化上下文，它是页面中的一块渲染区域，并且有一套属于自己的渲染规则：</p>
<ul>
<li>内部的盒子会在垂直方向上一个接一个的放置</li>
<li>对于同一个BFC的俩个相邻的盒子的margin会发生重叠，与方向无关。</li>
<li>每个元素的左外边距与包含块的左边界相接触（从左到右），即使浮动元素也是如此</li>
<li>BFC的区域不会与float的元素区域重叠</li>
<li>计算BFC的高度时，浮动子元素也参与计算</li>
<li>BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素，反之亦然</li>
</ul>
<p><code>BFC</code>目的是形成一个相对于外界完全独立的空间，让内部的子元素不会影响到外部的元素</p>
<h2 id="二、触发条件"><a href="#二、触发条件" class="headerlink" title="二、触发条件"></a>二、触发条件</h2><p>触发<code>BFC</code>的条件包含不限于：</p>
<ul>
<li>根元素，即HTML元素</li>
<li>浮动元素：float值为left、right</li>
<li>overflow值不为 visible，为 auto、scroll、hidden</li>
<li>display的值为inline-block、inltable-cell、table-caption、table、inline-table、flex、inline-flex、grid、inline-grid</li>
<li>position的值为absolute或fixed</li>
</ul>
<h2 id="三、应用场景"><a href="#三、应用场景" class="headerlink" title="三、应用场景"></a>三、应用场景</h2><p>利用<code>BFC</code>的特性，我们将<code>BFC</code>应用在以下场景：</p>
<h4 id="防止margin重叠（塌陷）"><a href="#防止margin重叠（塌陷）" class="headerlink" title="防止margin重叠（塌陷）"></a>防止margin重叠（塌陷）</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#f55</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#fcc</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">line-height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">text-align</span>:center;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Haha&lt;/p &gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hehe&lt;/p &gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>页面显示如下：</p>
<p> <img src="https://static.vue-js.com/d0ce3650-9511-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>两个<code>p</code>元素之间的距离为<code>100px</code>，发生了<code>margin</code>重叠（塌陷），以最大的为准，如果第一个P的<code>margin</code>为80的话，两个P之间的距离还是100，以最大的为准。</p>
<p>前面讲到，同一个<code>BFC</code>的俩个相邻的盒子的<code>margin</code>会发生重叠</p>
<p>可以在<code>p</code>外面包裹一层容器，并触发这个容器生成一个<code>BFC</code>，那么两个<code>p</code>就不属于同一个<code>BFC</code>，则不会出现<code>margin</code>重叠</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.wrap</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">overflow</span>: hidden;// 新的BFC</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#f55</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#fcc</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">line-height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">text-align</span>:center;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Haha&lt;/p &gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrap&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hehe&lt;/p &gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这时候，边距则不会重叠：</p>
<p> <img src="https://static.vue-js.com/dec44740-9511-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h4 id="清除内部浮动"><a href="#清除内部浮动" class="headerlink" title="清除内部浮动"></a>清除内部浮动</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.par</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">border</span>: <span class="number">5px</span> solid <span class="number">#fcc</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"> </span></span><br><span class="line"><span class="css">    <span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">border</span>: <span class="number">5px</span> solid <span class="number">#f66</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>:<span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;par&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>页面显示如下：</p>
<p> <img src="https://static.vue-js.com/ec5d4410-9511-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>而<code>BFC</code>在计算高度时，浮动元素也会参与，所以我们可以触发<code>.par</code>元素生活才能<code>BFC</code>，则内部浮动元素计算高度时候也会计算</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.par</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现效果如下：</p>
<p> <img src="https://static.vue-js.com/f6487b20-9511-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h4 id="自适应多栏布局"><a href="#自适应多栏布局" class="headerlink" title="自适应多栏布局"></a>自适应多栏布局</h4><p>这里举个两栏的布局</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"> </span></span><br><span class="line"><span class="css">    <span class="selector-class">.aside</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">150px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#f66</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"> </span></span><br><span class="line"><span class="css">    <span class="selector-class">.main</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#fcc</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;aside&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>效果图如下：</p>
<p> <img src="https://static.vue-js.com/ffb95210-9511-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>前面讲到，每个元素的左外边距与包含块的左边界相接触</p>
<p>因此，虽然<code>.aslide</code>为浮动元素，但是<code>main</code>的左边依然会与包含块的左边相接触</p>
<p>而<code>BFC</code>的区域不会与浮动盒子重叠</p>
<p>所以我们可以通过触发<code>main</code>生成<code>BFC</code>，以此适应两栏布局</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时候，新的<code>BFC</code>不会与浮动的<code>.aside</code>元素重叠。因此会根据包含块的宽度，和<code>.aside</code>的宽度，自动变窄</p>
<p>效果如下：</p>
<p> <img src="https://static.vue-js.com/0a5f2690-9512-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>可以看到上面几个案例，都体现了<code>BFC</code>实际就是页面一个独立的容器，里面的子元素不影响外面的元素</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Block_formatting_context">https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Block_formatting_context</a></li>
<li><a href="https://github.com/zuopf769/notebook/blob/master/fe/BFC%E5%8E%9F%E7%90%86%E5%89%96%E6%9E%90/README.md">https://github.com/zuopf769/notebook/blob/master/fe/BFC%E5%8E%9F%E7%90%86%E5%89%96%E6%9E%90/README.md</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>BTC</tag>
        <tag>css面试</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript面试基础理论</title>
    <url>/archives/dc3acdcc.html</url>
    <content><![CDATA[<h1 id="JavaScript面试基础理论"><a href="#JavaScript面试基础理论" class="headerlink" title="JavaScript面试基础理论"></a>JavaScript面试基础理论</h1><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li><strong><a href="#变量类型和计算">变量类型和计算</a></strong></li>
<li><strong><a href="#原型和原型链">原型和原型链</a></strong></li>
<li><strong><a href="#new操作的实现过程">new操作的实现过程</a></strong></li>
<li><strong><a href="#闭包和作用域">闭包和作用域</a></strong></li>
<li><strong><a href="#异步和单线程">异步和单线程</a></strong></li>
</ul>
<ul>
<li><strong><a href="#跨域">跨域</a></strong></li>
<li><strong><a href="#安全性">安全性</a></strong></li>
<li><strong><a href="#http相关">http相关</a></strong></li>
</ul>
<ul>
<li><strong><a href="#模块化开发">模块化开发</a></strong></li>
</ul>
<ul>
<li><strong><a href="#手工实现系列">手工实现系列</a></strong></li>
<li><strong><a href="#手写一个深度拷贝">手写一个深度拷贝</a></strong></li>
<li><strong><a href="#防抖与节流">防抖与节流</a></strong></li>
</ul>
<ul>
<li><strong><a href="#函数式编程">函数式编程</a></strong></li>
</ul>
<h2 id="变量类型和计算"><a href="#变量类型和计算" class="headerlink" title="变量类型和计算"></a>变量类型和计算</h2><h3 id="变量类型：值类型-引用类型"><a href="#变量类型：值类型-引用类型" class="headerlink" title="变量类型：值类型 + 引用类型"></a>变量类型：值类型 + 引用类型</h3><p>引用类型中变量只是对真实对象的一个指针</p>
<p>引用类型可以无限制扩展属性</p>
<h3 id="存储方式"><a href="#存储方式" class="headerlink" title="存储方式"></a>存储方式</h3><p><strong>值类型：</strong> 存储在 栈(stack) 中，占据空间小，大小固定。</p>
<p><strong>引用类型：</strong> 同时存储在 栈 和 堆(heap) 中，占据空间大，大小不固定。引用类型在栈中存储了指针，该指针指向堆中该实体的起始地址，当解释器寻找引用值时，会首先检索其在栈中的地址，取得地址后从堆中获取实体。</p>
<h3 id="typeof：有-8-种类型"><a href="#typeof：有-8-种类型" class="headerlink" title="typeof：有 8 种类型"></a>typeof：有 8 种类型</h3><p>typeof可以精准识别出值类型，但是无法精准识别出 引用类型。</p>
<p>对于引用类型，typeof 只能识别出是 object 或 function。</p>
<blockquote>
<p>array、null、object 都会被 typeof 识别为 object 类型</p>
</blockquote>
<ol>
<li>undefined</li>
<li>string</li>
<li>number</li>
<li>boolean</li>
<li>object</li>
<li>function</li>
<li>symbol(ES6新增)</li>
<li>BigInt(ES10新增)</li>
</ol>
<h3 id="变量计算"><a href="#变量计算" class="headerlink" title="变量计算"></a>变量计算</h3><p>以下只针对 值类型 变量计算。</p>
<p><strong>加号 + ：</strong></p>
<ol>
<li>number + number   —&gt;   number + number</li>
<li>number + string   —&gt;   String(number) + string</li>
</ol>
<p><strong>双等号 == ：</strong></p>
<ol>
<li>number == string  —&gt;  string(number) == string</li>
<li>number == ‘’   —&gt;  boolean(number) == boolean(‘’)</li>
<li>null == undefined   —&gt;  boolean(null) == boolean(undefined)</li>
</ol>
<blockquote>
<p>使用双等 == ，JS 会先尝试将两侧对比转换成 string 类型，看是否相等，若不相等再尝试转换成 boolean 类型，如果依然还不相等 才会返回计算结果 false</p>
<p>三等 === 不会出现以上情况。</p>
</blockquote>
<p>除了 if(obj.a == null){…} 之外，其他地方都推荐使用 三等。</p>
<p>obj.a == null 相当于：if(obj.a === null || obj.a === undefined){…}</p>
<p><strong>条件判断 if 语句：</strong></p>
<p>会尝试将 参数 转化为 boolean 类型。</p>
<p><strong>逻辑运算：</strong></p>
<p>&amp;&amp;：对比对象均会尝试转化为 boolean 类型</p>
<p>|| ：先将对比的前者转化为 boolean 类型，若为 true 则返回前者本身的值，若为 false 则返回 后者本身的值</p>
<p>! ：将对比对象转化为 boolean 类型，并返回该结果的相反结果</p>
<p>!! ：会将对比对象转化为 boolean 类型，并返回该结果</p>
<h3 id="JS内置构造函数类型：一共-10-种"><a href="#JS内置构造函数类型：一共-10-种" class="headerlink" title="JS内置构造函数类型：一共 10 种"></a>JS内置构造函数类型：一共 10 种</h3><ol>
<li>String</li>
<li>Number</li>
<li>Boolean</li>
<li>Array</li>
<li>Object</li>
<li>Function</li>
<li>Date</li>
<li>RegExp (regular expression)</li>
<li>Error</li>
<li>Symbol</li>
</ol>
<blockquote>
<p>Math、JSON 等等都是 JS 中是内置对象，而不是内置构造函数类型，他们的构造函数类型都是：Object</p>
<p>eval()、encodeURL()、isNaN() 等等都是  JS 中的内置函数，而不是内置构造函数类型，他们的构造函数类型都是：Function</p>
<p>NaN、Infinity、undefined、globalThis 这些都是 JS 中的内置属性值，他们是具体的值，不是函数，若使用 typeof xxx，得到的是他们值的类型(注意不是构造函数类型)</p>
</blockquote>
<h3 id="undefined与undeclared、null的区别"><a href="#undefined与undeclared、null的区别" class="headerlink" title="undefined与undeclared、null的区别"></a>undefined与undeclared、null的区别</h3><p>undefined：在作用域中已声明，但未赋值的变量</p>
<p>undeclared：还没有在作用域中声明的变量</p>
<blockquote>
<p>引用 undeclared 变量会报错：ReferenceError: xx is not defined.</p>
</blockquote>
<p>null：代表空对象(事实上并不是真正的对象)</p>
<blockquote>
<p>在最初的 32 为系统中，为了性能考虑使用低位存储变量的类型信息，000 开头代表对象，然而 null 表示为全 0，所以错误得判断 null 也为 object，虽然目前 JS 内部已经做了修正，但这个 bug 一直沿用至今。</p>
</blockquote>
<h3 id="和-的valueOf和toString的结果是什么"><a href="#和-的valueOf和toString的结果是什么" class="headerlink" title="{}和[]的valueOf和toString的结果是什么"></a>{}和[]的valueOf和toString的结果是什么</h3><div class="table-container">
<table>
<thead>
<tr>
<th>运行</th>
<th>{}</th>
<th>[]</th>
</tr>
</thead>
<tbody>
<tr>
<td>valueOf()</td>
<td>{}</td>
<td>“[object Object]”</td>
</tr>
<tr>
<td>toString()</td>
<td>[]</td>
<td>“”</td>
</tr>
</tbody>
</table>
</div>
<h3 id="赋值运算"><a href="#赋值运算" class="headerlink" title="赋值运算"></a>赋值运算</h3><p>赋值运算是从右往左进行计算执行的。</p>
<p>JS 在非严格模式下，若一个变量没有使用 var/let 声明，则 JS 默认会自动帮你声明。</p>
<p>两种情况叠加，于是，会出现下面的情况：</p>
<ol>
<li>let a = b = 3 其实相当于：b = 3;  let a = b;</li>
<li>b 会被 JS 自动定义，且为全局变量</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function myFun() &#123;</span><br><span class="line">    let a = b = 3</span><br><span class="line">&#125;</span><br><span class="line">myFun()</span><br><span class="line">console.log(b) // 3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>上述代码仅在 JS 非严格模式下 可以正常运行</p>
</blockquote>
<h2 id="原型和原型链"><a href="#原型和原型链" class="headerlink" title="原型和原型链"></a>原型和原型链</h2><p><strong>一道经典面试题</strong></p>
<p>如何判断一个对象是数组类型？</p>
<p>首先 typeof xxx 是不可以的，因为 typeof 返回的是该对象的 内置类型，typeof array 得到的是 Object。</p>
<p>所谓 “数组类型” 是指 构造函数为 Array，一个对象是数组类型真正想表达的是：一个对象的构造函数是Array。</p>
<p>因此需要判断和获取 对象的构造函数 是什么。</p>
<p><strong>第1种方式：</strong></p>
<p>使用 instanceof 来判断 对象的原型链是否为 JS 内置构造函数 Array</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const arr = []</span><br><span class="line">console.log(arr instanceof Array) //true</span><br></pre></td></tr></table></figure>
<blockquote>
<p>instanceof 的本质就是不断查找(一层一层查找) 变量的 <code>__proto__.constructor</code>值，直到最深处为 null 为止，若中间发现有和 要比较的类型函数相同，则返回 true</p>
</blockquote>
<p><strong>第2种方式</strong>：</p>
<p>使用 <code>__proto__</code> 来判断对象的隐式原型构造函数是否为 Aarray的构造函数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const arr = []</span><br><span class="line">console.log(arr.__proto__  === Array.prototype)</span><br></pre></td></tr></table></figure>
<p>或者这样写：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const arr = []</span><br><span class="line">console.log(arr.__proto__.constructor === Array)</span><br></pre></td></tr></table></figure>
<p><strong>第3种方式：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const arr = []</span><br><span class="line">console.log(arr.constructor === Array)</span><br></pre></td></tr></table></figure>
<p>或者是：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">console.log(arr.constructor.name === &#x27;Array&#x27;)</span><br></pre></td></tr></table></figure>
<p><strong>第4种方式：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const arr = []</span><br><span class="line">console.log(Object.getPrototypeOf(arr) === Array.prototype)</span><br></pre></td></tr></table></figure>
<p><strong>第5种方式：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const arr = []</span><br><span class="line">console.log(Array.isArray(arr))</span><br></pre></td></tr></table></figure>
<p><strong>函数 VS 构造函数</strong></p>
<p>所谓函数，就是可以重复执行的代码块，只定义一次但是可以被执行或调用任意次。</p>
<p>从功能上来划分，函数分为：普通函数和构造函数</p>
<p>普通函数就是使用 function 定义并且有明确返回值且返回值的函数，主要作用是用来执行或计算。</p>
<p>构造函数就是使用 function 定义并且没有明确返回值的函数，JS 会给他们自动隐形添加 return this，主要作用是用来初始化一个对象。构造函数需要通过 new 来配合使用。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function myFun()&#123;</span><br><span class="line">  this.xx = xx</span><br><span class="line">  // return this 默认普通函数会自动添加这一句</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>函数名一般采用驼峰命名法，通常约定，如果是普通函数则首字母小写，如果是构造函数则首字母大写</p>
</blockquote>
<p>普通函数也可以作为构造函数存在。</p>
<p>箭头函数是没有构造函数的，也就是说箭头函数本身并不会默认自动添加上 return this 这行隐形的代码。</p>
<p>自己手工添加的 return xxx 本质上是返回函数运行结果。</p>
<p><strong>函数参数</strong></p>
<p>普通函数和构造函数都有 arguments 对象，该属性为一个类似数组的对象，数组元素为所有参数。</p>
<p>箭头函数没有 arguments 对象。</p>
<h3 id="何为原型"><a href="#何为原型" class="headerlink" title="何为原型"></a>何为原型</h3><p>在 JS 中使用构造函数来创建新的对象，每个构造函数内部都有一个 prototype 属性，该属性是一个对象，这个对象包含了可以由该构造函数的所有实例共享的属性和方法，而这个对象被称为这个实例的原型。</p>
<h3 id="原型规则"><a href="#原型规则" class="headerlink" title="原型规则"></a>原型规则</h3><p>所有的引用类型(数字、对象、函数)都遵循以下 4 个原则：</p>
<ol>
<li><p>都具有对象特性，都可以自由无限扩展属性，除了 null 以外。</p>
</li>
<li><p>都有一个 <code>__proto__</code> 属性，属性值为对象的隐式构造函数的原型</p>
</li>
<li><p>当试图得到一个对象的某属性时，如果对象本身(显示原型)没有这个属性，则会去他的 <code>__proto__</code> (隐式原型) 中寻找</p>
<blockquote>
<p>有一种特殊情况，就是在 for(item in xxx){ … } 中，只会调用该对象本身的属性，不会去尝试调用 对象隐式原型上的属性</p>
<p>判断一个对象属性是否为显示原型上，还是隐式原型上，使用 xxx.hasOwnProperty(xxx) 来判断</p>
</blockquote>
</li>
</ol>
<p>所有的函数(箭头函数除外)都有一个 prototype 属性(显式原型)，属性值为该对象的显示构造函数的原型</p>
<hr>
<p>忽略上面一段文字，重新用另外一段文字来描述原型规则：</p>
<ol>
<li><p>所有通过 function 创建的对象，都叫函数对象</p>
</li>
<li><p>所有函数对象都有一个原型对象 prototype</p>
</li>
<li><p>所有对象上都有一个隐式原型对象 <code>__proto__</code> ，指向创建该对象的构造函数的原型对象</p>
</li>
<li><p>所有的原型对象上都有一个 constructor 对象，指向该原型对象所在的构造函数本身</p>
<blockquote>
<p>JS 为了避免死循环，因此 Object.prototype 的值为 null</p>
</blockquote>
</li>
</ol>
<h3 id="写一个原型链继承的例子"><a href="#写一个原型链继承的例子" class="headerlink" title="写一个原型链继承的例子"></a>写一个原型链继承的例子</h3><p>对象显示原型对象是可以更改的！所谓继承就是 动态 更改指定构造函数的显式原型。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function Animal()&#123;</span><br><span class="line">    this.eat = function ()&#123;</span><br><span class="line">        console.log(&#x27;eat...&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Dog()&#123;</span><br><span class="line">    this.run = function () &#123;</span><br><span class="line">        console.log(&#x27;run...&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//将 Dog 的显性原型更改为一个 Animal 对象实例，从而让 Dog 也具有 Animal 的属性</span><br><span class="line">Dog.prototype = new Animal()</span><br><span class="line">const mydog = new Dog()</span><br><span class="line"></span><br><span class="line">mydog.eat()</span><br><span class="line">mydog.run()</span><br></pre></td></tr></table></figure>
<p>还有另外一种继承方式，即直接给 函数的 prototype 属性值添加新的属性：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function Dog()&#123;</span><br><span class="line">    this.run = function () &#123;</span><br><span class="line">        console.log(&#x27;run...&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dog.prototype.eat = function ()&#123;</span><br><span class="line">    console.log(&#x27;eat...&#x27;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const mydog = new Dog()</span><br><span class="line"></span><br><span class="line">console.log(Dog.prototype)</span><br><span class="line">console.log(mydog.__proto__)</span><br><span class="line"></span><br><span class="line">mydog.eat()</span><br><span class="line">mydog.run()</span><br></pre></td></tr></table></figure>
<h2 id="new-操作的实现过程"><a href="#new-操作的实现过程" class="headerlink" title="new 操作的实现过程"></a>new 操作的实现过程</h2><p>new 运算符创建一个用户定义的对象类型的实例，或具有构造函数的内置对象的实例。new 关键词会进行以下操作：</p>
<ol>
<li>创建一个空的简单对象(即 {})</li>
<li>链接该对象(即设置该对象的构造函数) 到另一个对象</li>
<li>将步骤1新创建的对象作为 this 的上下文</li>
<li>如果该函数没有返回对象，则返回 this</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function Person (str)&#123;</span><br><span class="line">    this.name = str</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const me = new Person(&#x27;puxiao&#x27;)</span><br></pre></td></tr></table></figure>
<p>以上面代码中 new 为例，分别对应上面 4 个环节：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let obj = &#123;&#125;</span><br><span class="line">obj.__proto__ = Person.prototype</span><br><span class="line">Person.apply(obj,&#x27;puxiao&#x27;)</span><br><span class="line">return this</span><br><span class="line"></span><br><span class="line">let me = obj</span><br></pre></td></tr></table></figure>
<h2 id="闭包和作用域"><a href="#闭包和作用域" class="headerlink" title="闭包和作用域"></a>闭包和作用域</h2><p>JS 不是 静态编译型 语言，而是 动态解释型 语言。</p>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>闭包是指有权访问另外一个函数作用域内变量的函数。</p>
<p>创建闭包的最常见方式就是在一个函数内创建另外一个函数。</p>
<h3 id="闭包的用途"><a href="#闭包的用途" class="headerlink" title="闭包的用途"></a>闭包的用途</h3><ol>
<li><p>使我们可以在函数外部访问到函数内部的变量。具体做法是 通过调用闭包函数，从而在外部访问到函数内部的变量，可以使用这种方法来创建私有变量。</p>
</li>
<li><p>使已经运行结束的函数上下文中的变量对象继续保留在内存中，因为闭包函数保留了这个变量对象的引用，所以这个变量才不会被回收。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function myFun()&#123;</span><br><span class="line">    let n = 0</span><br><span class="line">    function add()&#123;</span><br><span class="line">        n ++</span><br><span class="line">        console.log(n)</span><br><span class="line">    &#125;</span><br><span class="line">    return add</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const add = myFun()</span><br><span class="line"></span><br><span class="line">console.log(add()) // 1</span><br><span class="line">console.log(add()) // 2</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="声明提升"><a href="#声明提升" class="headerlink" title="声明提升"></a>声明提升</h3><p>使用 var、let、const 定义变量 或 function 定义函数，默认都会进行变量提升。</p>
<h3 id="执行上下文"><a href="#执行上下文" class="headerlink" title="执行上下文"></a>执行上下文</h3><p>JS 中执行上下文是可以改变的，存在以下 2 种情况：</p>
<ol>
<li>定义时的上下文</li>
<li>运行时的上下文</li>
</ol>
<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><p>作用域：作用域是定义变量的区域，有一套访问变量的规则。分为全局作用域、函数作用域、ES6以后出现的块级作用域</p>
<p>在 ES6之前，JS 不存在块级作用域，在 ES6以后，可以使用 let 来定义块级作用域中的变量。</p>
<h3 id="作用域链"><a href="#作用域链" class="headerlink" title="作用域链"></a>作用域链</h3><p>当代码需要调用某个变量时，若当前作用域中不存在该变量，则会一级一级向外层作用域查找。</p>
<p>这种一级一级查找变量也就形成了一种 “链式结构”，这就是作用域链。</p>
<h3 id="函数的调用"><a href="#函数的调用" class="headerlink" title="函数的调用"></a>函数的调用</h3><p>JS 中函数调用有 4 种模式：</p>
<ol>
<li>方法调用</li>
<li>正常函数调用</li>
<li>构造函数调用</li>
<li>apply/call调用</li>
</ol>
<p>无论哪种函数调用，除了声明时定义的形参外，还会自动添加2个形参：this 和 arguments</p>
<h3 id="This"><a href="#This" class="headerlink" title="This"></a>This</h3><p>this 指向谁？</p>
<ol>
<li>在浏览器中，this 指向 windows 对象</li>
<li>在函数中，this 指向最后调用它的那个对象</li>
<li>在构造函数中，this 指向 new 出来的那个新对象</li>
<li>call/apply/bind 中的 this 指向被强行绑定的那个对象</li>
<li>箭头函数中的 this，指向父作用域中的 this</li>
</ol>
<p>上面前 4 种情况，this 只有在执行时才能确认值，定义时无法确认。唯独第 5 种情况，this 在定义时就已经被明确下来。</p>
<p>myFun.xx.call(xxx) 中，call(xxx) 可以将 myFun.xx 中的 this 对象修改为 xxx</p>
<p>apply/call 主要区别仅在 传递函数形参时的形式，apply 是用数组，而 call 使用 逗号分隔。</p>
<p>bind 则表示将作用域固定为某对象，但并不会让函数立即执行。</p>
<h3 id="闭包-1"><a href="#闭包-1" class="headerlink" title="闭包"></a>闭包</h3><p>闭包的应用场景：函数返回值依然是函数</p>
<h1 id="网络通信"><a href="#网络通信" class="headerlink" title="网络通信"></a>网络通信</h1><h2 id="异步和单线程"><a href="#异步和单线程" class="headerlink" title="异步和单线程"></a>异步和单线程</h2><p>所谓同步，就是会阻塞进程，当前不执行完毕不会执行后面代码。</p>
<p>所谓异步，就是不会阻塞进程。</p>
<p>通常情况下，需要 “等待” 的操作需求，都最好使用异步。</p>
<blockquote>
<p>例如 加载资源、请求数据、计时器等</p>
<p>alert() 是同步，会阻塞进程</p>
</blockquote>
<h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><h3 id="允许跨域的标签"><a href="#允许跨域的标签" class="headerlink" title="允许跨域的标签"></a>允许跨域的标签</h3><p>在网页中，有3个标签是可以允许跨域加载资源：</p>
<ol>
<li><code>&lt;img\&gt;</code></li>
<li><code>&lt;link\&gt;</code></li>
<li><code>&lt;script&gt;</code></li>
</ol>
<h3 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h3><p>所谓通过 JSONP 解决跨域，本质上就是利用了 <code>&lt;script&gt;</code> 标签允许跨域加载资源的特性 来实现跨域数据请求：</p>
<ol>
<li>客户端通过 <code>&lt;script src=&#39;xxxxx&#39;&gt;</code> 来请求 某网络 JS 文件地址</li>
<li>服务器 动态生成 对应的 JS 文件内容(包含客户端需要的数据)返回给客户端</li>
</ol>
<h3 id="服务器端设置允许跨域"><a href="#服务器端设置允许跨域" class="headerlink" title="服务器端设置允许跨域"></a>服务器端设置允许跨域</h3><p>服务端返回数据时，添加 允许跨域的 header 标签：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">respose.setHeader(&#x27;Access-Control-Allow-Origin&#x27;,&#x27;xxxxx&#x27;)</span><br></pre></td></tr></table></figure>
<h2 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h2><h3 id="XSS-跨站请求攻击"><a href="#XSS-跨站请求攻击" class="headerlink" title="XSS 跨站请求攻击"></a>XSS 跨站请求攻击</h3><p>提交数据内容中包含 <script\> 代码，若对方并没有处理，则对方代码中就会包含攻击方的 JS 脚本。</p>
<p>通常 JS 脚本可以获取 cookie 并发送到自己服务器中。</p>
<p>后端解决方案：将 &lt; 替换为 <code>&amp;lt;</code> 、&gt; 替换为 <code>&amp;gt;</code> 这样就不是 JS 代码可执行的片段代码了。</p>
<h3 id="XSRF-伪装请求"><a href="#XSRF-伪装请求" class="headerlink" title="XSRF 伪装请求"></a>XSRF 伪装请求</h3><p>假设某网站支付的接口中，并没有进行用户验证。那么攻击者可以将该请求地址 伪装 隐藏到 给你的特定邮件或网页中，当你点击请求包含该 请求连接接口地址时，则进行自动支付(假设支付接口并不进行二次验证)。</p>
<p>后端解决方案：增加验证流程即可</p>
<h2 id="http相关"><a href="#http相关" class="headerlink" title="http相关"></a>http相关</h2><h3 id="GET-与-POST-的区别"><a href="#GET-与-POST-的区别" class="headerlink" title="GET 与 POST 的区别"></a>GET 与 POST 的区别</h3><p>GET 数据位于 消息头中，而 POST 数据位于 消息体 中。</p>
<p>另外，POST 请求不可以做以下事情：</p>
<ol>
<li>POST 请求不会被缓存</li>
<li>POST 请求不会保留在浏览器历史记录中</li>
<li>POST 请求不能收藏为书签</li>
<li>POST 请求对数据长度没有要求限制</li>
</ol>
<h1 id="模块化开发"><a href="#模块化开发" class="headerlink" title="模块化开发"></a>模块化开发</h1><h3 id="模块化的理解"><a href="#模块化的理解" class="headerlink" title="模块化的理解"></a>模块化的理解</h3><p>一个模块是实现一个特定功能的一组方法，最常用的是立即执行函数的写法，通过利用闭包来实现变量的私有化，不会对全局造成污染。</p>
<h3 id="函数式编程简单介绍"><a href="#函数式编程简单介绍" class="headerlink" title="函数式编程简单介绍"></a>函数式编程简单介绍</h3><p>通过编写纯函数，避免共享状态、可变数据、副作用 来构建软件的过程。</p>
<p>面向对象中应用程序的状态通常和方法共享和共处，但函数式编程不是这样，因此函数式编程代码更简洁，更可预测，更容易测试。</p>
<h3 id="纯函数"><a href="#纯函数" class="headerlink" title="纯函数"></a>纯函数</h3><p>给固定的参数，返回结果也一定是固定值。</p>
<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><p>将函数作为参数或者返回值的函数，称为高阶函数。</p>
<h1 id="手工实现系列"><a href="#手工实现系列" class="headerlink" title="手工实现系列"></a>手工实现系列</h1><h3 id="手工实现Array-prototype-map"><a href="#手工实现Array-prototype-map" class="headerlink" title="手工实现Array.prototype.map"></a>手工实现Array.prototype.map</h3><p><strong>分析：</strong></p>
<p>map() 函数本身作用是将数组中每一个元素都执行一遍某个函数，并将所有的执行结果汇总成一个新的数组。</p>
<p><strong>实现：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function map(arr, callback) &#123;</span><br><span class="line">    if (!Array.isArray(arr) || !arr.length || typeof callback !== &#x27;function&#x27;) &#123;</span><br><span class="line">        return []</span><br><span class="line">    &#125;</span><br><span class="line">    const result = []</span><br><span class="line"></span><br><span class="line">    for (let i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">        result.push(callback(arr[i], i, arr))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const arr = [0, 1, 2]</span><br><span class="line">function add(n, i, arr) &#123;</span><br><span class="line">    return n + 1</span><br><span class="line">&#125;</span><br><span class="line">let new_arr = map(arr, add)</span><br><span class="line">console.log(new_arr) //[1,2,3]</span><br></pre></td></tr></table></figure>
<h3 id="手工实现Array-prototype-filter"><a href="#手工实现Array-prototype-filter" class="headerlink" title="手工实现Array.prototype.filter"></a>手工实现Array.prototype.filter</h3><p><strong>分析：</strong></p>
<p>filter() 函数的作用是将数组中的所有元素都进行一次 某个函数 计算是否匹配，并将所有匹配的元素汇总成一个新数组并返回。</p>
<p><strong>实现：</strong></p>
<p>和上面 map() 的方法类似，唯一区别就在于 map 是 result.push(callback(arr[i],i,arr))，而 filter 应该是：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(callback(arr[i],i,arr))&#123;</span><br><span class="line">  result.push(arr[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="手工实现Array-prototype-reduce"><a href="#手工实现Array-prototype-reduce" class="headerlink" title="手工实现Array.prototype.reduce"></a>手工实现Array.prototype.reduce</h3><p><strong>分析：</strong></p>
<p>reduce() 函数的作用是将数组中所有元素都执行一次 某个函数，并依次累加这些计算结果，将最终结果汇总为单个返回值。</p>
<p><strong>实现：</strong></p>
<p>和前面两个略有不同的地方在于 reduce() 函数有一个 初始值 的参数(不传该值则默认为空，不会加入到汇总的起始中)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function reduce(arr, callback, initial) &#123;</span><br><span class="line">    if (!Array.isArray(arr) || !arr.length || typeof callback !== &#x27;function&#x27;) &#123;</span><br><span class="line">        return []</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    let boo = initial !== undefined</span><br><span class="line">    let result = boo ? initial : arr[0]</span><br><span class="line"></span><br><span class="line">    for (let i = boo ? 1 : 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">        result = callback(result, arr[i], i, arr)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const arr = [0, 1, 2]</span><br><span class="line">function callbackFun(value, item, i, arr) &#123;</span><br><span class="line">    return value += item</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let value = reduce(arr, callbackFun)</span><br><span class="line">let value2 = reduce(arr, callbackFun, 2)</span><br><span class="line">console.log(value, value2) // 3,5</span><br></pre></td></tr></table></figure>
<h3 id="手写一个深度拷贝"><a href="#手写一个深度拷贝" class="headerlink" title="手写一个深度拷贝"></a>手写一个深度拷贝</h3><p>先说一下浅拷贝：浅拷贝的原则是：</p>
<ol>
<li>若属性为值类型，则直接赋值</li>
<li>若属性为引用类型，则添加引用(仅仅是添加指针，内存中并未增加新的存储实体)</li>
</ol>
<p><strong>第1种浅拷贝：</strong></p>
<p>对于对象来说，比较简单的浅拷贝方式就是：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let b = &#123;...a&#125;</span><br></pre></td></tr></table></figure>
<p>对于组来说，：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let b = [...a]</span><br></pre></td></tr></table></figure>
<p><strong>第2种浅拷贝：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let b = Object.assign(&#123;&#125;,a)</span><br></pre></td></tr></table></figure>
<p>注意：Object.assign() 仅仅可以实现第一层的拷贝，如果嵌套多层则还是引用而非深度拷贝。</p>
<p><strong>深拷贝</strong></p>
<p>深拷贝就是在内存中，完全新建一份存储实体对象。</p>
<p>深拷贝实现思路为：</p>
<ol>
<li>判断拷贝对象的类型，若为值类型，则直接赋值</li>
<li>若为引用类型，则通过递归，深层次对属性进行查询，直到属性的值为值类型后，赋值，逐层赋值。</li>
</ol>
<p><strong>简单的实现代码：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function deepClone(target) &#123;</span><br><span class="line">    let result = undefined</span><br><span class="line"></span><br><span class="line">    if (target === null || !(typeof target === &#x27;object&#x27;)) &#123;</span><br><span class="line">        result = target</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        result = target.constructor.name === &#x27;Array&#x27; ? [] : &#123;&#125;</span><br><span class="line">        for (let key in target) &#123;</span><br><span class="line">            result[key] = deepClone(target[key])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在最新的 JS for in 中，本身就只会循环 对象自身特有的属性，因此是不需要添加 target.hasOwnProperty(key) 判断该属性是自身属性还是原型对象的属性。</p>
</blockquote>
<h2 id="防抖与节流"><a href="#防抖与节流" class="headerlink" title="防抖与节流"></a>防抖与节流</h2><h3 id="防抖："><a href="#防抖：" class="headerlink" title="防抖："></a>防抖：</h3><p>防抖 指 在 事件被触发 N 秒后再执行回调函数，如果在这 N 秒内又被触发，则重新计时。</p>
<blockquote>
<p>例如在用户信息提交时，可以避免用户多次点击向后台多次提交</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function debounce(fun,wait)&#123;</span><br><span class="line">  let timer </span><br><span class="line">  return (...args) =&gt; &#123;</span><br><span class="line">    clearTimeout(time)</span><br><span class="line">    timer = setTimeout(() =&gt; &#123;</span><br><span class="line">      fun(...args)</span><br><span class="line">    &#125;, wait)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="节流："><a href="#节流：" class="headerlink" title="节流："></a>节流：</h3><p>节流 指 在 N 秒之内，无论调用多少次，函数都只执行1次。</p>
<blockquote>
<p>例如在滚动浏览器时，scroll 函数的事件监听上，通过节流降低事件调用的频率</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function throttle(fun,wait)&#123;</span><br><span class="line">  let timer</span><br><span class="line">  return (...args) =&gt; &#123;</span><br><span class="line">    if(timer)&#123;</span><br><span class="line">      return</span><br><span class="line">    &#125;</span><br><span class="line">    timer = setTimerout(() =&gt; &#123;</span><br><span class="line">      fun(...args)</span><br><span class="line">      timer = null</span><br><span class="line">    &#125;, wait)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h1><h2 id="什么是函数式编程？"><a href="#什么是函数式编程？" class="headerlink" title="什么是函数式编程？"></a>什么是函数式编程？</h2><p>函数式编程是一种编程范式，<strong>主要利用函数把运算过程封装起来，通过组合各种函数来计算结果</strong>。</p>
<p><strong>试想一下以下场景：</strong></p>
<p>将字符串 “hello yang puxiao” 变成每个单词(拼音) 首字母大写。</p>
<p>代码一：按照正常的运算过程，代码为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let str = &#x27;hello yang puxiao&#x27;</span><br><span class="line">let arr = str.split(&#x27; &#x27;) //先用空格将字符串每个单词断开，将单词组合成一个数组</span><br><span class="line">arr = arr.map(item =&gt; item.slice(0,1).toUpperCase() + item.slice(1)) //得到新的数组元素</span><br><span class="line">str = arr.join(&#x27; &#x27;) //将数组元素以空格重新分割，得到最终目标结果</span><br></pre></td></tr></table></figure>
<p>代码二：上面代码可以简写合并为以下代码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let str = &#x27;hello yang puxiao&#x27;</span><br><span class="line">str = str.split(&#x27; &#x27;)</span><br><span class="line">    .map(item =&gt; item.slice(0,1).toUpperCase() + item.slice(1))</span><br><span class="line">    .join(&#x27; &#x27;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>观察并留意以上 2 种方式的代码，这里先不讨论 代码一，而是去讲一下代码二。</p>
</blockquote>
<p><strong>先说结论：代码二 实际上执行的就是 函数式编程思想。</strong></p>
<p>代码二实际上执行流程是：join( map( split( str ) ) )，体现了函数式编程的核心思想：通过函数对数据进行转换。</p>
<p><strong>函数式编程的两个基本特点：</strong></p>
<ol>
<li>通过函数来对数据进行转换</li>
<li>通过串联多个函数来求结果</li>
</ol>
<h2 id="对比声明式与命令式"><a href="#对比声明式与命令式" class="headerlink" title="对比声明式与命令式"></a>对比声明式与命令式</h2><p><strong>命令式：</strong> 通过编写一条又一条的指令去计算执行一些动作。通常会涉及一些复杂的细节和语句，例如 for、if、switch、throw</p>
<p><strong>声明式：</strong> 通过写表达式的方式来声明我们想干什么，而不是通过一步一步的指示。表达式通常是某些函数调用的复合，一些值和操作符，用来计算出结果值。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//命令式</span><br><span class="line">const team = [&#123;ceo:&#x27;a&#x27;&#125;,&#123;ceo:&#x27;b&#x27;&#125;,&#123;ceo:&#x27;c&#x27;&#125;]</span><br><span class="line">const ceo = []</span><br><span class="line">for(let i = 0; i&lt; team.length; i++)&#123;</span><br><span class="line">    ceo.push(team[i].ceo)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//声明式</span><br><span class="line">const team = const team = [&#123;ceo:&#x27;a&#x27;&#125;,&#123;ceo:&#x27;b&#x27;&#125;,&#123;ceo:&#x27;c&#x27;&#125;]</span><br><span class="line">const ceo = team.map(item =&gt; item.ceo)</span><br></pre></td></tr></table></figure>
<p>从上面代码对比中，可以看到，命令式更加强调执行过程中的每一个细节。而声明式则仅为一个表达式，不关心计数器迭代过程、不关心返回的数组如何收集。</p>
<p><strong>命令式强调的是：每一步怎么做，并且每一个步骤都会记录中间结果，方便调试</strong></p>
<p><strong>声明式强调的是：做什么，但不过分关注直接过程</strong></p>
<h2 id="函数式编程与声明式编程的关系"><a href="#函数式编程与声明式编程的关系" class="headerlink" title="函数式编程与声明式编程的关系"></a>函数式编程与声明式编程的关系</h2><p>函数式编程就是声明式编程中的一种。</p>
<p>函数式编程主要思想是将计算机运算看作函数的计算。也就是把程序问题抽象成数学问题去解决。</p>
<p>函数式编程中，所有的变量都是唯一的值，就像是数学中的代数 x y，他们要么还未被解出，要么是被解出的固定值。对于 x = x +1 这种自增是不合法的，因为修改了代数值，不符合数学逻辑。</p>
<p>严格意义上讲，函数式编程中不可以出现 if、switch 等控制语句，如果需要条件判断可使用三元运算符。</p>
<h2 id="一些名词解释"><a href="#一些名词解释" class="headerlink" title="一些名词解释"></a>一些名词解释</h2><h4 id="纯函数-无副作用"><a href="#纯函数-无副作用" class="headerlink" title="纯函数(无副作用)"></a>纯函数(无副作用)</h4><p>无副作用指调用函数时不会修改外部状态，即一个函数调用 N 次后依然返回相同的结果。通常把这种无副作用的函数称为 纯函数。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let num = 0</span><br><span class="line"></span><br><span class="line">//每次执行 add()，都会修改外部的 num 的值，因此 add() 函数不是纯函数，他是有副作用的</span><br><span class="line">function add()&#123;</span><br><span class="line">  num ++</span><br><span class="line">  return num</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//每次执行 add2()，函数内部执行的是将参数 num + 1 并返回该值，并没有修改外部任何对象</span><br><span class="line">//无论执行多少次 add2()，只要保证所传入的 参数一致，其返回结果也一定相同</span><br><span class="line">//因此这里的 add2() 是纯函数，且无副作用。</span><br><span class="line">function add2(num) &#123;</span><br><span class="line">  return num + 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="透明引用"><a href="#透明引用" class="headerlink" title="透明引用"></a>透明引用</h4><p>透明引用指函数只会用到传递给他的变量(参数)以及内部创建的变量，不会使用到其他变量。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let a = 1</span><br><span class="line">let b = 2</span><br><span class="line"></span><br><span class="line">//add() 函数内部使用到了本不是自己内部定义，也不是传递进来的参数的变量</span><br><span class="line">function add()&#123;</span><br><span class="line">  return a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//add2() 函数内部仅使用到了内部定义或参数变量，没有用到其他变量</span><br><span class="line">function add2(a,b)&#123;</span><br><span class="line">  return a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数式编程采用透明引用，除了参数外，内部不引用其他外部变量。</p>
<h4 id="不可变变量"><a href="#不可变变量" class="headerlink" title="不可变变量"></a>不可变变量</h4><p>不可变变量指变量一旦创建后，就不能再进行修改。任何修改都会生成一个新的变量。</p>
<p>换句话说：不可以修改变量，但可以返回新的值。</p>
<h4 id="函数是一等公民"><a href="#函数是一等公民" class="headerlink" title="函数是一等公民"></a>函数是一等公民</h4><p>这是一个比喻，所谓一等公民，不是指函数最厉害，而是指 <strong>函数和其他一等公民一样(变量)</strong>，可以赋值给其他变量，也可以作为参数，或者作为函数返回值。</p>
<h3 id="补充说明：不可变变量-和-JS-中-const-的概念和用途完全不同"><a href="#补充说明：不可变变量-和-JS-中-const-的概念和用途完全不同" class="headerlink" title="补充说明：不可变变量 和 JS 中 const 的概念和用途完全不同"></a>补充说明：不可变变量 和 JS 中 const 的概念和用途完全不同</h3><p><strong>虽然本小节讲的是 函数式编程，但是这里插入一些 Object.freeze() 的知识，尽管和本小节并无任何关联。</strong></p>
<p>注意：const 关键词声明的变量，仅仅表示类型不可变，类型的某属性值是可以修改的。</p>
<p>因此使用 const 声明变量并不能满足 不可变变量 的要求。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const obj = &#123; age: 18 &#125;</span><br><span class="line">obj.age = 34</span><br><span class="line">console.log(obj.age) // 34</span><br></pre></td></tr></table></figure>
<p>在 ES6 之前，原生 JS 不支持不可变变量，需要使用第三方库来实现，例如 Immutable.js、Mori 等。</p>
<p>在 ES6 之后，通过新增的 Object.freeze() 来冻结一个对象，来实现 不可变变量。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const obj = Object.freeze(&#123; age: 18 &#125;)</span><br><span class="line">obj.age = 34 //在JS严格模式下，此时会抛出一个 TypeError 错误</span><br><span class="line">console.log(obj.age) //18</span><br></pre></td></tr></table></figure>
<p>通常情况下，不可变变量 会应用在 配置项中，这样避免其他地方无意修改配置项。</p>
<p><strong>使用 Object.freeze() 冻结对象的补充说明：</strong></p>
<p><strong>补充1：冻结对象后</strong></p>
<ol>
<li>不能添加新属性</li>
<li>不能删除已有新属性</li>
<li>不能修改已有属性的值</li>
<li>不能修改原型</li>
<li>不能修改已有属性的可枚举新、可配置性、可写性</li>
</ol>
<p><strong>补充2：默认只冻结对象第一层属性</strong></p>
<p>若对象某属性依然为一个对象，则第二层对象属性值是不受约束，是可以修改的。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let me = Object.freeze(&#123;age:18,do:&#123;react:&#x27;React&#x27;&#125;&#125;)</span><br><span class="line">me.do.react = &#x27;Taro&#x27;</span><br><span class="line">console.log(me.do.react) // Taro</span><br></pre></td></tr></table></figure>
<p><strong>补充3：属性访问器 getter 和 setter 不受影响</strong></p>
<p>假设该对象具有属性访问器 getter 和  setter，那么他们作为函数本身也是会被 冻结，无法再修改的，但由于它们是函数，且可以通过参数修改属性值，所以会给人错觉，以为还是可以修改属性值的。</p>
<p><strong>补充4：若数组被冻结，则无法向该数组增加或删除数组元素</strong></p>
<p><strong>补充5：通过递归，深层冻结</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function deepFreeze(obj)&#123;</span><br><span class="line">    for( let key in obj)&#123;</span><br><span class="line">        if(obj[key] !==null &amp;&amp; typeof obj[key] === &#x27;object&#x27;)&#123;</span><br><span class="line">            deepFreeze(obj[key])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return Object.freeze(obj)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const me = deepFreeze(&#123;age:18,do:&#123;react:&#x27;React&#x27;&#125;&#125;)</span><br><span class="line">me.do.react = &#x27;Taro&#x27; //在严格模式下，会报 TypeError 错误</span><br><span class="line">console.log(me) //React</span><br></pre></td></tr></table></figure>
<p><strong>补充6：若使用 let 创建变量，尽管引用对象可以被冻结无法修改，但可以对变量重新赋值</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//若使用 let 来定义变量</span><br><span class="line">let me = Object.freeze(&#123;age:18&#125;)</span><br><span class="line"></span><br><span class="line">me = &#123;age:34&#125; //直接将变量重新赋值</span><br><span class="line">console.log(me.age) //34</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//若使用 const 来定义变量</span><br><span class="line">const me = Object.freeze(&#123;age:18&#125;)</span><br><span class="line"></span><br><span class="line">me = &#123;age:34&#125; //尝试将变量重新赋值，会直接报错</span><br></pre></td></tr></table></figure>
<h4 id="自由变量"><a href="#自由变量" class="headerlink" title="自由变量"></a>自由变量</h4><p>自由变量指不属于函数作用域的变量，通常情况下是指外层函数内定义的变量。</p>
<blockquote>
<p>所有全局变量都是自由变量，严格来说引用了全局变量的函数都是闭包，但这种闭包并没有什么实际意义作用，通常情况下自由变量是指 闭包 中外层函数中定义的变量。</p>
</blockquote>
<h2 id="常见的函数式编程模型"><a href="#常见的函数式编程模型" class="headerlink" title="常见的函数式编程模型"></a>常见的函数式编程模型</h2><h3 id="1、闭包"><a href="#1、闭包" class="headerlink" title="1、闭包"></a>1、闭包</h3><p>闭包的形成条件：</p>
<ol>
<li>函数内创建函数，即存在 内、外 两层函数</li>
<li>内层函数中引用了外层函数中定义的局部变量</li>
</ol>
<p>闭包的用途：可以定义写作用域局限的持久化变量，这些变量可以用来做缓存或者计算中间量等。</p>
<blockquote>
<p>简单来说，就是通过闭包，可以将函数内定义的变量持久化</p>
</blockquote>
<p>闭包将局部变量持久化的代码示例：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//通过匿名函数，创建了一个闭包</span><br><span class="line">const cache = (function()&#123;</span><br><span class="line">  const store = &#123;&#125;</span><br><span class="line">  return &#123;</span><br><span class="line">    get(key)&#123;</span><br><span class="line">    return store[key]</span><br><span class="line">  &#125;</span><br><span class="line">  set(key,val)&#123;</span><br><span class="line">    store[key]=val</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line">cache.set(&#x27;num&#x27;:1)</span><br><span class="line">cache.get(&#x27;num&#x27;) //1</span><br></pre></td></tr></table></figure>
<p>请注意：上述代码中，通过创建闭包，持久化了一个局部变量 sotre，弊端是 sotre 持续占用内存空间，永远不会被正常释放(垃圾回收)，容易造成内存浪费，所以一般需要一些额外手动的清理机制。</p>
<h3 id="2、高阶函数"><a href="#2、高阶函数" class="headerlink" title="2、高阶函数"></a>2、高阶函数</h3><p>高阶函数：指一个函数以函数为参数，或以函数为返回值，再或者即以函数为参数同时返回值也是一个函数。</p>
<p>高阶函数常见用途：</p>
<ol>
<li>抽象或隔离行为、作用、异步控制流程作为回调函数</li>
<li>创建可以泛用于各种数据类型的功能</li>
<li>部分应用于函数参数，或 创建一个柯里化的函数</li>
<li>接收一个函数列表，并返回一些由这个列表中的函数组成的复合函数</li>
</ol>
<blockquote>
<p>以上 4 条总结摘抄于 网上相关教程，本人暂时不太完全理解。</p>
</blockquote>
<p>使用高阶函数会让我们的代码更加清晰简洁。例如 Array.prototype.map 就是高阶函数。</p>
<h3 id="3、函数柯里化"><a href="#3、函数柯里化" class="headerlink" title="3、函数柯里化"></a>3、函数柯里化</h3><p>柯里化又称部分求值，柯里化函数会接收一些参数，然后不会立即求值，而是继续返回一个新函数，将传入的参数通过闭包的形式保存，等到被真正求值的时候，再一次性把所有传入的参数进行求值。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//普通函数</span><br><span class="line">function add(x,y)&#123;</span><br><span class="line">  return x + y</span><br><span class="line">&#125;</span><br><span class="line">add(1,2) //3</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//柯里化函数</span><br><span class="line">const add = function(x) &#123;</span><br><span class="line">  return function (y) &#123;</span><br><span class="line">    return x + y</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">let increment = add(1)</span><br><span class="line">imcrement(2) //3</span><br></pre></td></tr></table></figure>
<p>以上代码还可以简化为：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//柯里化函数</span><br><span class="line">const add = function(x) &#123;</span><br><span class="line">  return function (y) &#123;</span><br><span class="line">    return x + y</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let result = add(1)(2)</span><br><span class="line">console.log(result) //3</span><br></pre></td></tr></table></figure>
<p>柯里化通过传递较少的参数，得到一个已经记住了这些参数的新函数，某种意义上讲，这是一种对参数的 “缓存”，是一个高效的编写函数的方法。</p>
<blockquote>
<p>依我目前的理解，柯里化本质上是运用了 JS 中函数参数数量不做严格限制的前提下进行的，我认为在 TypeScript 环境下，不太适合做柯里化。</p>
</blockquote>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>JavaScript面试基础理论</tag>
      </tags>
  </entry>
  <entry>
    <title>BOM</title>
    <url>/archives/f3d3ee5b.html</url>
    <content><![CDATA[<h1 id="面试官：说说你对BOM的理解，常见的BOM对象你了解哪些？"><a href="#面试官：说说你对BOM的理解，常见的BOM对象你了解哪些？" class="headerlink" title="面试官：说说你对BOM的理解，常见的BOM对象你了解哪些？"></a>面试官：说说你对BOM的理解，常见的BOM对象你了解哪些？</h1><p> <img src="https://static.vue-js.com/3e191c40-8089-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p><code>BOM</code> (Browser Object Model)，浏览器对象模型，提供了独立于内容与浏览器窗口进行交互的对象</p>
<p>其作用就是跟浏览器做一些交互效果,比如如何进行页面的后退，前进，刷新，浏览器的窗口发生变化，滚动条的滚动，以及获取客户的一些信息如：浏览器品牌版本，屏幕分辨率</p>
<p>浏览器的全部内容可以看成<code>DOM</code>，整个浏览器可以看成<code>BOM</code>。区别如下：</p>
<p><img src="https://static.vue-js.com/482f33e0-8089-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="二、window"><a href="#二、window" class="headerlink" title="二、window"></a>二、window</h2><p><code>Bom</code>的核心对象是<code>window</code>，它表示浏览器的一个实例</p>
<p>在浏览器中，<code>window</code>对象有双重角色，即是浏览器窗口的一个接口，又是全局对象</p>
<p>因此所有在全局作用域中声明的变量、函数都会变成<code>window</code>对象的属性和方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">&#x27;js每日一题&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lookName</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  alert(<span class="built_in">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.name);  <span class="comment">//js每日一题</span></span><br><span class="line">lookName();                <span class="comment">//js每日一题</span></span><br><span class="line"><span class="built_in">window</span>.lookName();         <span class="comment">//js每日一题</span></span><br></pre></td></tr></table></figure>
<p>关于窗口控制方法如下：</p>
<ul>
<li><code>moveBy(x,y)</code>：从当前位置水平移动窗体x个像素，垂直移动窗体y个像素，x为负数，将向左移动窗体，y为负数，将向上移动窗体</li>
<li><code>moveTo(x,y)</code>：移动窗体左上角到相对于屏幕左上角的(x,y)点</li>
<li><code>resizeBy(w,h)</code>：相对窗体当前的大小，宽度调整w个像素，高度调整h个像素。如果参数为负值，将缩小窗体，反之扩大窗体</li>
<li><code>resizeTo(w,h)</code>：把窗体宽度调整为w个像素，高度调整为h个像素</li>
<li><code>scrollTo(x,y)</code>：如果有滚动条，将横向滚动条移动到相对于窗体宽度为x个像素的位置，将纵向滚动条移动到相对于窗体高度为y个像素的位置</li>
<li><p><code>scrollBy(x,y)</code>： 如果有滚动条，将横向滚动条向左移动x个像素，将纵向滚动条向下移动y个像素</p>
<p><code>window.open()</code> 既可以导航到一个特定的<code>url</code>，也可以打开一个新的浏览器窗口</p>
</li>
</ul>
<p>如果 <code>window.open()</code> 传递了第二个参数，且该参数是已有窗口或者框架的名称，那么就会在目标窗口加载第一个参数指定的URL</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.open(<span class="string">&#x27;htttp://www.vue3js.cn&#x27;</span>,<span class="string">&#x27;topFrame&#x27;</span>)</span><br><span class="line">==&gt; &lt; a href=<span class="string">&quot; &quot;</span> target=<span class="string">&quot;topFrame&quot;</span>&gt;&lt;/ a&gt;</span><br></pre></td></tr></table></figure>
<p><code>window.open()</code> 会返回新窗口的引用，也就是新窗口的 <code>window</code> 对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> myWin = <span class="built_in">window</span>.open(<span class="string">&#x27;http://www.vue3js.cn&#x27;</span>,<span class="string">&#x27;myWin&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><code>window.close()</code> 仅用于通过 <code>window.open()</code> 打开的窗口</p>
<p>新创建的 <code>window</code> 对象有一个 <code>opener</code> 属性，该属性指向打开他的原始窗口对象</p>
<h2 id="三、location"><a href="#三、location" class="headerlink" title="三、location"></a>三、location</h2><p><code>url</code>地址如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//foouser:barpassword@www.wrox.com:80/WileyCDA/?q=javascript#contents</span></span><br></pre></td></tr></table></figure>
<p><code>location</code>属性描述如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>属性名</th>
<th>例子</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>hash</td>
<td>“#contents”</td>
<td>utl中#后面的字符，没有则返回空串</td>
</tr>
<tr>
<td>host</td>
<td>www.wrox.com:80</td>
<td>服务器名称和端口号</td>
</tr>
<tr>
<td>hostname</td>
<td>www.wrox.com</td>
<td>域名，不带端口号</td>
</tr>
<tr>
<td>href</td>
<td><a href="http://www.wrox.com:80/WileyCDA/?q=javascript#contents">http://www.wrox.com:80/WileyCDA/?q=javascript#contents</a></td>
<td>完整url</td>
</tr>
<tr>
<td>pathname</td>
<td>“/WileyCDA/“</td>
<td>服务器下面的文件路径</td>
</tr>
<tr>
<td>port</td>
<td>80</td>
<td>url的端口号，没有则为空</td>
</tr>
<tr>
<td>protocol</td>
<td>http:</td>
<td>使用的协议</td>
</tr>
<tr>
<td>search</td>
<td>?q=javascript</td>
<td>url的查询字符串，通常为？后面的内容</td>
</tr>
</tbody>
</table>
</div>
<p>除了 <code>hash</code>之外，只要修改<code>location</code>的一个属性，就会导致页面重新加载新<code>URL</code></p>
<p><code>location.reload()</code>，此方法可以重新刷新当前页面。这个方法会根据最有效的方式刷新页面，如果页面自上一次请求以来没有改变过，页面就会从浏览器缓存中重新加载</p>
<p>如果要强制从服务器中重新加载，传递一个参数<code>true</code>即可</p>
<h2 id="四、navigator"><a href="#四、navigator" class="headerlink" title="四、navigator"></a>四、navigator</h2><p><code>navigator</code> 对象主要用来获取浏览器的属性，区分浏览器类型。属性较多，且兼容性比较复杂</p>
<p>下表列出了<code>navigator</code>对象接口定义的属性和方法：</p>
<p> <img src="https://static.vue-js.com/6797ab40-8089-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p> <img src="https://static.vue-js.com/74096620-8089-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="五、screen"><a href="#五、screen" class="headerlink" title="五、screen"></a>五、screen</h2><p>保存的纯粹是客户端能力信息，也就是浏览器窗口外面的客户端显示器的信息，比如像素宽度和像素高度</p>
<p> <img src="https://static.vue-js.com/7d6b21e0-8089-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="六、history"><a href="#六、history" class="headerlink" title="六、history"></a>六、history</h2><p><code>history</code>对象主要用来操作浏览器<code>URL</code>的历史记录，可以通过参数向前，向后，或者向指定<code>URL</code>跳转</p>
<p>常用的属性如下：</p>
<ul>
<li><code>history.go()</code></li>
</ul>
<p>接收一个整数数字或者字符串参数：向最近的一个记录中包含指定字符串的页面跳转，</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">history.go(<span class="string">&#x27;maixaofei.com&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>当参数为整数数字的时候，正数表示向前跳转指定的页面，负数为向后跳转指定的页面</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">history.go(<span class="number">3</span>) <span class="comment">//向前跳转三个记录</span></span><br><span class="line">history.go(-<span class="number">1</span>) <span class="comment">//向后跳转一个记录</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>history.forward()</code>：向前跳转一个页面</li>
<li><code>history.back()</code>：向后跳转一个页面</li>
<li><code>history.length</code>：获取历史记录数</li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>BOM</tag>
      </tags>
  </entry>
  <entry>
    <title>Dom</title>
    <url>/archives/59b49683.html</url>
    <content><![CDATA[<h1 id="面试官：DOM常见的操作有哪些？"><a href="#面试官：DOM常见的操作有哪些？" class="headerlink" title="面试官：DOM常见的操作有哪些？"></a>面试官：DOM常见的操作有哪些？</h1><p> <img src="https://static.vue-js.com/a89c99a0-7fdc-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、DOM"><a href="#一、DOM" class="headerlink" title="一、DOM"></a>一、DOM</h2><p>文档对象模型 (DOM) 是 <code>HTML</code> 和 <code>XML</code> 文档的编程接口</p>
<p>它提供了对文档的结构化的表述，并定义了一种方式可以使从程序中对该结构进行访问，从而改变文档的结构，样式和内容</p>
<p>任何 <code>HTML</code>或<code>XML</code>文档都可以用 <code>DOM</code>表示为一个由节点构成的层级结构</p>
<p>节点分很多类型，每种类型对应着文档中不同的信息和（或）标记，也都有自己不同的特性、数据和方法，而且与其他类型有某种关系，如下所示：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello World!&lt;/p &gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>DOM</code>像原子包含着亚原子微粒那样，也有很多类型的<code>DOM</code>节点包含着其他类型的节点。接下来我们先看看其中的三种：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">title</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">        content</span><br><span class="line">    &lt;/p &gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上述结构中，<code>div</code>、<code>p</code>就是元素节点，<code>content</code>就是文本节点，<code>title</code>就是属性节点</p>
<h2 id="二、操作"><a href="#二、操作" class="headerlink" title="二、操作"></a>二、操作</h2><p>日常前端开发，我们都离不开<code>DOM</code>操作</p>
<p>在以前，我们使用<code>Jquery</code>，<code>zepto</code>等库来操作<code>DOM</code>，之后在<code>vue</code>，<code>Angular</code>，<code>React</code>等框架出现后，我们通过操作数据来控制<code>DOM</code>（绝大多数时候），越来越少的去直接操作<code>DOM</code></p>
<p>但这并不代表原生操作不重要。相反，<code>DOM</code>操作才能有助于我们理解框架深层的内容</p>
<p>下面就来分析<code>DOM</code>常见的操作，主要分为：</p>
<ul>
<li>创建节点</li>
<li>查询节点</li>
<li>更新节点</li>
<li>添加节点</li>
<li>删除节点</li>
</ul>
<h3 id="创建节点"><a href="#创建节点" class="headerlink" title="创建节点"></a>创建节点</h3><h4 id="createElement"><a href="#createElement" class="headerlink" title="createElement"></a>createElement</h4><p>创建新元素，接受一个参数，即要创建元素的标签名</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> divEl = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="createTextNode"><a href="#createTextNode" class="headerlink" title="createTextNode"></a>createTextNode</h4><p>创建一个文本节点</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> textEl = <span class="built_in">document</span>.createTextNode(<span class="string">&quot;content&quot;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="createDocumentFragment"><a href="#createDocumentFragment" class="headerlink" title="createDocumentFragment"></a>createDocumentFragment</h4><p>用来创建一个文档碎片，它表示一种轻量级的文档，主要是用来存储临时节点，然后把文档碎片的内容一次性添加到<code>DOM</code>中</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fragment = <span class="built_in">document</span>.createDocumentFragment();</span><br></pre></td></tr></table></figure>
<p>当请求把一个<code>DocumentFragment</code> 节点插入文档树时，插入的不是 <code>DocumentFragment</code>自身，而是它的所有子孙节点</p>
<h4 id="createAttribute"><a href="#createAttribute" class="headerlink" title="createAttribute"></a>createAttribute</h4><p>创建属性节点，可以是自定义属性</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> dataAttribute = <span class="built_in">document</span>.createAttribute(<span class="string">&#x27;custom&#x27;</span>);</span><br><span class="line">consle.log(dataAttribute);</span><br></pre></td></tr></table></figure>
<h3 id="获取节点"><a href="#获取节点" class="headerlink" title="获取节点"></a>获取节点</h3><h4 id="querySelector"><a href="#querySelector" class="headerlink" title="querySelector"></a>querySelector</h4><p>传入任何有效的<code>css</code> 选择器，即可选中单个 <code>DOM</code>元素（首个）：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">&#x27;.element&#x27;</span>)</span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">&#x27;#element&#x27;</span>)</span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">&#x27;[name=&quot;username&quot;]&#x27;</span>)</span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">&#x27;div + p &gt; span&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>如果页面上没有指定的元素时，返回 <code>null</code></p>
<h4 id="querySelectorAll"><a href="#querySelectorAll" class="headerlink" title="querySelectorAll"></a>querySelectorAll</h4><p>返回一个包含节点子树内所有与之相匹配的<code>Element</code>节点列表，如果没有相匹配的，则返回一个空节点列表</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> notLive = <span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;p&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>需要注意的是，该方法返回的是一个 <code>NodeList</code>的静态实例，它是一个静态的“快照”，而非“实时”的查询</p>
<p>关于获取<code>DOM</code>元素的方法还有如下，就不一一述说</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;id属性值&#x27;</span>);返回拥有指定id的对象的引用</span><br><span class="line"><span class="built_in">document</span>.getElementsByClassName(<span class="string">&#x27;class属性值&#x27;</span>);返回拥有指定<span class="class"><span class="keyword">class</span>的对象集合</span></span><br><span class="line"><span class="class"><span class="title">document</span>.<span class="title">getElementsByTagName</span>(&#x27;标签名&#x27;)</span>;返回拥有指定标签名的对象集合</span><br><span class="line"><span class="built_in">document</span>.getElementsByName(<span class="string">&#x27;name属性值&#x27;</span>); 返回拥有指定名称的对象结合</span><br><span class="line"><span class="built_in">document</span>/element.querySelector(<span class="string">&#x27;CSS选择器&#x27;</span>);  仅返回第一个匹配的元素</span><br><span class="line"><span class="built_in">document</span>/element.querySelectorAll(<span class="string">&#x27;CSS选择器&#x27;</span>);   返回所有匹配的元素</span><br><span class="line"><span class="built_in">document</span>.documentElement;  获取页面中的HTML标签</span><br><span class="line"><span class="built_in">document</span>.body; 获取页面中的BODY标签</span><br><span class="line"><span class="built_in">document</span>.all[<span class="string">&#x27;&#x27;</span>];  获取页面中的所有元素节点的对象集合型</span><br></pre></td></tr></table></figure>
<p>除此之外，每个<code>DOM</code>元素还有<code>parentNode</code>、<code>childNodes</code>、<code>firstChild</code>、<code>lastChild</code>、<code>nextSibling</code>、<code>previousSibling</code>属性，关系图如下图所示</p>
<p> <img src="https://static.vue-js.com/c100f450-7fdc-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="更新节点"><a href="#更新节点" class="headerlink" title="更新节点"></a>更新节点</h3><h4 id="innerHTML"><a href="#innerHTML" class="headerlink" title="innerHTML"></a>innerHTML</h4><p>不但可以修改一个<code>DOM</code>节点的文本内容，还可以直接通过<code>HTML</code>片段修改<code>DOM</code>节点内部的子树</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取&lt;p id=&quot;p&quot;&gt;...&lt;/p &gt;</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line"><span class="comment">// 设置文本为abc:</span></span><br><span class="line">p.innerHTML = <span class="string">&#x27;ABC&#x27;</span>; <span class="comment">// &lt;p id=&quot;p&quot;&gt;ABC&lt;/p &gt;</span></span><br><span class="line"><span class="comment">// 设置HTML:</span></span><br><span class="line">p.innerHTML = <span class="string">&#x27;ABC &lt;span style=&quot;color:red&quot;&gt;RED&lt;/span&gt; XYZ&#x27;</span>;</span><br><span class="line"><span class="comment">// &lt;p&gt;...&lt;/p &gt;的内部结构已修改</span></span><br></pre></td></tr></table></figure>
<h4 id="innerText、textContent"><a href="#innerText、textContent" class="headerlink" title="innerText、textContent"></a>innerText、textContent</h4><p>自动对字符串进行<code>HTML</code>编码，保证无法设置任何<code>HTML</code>标签</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 获取&lt;p id=&quot;p-id&quot;&gt;...&lt;/p &gt;</span><br><span class="line">var p = document.getElementById(&#x27;p-id&#x27;);</span><br><span class="line">// 设置文本:</span><br><span class="line">p.innerText = &#x27;&lt;script&gt;alert(&quot;Hi&quot;)&lt;/script&gt;&#x27;;</span><br><span class="line">// HTML被自动编码，无法设置一个&lt;script&gt;节点:</span><br><span class="line">// &lt;p id=&quot;p-id&quot;&gt;&amp;lt;script&amp;gt;alert(&quot;Hi&quot;)&amp;lt;/script&amp;gt;&lt;/p &gt;</span><br></pre></td></tr></table></figure>
<p>两者的区别在于读取属性时，<code>innerText</code>不返回隐藏元素的文本，而<code>textContent</code>返回所有文本</p>
<h4 id="style"><a href="#style" class="headerlink" title="style"></a>style</h4><p><code>DOM</code>节点的<code>style</code>属性对应所有的<code>CSS</code>，可以直接获取或设置。遇到<code>-</code>需要转化为驼峰命名</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取&lt;p id=&quot;p-id&quot;&gt;...&lt;/p &gt;</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;p-id&#x27;</span>);</span><br><span class="line"><span class="comment">// 设置CSS:</span></span><br><span class="line">p.style.color = <span class="string">&#x27;#ff0000&#x27;</span>;</span><br><span class="line">p.style.fontSize = <span class="string">&#x27;20px&#x27;</span>; <span class="comment">// 驼峰命名</span></span><br><span class="line">p.style.paddingTop = <span class="string">&#x27;2em&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="添加节点"><a href="#添加节点" class="headerlink" title="添加节点"></a>添加节点</h3><h4 id="innerHTML-1"><a href="#innerHTML-1" class="headerlink" title="innerHTML"></a>innerHTML</h4><p>如果这个DOM节点是空的，例如，<code>&lt;div&gt;&lt;/div&gt;</code>，那么，直接使用<code>innerHTML = &#39;&lt;span&gt;child&lt;/span&gt;&#39;</code>就可以修改<code>DOM</code>节点的内容，相当于添加了新的<code>DOM</code>节点</p>
<p>如果这个DOM节点不是空的，那就不能这么做，因为<code>innerHTML</code>会直接替换掉原来的所有子节点</p>
<h4 id="appendChild"><a href="#appendChild" class="headerlink" title="appendChild"></a>appendChild</h4><p>把一个子节点添加到父节点的最后一个子节点</p>
<p>举个例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;!-- HTML结构 --&gt;</span><br><span class="line">&lt;p id=&quot;js&quot;&gt;JavaScript&lt;/p &gt;</span><br><span class="line">&lt;div id=&quot;list&quot;&gt;</span><br><span class="line">    &lt;p id=&quot;java&quot;&gt;Java&lt;/p &gt;</span><br><span class="line">    &lt;p id=&quot;python&quot;&gt;Python&lt;/p &gt;</span><br><span class="line">    &lt;p id=&quot;scheme&quot;&gt;Scheme&lt;/p &gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>添加一个<code>p</code>元素</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> js = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;js&#x27;</span>)</span><br><span class="line">js.innerHTML = <span class="string">&quot;JavaScript&quot;</span></span><br><span class="line"><span class="keyword">const</span> list = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;list&#x27;</span>);</span><br><span class="line">list.appendChild(js);</span><br></pre></td></tr></table></figure>
<p>现在<code>HTML</code>结构变成了下面</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;!-- HTML结构 --&gt;</span><br><span class="line">&lt;div id=&quot;list&quot;&gt;</span><br><span class="line">    &lt;p id=&quot;java&quot;&gt;Java&lt;/p &gt;</span><br><span class="line">    &lt;p id=&quot;python&quot;&gt;Python&lt;/p &gt;</span><br><span class="line">    &lt;p id=&quot;scheme&quot;&gt;Scheme&lt;/p &gt;</span><br><span class="line">    &lt;p id=&quot;js&quot;&gt;JavaScript&lt;/p &gt;  &lt;!-- 添加元素 --&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>上述代码中，我们是获取<code>DOM</code>元素后再进行添加操作，这个<code>js</code>节点是已经存在当前文档树中，因此这个节点首先会从原先的位置删除，再插入到新的位置</p>
<p>如果动态添加新的节点，则先创建一个新的节点，然后插入到指定的位置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> list = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;list&#x27;</span>),</span><br><span class="line"><span class="keyword">const</span> haskell = <span class="built_in">document</span>.createElement(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">haskell.id = <span class="string">&#x27;haskell&#x27;</span>;</span><br><span class="line">haskell.innerText = <span class="string">&#x27;Haskell&#x27;</span>;</span><br><span class="line">list.appendChild(haskell);</span><br></pre></td></tr></table></figure>
<h4 id="insertBefore"><a href="#insertBefore" class="headerlink" title="insertBefore"></a>insertBefore</h4><p>把子节点插入到指定的位置，使用方法如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">parentElement.insertBefore(newElement, referenceElement)</span><br></pre></td></tr></table></figure>
<p>子节点会插入到<code>referenceElement</code>之前</p>
<h4 id="setAttribute"><a href="#setAttribute" class="headerlink" title="setAttribute"></a>setAttribute</h4><p>在指定元素中添加一个属性节点，如果元素中已有该属性改变属性值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> div = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">div.setAttribute(<span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;white&#x27;</span>);<span class="comment">//第一个参数属性名，第二个参数属性值。</span></span><br></pre></td></tr></table></figure>
<h3 id="删除节点"><a href="#删除节点" class="headerlink" title="删除节点"></a>删除节点</h3><p>删除一个节点，首先要获得该节点本身以及它的父节点，然后，调用父节点的<code>removeChild</code>把自己删掉</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 拿到待删除节点:</span></span><br><span class="line"><span class="keyword">const</span> self = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;to-be-removed&#x27;</span>);</span><br><span class="line"><span class="comment">// 拿到父节点:</span></span><br><span class="line"><span class="keyword">const</span> parent = self.parentElement;</span><br><span class="line"><span class="comment">// 删除:</span></span><br><span class="line"><span class="keyword">const</span> removed = parent.removeChild(self);</span><br><span class="line">removed === self; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>删除后的节点虽然不在文档树中了，但其实它还在内存中，可以随时再次被添加到别的位置</p>
<h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document_Object_Model">https://developer.mozilla.org/zh-CN/docs/Web/API/Document_Object_Model</a></p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>Dom</tag>
      </tags>
  </entry>
  <entry>
    <title>about us 2021</title>
    <url>/archives/afcd4575.html</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">
  <script id="hbeData" type="hbeData" data-hmacdigest="ab7727bc9c471bd7f0b444471bbc6b4692c3848db01021781153c4dabf1c187b">7a13521b6242615d832816f422e7dfef73da25fdbdf3b6222d8a59b6468cf1af43f41c56cd77ce14167e0f47abb820f3b30907a60039d37ff17b59d57fe34743842ccb0d9384c989a69e8e7cdf1c7ef60db4d200d78b42a3b4723dd629cf5e2f7cc4a2706e193a5c80750d76129251512268f46f459ad01fd03b9f749a9bffb4f85d24a6d37df1b5e2dcb2e0059afb240dcd607e6c6c2d89ffc9dcbfaebd8bd0b5669189c24c4e991018c04055be3173d83dc8ffbffa92a72024a5b313ac213026ae571261cecf38ebdf6a1a67330bb222a778afafaaadcd3454403d5d0167e30d61a1d34ec44bf116ce09a42ce7a79312a2015918a13b93cad06387d6821c550637f665360a4b7a3c2eaac0f833b5a3443724186d1d0786929cb57ff9139905d1a81f2feeb7c8b942de492c97362f1d59d3072de91baeddedf36f0c6b947595fd1cedb65dbc03f7d2d0014dc205afc90dfe9292cdbb0ed425a46f2e0d5c152933e0ca62ede3b8d5874be034d4cf89823390f656c100792ac2ca272707ca5de1fc85a059e25cb2604a035f2177b7580f36978e2129156ec8bbb7cd70ad9e01a9b6fe974214a40df8299a74c92b72d3a49430e50598ed6ba3f07dc93a9334a7313900e10aa3fa9778a94676d4b53b280178d5aa506a526a4c9151244f4fb9abe0f7b8f8e46540adf13eb72900fa3b4a33075bffb843956d69b21e7092152b5b5c665401215ccc521f9f3faddf9f90e894b4478f951c1089f663650cde8d321227f78f11e5d6f7e7c7bfece80e08fd3846701fd018bec4dd849b8a80248418effcc8c97c81660c528cb716fb7c55583efee30620acba057fa86dac27ded47d83d8491b035818c16fc11220cc055b7619fe3a8791659824c0e41765301845a11570e9ca6f3e509e1be1ff31f656a10b8b3631cdae6bb83aa09ef2a32c224f85066db880cd3b4f6c87b9f75d64162522c864d0376ed7c0376f0c683a5df81e9f86ac607d463c31aed5dd74c09a7d74ab05df50622be84b70be065a13e7d6a9f4f89d23b8809139a23105501d0cd6b723f2c8b3b539f513bcb410b3cc38bc32922924d99d54dfeab46e2474101519f09f87899a9c8fe6d9a64d9654c9ca6b465c9d6ea2fdba37dff3b77ad65c64c6795a0973639747af545a85b9b34fc9d0b733967c29a6908c8b6c63ed242b12e430faf2a073f4620ebba1d0e8d0e9343e9cf49dce50458c30183ba037e964f2d29b247641e892d3fa5fafbef3da2806cfeeca8e531ce25c0238cf9c674a83c61ddbbfba1580f765e1f2f757fa639c6e9e8b2e46b6866e7cc5e4e64441652de50492ccdfb0e4fde7bf8a34eb7a7c19715f9fbc7add5b79be916c6fc9af7f7274a2a8ce592a4cdebd90dd35236e5fd662d11183cb850c005c902cf3c3eb1fbf6d2e0cd90154816a02b82ad5386c6bd176ad5392a3a455459907032a450440e34ad12b06be1c297adc27c2a2e314ebde790c1a3f194f1033ebc6dde7a8e10b9699e2f7f623ca685175d0b384d15bbec2a767d0c270d2c9941217268d89bc0b9a4e443c268764bf601b67d4d380ff94a3c6975b1b8375de834f0cef033d72fb04f8931c3e47d7b6135feac8c69f7bdbb9be4c3234ad264b7226a0d304305beddc9be96af2713a71bec0c377145da2118b5c0f34038249141a3246e589e69c7d5f74d572f32386fa144023e345fa6ff9364f7a3ade18ef79994124b1aa692e2b790c5da743d2fb4f275f368cdc7844c78c368805b84c91a68a178488b2cb517bfd67e489bbdbb277b97b7195a1bd00e76430120aec1f60c8e4ddbfa4422c96bbb5f8190fd2ff3a9d342db34544dc1130fb42f2d6a9971d51e98b4273f2354fcd5ef4b507151810116e07c3db9f479b4582cbde23beec7e855d49a930c4426459424ac832ff29473888e4a2d46f31fd58eee3dff95826d24dad1f69ab64b28d81cd2a7ba4cf100a0b597163bf0d4c1e1d6ba98c5f532b7ad3960884361fb68d417bc6283cdcf9849fe29634f9be1145eaf43c8a4cf17f5e171cd28a024320a95e9c912c1386a1c9f25959e5ffc3de3a4b6c557d54fde500505098b8ce818bef65d1b51c4b185648d73ba410302fb574f0392c896225c41e114e9ec1bf007b8956bd4dcd778e41bc63eeb4e8cf1c4a3e78c70193a9a7228289fefe6860ba011d0b6d3fda88a030e2f042efb7d0dfb9dd9cc33162ab277c4e9c717b186c4aceb250942b040733b4df49dd1e379b5fb9c35fe079f4da1ca600a568d7534d6597cb725010f6c26e041943717e2745acef4ec56013d08c4c91a58434136e96d74cf973410b8cf408f0f855113ef97181688103fff12dfe96f52e7e459bd7953cd488d4edcc2532495709a5fac90079eaa0cbb8f98fdde3928a11c838d2dfe2259e9cbed5a9a0e435cf7b0017c9612c462c43b8c179fc3198793447fc7159922defc9d3c84f6f6854a2fbb5d0508e752d14f9ab78d0493bb22384b1a8a4df92e868680ae7662fd9c2b4961ba2b80839def458dac2d583a82ea347401e30aac3d1f6dfc6de5c73803d07735fff106be5d1260993accd390d9aaa718266e04f9b5871b6021dce99ae8038ac95656f64c7e2bdfbae0bfb02b28437ddd65c9564617dc6ef377db36b3a1cf2b8cd2a0be66ceaddb5da4f9153f96f4af88a8b96c4424e26a00d7da8d0a914ff24377ffa5edbbb42a2287fadd58d865dd792e23e2c2d9741c215791f72939434b3e6fd57a643a772d78793f3532c9d5a1c456873db15f2dd3692ab5c84d2e17d1a36735f610d1d0bfa722a54b0a2ae8e234c7c8f5b5d5ab8e4bc4b6805986be48903ae3caa89645bc8ad3840ea67fc1425ab663979fba29c38023c8528d3b92f2c13035cabc1a6d3d5553c580c6f55288c35d6269e82fb337daed881371dbfa6293b2ebba3bd72d9741aefffecb878bb198680f19d0892b39fdd53bc144483692ad9070bb6ead21ef4da1c3788d9ee0207ff75a60412f6d4961736ac6f67f7345eee90b51f88818750d91e33bd985a21d64fd7184f7245f66728d2cf99050f422c4d3ccc8bc8a0ff0d6be20d32f1380356d654b64b7667b63e9922036ea1c1a61596dc5076a5c0d46b18962d1a29c3e4780528df8e82f85e49b089e7f89a31a76049e63d291bbcec90fefd4b958d99954f8ef72693a78935f17078faf7f9bced734ab9d20bf5ec6b8edadef2b97323cdded4f5b0badcc8e6b829420a28d8d86b898740f7ca982b0a29dac184811554600306cef9b8af87c2cf298dda22742f111a6388b85071fd5dc9d15f4f2522271e2beb91363cc9cf068d75e4f22b1a5331ef42a1b7b07b6b55720f528be40ec49af823651b1a6aa58ecf240204438d21bed386f7ce73ef7f7e3fb1170063a94b233814c9c3e5e2372f6b68c3f6d9146269486ab8b88c2609d407172e27918a9d978512d2e2be56c9478072174cc906a936e24a3a3123a5034cb36fc6f04fb928dcdc65c67617425805748742a1307cd93f04d9e4283566e88058f06fd81a17005291f484c9b293ba376f76c80ecf69155b8e2b8155a21293cd8ad9ec8857dccff7c4838d795ca04a9c88343790c14c522df4a5e2377c5f2e6315853f929ea7a06768ae748129a0d93bbfb44fd27ac37422d1743dc790db977ceb8d3286b7f88f61c3b8c59c7551bdeee90abd2bbc96a42a78594253441e3122a04ae5676a8b575d42be0865393b76fe12a152e16db63a11b4424b6abb87887bb593380a366e8ba26c8e36b433e13fd4e6ec43c4642e1839c2d1cfc0369ab7c180a7a2e27917cd85144896108371493ebcc23481f14eb8b3b27520ff619dc82a33042c872371812b1592e5d5e234242ba0ffb76ff26e4dc0a1605489419bfcdd95e41482e4e0e2114faac1f28dbd96fd064a597420b07660690da8927ad755d65a4c4b00d98c51046f37b724a766557ab39781c4b3fecae88191f4f66379e4e3f4785ba14bdc3fb09c542c03dae7989b0bc6e4ed945e975fbc9862435e80ef3fbb20d413504375bda9078639d2d93e0385beccd2bf993761f9ccae9d741d3488bda79f6f18ebae7adbc59752768a69b11c4f46088565c359751a0a4c60b0a1387e9d74a307dc6cbcfad8ed5c574b995fb5837b08255b9ae949bb77b56d3e590af2c0669e48f03b5aa5cd7c495ea12fde79e45d4a8defb9335fbc64215d8d40f9e726acc2b8586f39b63c2166c934cffec6c29e5c927a5b3a114ccc19a00b8a908b84c4a163af6d43aca826c8cadeb7c8c0f8f58220d086d1290160e78cc4a7d4ddbe36f2da42af7a74029845b9e2601ce9e279a4b4ccdb3e604e639e32761f567addb9ce4d482a3aeaff6b135ccda5b08cead2a447cf953edd03cee958523bbd9d404ee4ba6c4d9d4924de05b4bbb79029e47cf2d5bbe9331e5f6ba9da43aa557cc4a5738882dd8f43d1487eae4c23f1cf3db02661cdea093153c4124277aa1c133c70e9b2431fa0c09a30e39cab92ea9dd17d6d868f10c1a47cce4fb68b4ef0be2012c4b79ca9e911ac7a1c884003174306d4b14185d31983a138ebb9b3f3eb51e6a1526945841d1b2c5eb037c4ca8cba9c79eca62c5121945b8013be08f522afb43d7d726df5605f4eb7a89262d56394684eccda4c8ca60ab3eeeac64e9796ca9e6852b1165ee6001e407d1b5c80ba1241d35010fffac567</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">想看我的秘密，需要密码呦༼ つ ◕_◕ ༽つ</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>fine</category>
      </categories>
      <tags>
        <tag>fine</tag>
      </tags>
  </entry>
  <entry>
    <title>typeScript基础知识</title>
    <url>/archives/ae4c07b8.html</url>
    <content><![CDATA[<h1 id="TypeScript-教程"><a href="#TypeScript-教程" class="headerlink" title="TypeScript 教程"></a><strong>TypeScript</strong> 教程</h1><h2 id="1-TypeScript-概述"><a href="#1-TypeScript-概述" class="headerlink" title="1. TypeScript 概述"></a>1. TypeScript 概述</h2><h3 id="1-1-TypeScript-是什么"><a href="#1-1-TypeScript-是什么" class="headerlink" title="1.1 TypeScript 是什么"></a>1.1 TypeScript 是什么</h3><ul>
<li><p>TypeScript 是一门基于 JavaScript 的编程语言，它是具有类型系统的 JavaScript，是一种解决 JavaScript 缺点的编程语言。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 所有的 JavaScript 代码都是合法的 TypeScript 代码。</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TypeScript 是静态类型编程语言，即编译期间进行类型检查，变量、参数、返回值等都必须有固定的类型。</span></span><br><span class="line"><span class="keyword">let</span> x: <span class="built_in">number</span> = <span class="number">10</span>;</span><br><span class="line">x = <span class="number">20</span>;  <span class="comment">// ✅</span></span><br><span class="line">x = <span class="string">&quot;a&quot;</span>; <span class="comment">// ❎</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2022/07/01/jMhJKJ.png" /></p>
</li>
</ul>
<ul>
<li><p>TypeScript 不能在浏览器环境或者 Node 环境直接运行，它在执行前需要先被编译为 JavaScript。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TypeScript</span></span><br><span class="line"><span class="keyword">let</span> isLogin: <span class="built_in">boolean</span> = <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Javascript</span></span><br><span class="line"><span class="keyword">let</span> isLogin = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>TypeScript 提供的类型系统只应用在开发阶段，只有在开发阶段开发者才需要借助它编写出更加健壮的程序。<br><img src="/img/ts/images/03.png" /></p>
</li>
<li><p>TypeScript 由微软发布，第一个正式版的发布时间为是2013年6月19日。<br><img src="/img/ts/images/01.png" /></p>
</li>
</ul>
<h3 id="1-2-类型系统带来的好处"><a href="#1-2-类型系统带来的好处" class="headerlink" title="1.2 类型系统带来的好处"></a>1.2 类型系统带来的好处</h3><p>通过静态类型检查可以让开发者在编译时就发现错误而不是在代码运行时。</p>
<p>类型系统为编辑器带来了更加精准的代码提示，以此来提升开发人员的编程体验。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">app.get(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.</span><br><span class="line">    send</span><br><span class="line">    sendDate</span><br><span class="line">    sendfile</span><br><span class="line">    sendFile</span><br><span class="line">    sendStatus</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在声明变量时明确告知编译器它的类型，编译器就知道该变量可以调用哪些属性和方法，当开发者调用了错误的属性或方法时，编译器会及时给出提示。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> name: <span class="built_in">string</span> = <span class="string">&quot;张三&quot;</span>;</span><br><span class="line">name.toFixed(<span class="number">2</span>); <span class="comment">// 属性&quot;toFixed&quot;在类型&quot;string&quot;上不存在</span></span><br></pre></td></tr></table></figure>
<p>在声明函数时明确告知编译器参数的类型，当开发者调用该函数时如果传递的参数的类型不正确，编译器会及时给出提示。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>) </span>&#123;&#125;</span><br><span class="line">sum(<span class="number">10</span>, <span class="string">&quot;a&quot;</span>); <span class="comment">// 类型&quot;string&quot;的参数不能赋给类型&quot;number&quot;的参数。</span></span><br></pre></td></tr></table></figure>
<p>在声明函数时明确告知编译器返回值的类型，当开发者返回的值的类型错误时，编译器会及时给出提示。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params"></span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">100</span>; <span class="comment">// 不能将类型&quot;number&quot;分配给类型&quot;string&quot;。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在声明对象时告知编译器该对象下有哪些属性，当开发者访问了对象中不存在的属性时，编译器会及时给出提示。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span> &#125;;</span><br><span class="line">person.age; <span class="comment">// 类型&quot;&#123;name: string&#125;&quot;上不存在属性&quot;age&quot;。</span></span><br></pre></td></tr></table></figure>
<p>类型系统使代码变得可预测，能够让开发者更早的发现代码存在的问题和潜在问题。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123; &#125;</span><br><span class="line"><span class="built_in">console</span>.log(i); <span class="comment">// 编译器会捕获到错误: cannot find name &quot;i&quot;</span></span><br></pre></td></tr></table></figure>
<p>当重复声明同名变量时，编译器会立即给出提示。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="comment">// 无法重新声明块范围变量&quot;colors&quot;。</span></span><br><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br></pre></td></tr></table></figure>
<h2 id="2-TypeScript-初体验"><a href="#2-TypeScript-初体验" class="headerlink" title="2. TypeScript 初体验"></a>2. TypeScript 初体验</h2><h3 id="2-1-第一个-TypeScript-应用"><a href="#2-1-第一个-TypeScript-应用" class="headerlink" title="2.1 第一个 TypeScript 应用"></a>2.1 第一个 TypeScript 应用</h3><blockquote>
<p>需求：向服务端发送请求获取 ID 为 1 的任务对象。</p>
<p>目标：将 TypeScript 编译为 JavaScript。</p>
</blockquote>
<hr>
<ul>
<li>[ ] 安装 TypeScript 编译器，用于将 TypeScript 代码编译为 JavaScript 代码</li>
<li>[ ] 安装 axios 库，用于发送请求</li>
<li>[ ] 新建 index.ts 文件，用于编写代码</li>
<li>[ ] 将 TypeScript 代码编译为 JavaScript 代码并执行</li>
</ul>
<hr>
<p>第一步：安装 TypeScript 编译器，用于将 TypeScript 代码编译为 JavaScript 代码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 全局安装 typescript 编译器</span></span><br><span class="line">npm install -g typescript</span><br><span class="line"><span class="comment"># 通过查看 typescript 编译器版本验证编译器是否安装成功</span></span><br><span class="line">tsc -version</span><br></pre></td></tr></table></figure>
<p>第二步：安装 axios 库，用于发送请求。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装 axios 用于发送请求</span></span><br><span class="line">npm install axios</span><br></pre></td></tr></table></figure>
<p>第三步：新建 index.ts 文件用于编写代码，TypeScript 程序文件的后缀名为 <code>.ts</code>。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line">axios.get(<span class="string">&quot;https://jsonplaceholder.typicode.com/todos/1&quot;</span>).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(response.data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>第四步：将 TypeScript 代码编译为 JavaScript 代码并执行。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 编译 index.ts 文件, 编译后在同级目录下会多出 index.js 文件, 该文件存储的就是编译后的 JavaScript 代码</span></span><br><span class="line">tsc index.ts</span><br><span class="line"><span class="comment"># 执行 JavaScript 代码</span></span><br><span class="line">node index.js</span><br></pre></td></tr></table></figure>
<h3 id="2-2-优化工作流"><a href="#2-2-优化工作流" class="headerlink" title="2.2 优化工作流"></a>2.2 优化工作流</h3><blockquote>
<p>目标：监控 TypeScript 文件的变化，实现自动编译、自动执行代码</p>
</blockquote>
<hr>
<ul>
<li><p>[ ] 安装 nodemon、ts-node</p>
</li>
<li><p>[ ] 创建应用启动脚本</p>
</li>
<li>[ ] 通过应用启动脚本启动应用</li>
</ul>
<hr>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># nodemon: 监听文件的变化, 当 TypeScript 文件内容发生变动后调用 ts-node</span></span><br><span class="line"><span class="comment"># ts-node: 将 TypeScript 编译为 JavaScript 并执行</span></span><br><span class="line">npm install -g nodemon ts-node</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;nodemon index.ts&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
<p>tsc 与 ts-node 的主要区别在于 tsc 根据您的 tsconfig 编译所有文件。ts-node 会从入口文件开始，并根据导入/导出逐步转译文件。</p>
<h3 id="2-3-体验类型带来的好处"><a href="#2-3-体验类型带来的好处" class="headerlink" title="2.3 体验类型带来的好处"></a>2.3 体验类型带来的好处</h3><p>需求：将任务ID、任务名称、任务是否完成分别输出到控制台中。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line">axios.get(<span class="string">&quot;https://jsonplaceholder.typicode.com/todos/1&quot;</span>).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> todo = response.data;</span><br><span class="line">  <span class="keyword">const</span> id = todo.ID;</span><br><span class="line">  <span class="keyword">const</span> title = todo.Title;</span><br><span class="line">  <span class="keyword">const</span> finished = todo.finished;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`</span></span><br><span class="line"><span class="string">    任务的ID是: <span class="subst">$&#123;id&#125;</span>,</span></span><br><span class="line"><span class="string">    任务的名称是: <span class="subst">$&#123;title&#125;</span>,</span></span><br><span class="line"><span class="string">    任务是否完成: <span class="subst">$&#123;finished&#125;</span></span></span><br><span class="line"><span class="string">  `</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>以上代码执行后，输出的结果都是 undefined，发生了什么？</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">任务的ID是: undefined,</span><br><span class="line">任务的名称是: undefined,</span><br><span class="line">任务是否完成: undefined</span><br></pre></td></tr></table></figure>
<p>通过查看得知，任务 ID 对应的属性名称是 id，任务名称对应的属性名称是 title，任务是否完成对应的属性名称是 completed，原来是属性名称写错了。</p>
<p>目前的问题是在书写代码的过程中并没有任何的错误提示，只有代码运行以后开发者才能够知道代码中存在错误，这个问题应该怎么解决呢？</p>
<p>显式告知 TypeScript 编译器 response.data 中存储的数据的类型，编译器会实时检测你写的代码是否符合类型上的要求。</p>
<p>以下代码展示的是通过 TypeScript 约束对象中可以存在的属性，当访问了不存在的属性时编译器会实时进行提示。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// interface 意为接口, 可以约束对象中可以有哪些属性, 约束对象中属性的类型 </span></span><br><span class="line"><span class="keyword">interface</span> Todo &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  title: <span class="built_in">string</span>;</span><br><span class="line">  completed: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">axios.get(<span class="string">&quot;https://jsonplaceholder.typicode.com/todos/1&quot;</span>).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> todo = response.data <span class="keyword">as</span> Todo;</span><br><span class="line">  <span class="keyword">const</span> id = todo.ID; <span class="comment">// 属性&quot;Id&quot;在类型&quot;Todo&quot;上不存在。你是否指的是&quot;id&quot;?</span></span><br><span class="line">  <span class="keyword">const</span> title = todo.Title; <span class="comment">// 属性&quot;Title&quot;在类型“Todo&quot;上不存在。你是否指的是&quot;title&quot;?</span></span><br><span class="line">  <span class="keyword">const</span> finished = todo.finished; <span class="comment">// 属性&quot;finished&quot;在类型&quot;Todo&quot;上不存在。</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`</span></span><br><span class="line"><span class="string">    任务的ID是: <span class="subst">$&#123;id&#125;</span>, </span></span><br><span class="line"><span class="string">    任务的名称是: <span class="subst">$&#123;title&#125;</span>, </span></span><br><span class="line"><span class="string">    任务是否结束: <span class="subst">$&#123;finished&#125;</span></span></span><br><span class="line"><span class="string">  `</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>以下代码展示的是通过 TypeScript 约束函数参数的类型，调用函数时如果传入的参数类型错误，编译器会实时进行提示。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Todo &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  title: <span class="built_in">string</span>;</span><br><span class="line">  completed: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">axios.get(<span class="string">&quot;https://jsonplaceholder.typicode.com/todos/1&quot;</span>).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> todo = response.data <span class="keyword">as</span> Todo;</span><br><span class="line">  <span class="keyword">const</span> id = todo.id;</span><br><span class="line">  <span class="keyword">const</span> title = todo.title;</span><br><span class="line">  <span class="keyword">const</span> completed = todo.completed;</span><br><span class="line">  logTodo(title, id, completed); <span class="comment">// 类型&quot;string&quot;的参数不能赋给类型&quot;number&quot;的参数。</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logTodo</span>(<span class="params">id: <span class="built_in">number</span>, title: <span class="built_in">string</span>, completed: <span class="built_in">boolean</span></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`</span></span><br><span class="line"><span class="string">  任务的ID是: <span class="subst">$&#123;id&#125;</span>,</span></span><br><span class="line"><span class="string">  任务的名称是: <span class="subst">$&#123;title&#125;</span>,</span></span><br><span class="line"><span class="string">  任务是否结束: <span class="subst">$&#123;completed&#125;</span></span></span><br><span class="line"><span class="string">`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-TypeScript-基础类型"><a href="#3-TypeScript-基础类型" class="headerlink" title="3. TypeScript 基础类型"></a>3. TypeScript 基础类型</h2><h3 id="3-1-概述"><a href="#3-1-概述" class="headerlink" title="3.1 概述"></a>3.1 概述</h3><p>在 TypeScript 中，开发者可以通过类型注释对变量、参数、返回值的类型进行标注。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>JavaScript</th>
<th>TypeScript</th>
</tr>
</thead>
<tbody>
<tr>
<td>number</td>
<td>any</td>
</tr>
<tr>
<td>string</td>
<td>unknow</td>
</tr>
<tr>
<td>boolean</td>
<td>never</td>
</tr>
<tr>
<td>null</td>
<td>enum</td>
</tr>
<tr>
<td>undefined</td>
<td>tuple</td>
</tr>
<tr>
<td>object</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-2-基本数据类型"><a href="#3-2-基本数据类型" class="headerlink" title="3.2 基本数据类型"></a>3.2 基本数据类型</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 数值类型</span></span><br><span class="line"><span class="keyword">let</span> apples: <span class="built_in">number</span> = <span class="number">5</span>;</span><br><span class="line"><span class="comment">// 字符串类型</span></span><br><span class="line"><span class="keyword">let</span> speed: <span class="built_in">string</span> = <span class="string">&quot;fast&quot;</span>;</span><br><span class="line"><span class="comment">// 布尔值布尔</span></span><br><span class="line"><span class="keyword">let</span> hasName: <span class="built_in">boolean</span> = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TS2322: Type &#x27;string&#x27; is not assignable to type &#x27;number&#x27;</span></span><br><span class="line"><span class="comment">// 类型 &#x27;string&#x27; 不能分配给类型为 &#x27;number&#x27;</span></span><br><span class="line">apples = <span class="string">&quot;5&quot;</span>;    <span class="comment">// ❎</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2322: Type &#x27;number&#x27; is not assignable to type &#x27;string&#x27;.</span></span><br><span class="line"><span class="comment">// 类型 &#x27;number&#x27; 不能分配给类型 &#x27;string&#x27;</span></span><br><span class="line">speed = <span class="number">120</span>;     <span class="comment">// ❎</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2322: Type &#x27;string&#x27; is not assignable to type &#x27;boolean&#x27;.</span></span><br><span class="line"><span class="comment">// 类型 &#x27;string&#x27; 不能分类给类型 &#x27;boolean&#x27;</span></span><br><span class="line">hasName = <span class="string">&quot;yes&quot;</span>; <span class="comment">// ❎</span></span><br></pre></td></tr></table></figure>
<p><img src="https://files.catbox.moe/tclcf5.png" alt=""></p>
<h3 id="3-3-any-类型"><a href="#3-3-any-类型" class="headerlink" title="3.3 any 类型"></a>3.3 any 类型</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// any 类型</span></span><br><span class="line"><span class="comment">// 变量中可以存储任何数据类型的值</span></span><br><span class="line"><span class="keyword">let</span> anything: <span class="built_in">any</span> = <span class="string">&quot;Hello TypeScript&quot;</span>;</span><br><span class="line">anything = <span class="literal">true</span>;           <span class="comment">// ✅</span></span><br><span class="line">anything = <span class="number">3.14</span>;           <span class="comment">// ✅</span></span><br><span class="line">anything = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// ✅</span></span><br><span class="line">anything = <span class="literal">null</span>;           <span class="comment">// ✅</span></span><br></pre></td></tr></table></figure>
<h3 id="3-4-数组-Array"><a href="#3-4-数组-Array" class="headerlink" title="3.4 数组 Array"></a>3.4 数组 Array</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在没有为数组显式标注类型时, 变量的初始值又是一个空数组</span></span><br><span class="line"><span class="comment">// 此时该数组中可以存储任何类型的值</span></span><br><span class="line"><span class="comment">// 虽然写法正确, 但丢失了 TypeScript 类型检查功能</span></span><br><span class="line"><span class="comment">// let colors = any[];</span></span><br><span class="line"><span class="keyword">let</span> colors = [];</span><br><span class="line"></span><br><span class="line">colors[<span class="number">0</span>] = <span class="number">1</span>;        <span class="comment">// ✅</span></span><br><span class="line">colors[<span class="number">1</span>] = <span class="string">&quot;hello&quot;</span>;  <span class="comment">// ✅</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 字符串数组</span></span><br><span class="line"><span class="keyword">let</span> colors: <span class="built_in">string</span>[] = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="comment">// 数值数组</span></span><br><span class="line"><span class="keyword">let</span> numbers: <span class="built_in">number</span>[] = [<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>];</span><br><span class="line"><span class="comment">// 布尔数组</span></span><br><span class="line"><span class="keyword">let</span> bools: <span class="built_in">boolean</span>[] = [<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>];</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 二维数组</span></span><br><span class="line"><span class="keyword">const</span> carMakers: <span class="built_in">string</span>[][] = [[<span class="string">&quot;宝马&quot;</span>, <span class="string">&quot;比亚迪&quot;</span>]];</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// item: string</span></span><br><span class="line">colors.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;&#125;);</span><br><span class="line"><span class="comment">// let colors: string[]</span></span><br><span class="line">colors[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<h3 id="3-5-元组-Tuples"><a href="#3-5-元组-Tuples" class="headerlink" title="3.5 元组 Tuples"></a>3.5 元组 Tuples</h3><p>观察下列代码中存在的问题。</p>
<p>在 employee 数组中我们约定在数组中下标为0的位置存储员工姓名，在下标为1的位置存储员工的年龄。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> employee = [<span class="string">&quot;张三&quot;</span>, <span class="number">20</span>];</span><br><span class="line">employee[<span class="number">0</span>] = <span class="number">30</span>;</span><br><span class="line">employee[<span class="number">1</span>] = <span class="string">&quot;李四&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>以上代码存在的问题是 employee 数组没有被类型系统约束，没有约束每个数组元素对应的类型，导致在错误位置修改元素值时没有错误提示。</p>
<p>元组是 TypeScript 引入的一种新数据类型，它像数组一样工作但是有一些额外的限制：元组中元素个数是固定，元组中元素类型已知。</p>
<p>元组用来存储一些以特定顺序出现且相关关联的数据，通过元组可以约束元素个数及元素类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> employee: [<span class="built_in">string</span>, <span class="built_in">number</span>] = [<span class="string">&quot;张三&quot;</span>, <span class="number">20</span>];</span><br><span class="line"><span class="comment">// 不能将类型&quot;number&quot;分配给类型&quot;string&quot;</span></span><br><span class="line">employee[<span class="number">0</span>] = <span class="number">30</span>;</span><br><span class="line"><span class="comment">// 不能将类型&quot;string&quot;分配给类型&quot;number&quot;</span></span><br><span class="line">employee[<span class="number">1</span>] = <span class="string">&quot;李四&quot;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 使用元组存储 RGB 颜色值及透明度</span></span><br><span class="line"><span class="keyword">var</span> bgColor: [<span class="built_in">number</span>, <span class="built_in">number</span>, <span class="built_in">number</span>, <span class="built_in">number</span>] = [<span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>];</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建元组数组(二维数组)</span></span><br><span class="line"><span class="keyword">var</span> employees: [<span class="built_in">number</span>, <span class="built_in">string</span>][] = [</span><br><span class="line">  [<span class="number">1</span>, <span class="string">&quot;Steve&quot;</span>],</span><br><span class="line">  [<span class="number">2</span>, <span class="string">&quot;Tom&quot;</span>],</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<h3 id="3-6-枚举-Enum"><a href="#3-6-枚举-Enum" class="headerlink" title="3.6 枚举 Enum"></a>3.6 枚举 Enum</h3><p>枚举用于存储一组密切相关且有限的值，可以提升代码的可读性，可以限定值的范围，比如比赛结果，考试成绩，颜色种类，性别等等。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">enum</span> Sizes &#123;</span><br><span class="line">  Small,  <span class="comment">// Small = 0</span></span><br><span class="line">  Medium, <span class="comment">// Medium = 1</span></span><br><span class="line">  Large,  <span class="comment">// Large = 2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(Sizes.Small); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">enum</span> Sizes &#123;</span><br><span class="line">  Small = <span class="number">1</span>,  <span class="comment">// Small = 1</span></span><br><span class="line">  Medium,     <span class="comment">// Medium = 2</span></span><br><span class="line">  Large,      <span class="comment">// Large = 3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(Sizes.Small); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 如果枚举值为非数值, 则每个属性都必须进行初始化</span></span><br><span class="line"><span class="built_in">enum</span> Sizes &#123;</span><br><span class="line">  Small = <span class="string">&quot;s&quot;</span>,</span><br><span class="line">  Medium = <span class="string">&quot;m&quot;</span>,</span><br><span class="line">  Large = <span class="string">&quot;l&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(Sizes.Small); <span class="comment">// s</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 枚举被编译为了 JavaScript 中的对象</span></span><br><span class="line"><span class="keyword">var</span> Sizes;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">Sizes</span>) </span>&#123;</span><br><span class="line">    Sizes[<span class="string">&quot;Small&quot;</span>] = <span class="string">&quot;s&quot;</span>;</span><br><span class="line">    Sizes[<span class="string">&quot;Medium&quot;</span>] = <span class="string">&quot;m&quot;</span>;</span><br><span class="line">    Sizes[<span class="string">&quot;Large&quot;</span>] = <span class="string">&quot;l&quot;</span>;</span><br><span class="line">&#125;)(Sizes || (Sizes = &#123;&#125;));</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在声明枚举类型时, 如果使用 const 关键字, TypeScript 编译器将输出更加简洁的代码</span></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">enum</span> Sizes &#123;</span><br><span class="line">  Small = <span class="string">&quot;s&quot;</span>,</span><br><span class="line">  Medium = <span class="string">&quot;m&quot;</span>,</span><br><span class="line">  Large = <span class="string">&quot;l&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> selected = Sizes.Large;</span><br><span class="line"><span class="built_in">console</span>.log(selected);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这是以上代码的编译结果</span></span><br><span class="line"><span class="keyword">var</span> selected = <span class="string">&quot;l&quot;</span> <span class="comment">/* Large */</span>;</span><br><span class="line"><span class="built_in">console</span>.log(selected);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 枚举使用示例</span></span><br><span class="line"><span class="built_in">enum</span> Sizes &#123;</span><br><span class="line">  Small = <span class="string">&quot;s&quot;</span>,</span><br><span class="line">  Medium = <span class="string">&quot;m&quot;</span>,</span><br><span class="line">  Large = <span class="string">&quot;l&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> selected: Sizes = Sizes.Small;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateSize</span>(<span class="params">size: Sizes</span>) </span>&#123;</span><br><span class="line">  selected = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">updateSize(Sizes.Large);</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>场景</th>
<th>使用</th>
<th>不使用</th>
</tr>
</thead>
<tbody>
<tr>
<td>消息的阅读状态</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>从1750年到现在的年份列表</td>
<td></td>
<td>NO</td>
</tr>
<tr>
<td>菜单中饮料的种类</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>文章列表的所有标题</td>
<td></td>
<td>NO</td>
</tr>
<tr>
<td>服务器端的电影分类</td>
<td></td>
<td>NO</td>
</tr>
<tr>
<td>颜色选择器中的颜色</td>
<td>YES</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-7-函数-Function"><a href="#3-7-函数-Function" class="headerlink" title="3.7 函数 Function"></a>3.7 函数 Function</h3><p>通过类型注释可以显式设置函数将要接收的参数的类型，函数将要返回的值的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> add = (a: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span>): <span class="function"><span class="params">number</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// TS2345: Argument of type &#x27;string&#x27; is not assignable to parameter of type &#x27;number&#x27;.</span></span><br><span class="line">sum(<span class="number">10</span>, <span class="string">&quot;20&quot;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> logNumber: <span class="function">(<span class="params">n: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">logNumber = (m: <span class="built_in">number</span>): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(m);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>如果函数没有返回值，可以使用 void 进行标注。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"></span>): <span class="title">void</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>TypeScript 编译器会检查实参的类型及参数数量是否正确。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2554: Expected 2 arguments, but got 3.</span></span><br><span class="line">sum(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</span><br></pre></td></tr></table></figure>
<p>TypeScript 编译器会检测函数是否拥有正确的返回值。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TS2366: Function lacks ending return statement and return type does not include &#x27;undefined&#x27;.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a: <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (a &gt; <span class="number">10</span>) <span class="keyword">return</span> a + <span class="number">20</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TypeScript 编译器会检测函数内部没有使用的变量。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 未使用的 局部变量 x </span></span><br><span class="line">  <span class="comment">// 移除未使用的 局部变量 &#x27;x&#x27; </span></span><br><span class="line">  <span class="keyword">let</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过 ? 的方式设置可选参数, 它的类型是要么是它原本的类型要么是 undefined。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// c?: number | undefined</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span>, c?: <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> c !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b + c;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sum(<span class="number">10</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<p>通过参数默认值的方式设置可选参数，它的类型就是原本的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// c?: number</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span>, c: <span class="built_in">number</span> = <span class="number">0</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sum(<span class="number">10</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<p>在定义函数时，如果形参被定义为解构语法，则使用下面的方式为函数形参设置类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> logWeather = <span class="function">(<span class="params">&#123; date, weather &#125;: &#123; date: <span class="built_in">Date</span>; weather: <span class="built_in">string</span> &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(date, weather);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> today = &#123;</span><br><span class="line">  <span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">  <span class="attr">weather</span>: <span class="string">&quot;sunny&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">logWeather(today);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> profile = &#123;</span><br><span class="line">  <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">coords</span>: &#123;</span><br><span class="line">    <span class="attr">lat</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">lng</span>: <span class="number">15</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; age &#125;: &#123; <span class="attr">age</span>: <span class="built_in">number</span> &#125; = profile;</span><br><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">  <span class="attr">coords</span>: &#123; lat, lng &#125;,</span><br><span class="line">&#125;: &#123; <span class="attr">coords</span>: &#123; <span class="attr">lat</span>: <span class="built_in">number</span>; lng: <span class="built_in">number</span> &#125; &#125; = profile;</span><br></pre></td></tr></table></figure>
<h3 id="3-8-对象-Object"><a href="#3-8-对象-Object" class="headerlink" title="3.8 对象 Object"></a>3.8 对象 Object</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 对象字面量</span></span><br><span class="line"><span class="keyword">let</span> point: &#123; <span class="attr">x</span>: <span class="built_in">number</span>; y: <span class="built_in">number</span> &#125; = &#123; <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">200</span> &#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> employee: &#123; <span class="keyword">readonly</span> id: <span class="built_in">number</span> &#125; = &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2540: Cannot assign to &#x27;id&#x27; because it is a read-only property.</span></span><br><span class="line"><span class="comment">// employee.id = 2;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2741: Property &#x27;name&#x27; is missing in type &#x27;&#123;&#125;&#x27; but required in type &#x27;&#123; name: string; &#125;&#x27;.</span></span><br><span class="line"><span class="comment">// let person: &#123; name: string &#125; = &#123;&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> people = &#123;&#125;;</span><br><span class="line"><span class="comment">// TS2339: Property &#x27;name&#x27; does not exist on type &#x27;&#123;&#125;&#x27;.</span></span><br><span class="line"><span class="comment">// people.name = &quot;张三&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// age?: number | undefined</span></span><br><span class="line"><span class="keyword">let</span> student: &#123; age?: <span class="built_in">number</span> &#125; = &#123;&#125;;</span><br><span class="line">student.age = <span class="number">20</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 内置对象 类本身可以作为类实例的类型</span></span><br><span class="line"><span class="keyword">let</span> date: <span class="built_in">Date</span> = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义类</span></span><br><span class="line"><span class="comment">// 类可以作为类实例的类型</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> car: Car = <span class="keyword">new</span> Car();</span><br></pre></td></tr></table></figure>
<h3 id="3-9-类型推断"><a href="#3-9-类型推断" class="headerlink" title="3.9 类型推断"></a>3.9 类型推断</h3><p>TypeScript 编译器能根据一些简单的规则推断变量的类型，在没有显式设置变量类型的情况下，编译器将变量初始值的类型作为该变量的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// let apples: number</span></span><br><span class="line"><span class="keyword">let</span> apples = <span class="number">5</span>;</span><br><span class="line"><span class="comment">// let speed: string</span></span><br><span class="line"><span class="keyword">let</span> speed = <span class="string">&quot;fast&quot;</span>;</span><br><span class="line"><span class="comment">// let hasName: boolean</span></span><br><span class="line"><span class="keyword">let</span> hasName = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// let colors: string[]</span></span><br><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="comment">// let numbers: number[]</span></span><br><span class="line"><span class="keyword">let</span> numbers = [<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>];</span><br><span class="line"><span class="comment">// let bools: boolean[]</span></span><br><span class="line"><span class="keyword">let</span> bools = [<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>];</span><br><span class="line"><span class="comment">// let anything: any[</span></span><br><span class="line"><span class="keyword">let</span> anything = [];</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// let point: &#123;x: number, y: number&#125;</span></span><br><span class="line"><span class="keyword">let</span> point = &#123; <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">200</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>TypeScript 编译器会试图推断函数返回值的类型。</p>
<p>注意：使用函数返回值类型推断时，在编写函数内部代码时就失去了类型检测功能，所以函数返回值类型推荐明确指定。如果函数的返回值是 undefined，可以指定函数的返回值为 void。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const add: (a: number, b: number) =&gt; number</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const add: (a: number, b: number) =&gt; void</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>) =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const add: (a: number, b: string) =&gt; string</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const add: () =&gt; string</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;a&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const find: (name: string) =&gt; string | boolean</span></span><br><span class="line"><span class="keyword">const</span> find = <span class="function">(<span class="params">name: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (name) &#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>在 TypeScript 编译器可以推断出变量类型的情况下，开发者不需要显式编写类型注释，也就是说只有在 TypeScript 不能正确推断变量类型的情况下开发者才需要编写类型注释，那么在哪些情况下 TypeScript 编译器不能正确推断出变量的类型呢？</p>
<p>① 如果变量声明后没有被立即初始化，TypeScript 编译器不能正确的推断出它的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 此时 TypeScript 编译器认为它是 Any 类型，即在该变量中可以存储任意类型的数据。</span></span><br><span class="line"><span class="comment">// 该变量失去了 TypeScript 中的类型检查功能</span></span><br><span class="line"><span class="comment">// let anything: any;</span></span><br><span class="line"><span class="keyword">let</span> anything;</span><br><span class="line">anything = <span class="number">12</span>;</span><br><span class="line">anything = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">anything = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="comment">// let foundColor: any</span></span><br><span class="line"><span class="comment">// 解决办法是要么设置初始值, 要么显式指定变量类型</span></span><br><span class="line"><span class="keyword">let</span> foundColor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; colors.length; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (colors[i] === <span class="string">&quot;green&quot;</span>) &#123;</span><br><span class="line">    foundColor = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>② 当调用的函数返回值为 Any 类型时，我们应该使用类型注释显式声明它的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// let json: string;</span></span><br><span class="line"><span class="keyword">let</span> json = <span class="string">&#x27;&#123;&quot;name&quot;: &quot;张三&quot;&#125;&#x27;</span>;</span><br><span class="line"><span class="comment">// let person: any =&gt; let person: &#123;name: string&#125;</span></span><br><span class="line"><span class="keyword">let</span> person = <span class="built_in">JSON</span>.parse(json);</span><br></pre></td></tr></table></figure>
<p>③ 当变量可能有多个类型的值时。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 需求: 在数组中查找大于 0 的数值, 如果找到将该值赋值给变量 target, 如果没有找到, 将 false 赋值给变量 target</span></span><br><span class="line"><span class="keyword">let</span> numbers = [-<span class="number">10</span>, -<span class="number">1</span>, <span class="number">20</span>];</span><br><span class="line"><span class="keyword">let</span> target = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; numbers.length; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (numbers[i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// 不能将类型&quot;number&quot;分配给类型&quot;boolean&quot;</span></span><br><span class="line">    target = numbers[i];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> target: <span class="built_in">boolean</span> | <span class="built_in">number</span> = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>④ 函数的参数必须设置类型，TypeScript 并不能推断函数参数的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TS7006: Parameter &#x27;a&#x27; implicitly has an &#x27;any&#x27; type</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a, b</span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-TypeScript-高级类型"><a href="#4-TypeScript-高级类型" class="headerlink" title="4. TypeScript 高级类型"></a>4. TypeScript 高级类型</h2><h3 id="4-1-类型别名"><a href="#4-1-类型别名" class="headerlink" title="4.1 类型别名"></a>4.1 类型别名</h3><p>类型别名用来为类型起个新名字。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Name = <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">let</span> nameValue: Name = <span class="string">&quot;张三&quot;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Point = &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="built_in">number</span>;</span><br><span class="line">  y: <span class="built_in">number</span>;</span><br><span class="line">  add: <span class="function">(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">number</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> point: Point = &#123; <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">200</span>, <span class="attr">add</span>: <span class="function">(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>) =&gt;</span> x + y &#125;;</span><br></pre></td></tr></table></figure>
<p>观察下列代码中存在的问题。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> pizzaSize: <span class="string">&#x27;large&#x27;</span> | <span class="string">&#x27;medium&#x27;</span> | <span class="string">&#x27;small&#x27;</span> = <span class="string">&#x27;medium&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectPizzaSize</span> (<span class="params">size: <span class="string">&#x27;large&#x27;</span> | <span class="string">&#x27;medium&#x27;</span>| <span class="string">&#x27;small&#x27;</span></span>) </span>&#123;</span><br><span class="line">  pizzaSize = size</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">selectPizzaSize(<span class="string">&#x27;small&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>以上代码同一个类型被定义了多次, 重复代码太多，可以使用 type 创建类型，复用类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Size = <span class="string">&#x27;large&#x27;</span> | <span class="string">&#x27;medium&#x27;</span> | <span class="string">&#x27;small&#x27;</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> pizzaSize: Size = <span class="string">&#x27;medium&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectPizzaSize</span> (<span class="params">size: Size</span>) </span>&#123;</span><br><span class="line">  pizzaSize = size</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">selectPizzaSize(<span class="string">&#x27;large&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="4-2-联合类型"><a href="#4-2-联合类型" class="headerlink" title="4.2 联合类型"></a>4.2 联合类型</h3><p>联合类型可以将变量设置为多种类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 联合类型: 为一个变量设置多个类型</span></span><br><span class="line"><span class="keyword">let</span> a: <span class="built_in">string</span> | <span class="built_in">number</span> | <span class="built_in">boolean</span> = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// arg 参数既可以是字符串类型也可以是数值类型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">arg: <span class="built_in">string</span> | <span class="built_in">number</span></span>) </span>&#123;&#125;</span><br><span class="line">fn(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">fn(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<p>在使用联合类型的变量时，默认只能使用联合类型中所有类型中的公共属性，因为 TypeScript 编译器并不能确定它的具体类型是什么，所以不能准确的列出它的下面有哪些属性和方法。</p>
<p><img src="/img/ts/images/50.png"  align="left"/></p>
<p>在大多数情况下，在使用联合类型的变量时，需要先缩小变量的类型范围，尽量让TypeScript 编译器列出更加准备的属性和方法。</p>
<p><img src="/img/ts/images/51.png"  align="left"/></p>
<p><img src="/img/ts/images/52.png"  align="left"/></p>
<h3 id="4-3-交叉类型"><a href="#4-3-交叉类型" class="headerlink" title="4.3 交叉类型"></a>4.3 交叉类型</h3><p>交叉类型是将多个类型叠加合并组成新的类型，新类型包含了所有被合并类型的所有属性。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Draggable = &#123;</span><br><span class="line">  <span class="attr">drag</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Resizable = &#123;</span><br><span class="line">  <span class="attr">resize</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> UIWidget = Draggable &amp; Resizable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> textBox: UIWidget = &#123;</span><br><span class="line">  <span class="attr">drag</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">  <span class="attr">resize</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="4-4-字面量类型"><a href="#4-4-字面量类型" class="headerlink" title="4.4 字面量类型"></a>4.4 字面量类型</h3><p>字面量类型既可以设置变量的类型，又可以限制变量的取值范围。</p>
<p>字面量值的类型就是变量的类型，字面量值就是变量的取值范围。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Quantity = <span class="number">50</span> | <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2322: Type &#x27;54&#x27; is not assignable to type &#x27;Quantity&#x27;.</span></span><br><span class="line"><span class="keyword">let</span> quantity: Quantity = <span class="number">54</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Metric = <span class="string">&quot;cm&quot;</span> | <span class="string">&quot;inch&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2322: Type &#x27;&quot;abc&quot;&#x27; is not assignable to type &#x27;Metric&#x27;.</span></span><br><span class="line"><span class="keyword">let</span> metric: Metric = <span class="string">&quot;abc&quot;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-5-可空类型"><a href="#4-5-可空类型" class="headerlink" title="4.5 可空类型"></a>4.5 可空类型</h3><p>在 TypeScript 中，undefined 和 null 这两个值本身也可以作为类型使用。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">let</span> nothing: <span class="literal">undefined</span> = <span class="literal">undefined</span>;</span><br><span class="line"><span class="comment">// null</span></span><br><span class="line"><span class="keyword">let</span> nothingMuch: <span class="literal">null</span> = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params">name: <span class="built_in">string</span> | <span class="literal">null</span> | <span class="literal">undefined</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> name === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(name.toLowerCase());</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;something went wrong&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">greet(<span class="literal">undefined</span>);</span><br></pre></td></tr></table></figure>
<h3 id="4-6-可选链操作符"><a href="#4-6-可选链操作符" class="headerlink" title="4.6 可选链操作符"></a>4.6 可选链操作符</h3><p>可选链操作符( <code>?.</code> )允许开发者通过链式的方式访问一个对象上可能为 <code>null</code> 或 <code>undefined</code> 的属性，并且不用检查中间的属性是否为空。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Customer = &#123;</span><br><span class="line">  birthday?: <span class="built_in">Date</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCustomer</span>(<span class="params">id: <span class="built_in">number</span></span>): <span class="title">Customer</span> | <span class="title">undefined</span> | <span class="title">null</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> id === <span class="number">0</span> ? <span class="literal">null</span> : &#123; <span class="attr">birthday</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> customer = getCustomer(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// if (customer !== null &amp;&amp; customer !== undefined) &#123;</span></span><br><span class="line"><span class="comment">//   if (customer.birthday !== undefined) &#123;</span></span><br><span class="line"><span class="comment">//     console.log(customer.birthday);</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(customer?.birthday?.getFullYear());</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> array: <span class="built_in">string</span> | <span class="built_in">number</span>[] | <span class="literal">null</span> = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="built_in">console</span>.log(array?.[<span class="number">0</span>]);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> log: <span class="built_in">any</span> = <span class="function">(<span class="params">message: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">console</span>.log(message);</span><br><span class="line">log = <span class="literal">null</span>;</span><br><span class="line">log?.(<span class="string">&quot;Hello&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="4-7-空值合并运算符"><a href="#4-7-空值合并运算符" class="headerlink" title="4.7 空值合并运算符"></a>4.7 空值合并运算符</h3><p>空值合并操作符 (<code>??</code>) 是一个逻辑操作符，当左侧的操作数为 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/null"><code>null</code></a> 或者 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/undefined"><code>undefined</code></a> 时，返回其右侧操作数，否则返回左侧操作数。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> speed: <span class="built_in">number</span> | <span class="literal">null</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ride = &#123;</span><br><span class="line">  <span class="comment">// speed: speed !== null ? speed : 30,</span></span><br><span class="line">  <span class="attr">speed</span>: speed ?? <span class="number">30</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="4-8-类型断言"><a href="#4-8-类型断言" class="headerlink" title="4.8 类型断言"></a>4.8 类型断言</h3><p>通过类型断言可以覆盖 TypeScript 编译器的推断，当开发者比 TypeScript 更加清楚它的类型时使用。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const phone: HTMLElement | null</span></span><br><span class="line"><span class="keyword">const</span> phone = <span class="built_in">document</span>.getElementById(<span class="string">&quot;phone&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log((&lt;HTMLInputElement&gt;phone).value);</span><br><span class="line"><span class="built_in">console</span>.log((phone <span class="keyword">as</span> HTMLInputElement).value);</span><br></pre></td></tr></table></figure>
<h3 id="4-9-unknown-类型"><a href="#4-9-unknown-类型" class="headerlink" title="4.9 unknown 类型"></a>4.9 unknown 类型</h3><p>unknow 是更加严格的 any 类型，在对 unknown 类型的变量执行操作之前必须进行先假设它的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> anything: unknown = <span class="string">&quot;Hello TypeScript&quot;</span>;</span><br><span class="line">anything = <span class="literal">true</span>;            <span class="comment">// ✅</span></span><br><span class="line">anything = <span class="number">3.14</span>;            <span class="comment">// ✅</span></span><br><span class="line">anything = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;  <span class="comment">// ✅</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2571: Object is of type &#x27;unknown&#x27;. ❎</span></span><br><span class="line"><span class="comment">// console.log(anything.length);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> anything === <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">  anything.toFixed();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> anything === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">  anything.toUpperCase();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> anything === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">  anything();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-10-never-类型"><a href="#4-10-never-类型" class="headerlink" title="4.10 never 类型"></a>4.10 never 类型</h3><p>如果一个函数永远都不会有返回值，可以指定函数的返回值类型为 never。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> throwError = (message: <span class="built_in">string</span>): <span class="function"><span class="params">never</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const throwError: (message: string) =&gt; void</span></span><br><span class="line"><span class="keyword">const</span> throwError = <span class="function">(<span class="params">message: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!message) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>注意：如果一个函数永远都不会有返回值，说明函数调用位置后面的代码永远都不会被执行。</p>
<h2 id="5-面向对象编程"><a href="#5-面向对象编程" class="headerlink" title="5. 面向对象编程"></a>5. 面向对象编程</h2><h3 id="5-1-概述"><a href="#5-1-概述" class="headerlink" title="5.1 概述"></a>5.1 概述</h3><p>面向对象和面向过程都属于编写程序的指导思想，指导开发者按照什么样的套路编写代码。</p>
<p>面向过程是侧重于过程的编程，代码的执行过程就是代码的编写过程。在编写程序时要明确知道每一步都要做什么，比如将大象装冰箱一共分为三步，那么程序代码就是这三步。</p>
<p>面向对象是侧重于对象的编程，开发者站在上帝视角，要想什么就创建什么对象，然后为对象赋予响应的能力，要做的事情让对象自己完成。比如将大象装冰箱，我们要创建大象对象，创建冰箱对象，赐予大象进冰箱的能力，然后让大象自己进冰箱。</p>
<p>面向过程的优点是简单，思考简单，编写简单。</p>
<p>面向过程的缺点是代码量越大维护成本越高。当程序出问题后，需要从头到尾将步骤过一遍，在此过程中找问题，修复问题，如果代码中步骤非常多的话，是非常耗时间和精力的。</p>
<p>面向对象的优点的是扩展性强维护成本低，当程序出问题后定位对象即可，哪个对象出问题就找哪个对象修复哪个对象就可以了。</p>
<p>面向对象的缺点是新人上手难度高。</p>
<h3 id="5-2-类与对象"><a href="#5-2-类与对象" class="headerlink" title="5.2 类与对象"></a>5.2 类与对象</h3><p>面向对象的思维方式就是你是上帝，你想要什么你就造什么对象，问题是如何造对象？比如造一辆车。</p>
<p>现实世界中，第一步画造车图纸 ① 定义车的信息，车是什么颜色，有多少座位 @ 定义车的能力，跑。第二步根据图纸造车。</p>
<p>面向对象中，通过类表示图纸，定义类就是画图纸，类中包含两部分，属性和方法，由于通过图纸可以造多个相同的实物，所以属性就是这一类事物拥有的共同特性，方法就是这一类事物拥有的共同的能力。</p>
<p>面向对象中，通过对象表示具体的实物，对象是通过类创建的，对象能干什么完全取决于你的类是如何定义的。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="built_in">string</span> = <span class="string">&quot;白色&quot;</span>;</span><br><span class="line">  maxSpeed: <span class="built_in">number</span> = <span class="number">220</span>;</span><br><span class="line">  <span class="function"><span class="title">drive</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">honk</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;didi&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> vehicle = <span class="keyword">new</span> Vehicle();</span><br><span class="line"><span class="built_in">console</span>.log(vehicle);</span><br><span class="line"><span class="built_in">console</span>.log(vehicle.color);</span><br><span class="line"><span class="built_in">console</span>.log(vehicle.maxSpeed);</span><br><span class="line">vehicle.drive();</span><br><span class="line">vehicle.honk();</span><br></pre></td></tr></table></figure>
<h3 id="5-3-构造函数"><a href="#5-3-构造函数" class="headerlink" title="5.3 构造函数"></a>5.3 构造函数</h3><p>构造函数用来在创建对象时为对象属性赋初始值，在使用 new 关键字实例化对象时被自动调用。</p>
<p>在 TypeScript 中构造函数使用 constructor 实现，在该方法中可以通过 this 关键字访问当前类中的属性和方法。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="built_in">string</span>;</span><br><span class="line">  maxSpeed: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">color: <span class="built_in">string</span>, maxSpeed: <span class="built_in">number</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.color = color;</span><br><span class="line">    <span class="built_in">this</span>.maxSpeed = maxSpeed;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vehicle = <span class="keyword">new</span> Vehicle(<span class="string">&quot;红色&quot;</span>, <span class="number">240</span>);</span><br></pre></td></tr></table></figure>
<h3 id="5-4-只读属性"><a href="#5-4-只读属性" class="headerlink" title="5.4 只读属性"></a>5.4 只读属性</h3><p>只读属性是指属性一旦被赋值，该值就不能被修改，无论在类的外部还是在类的内部都不能被修改。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="keyword">readonly</span> maxSpeed: <span class="built_in">number</span>;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">maxSpeed: <span class="built_in">number</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.maxSpeed = maxSpeed;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">drive</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">//  TS2540: Cannot assign to &#x27;maxSpeed&#x27; because it is a read-only property.</span></span><br><span class="line">    <span class="built_in">this</span>.maxSpeed = <span class="number">900</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vehicle = <span class="keyword">new</span> Vehicle(<span class="number">240</span>);</span><br><span class="line"><span class="comment">// TS2540: Cannot assign to &#x27;maxSpeed&#x27; because it is a read-only property.</span></span><br><span class="line">vehicle.maxSpeed = <span class="number">300</span>;</span><br></pre></td></tr></table></figure>
<h3 id="5-5-继承"><a href="#5-5-继承" class="headerlink" title="5.5 继承"></a>5.5 继承</h3><p>在为事物进行分类时，通常会对类别进行细化，比如汽车分类，在该分类下还会包含轿车和面包车，这种细化关系在程序世界中应该如何表示呢？</p>
<p>在程序世界中我们会分别创建汽车分类，轿车分类、面包车分类，在汽车分类下描述所有汽车的通用特征，在细化分类下只描述该分类独有的特征。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 汽车分类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">drive</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">  brand = <span class="string">&quot;BMW&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>虽然我们目前对类别进行了细化，但随之也出现了问题，在使用类创建对象时，比如创建轿车对象，在创建出来的轿车对象中只包含了轿车的独有特征，没有包含汽车的通用特性，就是说创建出来的轿车对象是不完整的对象，完整的对象应该是既包含汽车的通用特征又包含轿车的独有特性。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> car = <span class="keyword">new</span> Car();</span><br><span class="line"><span class="built_in">console</span>.log(car); <span class="comment">// &#123; brand: &quot;BMW&quot;&#125;</span></span><br></pre></td></tr></table></figure>
<p>可以使用继承关系解决上述问题。既然汽车分类包含了细化分类的通用特征，那么汽车分类就被叫做父类，下面的细化分类就被叫做子类，子类通过继承父类就可以拥有汽车分类中的通用特征了，再加上子类中定义了其独有的特征，最终通过子类创建出来的对象就是拥有完整特性的对象了。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">extends</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  brand = <span class="string">&quot;BMW&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> car = <span class="keyword">new</span> Car(); </span><br><span class="line"><span class="comment">// &#123;brand: &quot;BMW&quot;&#125; </span></span><br><span class="line"><span class="comment">// car.drive() </span></span><br><span class="line"><span class="comment">// 注意: drive 方法被添加到了原型对象中, 所以 log 实例对象时并没有看到它</span></span><br></pre></td></tr></table></figure>
<p>在子类继承父类后，如果父类需要在初始化的时候传递参数，该参数由子类接收，在子类的构造函数中通过 super 调用父类将参数传递给父类。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> name: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> studentId: <span class="built_in">number</span>, name: <span class="built_in">string</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> Student(<span class="number">1</span>, <span class="string">&quot;张三&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(p1.studentId);</span><br><span class="line"><span class="built_in">console</span>.log(p1.name);</span><br></pre></td></tr></table></figure>
<p>子类在继承父类后，还可以通过重写父类方法对功能进行扩展。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">walk</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;person walk&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="comment">// override 表示该方法是覆盖的父类方法, 仅作为标识提升代码的可阅读性, 不会对代码的实际执行产生任何副作用</span></span><br><span class="line">  override <span class="function"><span class="title">walk</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;student walk&quot;</span>);</span><br><span class="line">    <span class="comment">// 通过 super 调用父类 walk 方法</span></span><br><span class="line">    <span class="built_in">super</span>.walk();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> Student();</span><br><span class="line">p1.walk();</span><br></pre></td></tr></table></figure>
<h3 id="5-6-访问权限修饰符"><a href="#5-6-访问权限修饰符" class="headerlink" title="5.6 访问权限修饰符"></a>5.6 访问权限修饰符</h3><p>通过访问权限修饰符可以指定类中的属性、方法能够在哪些范围内被使用。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>修饰符</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>public</td>
<td>被 public 关键字修饰的类属性和类方法可以在任何地方使用 (当前类、子类、实例)</td>
</tr>
<tr>
<td>private</td>
<td>被 private 关键字修饰的类属性和类方法只能在当前类中使用</td>
</tr>
<tr>
<td>protected</td>
<td>被 protected 关键字修饰的类属性和类方法可以在当前类和子类中使用</td>
</tr>
</tbody>
</table>
</div>
<p><strong>① public 公开的</strong></p>
<p>类属性和类方法在不加任何权限修饰符的情况下，它就是可以在任何地方被访问的，也就是说 public 是默认值，是可以被省略的。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. 在本类中的其他方法中使用</span></span><br><span class="line">    <span class="built_in">this</span>.drive();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="title">drive</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">extends</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">drive</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 2. 在子类中使用</span></span><br><span class="line">    <span class="built_in">super</span>.drive();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> car = <span class="keyword">new</span> Car();</span><br><span class="line"><span class="comment">// 3. 在实例对象中使用</span></span><br><span class="line">car.drive();</span><br></pre></td></tr></table></figure>
<p><strong>② private 私有的</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 在本类中的其他方法中使用</span></span><br><span class="line">    <span class="built_in">this</span>.drive();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="title">drive</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">extends</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">drive</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 属性&quot;drive&quot;为私有属性，只能在类&quot;Vehicle&quot;中访问</span></span><br><span class="line">    <span class="built_in">super</span>.drive();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vehicle = <span class="keyword">new</span> Vehicle();</span><br><span class="line"><span class="comment">// 属性&quot;drive&quot;为私有属性，只能在类&quot;Vehicle&quot;中访问</span></span><br><span class="line">vehicle.drive();</span><br></pre></td></tr></table></figure>
<p><strong>③ protected 受保护的</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. 在本类中的其他方法中使用</span></span><br><span class="line">    <span class="built_in">this</span>.drive();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">protected</span> <span class="function"><span class="title">drive</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">extends</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">drive</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 2. 在子类中使用</span></span><br><span class="line">    <span class="built_in">super</span>.drive();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vehicle = <span class="keyword">new</span> Vehicle();</span><br><span class="line"><span class="comment">// 属性&quot;drive&quot;受保护, 只能在类&quot;Vehicle&quot;及其子类中访问</span></span><br><span class="line">vehicle.drive();</span><br></pre></td></tr></table></figure>
<h3 id="5-7-Getter-与-Setter"><a href="#5-7-Getter-与-Setter" class="headerlink" title="5.7 Getter 与 Setter"></a>5.7 Getter 与 Setter</h3><p>Getter 和 Setter 是对属性访问的封装，比如通过类实例对象访问私有属性就需要用到它们，获取属性值时使用Getter，修改属性值时使用 Setter。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> _salary: <span class="built_in">number</span>;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">salary: <span class="built_in">number</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._salary = salary;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">salary</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._salary;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">set</span> <span class="title">salary</span>(<span class="params">salary: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>._salary = salary;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> employee = <span class="keyword">new</span> Employee(<span class="number">4000</span>);</span><br><span class="line"><span class="built_in">console</span>.log(employee.salary);</span><br><span class="line">employee.salary = <span class="number">6000</span>;</span><br><span class="line"><span class="built_in">console</span>.log(employee.salary);</span><br></pre></td></tr></table></figure>
<h3 id="5-8-参数属性"><a href="#5-8-参数属性" class="headerlink" title="5.8 参数属性"></a>5.8 参数属性</h3><p>TypeScript 提供了特殊的语法将构造函数参数转换为具有相同名称的类属性。 这些称为参数属性，是通过在构造函数参数前面加上权限修饰符 public、private、protected 或 readonly 之一来创建的。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Params</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">public</span> <span class="keyword">readonly</span> x: <span class="built_in">number</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">protected</span> y: <span class="built_in">number</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">private</span> z: <span class="built_in">number</span></span></span></span><br><span class="line"><span class="params"><span class="function">  </span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">log</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.x);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.y);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.z);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> Params(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</span><br><span class="line">p.log();</span><br></pre></td></tr></table></figure>
<h3 id="5-9-索引签名"><a href="#5-9-索引签名" class="headerlink" title="5.9 索引签名"></a>5.9 索引签名</h3><p>在 JavaScript 中，为对象动态添加属性是被允许的，但是在 TypeScript 中是不行的，因为在 TypeScript 中对象要有严格的数据类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;&#125;;</span><br><span class="line"><span class="comment">// TS2339: Property &#x27;name&#x27; does not exist on type &#x27;&#123;&#125;&#x27;.</span></span><br><span class="line">person.name = <span class="string">&quot;张三&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>在 TypeScript 中动态为对象添加属性，需要使用索引签名，通过索引签名可以在不确定属性名称的情况下限制对象属性的类型以及对象值的类型。</p>
<p>在不确定属性名称的情况下限制属性的类型意味着我们可以动态的为对象添加任意属性，但属性类型要符合要求。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SeatAssignment</span> </span>&#123;</span><br><span class="line">  <span class="attr">A1</span>: <span class="built_in">string</span>;</span><br><span class="line">  A2: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// ....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SeatAssignment</span> </span>&#123;</span><br><span class="line">  <span class="comment">// seatNumber 只是用来占位的, 实际属性的名称开发者可以自定义，而且 seatNumber 也可以换成其他名称</span></span><br><span class="line">  [seatNumber: <span class="built_in">string</span>]: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> seats = <span class="keyword">new</span> SeatAssignment();</span><br><span class="line"></span><br><span class="line">seats.A1 = <span class="string">&quot;张三&quot;</span>;</span><br><span class="line">seats.A2 = <span class="string">&quot;李四&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ❎ TS2538: Type &#x27;true&#x27; cannot be used as an index type.</span></span><br><span class="line">seats[<span class="literal">true</span>] = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ❎ TS2322: Type &#x27;number&#x27; is not assignable to type &#x27;string&#x27;.</span></span><br><span class="line">seats.A3 = <span class="number">12</span>;</span><br></pre></td></tr></table></figure>
<h3 id="5-10-静态成员"><a href="#5-10-静态成员" class="headerlink" title="5.10 静态成员"></a>5.10 静态成员</h3><p>在类中被 static 关键字修饰的类属性和类方法被叫做静态成员，静态成员属于类，所以访问静态成员的方式是类名点上静态成员名称。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rich</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> count: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 通过 类名 + 静态成员名称 访问静态成员</span></span><br><span class="line">Rich.count;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下写法错误</span></span><br><span class="line"><span class="comment">// 静态成员不属于类的实例对象, 所以不能通过类的实例对象访问静态成员</span></span><br><span class="line"><span class="keyword">const</span> r = <span class="keyword">new</span> Rich();</span><br><span class="line"><span class="comment">// TS2576: Property &#x27;count&#x27; does not exist on type &#x27;Rich&#x27;. </span></span><br><span class="line"><span class="comment">// Did you mean to access the static member &#x27;Rich.count&#x27; instead?</span></span><br><span class="line">r.count;</span><br></pre></td></tr></table></figure>
<p>对于该类的任何一个对象而言，静态属性就是公共的存储单元，该类的任何对象访问它时，取到的都是相同的值，同样任何一个类的对象去修改它时，也都是在对同一个内存单元做操作，所以静态成员主要用在各个对象都有相同的某项属性的时候。</p>
<p>目标: 获取类的实例对象的数量。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Rich</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> _count: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    Rich._count++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">getCount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Rich._count;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> r1 = <span class="keyword">new</span> Rich();</span><br><span class="line"><span class="keyword">const</span> r2 = <span class="keyword">new</span> Rich();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(r1.getCount());</span><br><span class="line"><span class="built_in">console</span>.log(r2.getCount());</span><br></pre></td></tr></table></figure>
<p>因为静态成员存在于内存，而非静态成员需要实例化才可以分配内存，所以静态成员不能访问非静态成员，非静态成员可以访问类中的静态成员。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rich</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> _count: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// 静态成员中不能访问非静态成员</span></span><br><span class="line">  <span class="comment">// 静态方法中的 this 指向了类, 而不是类实例</span></span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="title">fn</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// TS2339: Property &#x27;getCount&#x27; does not exist on type &#x27;typeof Rich&#x27;.</span></span><br><span class="line">    <span class="comment">// this.getCount();</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 非静态成员中可以访问静态成员</span></span><br><span class="line">  <span class="function"><span class="title">getCount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Rich._count;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-11-抽象类"><a href="#5-11-抽象类" class="headerlink" title="5.11 抽象类"></a>5.11 抽象类</h3><p>抽象类因继承而存在，通过抽象类可以约束子类必须实现哪些成员，如果抽象类不被继承，它将毫无意义。</p>
<p>在抽象类中可以只定义成员，具体的成员实现由子类完成且必须完成，所以抽象类不能被直接实例化。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">  <span class="keyword">abstract</span> color: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">abstract</span> render(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">extends</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> color: <span class="built_in">string</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  override render(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;render&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2511: Cannot create an instance of an abstract class.</span></span><br><span class="line"><span class="comment">// new Shape();</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> circle = <span class="keyword">new</span> Circle(<span class="string">&quot;red&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(circle.color);</span><br><span class="line">circle.render();</span><br></pre></td></tr></table></figure>
<h3 id="5-12-接口"><a href="#5-12-接口" class="headerlink" title="5.12 接口"></a>5.12 接口</h3><p>接口用于对复杂的数据结构进行类型描述、定义类型规范，TypeScript 编译器通过接口定义的规范对数据进行类型检查。</p>
<p>先来观察一段 JavaScript 代码，看看代码中存在什么问题。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserInfo</span>(<span class="params">user</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;user.name&#125;</span> - <span class="subst">$&#123;user.age&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 运行时错误: Uncaught TypeError: Cannot read properties of undefined (reading &#x27;name&#x27;)</span></span><br><span class="line">getUserInfo();</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// undefined - undefined</span></span><br><span class="line">getUserInfo(<span class="string">&quot;张三&quot;</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 张三 - undefined</span></span><br><span class="line">getUserInfo(&#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">height</span>: <span class="number">178</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>JavaScript 是弱类型的语言，所以并不会对我们传入的代码进行任何的检测。在 TypeScript 中，接口可以解决上述问题。</p>
<p>在 TypeScript 中，使用 interface 关键字定义接口，通过接口可以约束对象的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> IUser &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserInfo</span>(<span class="params">user: IUser</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;user.name&#125;</span> - <span class="subst">$&#123;user.age&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TS2554: Expected 1 arguments, but got 0.</span></span><br><span class="line">getUserInfo();</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TS2345: Argument of type &#x27;string&#x27; is not assignable to parameter of type &#x27;IUser&#x27;.</span></span><br><span class="line">getUserInfo(<span class="string">&quot;张三&quot;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TS2554: Expected 1 arguments, but got 2.</span></span><br><span class="line">getUserInfo(<span class="string">&quot;张三&quot;</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TS2345: Argument of type &#x27;&#123; name: string; height: number; &#125;&#x27; is not assignable to parameter of type &#x27;IUser&#x27;.</span></span><br><span class="line"><span class="comment">// Object literal may only specify known properties, and &#x27;height&#x27; does not exist in type &#x27;IUser&#x27;.</span></span><br><span class="line">getUserInfo(&#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">height</span>: <span class="number">20</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>接口中定义的规范默认情况下都是必须被实现的，也就是说你定义的变量的值必须符合接口规范，少一个都不行。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Person &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">  isMarray: <span class="built_in">boolean</span>;</span><br><span class="line">  summary(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printPerson</span>(<span class="params">person: Person</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(person);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">isMarray</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类型&quot;&#123; name: string; age: number; isMarray: boolean; &#125;&quot;的参数不能赋给类型&quot;Person&quot;的参数</span></span><br><span class="line"><span class="comment">// 类型&quot;&#123; name: string; age: number; isMarray: boolean; &#125;&quot;中缺少属性 &quot;summary&quot;, 但类型&quot;Person&quot;中需要该属性</span></span><br><span class="line">printPerson(person);</span><br></pre></td></tr></table></figure>
<p>在实现了接口规范的情况下，规范以外的值默认是允许存在的。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Reportable &#123;</span><br><span class="line">  summary(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printSummary</span>(<span class="params">item: Reportable</span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item.summary());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  <span class="function"><span class="title">summary</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`您好, 我的名字叫<span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span>`</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> drink = &#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="string">&quot;棕色&quot;</span>,</span><br><span class="line">  <span class="function"><span class="title">summary</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;我喝的咖啡是$&#123;brow&#125;的&quot;</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">printSummary(person);</span><br><span class="line">printSummary(drink);</span><br></pre></td></tr></table></figure>
<p>接口具有继承特性，即接口与接口之间可以存在继承关系，而且一个接口可以继承多个接口。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 接口继承示例</span></span><br><span class="line"><span class="keyword">interface</span> Sizes &#123;</span><br><span class="line">  <span class="attr">sizes</span>: <span class="built_in">string</span>[];</span><br><span class="line">  getAvailableSizes(): <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Shape &#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Pizza <span class="keyword">extends</span> Sizes, Shape &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> pizza: Pizza = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  <span class="attr">color</span>: <span class="string">&quot;skyblue&quot;</span>,</span><br><span class="line">  <span class="attr">sizes</span>: [<span class="string">&quot;large&quot;</span>, <span class="string">&quot;small&quot;</span>],</span><br><span class="line">  <span class="function"><span class="title">getAvailableSizes</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.sizes;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>接口具有声明合并特性，即多个相同名称的接口可以合并。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Box &#123;</span><br><span class="line">  <span class="attr">height</span>: <span class="built_in">number</span>;</span><br><span class="line">  width: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Box &#123;</span><br><span class="line">  <span class="attr">scale</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> box: Box = &#123; <span class="attr">height</span>: <span class="number">5</span>, <span class="attr">width</span>: <span class="number">6</span>, <span class="attr">scale</span>: <span class="number">10</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>接口可以被类实现，约束类中必须要实现的成员。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Calendar &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  addEvent(): <span class="built_in">void</span>;</span><br><span class="line">  removeEvent(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GoogleCalendar</span> <span class="title">implements</span> <span class="title">Calendar</span> </span>&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span> = <span class="string">&quot;test&quot;</span>;</span><br><span class="line">  addEvent(): <span class="built_in">void</span> &#123;&#125;</span><br><span class="line">  removeEvent(): <span class="built_in">void</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用接口可以规范函数的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Sum &#123;</span><br><span class="line">  (n: <span class="built_in">number</span>, <span class="attr">m</span>: <span class="built_in">number</span>): <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sum: Sum = <span class="function"><span class="keyword">function</span> (<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="5-13-接口与类型别名"><a href="#5-13-接口与类型别名" class="headerlink" title="5.13 接口与类型别名"></a>5.13 接口与类型别名</h3><p>在 TypeScript 中，类型别名可以定义合成类型，比如对象和联合类型，类型别名可以定义基本数据类型，而接口只能定义对象类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 使用类型别名定义联合类型</span></span><br><span class="line"><span class="comment">// ISBN: 国际标准书号</span></span><br><span class="line"><span class="keyword">type</span> ISBN = <span class="built_in">number</span> | <span class="built_in">string</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 使用联合类型定义对象类型</span></span><br><span class="line"><span class="keyword">type</span> PublicationT = &#123;</span><br><span class="line">  <span class="attr">isbn</span>: ISBN;</span><br><span class="line">  author: <span class="built_in">string</span>;</span><br><span class="line">  publisher: <span class="built_in">string</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// 接口只能定义对象类型</span></span><br><span class="line"><span class="keyword">interface</span> PublicationI &#123;</span><br><span class="line">  <span class="attr">isbn</span>: ISBN;</span><br><span class="line">  author: <span class="built_in">string</span>;</span><br><span class="line">  publisher: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-11-函数重载"><a href="#4-11-函数重载" class="headerlink" title="4.11 函数重载"></a>4.11 函数重载</h3><p>需求：调用 getMessage 方法获取消息，如果传递的参数是数值类型，则表示根据消息 id 获取消息，返回值为对象类型，表示一条消息，如果传递的参数是字符串类型，则表示根据消息种类获取消息，返回值为数组类型，表示一组消息。</p>
<p>函数重载：根据函数入参类型的不同或入参个数的不同，设置不同的返回值类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 消息种类的类型</span></span><br><span class="line"><span class="keyword">type</span> MessageType = <span class="string">&quot;string&quot;</span> | <span class="string">&quot;image&quot;</span> | <span class="string">&quot;audio&quot;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 消息对象的类型</span></span><br><span class="line"><span class="keyword">type</span> Message = &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="keyword">type</span>: MessageType;</span><br><span class="line">  content: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 消息数组</span></span><br><span class="line"><span class="keyword">const</span> data: Message[] = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">type</span>: <span class="string">&quot;string&quot;</span>, <span class="attr">content</span>: <span class="string">&quot;hello-1&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">type</span>: <span class="string">&quot;image&quot;</span>, <span class="attr">content</span>: <span class="string">&quot;hello-2&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">type</span>: <span class="string">&quot;audio&quot;</span>, <span class="attr">content</span>: <span class="string">&quot;hello-3&quot;</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMessage</span>(<span class="params">id: <span class="built_in">number</span></span>): <span class="title">Message</span> | <span class="title">undefined</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMessage</span>(<span class="params"><span class="keyword">type</span>: MessageType</span>): <span class="title">Message</span>[]</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMessage</span>(<span class="params">query: <span class="built_in">any</span></span>): <span class="title">any</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> query === <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> data.find(<span class="function"><span class="params">message</span> =&gt;</span> message.id === query);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> data.filter(<span class="function"><span class="params">message</span> =&gt;</span> message.type === query);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const r1: Message | undefined</span></span><br><span class="line"><span class="keyword">const</span> r1 = getMessage(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// const r2: Message[]</span></span><br><span class="line"><span class="keyword">const</span> r2 = getMessage(<span class="string">&quot;image&quot;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> GetMessage &#123;</span><br><span class="line">  (id: <span class="built_in">number</span>): Message | <span class="literal">undefined</span>;</span><br><span class="line">  (<span class="keyword">type</span>: MessageType): Message[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getMessage: GetMessage = (query: <span class="built_in">any</span>): <span class="function"><span class="params">any</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> query === <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> data.find(<span class="function">(<span class="params">message</span>) =&gt;</span> message.id === query);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> data.filter(<span class="function">(<span class="params">message</span>) =&gt;</span> message.type === query);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="6-其他类型"><a href="#6-其他类型" class="headerlink" title="6. 其他类型"></a>6. 其他类型</h2><h3 id="6-1-泛型"><a href="#6-1-泛型" class="headerlink" title="6.1 泛型"></a>6.1 泛型</h3><p>泛型是指将类型作为参数进行传递，通过参数的传递解决代码复用问题。</p>
<h4 id="1-泛型类"><a href="#1-泛型类" class="headerlink" title="1.  泛型类"></a>1.  泛型类</h4><p>需求：通过类创建对象，对象的属性可以是字符串可以是数值，对象的属性值可以是字符串可以是数值。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StringKeyValuePair</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> key: <span class="built_in">string</span>, <span class="keyword">public</span> value: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumberKeyValuePair</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> key: <span class="built_in">number</span>, <span class="keyword">public</span> value: <span class="built_in">number</span></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StringNumberKeyValuePair</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> key: <span class="built_in">string</span>, <span class="keyword">public</span> value: <span class="built_in">number</span></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KeyValuePair</span>&lt;<span class="title">T</span>, <span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> key: T, <span class="keyword">public</span> value: V</span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>需求： 创建数组，数组中可以存储字符串也可以存储数值，通过索引可以获取到数组中的值。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArrayOfNumbers</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> collection: <span class="built_in">number</span>[]</span>)</span> &#123;&#125;</span><br><span class="line">  get(index): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.collection[index];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArrayOfStrings</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> collection: <span class="built_in">string</span>[]</span>)</span> &#123;&#125;</span><br><span class="line">  get(index): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.collection[index];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在以上代码中，数值数组类和字符串数组类所做的事情是一样的，但由于创建的数据类型不同，所以写成了两个类，它们属于重复代码。</p>
<p>在 TypeScript 中使用泛型可以完美解决以上代码复用的问题。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArrayOfAnything</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> collection: T[]</span>)</span> &#123;&#125;</span><br><span class="line">  get(index): T &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.collection[index];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// constructor ArrayOfAnything&lt;number&gt;(collection: number[]): ArrayOfAnything&lt;number&gt;</span></span><br><span class="line"><span class="keyword">new</span> ArrayOfAnything&lt;<span class="built_in">number</span>&gt;([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="comment">// constructor ArrayOfAnything&lt;string&gt;(collection: string[]): ArrayOfAnything&lt;string&gt;</span></span><br><span class="line"><span class="keyword">new</span> ArrayOfAnything&lt;<span class="built_in">string</span>&gt;([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>]);</span><br></pre></td></tr></table></figure>
<h4 id="2-泛型函数"><a href="#2-泛型函数" class="headerlink" title="2. 泛型函数"></a>2. 泛型函数</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getString</span>(<span class="params">value: <span class="built_in">string</span></span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getNumber</span>(<span class="params">value: <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getValue</span>&lt;<span class="title">T</span>&gt;(<span class="params">value: T</span>): <span class="title">T</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getValue&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">getValue&lt;<span class="built_in">number</span>&gt;(<span class="number">100</span>);</span><br></pre></td></tr></table></figure>
<h4 id="3-泛型接口"><a href="#3-泛型接口" class="headerlink" title="3. 泛型接口"></a>3. 泛型接口</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// http://api.example.com/users</span></span><br><span class="line"><span class="comment">// http://api.example.com/products</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Result&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">data</span>: T | <span class="literal">null</span>;</span><br><span class="line">  error: <span class="built_in">string</span> | <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> User &#123;</span><br><span class="line">  <span class="attr">username</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Product &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetch</span>&lt;<span class="title">T</span>&gt;(<span class="params"></span>): <span class="title">Result</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">data</span>: <span class="literal">null</span>, <span class="attr">error</span>: <span class="literal">null</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fetch&lt;User&gt;().data?.username;</span><br><span class="line">fetch&lt;Product&gt;().data?.title;</span><br></pre></td></tr></table></figure>
<h4 id="4-泛型约束"><a href="#4-泛型约束" class="headerlink" title="4. 泛型约束"></a>4. 泛型约束</h4><p>泛型约束是指对泛型参数的范围进行约束，就是说虽然类型可以被当做参数传递，但是传递的类型不能是随意的想传什么就传什么，通过泛型约束可以限制能够传递的类型的范围。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">echo</span>&lt;<span class="title">T</span> <span class="title">extends</span> <span class="title">string</span> | <span class="title">number</span>&gt;(<span class="params">value: T</span>): <span class="title">T</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line">echo(<span class="string">&#x27;Hello&#x27;</span>); <span class="comment">// ✅</span></span><br><span class="line">echo(<span class="number">100</span>);     <span class="comment">// ✅</span></span><br><span class="line">echo(&#123;&#125;);      <span class="comment">// ❎ TS2345: Argument of type &#x27;&#123;&#125;&#x27; is not assignable to parameter of type &#x27;string | number&#x27;.</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Person &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">echo</span>&lt;<span class="title">T</span> <span class="title">extends</span> <span class="title">Person</span>&gt;(<span class="params">value: T</span>): <span class="title">T</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo(&#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span> &#125;); <span class="comment">// ✅</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> name: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Custom</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">echo</span>&lt;<span class="title">T</span> <span class="title">extends</span> <span class="title">Person</span>&gt;(<span class="params">value: T</span>): <span class="title">T</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo(<span class="keyword">new</span> Person(<span class="string">&quot;张三&quot;</span>));</span><br><span class="line">echo(<span class="keyword">new</span> Custom(<span class="string">&quot;李四&quot;</span>));</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">print</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;car&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hourse</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">print</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Hourse&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Printable &#123;</span><br><span class="line">  print(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printHousesOrCars</span>&lt;<span class="title">T</span> <span class="title">extends</span> <span class="title">Printable</span>&gt;(<span class="params">carOrHouse: T</span>) </span>&#123;</span><br><span class="line">  carOrHouse.print();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printHousesOrCars&lt;Car&gt;(<span class="keyword">new</span> Car());</span><br><span class="line">printHousesOrCars&lt;Hourse&gt;(<span class="keyword">new</span> Hourse());</span><br></pre></td></tr></table></figure>
<h4 id="5-继承泛型类"><a href="#5-继承泛型类" class="headerlink" title="5. 继承泛型类"></a>5. 继承泛型类</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Product &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  price: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> _objects: T[] = [];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">add</span>(<span class="params">obj: T</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._objects.push(obj);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Store&lt;Product&gt;();</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CompressibleStore</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Store</span>&lt;<span class="title">T</span>&gt; </span>&#123;&#125;</span><br><span class="line"><span class="keyword">new</span> CompressibleStore&lt;Product&gt;();</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SearchableStore</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> </span>&#123; name: <span class="built_in">string</span> &#125;&gt; <span class="keyword">extends</span> Store&lt;T&gt; &#123;</span><br><span class="line">  find(name: <span class="built_in">string</span>): T | <span class="literal">undefined</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._objects.find(<span class="function">(<span class="params">obj</span>) =&gt;</span> obj.name == name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductStore</span> <span class="keyword">extends</span> <span class="title">Store</span>&lt;<span class="title">Product</span>&gt; </span>&#123;</span><br><span class="line">  filterByPrice(price: <span class="built_in">number</span>): Product[] &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._objects.filter(<span class="function">(<span class="params">obj</span>) =&gt;</span> obj.price &gt; <span class="number">100</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-2-keyof-操作符"><a href="#6-2-keyof-操作符" class="headerlink" title="6.2 keyof 操作符"></a>6.2 keyof 操作符</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Product &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  price: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> _objects: T[] = [];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">add</span>(<span class="params">obj: T</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._objects.push(obj);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  find(property: keyof T, <span class="attr">value</span>: unknown): T | <span class="literal">undefined</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._objects.find(<span class="function">(<span class="params">obj</span>) =&gt;</span> obj[property] === value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Store&lt;Product&gt;();</span><br><span class="line">store.add(&#123; <span class="attr">name</span>: <span class="string">&quot;Hello&quot;</span>, <span class="attr">price</span>: <span class="number">100</span> &#125;);</span><br><span class="line">store.find(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">store.find(<span class="string">&quot;price&quot;</span>, <span class="number">100</span>);</span><br><span class="line"><span class="comment">// TS2345: Argument of type &#x27;&quot;a&quot;&#x27; is not assignable to parameter of type &#x27;keyof Product&#x27;.</span></span><br><span class="line">store.find(<span class="string">&quot;a&quot;</span>, <span class="number">12</span>);</span><br><span class="line"><span class="comment">// TS2345: Argument of type &#x27;&quot;greet&quot;&#x27; is not assignable to parameter of type &#x27;keyof Product&#x27;.</span></span><br><span class="line">store.find(<span class="string">&quot;greet&quot;</span>, <span class="string">&quot;hi&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="6-3-映射类型"><a href="#6-3-映射类型" class="headerlink" title="6.3 映射类型"></a>6.3 映射类型</h3><p>目标：创建 ReadOnly 类型，接收泛型，得到新的类型，新类型中所有的属性都是只读的。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 最终目标如下</span></span><br><span class="line"><span class="keyword">interface</span> Product &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  price: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ReadOnlyProduct = &#123;</span><br><span class="line">  <span class="keyword">readonly</span> name: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">readonly</span> price: <span class="built_in">number</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> ReadOnlyProduct = &#123;</span><br><span class="line">  <span class="keyword">readonly</span> [K <span class="keyword">in</span> keyof Product]: Product[K];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> product: ReadOnlyProduct = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">  <span class="attr">price</span>: <span class="number">100</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2540: Cannot assign to &#x27;name&#x27; because it is a read-only property.</span></span><br><span class="line">product.name = <span class="string">&quot;hello&quot;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> ReadOnly&lt;T&gt; = &#123;</span><br><span class="line">  <span class="keyword">readonly</span> [K <span class="keyword">in</span> keyof T]: T[K];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> product: ReadOnly&lt;Product&gt; = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">  <span class="attr">price</span>: <span class="number">100</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TS2540: Cannot assign to &#x27;name&#x27; because it is a read-only property.</span></span><br><span class="line">product.name = <span class="string">&quot;hello&quot;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Optional&lt;T&gt; = &#123;</span><br><span class="line">  [K <span class="keyword">in</span> keyof T]?: T[K];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Nullable&lt;T&gt; = &#123;</span><br><span class="line">  [K <span class="keyword">in</span> keyof T]: T[K] | <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="6-4-工具类型"><a href="#6-4-工具类型" class="headerlink" title="6.4 工具类型"></a>6.4 工具类型</h3><h4 id="6-4-1-Partical"><a href="#6-4-1-Partical" class="headerlink" title="6.4.1 Partical"></a>6.4.1 Partical</h4><p>将类型中的属性都变成可选的，接收类型，返回类型。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Partial&lt;Type&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Person &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person: Person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> anothor = Partical&lt;Person&gt;;</span><br><span class="line"><span class="comment">// &#123;name?: string, age?: number&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateObject</span>&lt;<span class="title">T</span>&gt;(<span class="params">obj: T, props: Partial&lt;T&gt;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; ...obj, ...props &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">updateObject&lt;Person&gt;(person, &#123; <span class="attr">name</span>: <span class="string">&quot;李四&quot;</span> &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="6-4-2-Readonly"><a href="#6-4-2-Readonly" class="headerlink" title="6.4.2 Readonly"></a>6.4.2 Readonly</h4><p>将类型中的属性都变成只读的，接收类型，返回类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">Readonly&lt;Type&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Person &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person: Person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> anthor: Readonly&lt;Person&gt; = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;李四&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">40</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以修改</span></span><br><span class="line">person.name = <span class="string">&quot;王五&quot;</span>;</span><br><span class="line"><span class="comment">// 不可以修改</span></span><br><span class="line"><span class="comment">// anthor.name = &quot;赵六&quot;;</span></span><br></pre></td></tr></table></figure>
<h4 id="6-4-3-Record"><a href="#6-4-3-Record" class="headerlink" title="6.4.3 Record"></a>6.4.3 Record</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">Record&lt;Keys, Type&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> EmployeeType &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">fullname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> employees: Record&lt;<span class="built_in">number</span>, EmployeeType&gt; = &#123;</span><br><span class="line">  <span class="number">0</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">fullname</span>: <span class="string">&quot;John Doe&quot;</span>, <span class="attr">role</span>: <span class="string">&quot;Designer&quot;</span> &#125;,</span><br><span class="line">  <span class="number">1</span>: &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">fullname</span>: <span class="string">&quot;Ibrahima Fall&quot;</span>, <span class="attr">role</span>: <span class="string">&quot;Developer&quot;</span> &#125;,</span><br><span class="line">  <span class="number">2</span>: &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">fullname</span>: <span class="string">&quot;Sara Duckson&quot;</span>, <span class="attr">role</span>: <span class="string">&quot;Developer&quot;</span> &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-4-4-Omit"><a href="#6-4-4-Omit" class="headerlink" title="6.4.4 Omit"></a>6.4.4 Omit</h4><p>接收类型，得到新类型，在新类型中不要包含 keys</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">Omit&lt;Type, Keys&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Todo &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  description: <span class="built_in">string</span>;</span><br><span class="line">  completed: <span class="built_in">boolean</span>;</span><br><span class="line">  createdAt: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  type TodoPreview = &#123;</span></span><br><span class="line"><span class="comment">    title: string;</span></span><br><span class="line"><span class="comment">    completed: boolean;</span></span><br><span class="line"><span class="comment">    createdAt: number;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> TodoPreview = Omit&lt;Todo, <span class="string">&quot;description&quot;</span> | <span class="string">&quot;title&quot;</span>&gt;;</span><br></pre></td></tr></table></figure>
<h4 id="6-4-5-Pick"><a href="#6-4-5-Pick" class="headerlink" title="6.4.5 Pick"></a>6.4.5 Pick</h4><p>接收类型，返回新类型，在新类型中要包含 keys</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">Pick&lt;Type, Keys&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Todo &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  description: <span class="built_in">string</span>;</span><br><span class="line">  completed: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  type TodoPreview = &#123;</span></span><br><span class="line"><span class="comment">    title: string;</span></span><br><span class="line"><span class="comment">    completed: boolean;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> TodoPreview = Pick&lt;Todo, <span class="string">&quot;title&quot;</span> | <span class="string">&quot;completed&quot;</span>&gt;;</span><br></pre></td></tr></table></figure>
<h4 id="6-4-6-Exclude"><a href="#6-4-6-Exclude" class="headerlink" title="6.4.6 Exclude"></a>6.4.6 Exclude</h4><p>接收联合类型，得到新类型，在新类型中排除联合类型中的 ExcludedMembers。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">Exclude&lt;UnionType, ExcludedMembers&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// type T0 = &quot;b&quot; | &quot;c&quot;</span></span><br><span class="line"><span class="keyword">type</span> T0 = Exclude&lt;<span class="string">&quot;a&quot;</span> | <span class="string">&quot;b&quot;</span> | <span class="string">&quot;c&quot;</span>, <span class="string">&quot;a&quot;</span>&gt;;</span><br><span class="line"><span class="comment">// type T1 = &quot;c&quot;</span></span><br><span class="line"><span class="keyword">type</span> T1 = Exclude&lt;<span class="string">&quot;a&quot;</span> | <span class="string">&quot;b&quot;</span> | <span class="string">&quot;c&quot;</span>, <span class="string">&quot;a&quot;</span> | <span class="string">&quot;b&quot;</span>&gt;;</span><br></pre></td></tr></table></figure>
<h3 id="6-5-is"><a href="#6-5-is" class="headerlink" title="6.5 is"></a>6.5 is</h3><p>is 用于加强 TypeScript 类型推断，可以缩小类型的范围。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// isString 函数的返回值为布尔类型</span></span><br><span class="line"><span class="comment">// 如果 isString 函数的返回值为 true, TypeScript 编译器就认定 s 是字符串类型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isString</span>(<span class="params">s: <span class="built_in">any</span></span>): <span class="title">s</span> <span class="title">is</span> <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> s === <span class="string">&quot;string&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toUpperCase</span>(<span class="params">x: <span class="built_in">any</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (isString(x)) &#123;</span><br><span class="line">    <span class="keyword">return</span> x.toUpperCase();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-地图标记案例"><a href="#4-地图标记案例" class="headerlink" title="4. 地图标记案例"></a>4. 地图标记案例</h2><p>需求：随机创建用户和公司，并将他们的位置标注到地图中。</p>
<h3 id="4-1-案例准备"><a href="#4-1-案例准备" class="headerlink" title="4.1 案例准备"></a>4.1 案例准备</h3><h4 id="1-安装依赖"><a href="#1-安装依赖" class="headerlink" title="1. 安装依赖"></a>1. 安装依赖</h4><p><a href="https://parceljs.org/">parcel</a> 是前端构建工具，类似 webpack，parcel 的最大特点是打包速速非常快而且零配置开箱即用。</p>
<p>什么需求打包工具？</p>
<p>ts -&gt; js -&gt; 代码不能直接运行，浏览器不识别模块。<br>ts -&gt; js -&gt; 模块打包 -&gt; 在浏览器中直接运行。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install parcel@2.4.1 -g</span><br></pre></td></tr></table></figure>
<p>使用 <a href="https://www.npmjs.com/package/@faker-js/faker">@faker-js/faker</a> 可以随机创建模拟数据，当前案例中用于随机生成用户和公司信息。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install @faker-js/faker@6.1.1</span><br></pre></td></tr></table></figure>
<p><a href="https://www.npmjs.com/package/@types/google.maps">@types/google.maps</a> 是谷歌地图的 TS 类型声明文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install @types/google.maps@3.48.3</span><br></pre></td></tr></table></figure>
<h4 id="2-创建应用"><a href="#2-创建应用" class="headerlink" title="2. 创建应用"></a>2. 创建应用</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建 maps 目录并切换至 maps 目录</span></span><br><span class="line">mkdir maps &amp;&amp; <span class="built_in">cd</span> maps</span><br><span class="line"><span class="comment"># 创建项目工程文件</span></span><br><span class="line">npm init -y</span><br><span class="line"><span class="comment"># 详见应用源码目录</span></span><br><span class="line">mkdir src</span><br><span class="line"><span class="comment"># 创建应用页面入口</span></span><br><span class="line">touch index.html</span><br><span class="line"><span class="comment"># 切换至应用源码目录并创建应用逻辑入口</span></span><br><span class="line"><span class="built_in">cd</span> src &amp;&amp; touch index.ts</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在应用页面入口文件中导入应用逻辑入口文件 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 当 parcel 检测到引入的是 TS 文件时, parcel 会先将其转换为 JS, 再将 TS 文件替换为转换后的 JS  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./src/index.ts&quot;</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动开发服务器, 运行应用</span></span><br><span class="line">parcel index.html</span><br></pre></td></tr></table></figure>
<h3 id="4-2-创建用户"><a href="#4-2-创建用户" class="headerlink" title="4.2 创建用户"></a>4.2 创建用户</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/User.ts</span></span><br><span class="line"><span class="keyword">import</span> faker <span class="keyword">from</span> <span class="string">&quot;@faker-js/faker&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 姓名</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// 位置</span></span><br><span class="line">  location: &#123;</span><br><span class="line">    <span class="comment">// 纬度</span></span><br><span class="line">    <span class="attr">lat</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="comment">// 经度</span></span><br><span class="line">    lng: <span class="built_in">number</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 随机创建用户姓名</span></span><br><span class="line">    <span class="built_in">this</span>.name = faker.name.firstName();</span><br><span class="line">    <span class="comment">// 随机创建用户位置</span></span><br><span class="line">    <span class="built_in">this</span>.location = &#123;</span><br><span class="line">      <span class="attr">lat</span>: <span class="built_in">parseFloat</span>(faker.address.latitude()),</span><br><span class="line">      <span class="attr">lng</span>: <span class="built_in">parseFloat</span>(faker.address.longitude()),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="comment">// 导入 User 类</span></span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;./User&quot;</span>;</span><br><span class="line"><span class="comment">// 创建用户</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User();</span><br><span class="line"><span class="comment">// 测试:在控制台中输出用户信息</span></span><br><span class="line"><span class="built_in">console</span>.log(user);</span><br></pre></td></tr></table></figure>
<h3 id="4-3-创建公司"><a href="#4-3-创建公司" class="headerlink" title="4.3 创建公司"></a>4.3 创建公司</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Company.ts</span></span><br><span class="line"><span class="keyword">import</span> faker <span class="keyword">from</span> <span class="string">&quot;@faker-js/faker&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Company</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 公司名称</span></span><br><span class="line">  <span class="attr">companyName</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// 公司口号</span></span><br><span class="line">  catchPhrase: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// 公司位置</span></span><br><span class="line">  location: &#123;</span><br><span class="line">    <span class="comment">// 纬度</span></span><br><span class="line">    <span class="attr">lat</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="comment">// 经度</span></span><br><span class="line">    lng: <span class="built_in">number</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 随机创建公司名称</span></span><br><span class="line">    <span class="built_in">this</span>.companyName = faker.company.companyName();</span><br><span class="line">    <span class="comment">// 随机创建公司口号</span></span><br><span class="line">    <span class="built_in">this</span>.catchPhrase = faker.company.catchPhrase();</span><br><span class="line">    <span class="comment">// 随机创建公司位置</span></span><br><span class="line">    <span class="built_in">this</span>.location = &#123;</span><br><span class="line">      <span class="attr">lat</span>: <span class="built_in">parseFloat</span>(faker.address.latitude()),</span><br><span class="line">      <span class="attr">lng</span>: <span class="built_in">parseFloat</span>(faker.address.longitude()),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="comment">// 导入 Company  类</span></span><br><span class="line"><span class="keyword">import</span> &#123; Company &#125; <span class="keyword">from</span> <span class="string">&quot;./Company&quot;</span>;</span><br><span class="line"><span class="comment">// 创建公司</span></span><br><span class="line"><span class="keyword">const</span> company = <span class="keyword">new</span> Company();</span><br><span class="line"><span class="comment">// 测试: 在控制台中输出公司信息</span></span><br><span class="line"><span class="built_in">console</span>.log(company);</span><br></pre></td></tr></table></figure>
<h3 id="4-4-创建地图"><a href="#4-4-创建地图" class="headerlink" title="4.4 创建地图"></a>4.4 创建地图</h3><p><img src="/img/ts/images/06.png" /></p>
<p>第一步：在应用页面入口文件中添加 Google Map API。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://maps.googleapis.com/maps/api/js?key=AIzaSyBNLrJhOMz6idD05pzfn5lhA-TAw-mAZCU&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>第二步：在应用入口文件中创建用户放置地图的容器。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-tag">html</span>, <span class="selector-tag">body</span>, <span class="selector-id">#map</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>第三步：创建地图</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> google.maps.Map(<span class="built_in">document</span>.getElementById(<span class="string">&quot;map&quot;</span>), &#123;</span><br><span class="line">  <span class="attr">zoom</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">center</span>: &#123;</span><br><span class="line">    <span class="attr">lat</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">lng</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="4-5-封装地图类"><a href="#4-5-封装地图类" class="headerlink" title="4.5 封装地图类"></a>4.5 封装地图类</h3><p>目标：创建 Map 类，在类中封装和地图的相关的业务逻辑，以后在创建地图时只需要对该类进行实例化即可。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Map.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Map</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储地图实例</span></span><br><span class="line">  <span class="keyword">private</span> googleMap: google.maps.Map;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">divId: <span class="built_in">string</span></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 创建地图</span></span><br><span class="line">    <span class="built_in">this</span>.googleMap = <span class="keyword">new</span> google.maps.Map(<span class="built_in">document</span>.getElementById(divId), &#123;</span><br><span class="line">      <span class="attr">zoom</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">center</span>: &#123;</span><br><span class="line">        <span class="attr">lat</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">lng</span>: <span class="number">0</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="built_in">Map</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./Map&quot;</span>;</span><br><span class="line"><span class="comment">// 创建地图</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="4-6-地图标记"><a href="#4-6-地图标记" class="headerlink" title="4.6 地图标记"></a>4.6 地图标记</h3><p><img src="/img/ts/images/05.png" /></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Map.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Company &#125; <span class="keyword">from</span> <span class="string">&quot;./Company&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;./User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Map</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 在地图中标记用户位置</span></span><br><span class="line">  <span class="function"><span class="title">addUserMarker</span>(<span class="params">user: User</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">new</span> google.maps.Marker(&#123;</span><br><span class="line">      <span class="attr">map</span>: <span class="built_in">this</span>.googleMap,</span><br><span class="line">      <span class="attr">position</span>: &#123;</span><br><span class="line">        <span class="attr">lat</span>: user.location.lat,</span><br><span class="line">        <span class="attr">lng</span>: user.location.lng,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 在地图中标记公司位置</span></span><br><span class="line">  <span class="function"><span class="title">addCompanyMarker</span>(<span class="params">company: Company</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">new</span> google.maps.Marker(&#123;</span><br><span class="line">      <span class="attr">map</span>: <span class="built_in">this</span>.googleMap,</span><br><span class="line">      <span class="attr">position</span>: &#123;</span><br><span class="line">        <span class="attr">lat</span>: company.location.lat,</span><br><span class="line">        <span class="attr">lng</span>: company.location.lng,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">&quot;map&quot;</span>);</span><br><span class="line">map.addUserMarker(user);</span><br><span class="line">map.addCompanyMarker(company);</span><br></pre></td></tr></table></figure>
<h3 id="4-7-消除重复代码"><a href="#4-7-消除重复代码" class="headerlink" title="4.7 消除重复代码"></a>4.7 消除重复代码</h3><p>在目前的代码中，addUserMarker 和 addCompanyMarker 两个方法中的代码是一模一样的，为消除重复代码，现决定将两个方法进行合并，并将参数更改为 User 和 Company 的联合类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Company &#125; <span class="keyword">from</span> <span class="string">&quot;./Company&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;./User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Map</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 在地图中标记位置</span></span><br><span class="line">  <span class="function"><span class="title">addMarker</span>(<span class="params">mappable: User | Company</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">new</span> google.maps.Marker(&#123;</span><br><span class="line">      <span class="attr">map</span>: <span class="built_in">this</span>.googleMap,</span><br><span class="line">      <span class="attr">position</span>: &#123;</span><br><span class="line">        <span class="attr">lat</span>: mappable.location.lat,</span><br><span class="line">        <span class="attr">lng</span>: mappable.location.lng,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于 location 属性是 User 、Company 类型中的公共属性，所以在addMarker 方法中可以直接调用。</p>
<h3 id="4-8-增加程序扩展性"><a href="#4-8-增加程序扩展性" class="headerlink" title="4.8 增加程序扩展性"></a>4.8 增加程序扩展性</h3><p>虽然重复代码被消除了，但是这不利于程序的扩展性，如果要在地图中标记其他物体的位置信息，那么就只能在参数后面不断的罗列其他物体的类型信息了。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">addMarker</span>(<span class="params">mappable: User | Company | Park | School</span>)</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>解决问题的方式是定义通用的类型接口，不论是什么数据类型只要满足接口中定义的规范即可，从而解决程序扩展性问题。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Mappable &#123;</span><br><span class="line">  <span class="attr">location</span>: &#123;</span><br><span class="line">    <span class="attr">lat</span>: <span class="built_in">number</span>;</span><br><span class="line">    lng: <span class="built_in">number</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">addMarker</span>(<span class="params">mappable: Mappable</span>)</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>在目前的代码中，不论是 User 类的实例还是 Company 类的实例，都是满足 Mappable 接口规范的。</p>
<h3 id="4-9-创建标记弹框"><a href="#4-9-创建标记弹框" class="headerlink" title="4.9 创建标记弹框"></a>4.9 创建标记弹框</h3><p>目标：在点击地图中的标记时，通过弹框展示标记信息。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Map.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Map</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 在地图中标记位置</span></span><br><span class="line">  <span class="function"><span class="title">addMarker</span>(<span class="params">mappable: Mappable</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 创建标记</span></span><br><span class="line">    <span class="keyword">const</span> marker = <span class="keyword">new</span> google.maps.Marker();</span><br><span class="line">    <span class="comment">// 为标记绑定点击事件</span></span><br><span class="line">    marker.addListener(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 创建弹窗</span></span><br><span class="line">      <span class="keyword">const</span> infoWindow = <span class="keyword">new</span> google.maps.InfoWindow(&#123;</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&quot;Hello I am marker content&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 打开弹框并指定弹框在哪个地图的哪个的标记的位置上弹出</span></span><br><span class="line">      infoWindow.open(<span class="built_in">this</span>.googleMap, marker);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-10-使用接口约束类"><a href="#4-10-使用接口约束类" class="headerlink" title="4.10 使用接口约束类"></a>4.10 使用接口约束类</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Map.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Mappable &#123;</span><br><span class="line">  markerContent(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Map.ts</span></span><br><span class="line"><span class="keyword">const</span> infoWindow = <span class="keyword">new</span> google.maps.InfoWindow(&#123;</span><br><span class="line">  <span class="attr">content</span>: mappable.markerContent(),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/User.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Mappable &#125; <span class="keyword">from</span> <span class="string">&quot;./Map&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="title">implements</span> <span class="title">Mappable</span> </span>&#123;</span><br><span class="line">  markerContent(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`用户名: <span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Company.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Mappable &#125; <span class="keyword">from</span> <span class="string">&quot;./Map&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Company</span> <span class="title">implements</span> <span class="title">Mappable</span> </span>&#123;</span><br><span class="line">  markerContent(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;h2&gt;公司名称: <span class="subst">$&#123;<span class="built_in">this</span>.companyName&#125;</span>&lt;/h2&gt;</span></span><br><span class="line"><span class="string">      &lt;h4&gt;公司口号: <span class="subst">$&#123;<span class="built_in">this</span>.catchPhrase&#125;</span>&lt;/h4&gt;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-排序案例"><a href="#5-排序案例" class="headerlink" title="5. 排序案例"></a>5. 排序案例</h2><h3 id="5-1-概述-1"><a href="#5-1-概述-1" class="headerlink" title="5.1 概述"></a>5.1 概述</h3><p>目标：实现一个通用的排序算法类，使它能够对数值数组进行排序、能够对字符串进行排序等。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 数值数组排序</span></span><br><span class="line">[<span class="number">10</span>, <span class="number">5</span>, <span class="number">18</span>, -<span class="number">3</span>] =&gt; [-<span class="number">3</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">18</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 字符串排序</span></span><br><span class="line"><span class="string">&quot;PoaJB&quot;</span> =&gt; <span class="string">&quot;aBJoP&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="5-2-配置编译器"><a href="#5-2-配置编译器" class="headerlink" title="5.2 配置编译器"></a>5.2 配置编译器</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建项目目录</span></span><br><span class="line">mkdir sort</span><br><span class="line"><span class="comment"># 创建项目源码目录</span></span><br><span class="line"><span class="built_in">cd</span> sort &amp;&amp; mkdir src build</span><br><span class="line"><span class="comment"># 创建 ts 配置文件</span></span><br><span class="line">tsc --init</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// 配置应用源码目录</span></span><br><span class="line">    <span class="attr">&quot;rootDir&quot;</span>: <span class="string">&quot;./src&quot;</span>,</span><br><span class="line">    <span class="comment">// 配置编译输出目录</span></span><br><span class="line">    <span class="attr">&quot;outDir&quot;</span>: <span class="string">&quot;./build&quot;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 监控文件变化, 重新编译</span></span><br><span class="line">tsc -w</span><br></pre></td></tr></table></figure>
<h3 id="5-3-并行编译配置"><a href="#5-3-并行编译配置" class="headerlink" title="5.3 并行编译配置"></a>5.3 并行编译配置</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm install nodemon concurrently</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;start:build&quot;</span>: <span class="string">&quot;tsc -w&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;start:run&quot;</span>: <span class="string">&quot;nodemon build/index.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;concurrently npm:start:*&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
<h3 id="5-4-复习冒泡排序-升序"><a href="#5-4-复习冒泡排序-升序" class="headerlink" title="5.4 复习冒泡排序(升序)"></a>5.4 复习冒泡排序(升序)</h3><p>核心思想：数组中的值进行两两比较，如果第一个值比第二个值大，将两个值交换位置。</p>
<p>比较轮数: 数组长度 - 1</p>
<p>每一轮比较次数: 数组长度 - 1 - i</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">原始值 =&gt; [<span class="number">10</span>, <span class="number">5</span>, <span class="number">18</span>, -<span class="number">3</span>]</span><br><span class="line">第一轮 =&gt; [<span class="number">5</span>, <span class="number">10</span>, -<span class="number">3</span>, <span class="number">18</span>] =&gt; <span class="number">3</span>次</span><br><span class="line">第二轮 =&gt; [<span class="number">5</span>, -<span class="number">3</span>, <span class="number">10</span>, <span class="number">18</span>] =&gt; <span class="number">2</span>次</span><br><span class="line">第三轮 =&gt; [-<span class="number">3</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">18</span>] =&gt; <span class="number">1</span>次</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">10</span>, <span class="number">5</span>, <span class="number">18</span>, -<span class="number">3</span>];</span><br><span class="line"><span class="comment">// 外层循环控制比较的轮数</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">  <span class="comment">// 内层循环控制比较的次数</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; arr.length - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">      <span class="comment">// 交换位置</span></span><br><span class="line">      <span class="keyword">let</span> leftHand = arr[j];</span><br><span class="line">      arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">      arr[j + <span class="number">1</span>] = leftHand;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-5-创建排序类"><a href="#5-5-创建排序类" class="headerlink" title="5.5 创建排序类"></a>5.5 创建排序类</h3><p>目标：创建排序类，通过实例化排序类创建排序对象并传递要排序的数据，调用排序对象下的 sort 方法对数据进行排序。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sorter</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收排序值</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> collection: <span class="built_in">number</span>[]</span>)</span> &#123;&#125;</span><br><span class="line">  <span class="comment">// 排序方法</span></span><br><span class="line">  sort(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; length &#125; = <span class="built_in">this</span>.collection;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; length - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.collection[j] &gt; <span class="built_in">this</span>.collection[j + <span class="number">1</span>]) &#123;</span><br><span class="line">          <span class="keyword">var</span> leftHand = <span class="built_in">this</span>.collection[j];</span><br><span class="line">          <span class="built_in">this</span>.collection[j] = <span class="built_in">this</span>.collection[j + <span class="number">1</span>];</span><br><span class="line">          <span class="built_in">this</span>.collection[j + <span class="number">1</span>] = leftHand;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sorter = <span class="keyword">new</span> Sorter([<span class="number">10</span>, <span class="number">5</span>, <span class="number">18</span>, -<span class="number">3</span>]);</span><br><span class="line">sorter.sort();</span><br><span class="line"><span class="built_in">console</span>.log(sorter.collection);</span><br></pre></td></tr></table></figure>
<p>我们已经初步实现了排序，但目前它只能排序数值数组，我们希望如果 collection 是字符串，sort 方法依然可以进行排序。</p>
<p>对于数值数组来说，我们是通过交换元素的位置对其进行排序的，但是字符串是不可变数据结构，字符串中的字符是不能交换位置的, 所以以上排序代码并不适合字符串。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">string</span> = <span class="string">&quot;Xaa&quot;</span>;</span><br><span class="line"><span class="comment">// 编译器提示: 类型 &quot;String&quot; 中的索引签名仅允许读取。</span></span><br><span class="line"><span class="built_in">string</span>[<span class="number">0</span>] = <span class="string">&quot;Y&quot;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="5-6-类型守卫"><a href="#5-6-类型守卫" class="headerlink" title="5.6  类型守卫"></a>5.6  类型守卫</h3><p>目标：通过联合类型和类型守卫对 collection 参数的类型进行区分，针对不同的类型进行不同的排序。</p>
<p>类型守卫是指在操作变量之前先对变量的类型进行判断，针对不同类型的变量进行不同的操作。</p>
<p>将 collection 参数的类型指定为联合类型，即参数既可以数值数组也可以是字符串，然后通过类型守卫针对不同的类型进行不同的处理。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sorter</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> collection: <span class="built_in">number</span>[] | <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line">  sort(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 由于数组和字符串都有 length 属性, 所以此处代码没有问题</span></span><br><span class="line">    <span class="comment">// 就是说在 sort 方法中, 默认情况下只能调用数组和字符串下的公有的属性和方法</span></span><br><span class="line">    <span class="keyword">const</span> &#123; length &#125; = <span class="built_in">this</span>.collection;</span><br><span class="line">    <span class="comment">// 通过类型守卫明确数据类型后再进行处理</span></span><br><span class="line">    <span class="comment">// 如果 collection 是数组类型</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.collection <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">      <span class="comment">// 针对数组进行处理, 可以调用数组下面的属性和方法</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">this</span>.collection === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 针对字符串进行处理, 可以调用字符串下面的属性和方法</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>虽然通过类型守卫可以让 Sorter 类支持多种数据的排序，但这种方式并不理想。如果以后要想对其它数据类型排序，我们不得不回到 Sorter 类中，在参数中继续添加联合类型，在 sort 方法中继续编写判断数据类型的方法，而且每种数据类型排序中大概率会有重复代码。</p>
<h3 id="5-7-创建数值数组排序类"><a href="#5-7-创建数值数组排序类" class="headerlink" title="5.7 创建数值数组排序类"></a>5.7 创建数值数组排序类</h3><p>通过对排序逻辑进行拆分可以让 Sorter 类支持多种数据结构的排序，那么如何对排序逻辑进行拆分呢？</p>
<p>排序逻辑可以拆分为通用排序逻辑和针对不同数据结构的特定排序逻辑，两种类别的逻辑要被编写在不同的类中。</p>
<p>通用的排序逻辑编写在 Sorter 类中，不同数据结构的特定排序逻辑编写在用于排序特定数据结构的排序类中。</p>
<p>对于数值数组可以为它创建 NumbersCollection 排序类，对于字符串可以为它创建 CharacterCollection 排序类。</p>
<p>冒泡排序的通用逻辑是指控制比较轮数的第一层for循环和控制比较次数的第二层for循环，这些逻辑应该放在 Sorter 类中。</p>
<p>冒泡排序的非通用逻辑是指数据两两比较的逻辑，数据交换位置的逻辑，获取数据长度的逻辑，这是特定数据结构排序类中要编写的代码。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/NumbersCollection.ts</span></span><br><span class="line"><span class="comment">// 创建数值数组排序类, 提供数值数组的两两比较逻辑和数据交互逻辑以及数组长度</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">NumbersCollection</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收数值数组</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> data: <span class="built_in">number</span>[]</span>)</span> &#123;&#125;</span><br><span class="line">  <span class="comment">// 返回数值数组的长度</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">length</span>(): <span class="title">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data.length;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 声明比较方法</span></span><br><span class="line">  compare(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data[leftIndex] &gt; <span class="built_in">this</span>.data[rightIndex];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 声明交换元素位置的方法</span></span><br><span class="line">  swap(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> leftHand = <span class="built_in">this</span>.data[leftIndex];</span><br><span class="line">    <span class="built_in">this</span>.data[leftIndex] = <span class="built_in">this</span>.data[rightIndex];</span><br><span class="line">    <span class="built_in">this</span>.data[rightIndex] = leftHand;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Sorter.ts</span></span><br><span class="line"><span class="comment">// 创建排序类, 提供公共的排序逻辑</span></span><br><span class="line"><span class="keyword">import</span> &#123; NumbersCollection &#125; <span class="keyword">from</span> <span class="string">&quot;./NumbersCollection&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Sorter</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收其他数据类的实例对象</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> collection: NumbersCollection</span>)</span> &#123;&#125;</span><br><span class="line">  <span class="comment">// 排序方法</span></span><br><span class="line">  sort(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 获取数据长度, 根据长度进行遍历</span></span><br><span class="line">    <span class="keyword">const</span> &#123; length &#125; = <span class="built_in">this</span>.collection;</span><br><span class="line">    <span class="comment">// 根据数据长度定义比较轮数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">      <span class="comment">// 根据数据长度定义比较次数</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; length - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">        <span class="comment">// 使用数据类实例提供的比较逻辑进行比较</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.collection.compare(j, j + <span class="number">1</span>)) &#123;</span><br><span class="line">          <span class="comment">// 实例数据类实例提供的交换数据位置的方法对数据位置进行交换</span></span><br><span class="line">          <span class="built_in">this</span>.collection.swap(j, j + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="comment">// 导入数值数组排序类</span></span><br><span class="line"><span class="keyword">import</span> &#123; NumbersCollection &#125; <span class="keyword">from</span> <span class="string">&quot;./NumbersCollection&quot;</span>;</span><br><span class="line"><span class="comment">// 导入排序类</span></span><br><span class="line"><span class="keyword">import</span> &#123; Sorter &#125; <span class="keyword">from</span> <span class="string">&quot;./Sorter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用数值数组排序类创建数值数组排序实例</span></span><br><span class="line"><span class="keyword">var</span> numbersCollection = <span class="keyword">new</span> NumbersCollection([<span class="number">5</span>, <span class="number">10</span>, -<span class="number">3</span>, <span class="number">18</span>]);</span><br><span class="line"><span class="comment">// 创建排序类实例，并传入数值数组排序类实例</span></span><br><span class="line"><span class="keyword">var</span> sorter = <span class="keyword">new</span> Sorter(numbersCollection);</span><br><span class="line"><span class="comment">// 调用排序方法对数值数组进行排序</span></span><br><span class="line">sorter.sort();</span><br><span class="line"><span class="comment">// 输出排序结果</span></span><br><span class="line"><span class="built_in">console</span>.log(numbersCollection.data);</span><br></pre></td></tr></table></figure>
<h3 id="5-8-定义排序接口"><a href="#5-8-定义排序接口" class="headerlink" title="5.8 定义排序接口"></a>5.8 定义排序接口</h3><p>在以上的代码中存在一个问题，就是 Sorter 类中的 collection 参数的类型被固定为了 NumbersCollection，其他数据类型的排序类实例传递不进来了。</p>
<p>解决该问题的方法是定义一个通用接口规范用于约束 collection 参数的类型，只要其他的数据类型符合该接口，就可以使用 Sorter 类进行排序。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Sortable &#123;</span><br><span class="line">  <span class="attr">length</span>: <span class="built_in">number</span>;</span><br><span class="line">  compare(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">boolean</span>;</span><br><span class="line">  swap(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Sorter</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 在实例化 Sorter 类时传递的参数的类型必须符合 Sortable 接口规范</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> collection: Sortable</span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-9-创建字符串排序类"><a href="#5-9-创建字符串排序类" class="headerlink" title="5.9 创建字符串排序类"></a>5.9 创建字符串排序类</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/CharacterCollection.ts</span></span><br><span class="line"><span class="comment">// 创建字符串排序类</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CharacterCollection</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收要排序的字符串</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> data: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line">  <span class="comment">// 返回字符串长度</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">length</span>(): <span class="title">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data.length;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 比较</span></span><br><span class="line">  compare(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="built_in">this</span>.data[leftIndex].toLocaleLowerCase() &gt;</span><br><span class="line">      <span class="built_in">this</span>.data[rightIndex].toLocaleLowerCase()</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 位置交换</span></span><br><span class="line">  swap(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> characters = <span class="built_in">this</span>.data.split(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> leftHand = characters[leftIndex];</span><br><span class="line">    characters[leftIndex] = characters[rightIndex];</span><br><span class="line">    characters[rightIndex] = leftHand;</span><br><span class="line">    <span class="built_in">this</span>.data = characters.join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>提示：字符串比较内部使用的是 Unicode 编码，根据编码的大小决定排序结果。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">string</span> = <span class="string">&quot;Xaa&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">string</span>.charCodeAt(<span class="number">0</span>)); <span class="comment">// 88</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">string</span>.charCodeAt(<span class="number">1</span>)); <span class="comment">// 97</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; CharacterCollection &#125; <span class="keyword">from</span> <span class="string">&quot;./CharacterCollection&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Sorter &#125; <span class="keyword">from</span> <span class="string">&quot;./Sorter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> characters = <span class="keyword">new</span> CharacterCollection(<span class="string">&quot;zyx&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> sorter = <span class="keyword">new</span> Sorter(characters);</span><br><span class="line">sorter.sort();</span><br><span class="line"><span class="built_in">console</span>.log(characters.data);</span><br></pre></td></tr></table></figure>
<h3 id="5-10-简化排序类使用方式"><a href="#5-10-简化排序类使用方式" class="headerlink" title="5.10 简化排序类使用方式"></a>5.10 简化排序类使用方式</h3><p>目前在对数据进行排序时，需要分别实例化数据排序类和 Sorter 类，不是特别友好。</p>
<p>如果仅实例化数据排序类就可以对数据进行排序就比较理想了，要实现这个目标只需要让数据类继承 Sorter 类即可。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下代码为最终的调用方式</span></span><br><span class="line"><span class="keyword">var</span> numbersCollection = <span class="keyword">new</span> NumbersCollection([<span class="number">5</span>, <span class="number">10</span>, -<span class="number">3</span>, <span class="number">18</span>]);</span><br><span class="line">numbersCollection.sort();</span><br><span class="line"><span class="built_in">console</span>.log(numbersCollection.data);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/NumbersCollection.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Sorter &#125; <span class="keyword">from</span> <span class="string">&quot;./Sorter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据类继承 Sorter 类, 让数据类型拥有 sort 方法</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">NumbersCollection</span> <span class="keyword">extends</span> <span class="title">Sorter</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收数值数组</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> data: <span class="built_in">number</span>[]</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 返回数值数组的长度</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">length</span>(): <span class="title">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data.length;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 声明比较方法</span></span><br><span class="line">  compare(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data[leftIndex] &gt; <span class="built_in">this</span>.data[rightIndex];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 声明交换元素位置的方法</span></span><br><span class="line">  swap(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> leftHand = <span class="built_in">this</span>.data[leftIndex];</span><br><span class="line">    <span class="built_in">this</span>.data[leftIndex] = <span class="built_in">this</span>.data[rightIndex];</span><br><span class="line">    <span class="built_in">this</span>.data[rightIndex] = leftHand;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当数据排序类继承了 Sorter 类以后，Sorter 类就不需要被直接实例化了，所以也不需要接收 collection 参数了，也不需要 Sortable 接口了。</p>
<p>在去除了 collection 参数以后，在 sort 方法中，通过 this 获取 length、compare、swap。</p>
<p>因为数据排序类继承了 Sorter 类，其实就是将父类中的方法添加到了子类的实例对象中，sort 方法在执行是， this 指向子类实例对象。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Sorter.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Sorter</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 排序方法</span></span><br><span class="line">  sort(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 获取数据长度, 根据长度进行遍历</span></span><br><span class="line">    <span class="keyword">const</span> &#123; length &#125; = <span class="built_in">this</span>;</span><br><span class="line">    <span class="comment">// 根据数据长度定义比较轮数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">      <span class="comment">// 根据数据长度定义比较次数</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; length - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">        <span class="comment">// 使用数据类实例提供的比较逻辑进行比较</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.compare(j, j + <span class="number">1</span>)) &#123;</span><br><span class="line">          <span class="comment">// 实例数据类实例提供的交换数据位置的方法对数据位置进行交换</span></span><br><span class="line">          <span class="built_in">this</span>.swap(j, j + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是对于以上代码 TypeScript 编译器会报错，因为它在解析 Sorter 类时没有找到 length、compare、swap，它是期望本类中有这些属性和方法的。</p>
<p>可以使用抽象类解决编译器报错问题，那么到底什么是抽象类？</p>
<h3 id="5-11-抽象类-1"><a href="#5-11-抽象类-1" class="headerlink" title="5.11 抽象类"></a>5.11 抽象类</h3><p>在抽象类的方法中可以调用本类中不存在的属性或者方法，但是这些不存在的属性或方法需要被定义为抽象方法，通过这种方式告诉 TypeScript 编译器虽然当前类中没有这些方法，但是在继承了抽象类的子类中一定是有这些属性或方法的，这样 TypeScript 编译器就不会报错了。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// abstract 关键字用于定义抽象类和抽象类成员</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Sorter</span> </span>&#123;</span><br><span class="line">  <span class="keyword">abstract</span> compare(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="keyword">abstract</span> swap(leftIndex: <span class="built_in">number</span>, <span class="attr">rightIndex</span>: <span class="built_in">number</span>): <span class="built_in">void</span>;</span><br><span class="line">  <span class="keyword">abstract</span> length: <span class="built_in">number</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">sort</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>抽象类是专供子类继承使用的，继承了抽象类的类必须实现抽象类中定义的属性和方法，通过抽象类可以约束子类中必须实现特定的属性和方法。</p>
<p>如果子类在继承抽象类以后，没有实现抽象类中要求的属性和方法，TypeScript 就会在子类中报错。</p>
<p>抽象类不能被直接实例化，这也是符合我们的场景的，因为 Sorter 类目前不再需要被直接实例化。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/CharacterCollection.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Sorter &#125; <span class="keyword">from</span> <span class="string">&quot;./Sorter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CharacterCollection</span> <span class="keyword">extends</span> <span class="title">Sorter</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收要排序的字符串</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> data: <span class="built_in">string</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">var</span> characters = <span class="keyword">new</span> CharacterCollection(<span class="string">&quot;zyx&quot;</span>);</span><br><span class="line">characters.sort();</span><br><span class="line"><span class="built_in">console</span>.log(characters.data);</span><br></pre></td></tr></table></figure>
<p>在当前案例中，我们通过继承的方式从父类中获取了公共的 sort 方法，因为 sort 方法在执行后要调用子类的一些特定方法，所有又通过抽象类的方式约束了子类必须实现的一些属性和方法。</p>
<h2 id="6-统计数据案例"><a href="#6-统计数据案例" class="headerlink" title="6. 统计数据案例"></a>6. 统计数据案例</h2><h3 id="6-1-概述"><a href="#6-1-概述" class="headerlink" title="6.1 概述"></a>6.1 概述</h3><p>需求：从 CSV 格式的文件中读取足球比赛信息，并将它转换为程序支持的数据格式，分析数据（比如找出哪支球队赢得最多或者输的最多、每场比赛的平均进球数），生成报告（在控制台或其他地方输出分析结果）。</p>
<p><img src="/img/ts/images/07.png" /></p>
<p>H： 表示主队胜利、A：表示客队胜利、D：表示平局</p>
<h3 id="6-2-项目设置"><a href="#6-2-项目设置" class="headerlink" title="6.2 项目设置"></a>6.2 项目设置</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir stats &amp;&amp; <span class="built_in">cd</span> stats</span><br><span class="line">mkdir src build</span><br><span class="line">npm init -y</span><br><span class="line">tsc --init</span><br><span class="line">npm install nodemon concurrently @types/node</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// tsconfig.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// 配置应用源码目录</span></span><br><span class="line">    <span class="attr">&quot;rootDir&quot;</span>: <span class="string">&quot;./src&quot;</span>,</span><br><span class="line">    <span class="comment">// 配置编译输出目录</span></span><br><span class="line">    <span class="attr">&quot;outDir&quot;</span>: <span class="string">&quot;./build&quot;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;start:build&quot;</span>: <span class="string">&quot;tsc -w&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;start:run&quot;</span>: <span class="string">&quot;nodemon build/index.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;concurrently npm:start:*&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-3-需求-gt-CSV-数据解析"><a href="#6-3-需求-gt-CSV-数据解析" class="headerlink" title="6.3 需求 -&gt; CSV 数据解析"></a>6.3 需求 -&gt; CSV 数据解析</h3><p>目标：将 CSV 文件中的内容字符串解析为数组对象。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> matches = fs</span><br><span class="line">  .readFileSync(<span class="string">&quot;football.csv&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">encoding</span>: <span class="string">&quot;utf-8&quot;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  .split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .map((row: <span class="built_in">string</span>): <span class="built_in">string</span>[] =&gt; row.split(<span class="string">&quot;,&quot;</span>));</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 解析结果</span></span><br><span class="line"><span class="keyword">const</span> matches = [</span><br><span class="line">  [<span class="string">&quot;27/10/2021&quot;</span>, <span class="string">&quot;Watford&quot;</span>, <span class="string">&quot;Huddersfield&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;M Dean&quot;</span>],</span><br><span class="line">  [<span class="string">&quot;28/10/2021&quot;</span>, <span class="string">&quot;Burnley&quot;</span>, <span class="string">&quot;Chelsea&quot;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;A&quot;</span>, <span class="string">&quot;C Pawson&quot;</span>],</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<h3 id="6-4-需求-gt-求曼联赢赛的次数"><a href="#6-4-需求-gt-求曼联赢赛的次数" class="headerlink" title="6.4 需求 -&gt; 求曼联赢赛的次数"></a>6.4 需求 -&gt; 求曼联赢赛的次数</h3><p>计算曼联球队(Man United)赢得比赛的次数，无论曼联球队是主场(H)还是客场(A)。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">let</span> manUnitedWins = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> match <span class="keyword">of</span> matches) &#123;</span><br><span class="line">  <span class="comment">// 曼联球队为主场赢得比赛的情况</span></span><br><span class="line">  <span class="keyword">if</span> (match[<span class="number">1</span>] === <span class="string">&quot;Man United&quot;</span> &amp;&amp; match[<span class="number">5</span>] === <span class="string">&quot;H&quot;</span>) &#123;</span><br><span class="line">    manUnitedWins++;</span><br><span class="line">    <span class="comment">// 曼联球队为客场赢得比赛的情况</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (match[<span class="number">2</span>] === <span class="string">&quot;Man United&quot;</span> &amp;&amp; match[<span class="number">5</span>] === <span class="string">&quot;A&quot;</span>) &#123;</span><br><span class="line">    manUnitedWins++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-5-提升程序可阅读性"><a href="#6-5-提升程序可阅读性" class="headerlink" title="6.5 提升程序可阅读性"></a>6.5 提升程序可阅读性</h3><h4 id="6-5-1-问题"><a href="#6-5-1-问题" class="headerlink" title="6.5.1 问题"></a>6.5.1 问题</h4><p>在以上代码中，在判断曼联球队是否赢得比赛时，我们使用了 H 和 A 进行判断，这个代码是我们刚刚写完的，我们完全知道它代表什么含义，H 表示主场球队赢得了比赛，A 表示客场球队赢得了比赛。但是，当另外一个程序员来看这个代码的时候，他并不清楚 H 和 A 分别代表什么，或者在将来的某一个时间点，我们自己再回来看这个代码的时候，也不一定清楚的记得它们的含义。所以从代码的可阅读角度来看，直接使用字符串 H 和 A 进行判断是不明智的，它使代码的阅读变得困难。</p>
<p>或许我们可以声明两个变量来存储H和A，让变量的名字变得有含义，通过变量进行判断来提高程序的可阅读性，像下面这样。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> homeWin = <span class="string">&quot;H&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> awayWin = <span class="string">&quot;A&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (match[<span class="number">1</span>] === <span class="string">&quot;Man United&quot;</span> &amp;&amp; match[<span class="number">5</span>] === homeWin) &#123;</span><br><span class="line">  manUnitedWins++;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (match[<span class="number">2</span>] === <span class="string">&quot;Man United&quot;</span> &amp;&amp; match[<span class="number">5</span>] === awayWin) &#123;</span><br><span class="line">  manUnitedWins++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过以上的更改确实提高了代码的可阅读性但还是存在一个问题，比赛结果除了有H、A、还有 D，就是表示平局的D。在以上代码中由于目前没有用到 D，所以就没写，但是没写并不等于没有，当另外一个程序员来看这个代码的时候，他并不知道还有 D 这个比赛结果，这也是不尽人意的地方。那好，那我们就将 D 写在哪里，像下面这样。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> homeWin = <span class="string">&quot;H&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> awayWin = <span class="string">&quot;A&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> draw = <span class="string">&quot;D&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>虽然将 D 写出来，其他人能够猜出比赛结果可能有三个，但由于 draw 变量没有被使用，这时别人可能认为它是无用的代码，很可能随手就把它删掉了，这也是代码中存在的潜在问题。</p>
<h4 id="6-5-2-枚举"><a href="#6-5-2-枚举" class="headerlink" title="6.5.2  枚举"></a>6.5.2  枚举</h4><p>在 JavaScript 中，以上问题的解决方案是将三种比赛结果放在一个对象中，这样既提高了代码的可阅读性，又完整的表述了比赛的三种结果。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> matchResult = &#123;</span><br><span class="line">  <span class="attr">homeWin</span>: <span class="string">&quot;H&quot;</span>,</span><br><span class="line">  <span class="attr">awayWin</span>: <span class="string">&quot;A&quot;</span>,</span><br><span class="line">  <span class="attr">draw</span>: <span class="string">&quot;D&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (match[<span class="number">1</span>] === <span class="string">&quot;Man United&quot;</span> &amp;&amp; match[<span class="number">5</span>] === matchResult.homeWin) &#123;&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (match[<span class="number">2</span>] === <span class="string">&quot;Man United&quot;</span> &amp;&amp; match[<span class="number">5</span>] === matchResult.awayWin) &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>在 TypeScript 中，可以使用枚举解决上述问题。</p>
<p>枚举用于存储一组密切相关且有限的值，可以提升代码的可读性，可以限定值的范围，比如比赛结果，考试成绩，颜色种类，性别等等。</p>
<p>所以从代码可阅读的角度出发，以上问题的最佳解决方案就是使用枚举， 对象并没有明确的限定值的范围的含义。</p>
<p>枚举在编译后本质上仍然是 JavaScript 对象，但是在源码中它提升了代码的可阅读性。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">enum</span> MatchResult &#123;</span><br><span class="line">  homeWin = <span class="string">&quot;H&quot;</span>,</span><br><span class="line">  awayWin = <span class="string">&quot;A&quot;</span>,</span><br><span class="line">  draw = <span class="string">&quot;D&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (match[<span class="number">1</span>] === <span class="string">&quot;Man United&quot;</span> &amp;&amp; match[<span class="number">5</span>] === MatchResult.homeWin) &#123;&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (match[<span class="number">2</span>] === <span class="string">&quot;Man United&quot;</span> &amp;&amp; match[<span class="number">5</span>] === MatchResult.awayWin) &#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-6-提升程序可复用性"><a href="#6-6-提升程序可复用性" class="headerlink" title="6.6 提升程序可复用性"></a>6.6 提升程序可复用性</h3><h4 id="6-6-1-概述"><a href="#6-6-1-概述" class="headerlink" title="6.6.1 概述"></a>6.6.1 概述</h4><p>在当前代码中仍然存在的问题是，数据的来源代码是硬编码的，是读取的本地CSV文件，如果将来代码中的数据来源发生变化，比如更改为向服务器发送请求获取足球比赛数据，此时我们应该怎么办呢？删除旧代码重新编写新的数据来源代码？如果真的这样做，对于代码的重用是非常不利的，也许将来我们仍然要读取本地的CSV文件呢，难道要重写再写一遍吗？</p>
<p>解决上述问题的方法是将不同的获取数据来源的代码编写到不同的类中，比如读取本地 CSV 文件的类，向服务端发送请求获取数据的类，使用什么数据源就实例化对应的类就可以了，就算更改数据源也仅仅是删除少量的和实例化相关的代码，所有的核心代码都还在，将来要重新使用该数据源，只需要重新实例化就行了。</p>
<h4 id="6-6-2-创建读取本地CSV文件的类"><a href="#6-6-2-创建读取本地CSV文件的类" class="headerlink" title="6.6.2 创建读取本地CSV文件的类"></a>6.6.2 创建读取本地CSV文件的类</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// CsvFileReader.ts</span></span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CsvFileReader</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储 CSV 文件读取结果</span></span><br><span class="line">  <span class="attr">data</span>: <span class="built_in">string</span>[][] = [];</span><br><span class="line">  <span class="comment">// 接收要读取的 CSV 文件路径</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> filename: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line">  <span class="comment">// 读取 CSV 文件内容并对内容进行转换</span></span><br><span class="line">  read(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.data = fs</span><br><span class="line">      .readFileSync(<span class="built_in">this</span>.filename, &#123; <span class="attr">encoding</span>: <span class="string">&quot;utf-8&quot;</span> &#125;)</span><br><span class="line">      .split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">      .map((row: <span class="built_in">string</span>): <span class="built_in">string</span>[] =&gt; row.split(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; CsvFileReader &#125; <span class="keyword">from</span> <span class="string">&quot;./CSVFileReader&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reader = <span class="keyword">new</span> CsvFileReader(<span class="string">&quot;football.csv&quot;</span>);</span><br><span class="line">reader.read();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> match <span class="keyword">of</span> reader.data) &#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-7-需求-gt-行数据类型转换"><a href="#6-7-需求-gt-行数据类型转换" class="headerlink" title="6.7  需求 -&gt; 行数据类型转换"></a>6.7  需求 -&gt; 行数据类型转换</h3><p>在目前的代码中，比赛信息中的每一个字段的类型都是字符串，接下来我们要做的事情就是将比赛信息的每一个字段转换为它应是的类型。</p>
<p>第一步：定义一个辅助方法，用于将日期字符串转换为日期对象。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/utils.ts</span></span><br><span class="line"><span class="comment">// 将日期字符串转换为日期对象</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">dateStringToDate</span>(<span class="params">dateString: <span class="built_in">string</span></span>): <span class="title">Date</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> dateParts = dateString</span><br><span class="line">    .split(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">    .map((value: <span class="built_in">string</span>): <span class="function"><span class="params">number</span> =&gt;</span> <span class="built_in">parseInt</span>(value));</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(dateParts[<span class="number">2</span>], dateParts[<span class="number">1</span>] - <span class="number">1</span>, dateParts[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二步：将比赛结果枚举定义在单独的模块文件中，用于复用。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/matchResult.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="built_in">enum</span> MatchResult &#123;</span><br><span class="line">  homeWin = <span class="string">&quot;H&quot;</span>,</span><br><span class="line">  awayWin = <span class="string">&quot;A&quot;</span>,</span><br><span class="line">  draw = <span class="string">&quot;D&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; MatchResult &#125; <span class="keyword">from</span> <span class="string">&quot;./matchResult&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>第三步：通过元组约束比赛信息中的每一个字段的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> MatchData = [<span class="built_in">Date</span>, <span class="built_in">string</span>, <span class="built_in">string</span>, <span class="built_in">number</span>, <span class="built_in">number</span>, MatchResult, <span class="built_in">string</span>];</span><br></pre></td></tr></table></figure>
<p>第四步：将比赛信息中的每一个字段转换为它应有的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/CsvFileReader.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; MatchResult &#125; <span class="keyword">from</span> <span class="string">&quot;./matchResult&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; dateStringToDate &#125; <span class="keyword">from</span> <span class="string">&quot;./utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CsvFileReader</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储 CSV 文件读取结果</span></span><br><span class="line">  <span class="attr">data</span>: MatchData[] = [];</span><br><span class="line">  <span class="comment">// 读取 CSV 文件内容并对内容进行转换</span></span><br><span class="line">  read(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.data = fs</span><br><span class="line">      .readFileSync(<span class="built_in">this</span>.filename, &#123; <span class="attr">encoding</span>: <span class="string">&quot;utf-8&quot;</span> &#125;)</span><br><span class="line">      .split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">      .map((row: <span class="built_in">string</span>): <span class="built_in">string</span>[] =&gt; row.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">      .map((row: <span class="built_in">string</span>[]): <span class="function"><span class="params">MatchData</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">          dateStringToDate(row[<span class="number">0</span>]),</span><br><span class="line">          row[<span class="number">1</span>],</span><br><span class="line">          row[<span class="number">2</span>],</span><br><span class="line">          <span class="built_in">parseInt</span>(row[<span class="number">3</span>]),</span><br><span class="line">          <span class="built_in">parseInt</span>(row[<span class="number">4</span>]),</span><br><span class="line">          row[<span class="number">5</span>] <span class="keyword">as</span> MatchResult,</span><br><span class="line">          row[<span class="number">6</span>],</span><br><span class="line">        ];</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过元组限定了类型以后，从二维数组中获取的值，TypeScript 编译器可以自动推断出它的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// (property) 0: Date</span></span><br><span class="line">reader.data[<span class="number">0</span>][<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<h3 id="6-8-CsvFileReader-类重构"><a href="#6-8-CsvFileReader-类重构" class="headerlink" title="6.8  CsvFileReader 类重构"></a>6.8  CsvFileReader 类重构</h3><h4 id="6-8-1-概述"><a href="#6-8-1-概述" class="headerlink" title="6.8.1  概述"></a>6.8.1  概述</h4><p>现在我们继续看 CsvFileReader 这个类，它目前存在的问题是不可复用，因为在这个类中 data 属性的数据类型被固定了，这个数据类型是针对 football 这个 CSV 文件的，也就是说 CsvFileReader 类目前只能读取 football.csv 文件，换一个文件程序将会运行失败，因为会产生类型不匹配的问题。所以接下来我们要做的事情就是重构这个类，使它变得可复用，让它可以读取任何 CSV 文件。</p>
<h4 id="6-8-2-①-基于继承的重构"><a href="#6-8-2-①-基于继承的重构" class="headerlink" title="6.8.2 ① 基于继承的重构"></a>6.8.2 ① 基于继承的重构</h4><p>通过逻辑拆分可以使 CsvFileReader 类变得可复用。</p>
<h5 id="1-抽象类"><a href="#1-抽象类" class="headerlink" title="1. 抽象类"></a>1. 抽象类</h5><p>为不同的 CSV 文件创建不同的读取类，在特定类中放置特定逻辑，然后让它继承 CsvFileReader 类，父类调用子类提供了特定逻辑。</p>
<p>将 CsvFileReader 变成抽象类，在抽象类中创建抽象方法 mapRow，其他类在继承该类时必须实现该方法，用于实现各自的数据格式转换的逻辑。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/CsvFileReader.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CsvFileReader</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储 CSV 文件读取结果</span></span><br><span class="line">  <span class="attr">data</span>: <span class="built_in">any</span>[] = [];</span><br><span class="line">  <span class="comment">// 接收 CSV 文件名称</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> filename: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">abstract</span> mapRow(row: <span class="built_in">string</span>[]): <span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 读取 CSV 文件内容并对内容进行转换</span></span><br><span class="line">  read(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.data = fs</span><br><span class="line">      .readFileSync(<span class="built_in">this</span>.filename, &#123; <span class="attr">encoding</span>: <span class="string">&quot;utf-8&quot;</span> &#125;)</span><br><span class="line">      .split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">      .map((row: <span class="built_in">string</span>): <span class="built_in">string</span>[] =&gt; row.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">      .map(<span class="built_in">this</span>.mapRow);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/MatchReader.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; CsvFileReader &#125; <span class="keyword">from</span> <span class="string">&quot;./CsvFileReader&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; MatchResult &#125; <span class="keyword">from</span> <span class="string">&quot;./matchResult&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; dateStringToDate &#125; <span class="keyword">from</span> <span class="string">&quot;./utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MatchData = [<span class="built_in">Date</span>, <span class="built_in">string</span>, <span class="built_in">string</span>, <span class="built_in">number</span>, <span class="built_in">number</span>, MatchResult, <span class="built_in">string</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MatchReader</span> <span class="keyword">extends</span> <span class="title">CsvFileReader</span> </span>&#123;</span><br><span class="line">  mapRow(row: <span class="built_in">string</span>[]): MatchData &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      dateStringToDate(row[<span class="number">0</span>]),</span><br><span class="line">      row[<span class="number">1</span>],</span><br><span class="line">      row[<span class="number">2</span>],</span><br><span class="line">      <span class="built_in">parseInt</span>(row[<span class="number">3</span>]),</span><br><span class="line">      <span class="built_in">parseInt</span>(row[<span class="number">4</span>]),</span><br><span class="line">      row[<span class="number">5</span>] <span class="keyword">as</span> matchResult,</span><br><span class="line">      row[<span class="number">6</span>],</span><br><span class="line">    ];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-泛型"><a href="#2-泛型" class="headerlink" title="2. 泛型"></a>2. 泛型</h5><p>在以上代码中我们又遇到了一个问题，CsvFileReader 类中的 data 属性的类型以及 mapRow 方法的返回值的类型都无法指定了，因为在定义 CsvFileReader 类时，我们并不知道将来它会读取具有什么数据类型的 Csv 文件。</p>
<p>以上问题可以通过 TypeScript 中的泛型进行解决，那么什么是泛型呢？</p>
<p>泛型是指将类型作为参数进行传递，用于解决代码复用问题。泛型可以应用于函数，可以应用于类。</p>
<p>在定义函数时，函数参数的类型可暂不指定，参数的具体类型可以在调用函数时决定，在调用函数时可以将类型传递进函数以达到类型约束的目的。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HoldString</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> data: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HoldNumber</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> data: <span class="built_in">number</span></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> HoldString(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line"><span class="keyword">new</span> HoldNumber(<span class="number">123</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HoldAnything</span>&lt;<span class="title">TypeOfData</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> anything: TypeOfData</span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> HoldAnything&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;string&quot;</span>);</span><br><span class="line"><span class="keyword">new</span> HoldAnything&lt;<span class="built_in">number</span>&gt;(<span class="number">123</span>);</span><br></pre></td></tr></table></figure>
<p>通过泛型解决 CsvFileReader 类中的 data 属性类型的设置问题。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/CsvFileReader.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CsvFileReader</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储 CSV 文件读取结果</span></span><br><span class="line">  <span class="attr">data</span>: T[] = [];</span><br><span class="line">  <span class="keyword">abstract</span> mapRow(row: <span class="built_in">string</span>[]): T;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/MatchReader.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MatchReader</span> <span class="keyword">extends</span> <span class="title">CsvFileReader</span>&lt;<span class="title">MatchData</span>&gt; </span>&#123;</span><br><span class="line">  mapRow(row: <span class="built_in">string</span>[]): MatchData &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">const</span> reader = <span class="keyword">new</span> MatchReader(<span class="string">&quot;football.csv&quot;</span>);</span><br><span class="line">reader.read();</span><br><span class="line"><span class="comment">// (property) 0: Date</span></span><br><span class="line"><span class="comment">// reader.data[0][0]</span></span><br></pre></td></tr></table></figure>
<h4 id="6-8-3-②-基于组合的重构"><a href="#6-8-3-②-基于组合的重构" class="headerlink" title="6.8.3 ② 基于组合的重构"></a>6.8.3 ② 基于组合的重构</h4><p>在 CsvFileReader 类中，data 属性负责存储文件读取结果，read 方法负责读取文件。</p>
<p>在 MatchReader 类中，接收 CsvFileReader 实例对象，load 方法负责调用 CsvFileReader 对象中的 read 方法读取文件内容，文件内容读取完成后调用 CsvFileReader 对象中的 data 属性获取读取结果，读取结果获取完成后执行自定义处理逻辑，处理完成后使用 matches 属性存储最终处理结果。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CsvFileReader</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储 CSV 文件读取结果</span></span><br><span class="line">  <span class="attr">data</span>: <span class="built_in">string</span>[][] = [];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 接收 CSV 文件名称</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> filename: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 读取 CSV 文件内容</span></span><br><span class="line">  read(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.data = fs</span><br><span class="line">      .readFileSync(<span class="built_in">this</span>.filename, &#123; <span class="attr">encoding</span>: <span class="string">&quot;utf-8&quot;</span> &#125;)</span><br><span class="line">      .split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">      .map((row: <span class="built_in">string</span>): <span class="built_in">string</span>[] =&gt; row.split(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; MatchResult &#125; <span class="keyword">from</span> <span class="string">&quot;./matchResult&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; dateStringToDate &#125; <span class="keyword">from</span> <span class="string">&quot;./utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MatchData = [<span class="built_in">Date</span>, <span class="built_in">string</span>, <span class="built_in">string</span>, <span class="built_in">number</span>, <span class="built_in">number</span>, MatchResult, <span class="built_in">string</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> DataReader &#123;</span><br><span class="line">  read(): <span class="built_in">void</span>;</span><br><span class="line">  data: <span class="built_in">string</span>[][];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MatchReader</span> </span>&#123;</span><br><span class="line">  <span class="attr">matches</span>: MatchData[] = [];</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> reader: DataReader</span>)</span> &#123;&#125;</span><br><span class="line">  <span class="function"><span class="title">load</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.reader.read();</span><br><span class="line">    <span class="built_in">this</span>.matches = <span class="built_in">this</span>.reader.data.map((row: <span class="built_in">string</span>[]): <span class="function"><span class="params">MatchData</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> [</span><br><span class="line">        dateStringToDate(row[<span class="number">0</span>]),</span><br><span class="line">        row[<span class="number">1</span>],</span><br><span class="line">        row[<span class="number">2</span>],</span><br><span class="line">        <span class="built_in">parseInt</span>(row[<span class="number">3</span>]),</span><br><span class="line">        <span class="built_in">parseInt</span>(row[<span class="number">4</span>]),</span><br><span class="line">        row[<span class="number">5</span>] <span class="keyword">as</span> MatchResult,</span><br><span class="line">        row[<span class="number">6</span>],</span><br><span class="line">      ];</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> csvFileReader = <span class="keyword">new</span> CsvFileReader(<span class="string">&quot;football.csv&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> matchReader = <span class="keyword">new</span> MatchReader(csvFileReader);</span><br><span class="line">matchReader.load();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> match <span class="keyword">of</span> matchReader.matches) &#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-9-比赛结果的分析与输出"><a href="#6-9-比赛结果的分析与输出" class="headerlink" title="6.9 比赛结果的分析与输出"></a>6.9 比赛结果的分析与输出</h3><h4 id="6-9-1-概述"><a href="#6-9-1-概述" class="headerlink" title="6.9.1 概述"></a>6.9.1 概述</h4><p>在目前的代码中，我们仅仅是分析了曼联球队赢得比赛的次数并在控制台中打印了分析结果。试想一下，如果我们想分析其他球队赢得比赛的次数或者其他球队输得比赛的次数，代码该怎么写？如果我们不想在控制台中输出分析结果，想在 HTML 文件中存储分析结果代码又该怎么写？</p>
<ol>
<li>为使代码更具扩展性、复用性，我们会为不同的分析行为创建不同的类，为不同的输出行为创建不同的类，然后再创建一个用于组合分析行为和输出行为的类。</li>
<li>为使组合类能够正常工作，我们需要创建约束分析行为类的接口规范，创建约束输出行为类的接口规范。</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> summary = <span class="keyword">new</span> Summary(</span><br><span class="line">  <span class="keyword">new</span> WinsAnalysis(<span class="string">&quot;Man United&quot;</span>),</span><br><span class="line">  <span class="keyword">new</span> ConsoleReport()</span><br><span class="line">);</span><br><span class="line">summary.buildAndPrintReport(matchReader.matches);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> summary = <span class="keyword">new</span> Summary(</span><br><span class="line">  <span class="keyword">new</span> AverageGoalsAnalysis(<span class="string">&quot;Man United&quot;</span>),</span><br><span class="line">  <span class="keyword">new</span> HtmlReport()</span><br><span class="line">);</span><br><span class="line">summary.buildAndPrintReport(matchReader.matches);</span><br></pre></td></tr></table></figure>
<h4 id="6-9-2-创建分析接口和输出接口"><a href="#6-9-2-创建分析接口和输出接口" class="headerlink" title="6.9.2 创建分析接口和输出接口"></a>6.9.2 创建分析接口和输出接口</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Summary.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; MatchData &#125; <span class="keyword">from</span> <span class="string">&quot;./MatchData&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用于约束分析行为的接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Analyzer &#123;</span><br><span class="line">  <span class="comment">// 用于实现分析过程的方法, 接收比赛结果列表作为参数, 返回分析结果</span></span><br><span class="line">  run(matches: MatchData[]): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用于约束输出行为的接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> OutputTarget &#123;</span><br><span class="line">  <span class="comment">// 用于实现打印分析结果的方法, 接收分析结果作为参数, 没有返回值</span></span><br><span class="line">  print(report: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用于组合分析行为和输出行为的类</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Summary</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收满足分析行为接口的类实例</span></span><br><span class="line"> 	<span class="comment">// 接收满足输出行为接口的类实例</span></span><br><span class="line">  <span class="comment">// 只有满足接口要求, 在 Summary 类中才能安全统一的的调用相关方法实现功能</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> analyzer: Analyzer, <span class="keyword">public</span> outputTarget: OutputTarget</span>)</span> &#123;&#125;</span><br><span class="line">  <span class="comment">// 分析并打印分析结果</span></span><br><span class="line">  <span class="function"><span class="title">buildAndPrintReport</span>(<span class="params">matches: MatchData[]</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 调用分析类实例中的 run 方法进行分析</span></span><br><span class="line">    <span class="keyword">const</span> output = <span class="built_in">this</span>.analyzer.run(matches);</span><br><span class="line">    <span class="comment">// 打印分析结果</span></span><br><span class="line">    <span class="built_in">this</span>.outputTarget.print(output);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-9-3-创建分析类"><a href="#6-9-3-创建分析类" class="headerlink" title="6.9.3 创建分析类"></a>6.9.3 创建分析类</h4><p>需求：分析球队赢得比赛的次数。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Analyzers/WinsAnalysis.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; MatchData &#125; <span class="keyword">from</span> <span class="string">&quot;../MatchData&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; MatchResult &#125; <span class="keyword">from</span> <span class="string">&quot;../matchResult&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Analyzer &#125; <span class="keyword">from</span> <span class="string">&quot;../Summary&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">WinsAnalysis</span> <span class="title">implements</span> <span class="title">Analyzer</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收球队名称</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> team: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  run(matches: MatchData[]): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="comment">// 记录赢得比赛的次数</span></span><br><span class="line">    <span class="keyword">let</span> wins = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 开始分析</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> match <span class="keyword">of</span> matches) &#123;</span><br><span class="line">      <span class="comment">// 记录球队为主场赢得比赛的情况</span></span><br><span class="line">      <span class="keyword">if</span> (match[<span class="number">1</span>] === <span class="built_in">this</span>.team &amp;&amp; match[<span class="number">5</span>] === MatchResult.homeWin) &#123;</span><br><span class="line">        wins++;</span><br><span class="line">        <span class="comment">// 记录球队为客场赢得比赛的情况</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (match[<span class="number">2</span>] === <span class="built_in">this</span>.team &amp;&amp; match[<span class="number">5</span>] === MatchResult.awayWin) &#123;</span><br><span class="line">        wins++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.team&#125;</span> 球队赢得了 <span class="subst">$&#123;wins&#125;</span> 场球赛`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-9-4-创建输出类"><a href="#6-9-4-创建输出类" class="headerlink" title="6.9.4 创建输出类"></a>6.9.4 创建输出类</h4><p>需求：在控制台中打印分析结果。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/ReportTargets/ConsoleReport.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; OutputTarget &#125; <span class="keyword">from</span> <span class="string">&quot;../Summary&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsoleReport</span> <span class="title">implements</span> <span class="title">OutputTarget</span> </span>&#123;</span><br><span class="line">  print(report: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(report);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>需求：在 HTMl 文件中输出分析结果。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; OutputTarget &#125; <span class="keyword">from</span> <span class="string">&quot;../Summary&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HtmlReport</span> <span class="title">implements</span> <span class="title">OutputTarget</span> </span>&#123;</span><br><span class="line">  print(report: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> html = <span class="string">`&lt;h1&gt;分析结果&lt;/h1&gt;&lt;div&gt;<span class="subst">$&#123;report&#125;</span>&lt;/div&gt;`</span>;</span><br><span class="line">    fs.writeFileSync(<span class="string">&quot;report.html&quot;</span>, html);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-9-5-简化调用逻辑"><a href="#6-9-5-简化调用逻辑" class="headerlink" title="6.9.5 简化调用逻辑"></a>6.9.5 简化调用逻辑</h4><p>在创建 Summary 类实例时需要同时创建分析行为实例和输出行为实例，该逻辑可以被静态方法进行简化。</p>
<p>静态方法主要是用于存放逻辑性的代码，逻辑上属于类但是和类本身没有关系，也就是说在静态方法中，不会涉及到类中的属性和方法的操作。</p>
<p>调用静态方法不需要对类进行实例化，可以通过类名直接进行调用。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/Summary.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Summary</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于分析球队赢得比赛的信息并使用HTML的方式输出结果</span></span><br><span class="line">  <span class="keyword">static</span> winsAnalysisWithHtmlReport(team: <span class="built_in">string</span>): Summary &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Summary(<span class="keyword">new</span> WinsAnalysis(team), <span class="keyword">new</span> HtmlReport());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">const</span> summary = Summary.winsAnalysisWithHtmlReport(<span class="string">&quot;Man United&quot;</span>);</span><br><span class="line">summary.buildAndPrintReport(matchReader.matches);</span><br></pre></td></tr></table></figure>
<p>读取 CSV 文件的逻辑也可以使用相同的方式进行简化。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/MatchReader.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MatchReader</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> fromCSVFile(filename: <span class="built_in">string</span>): MatchReader &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MatchReader(<span class="keyword">new</span> CsvFileReader(filename));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> matchReader = MatchReader.fromCSVFile(<span class="string">&quot;football.csv&quot;</span>);</span><br><span class="line">matchReader.load();</span><br></pre></td></tr></table></figure>
<h2 id="8-数据驱动视图案例"><a href="#8-数据驱动视图案例" class="headerlink" title="8. 数据驱动视图案例"></a>8. 数据驱动视图案例</h2><h3 id="8-1-概述"><a href="#8-1-概述" class="headerlink" title="8.1 概述"></a>8.1 概述</h3><h4 id="8-1-1-目标"><a href="#8-1-1-目标" class="headerlink" title="8.1.1 目标"></a>8.1.1 目标</h4><p>目标：使用 TypeScript 创建一个小型框架，在框架内部实现数据驱动视图更新的功能。</p>
<p><img src="/img/ts/images/08.png" /></p>
<h4 id="8-1-2-创建应用"><a href="#8-1-2-创建应用" class="headerlink" title="8.1.2 创建应用"></a>8.1.2 创建应用</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 全局安装 parcel 构建工具</span></span><br><span class="line">npm install parcel@2.4.1 -g</span><br><span class="line"><span class="comment"># 创建应用目录并进入</span></span><br><span class="line">mkdir web &amp;&amp; <span class="built_in">cd</span> web</span><br><span class="line"><span class="comment"># 创建应用工程文件</span></span><br><span class="line">npm init -y</span><br><span class="line"><span class="comment"># 创建源码目录并进入</span></span><br><span class="line">mkdir src &amp;&amp; <span class="built_in">cd</span> src</span><br><span class="line"><span class="comment"># 创建应用逻辑入口文件</span></span><br><span class="line">touch index.ts</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 应用逻辑入口文件测试代码</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;Hello&quot;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 回到应用根目录创建应用视图入口文件</span></span><br><span class="line"><span class="built_in">cd</span> ../ &amp;&amp; touch index.html</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在应用视图入口文件中引入应用逻辑入口文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./src/index.ts&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动开发服务器</span></span><br><span class="line">parcel index.html</span><br></pre></td></tr></table></figure>
<h3 id="8-2-功能完善"><a href="#8-2-功能完善" class="headerlink" title="8.2 功能完善"></a>8.2 功能完善</h3><h4 id="8-2-1-创建模型类-User"><a href="#8-2-1-创建模型类-User" class="headerlink" title="8.2.1 创建模型类 User"></a>8.2.1 创建模型类 User</h4><p>目标：创建 User 模型类，通过私有属性 data 存储用户信息，创建 get 方法用于获取用户信息，创建 UserProps 接口用于定义用户信息规范。</p>
<p>说明：用户信息被设计为私有的原因是我们不希望开发者直接操作用户信息，因为用户信息被修改时程序需要监控到，以实现视图更新逻辑。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">interface</span> UserProps &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">private</span> data: UserProps</span>)</span> &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  get(propName: <span class="built_in">string</span>): <span class="built_in">string</span> | <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data[propName];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;./models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性&quot;data&quot;为私有属性, 只能在类&quot;User&quot;中访问。ts(2341)</span></span><br><span class="line"><span class="comment">// console.log(user.data);</span></span><br><span class="line"><span class="built_in">console</span>.log(user.get(<span class="string">&quot;name&quot;</span>));</span><br><span class="line"><span class="built_in">console</span>.log(user.get(<span class="string">&quot;age&quot;</span>));</span><br></pre></td></tr></table></figure>
<h4 id="8-2-2-创建-set-方法更新用户信息"><a href="#8-2-2-创建-set-方法更新用户信息" class="headerlink" title="8.2.2 创建 set 方法更新用户信息"></a>8.2.2 创建 set 方法更新用户信息</h4><p>目标：在 User 类中创建 set 方法，用于更新用户信息。</p>
<p>目前在用户信息中只有 name 属性和 age 属性，所以按照逻辑要求，在更改用户信息时只能更改这两个属性，但是在 JavaScript 中, 通过[对象.属性]的方式可以随意添加属性或修改属性值，如何确保在调用 set 方法时只更改符合要求的用户信息呢? 如何确保用户修改的值符合类型上的要求呢?</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 通过 UserProps 接口规范可以要求开发者在修改信息时, 只能修改规范中定义的属性, 而且值也必须要符合要求的类型</span></span><br><span class="line">  <span class="function"><span class="title">set</span>(<span class="params">update: UserProps</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// Object.assign(this.data, update);</span></span><br><span class="line">    <span class="built_in">this</span>.data = &#123;...this.data, ...update&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;);</span><br><span class="line">user.set(&#123; <span class="attr">name</span>: <span class="string">&quot;李四&quot;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>虽然在以上代码中实现了用户信息的修改，但是在更改用户信息时必须同时修改用户的所有信息，因为 update 参数的类型是 UserProps，如果只更改其中的某一个属性，将不满足 UserProps 接口规范。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 类型&quot;&#123; name: string; &#125;&quot;的参数不能赋给类型&quot;UserProps&quot;的参数。</span></span><br><span class="line"><span class="comment">// 类型&quot;&#123; name: string; &#125;&quot;中缺少属性&quot;age&quot;, 但类型&quot;UserProps&quot;中需要该属性. ts(2345)</span></span><br><span class="line">user.set(&#123; <span class="attr">name</span>: <span class="string">&quot;李四&quot;</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>可以将 UserProps 接口中的属性更改为可选的，即对象中可以有该属性也可以没有该属性，这样在修改用户信息时就可以实现只修改某些属性了。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> UserProps &#123;</span><br><span class="line">  name?: <span class="built_in">string</span>;</span><br><span class="line">  age?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>而且这样做还有另一个好处，就是在创建用户时可以创建一个没有任何属性的空对象，这是非常有用的。例如在注册用户时，我们要向用户提供表单，让用户填写姓名和年龄。在这个场景下，就可以先创建一个空的用户，然后在用户提交表单时再设置用户信息。</p>
<h4 id="8-2-3-小型事件系统"><a href="#8-2-3-小型事件系统" class="headerlink" title="8.2.3 小型事件系统"></a>8.2.3 小型事件系统</h4><p>目标：创建小型事件系统，包含事件监听器和事件触发器，当用户信息被修改时可以通过事件侦听器通知到应用程序的其他部分。</p>
<p>第一步：创建事件监听器，用于绑定事件。</p>
<p>说明：事件监听器可以有不同的类型，每个类型下可以有多个事件处理程序。</p>
<p><img src="/img/ts/images/09.png"/></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="comment">// 定义类型, 回调函数的类型</span></span><br><span class="line"><span class="keyword">type</span> Callback = <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于保存事件名称和对应的事件处理程序</span></span><br><span class="line">  <span class="attr">events</span>: &#123; [key: <span class="built_in">string</span>]: Callback[] &#125; = &#123;&#125;;</span><br><span class="line">	<span class="comment">// 事件侦听器, 用于绑定事件</span></span><br><span class="line">  on(eventName: <span class="built_in">string</span>, <span class="attr">callback</span>: Callback): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 通过事件名称获取已有事件监听程序</span></span><br><span class="line">    <span class="comment">// 如果不是第一次绑定事件, 得到的是 Callback 数组, 直接使用</span></span><br><span class="line">    <span class="comment">// 如果是第一次绑定, 得到的是 undefined, 利用逻辑短路思想, 放弃 undefined, 返回空数组</span></span><br><span class="line">    <span class="keyword">const</span> handlers = <span class="built_in">this</span>.events[eventName] || [];</span><br><span class="line">    <span class="comment">// 将此次要绑定的事件处理程序添加到数组中</span></span><br><span class="line">    handlers.push(callback);</span><br><span class="line">    <span class="comment">// 将拥有新结果的数组重新赋值给对应的时间</span></span><br><span class="line">    <span class="built_in">this</span>.events[eventName] = handlers;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line">user.on(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">user.on(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">user.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(user);</span><br></pre></td></tr></table></figure>
<p>第二步：创建事件触发器，用于触发事件。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 事件触发器, 用于触发事件</span></span><br><span class="line">  trigger(eventName: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 获取事件名称对应的事件处理程序</span></span><br><span class="line">    <span class="keyword">const</span> handlers = <span class="built_in">this</span>.events[eventName];</span><br><span class="line">    <span class="comment">// 1) 触发了一个没有绑定的事件</span></span><br><span class="line">    <span class="comment">// 2) 触发的事件曾经绑定过, 但目前已经解绑了</span></span><br><span class="line">    <span class="comment">// 判断是否是以上两种情况, 如果是阻止程序向下运行, 防止报错</span></span><br><span class="line">    <span class="keyword">if</span> (!handlers || handlers.length === <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// 依次调用该事件对应的事件处理程序</span></span><br><span class="line">    handlers.forEach(<span class="function">(<span class="params">callback</span>) =&gt;</span> callback());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line">user.on(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;click #1&quot;</span>));</span><br><span class="line">user.on(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;click #2&quot;</span>));</span><br><span class="line">user.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;change #1&quot;</span>));</span><br><span class="line"></span><br><span class="line">user.trigger(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">user.trigger(<span class="string">&quot;change&quot;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="8-2-4-状态同步"><a href="#8-2-4-状态同步" class="headerlink" title="8.2.4 状态同步"></a>8.2.4 状态同步</h4><p>目标：在模型类中创建 save 方法与 fetch 方法，用于与服务端进行数据交互。</p>
<p>第一步：使用 JSON Server 作为服务端，与客户端进行数据交互。</p>
<p><img src="/img/ts/images/10.png" /></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install json-server -g</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;users&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;age&quot;</span>: <span class="number">20</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install axios</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;start:db&quot;</span>: <span class="string">&quot;json-server -w db.json&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;start:parcel&quot;</span>: <span class="string">&quot;parcel index.html&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run start:db</span><br><span class="line">npm run start:parcel</span><br></pre></td></tr></table></figure>
<p>第二步：创建 fetch 方法用于向服务端发送请求获取数据</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">import</span> axios, &#123; AxiosResponse &#125; <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> UserProps &#123;</span><br><span class="line">  id?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">fetch</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> axios</span><br><span class="line">      .get(<span class="string">`http://localhost:3000/users/<span class="subst">$&#123;<span class="built_in">this</span>.get(<span class="string">&quot;id&quot;</span>)&#125;</span>`</span>)</span><br><span class="line">      .then(<span class="function">(<span class="params">response: AxiosResponse</span>) =&gt;</span> <span class="built_in">this</span>.set(response.data));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第三步：创建 save 方法，用于创建用户和修改用户。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">save</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> id = <span class="built_in">this</span>.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (id) &#123;</span><br><span class="line">      <span class="comment">// 修改</span></span><br><span class="line">      <span class="keyword">return</span> axios.patch(<span class="string">`http://localhost:3000/users/<span class="subst">$&#123;id&#125;</span>`</span>, <span class="built_in">this</span>.data);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 添加</span></span><br><span class="line">      <span class="keyword">return</span> axios.post(<span class="string">&quot;http://localhost:3000/users&quot;</span>, <span class="built_in">this</span>.data);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="comment">// 创建用户</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123; <span class="attr">name</span>: <span class="string">&quot;李四&quot;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;);</span><br><span class="line">user.save();</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 修改用户</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;王五&quot;</span> &#125;);</span><br><span class="line">user.save();</span><br></pre></td></tr></table></figure>
<h3 id="8-3-重构-提取复用代码"><a href="#8-3-重构-提取复用代码" class="headerlink" title="8.3 重构-提取复用代码"></a>8.3 重构-提取复用代码</h3><h4 id="8-3-1-概述"><a href="#8-3-1-概述" class="headerlink" title="8.3.1 概述"></a>8.3.1 概述</h4><p>目前代码中存在的问题是所有功能都写在了 User 类中，包括一些可以在不同模型类中复用的代码。</p>
<p>比如获取设置数据的方法、事件系统、与服务器端同步状态的代码在其他的模型类中也会使用。</p>
<p>而我们要做的事情就是将这些可以复用的代码抽取到不同的类中，然后再通过组合的方式将它们进行重组。</p>
<h4 id="8-3-2-提取事件系统"><a href="#8-3-2-提取事件系统" class="headerlink" title="8.3.2 提取事件系统"></a>8.3.2 提取事件系统</h4><p>目标：将事件系统相关的代码从 User 类中拆分出去。</p>
<p>第一步：创建 Eventing 类，用于放置所有和事件相关的代码。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Eventing.ts</span></span><br><span class="line"><span class="keyword">type</span> Callback = <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Eventing</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于保存事件名称和对应的事件处理程序</span></span><br><span class="line">  <span class="attr">events</span>: &#123; [key: <span class="built_in">string</span>]: Callback[] &#125; = &#123;&#125;;</span><br><span class="line">  <span class="comment">// 事件侦听器, 用于绑定事件</span></span><br><span class="line">  on(eventName: <span class="built_in">string</span>, <span class="attr">callback</span>: Callback): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 通过事件名称获取已有事件监听程序</span></span><br><span class="line">    <span class="comment">// 如果不是第一次绑定事件, 得到的是 Callback 数组, 直接使用</span></span><br><span class="line">    <span class="comment">// 如果是第一次绑定, 得到的是 undefined, 利用逻辑短路思想, 放弃 undefined, 返回空数组</span></span><br><span class="line">    <span class="keyword">const</span> handlers = <span class="built_in">this</span>.events[eventName] || [];</span><br><span class="line">    <span class="comment">// 将此次要绑定的事件处理程序添加到数组中</span></span><br><span class="line">    handlers.push(callback);</span><br><span class="line">    <span class="comment">// 将拥有新结果的数组重新赋值给对应的时间</span></span><br><span class="line">    <span class="built_in">this</span>.events[eventName] = handlers;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 事件触发器, 用于触发事件</span></span><br><span class="line">  trigger(eventName: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 获取事件名称对应的事件处理程序</span></span><br><span class="line">    <span class="keyword">const</span> handlers = <span class="built_in">this</span>.events[eventName];</span><br><span class="line">    <span class="comment">// 1) 触发了一个没有绑定的事件</span></span><br><span class="line">    <span class="comment">// 2) 触发的事件曾经绑定过, 但目前已经解绑了</span></span><br><span class="line">    <span class="comment">// 判断是否是以上两种情况, 如果是阻止程序向下运行, 防止报错</span></span><br><span class="line">    <span class="keyword">if</span> (!handlers || handlers.length === <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// 依次调用该事件对应的事件处理程序</span></span><br><span class="line">    handlers.forEach(<span class="function">(<span class="params">callback</span>) =&gt;</span> callback());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二步：为 User 模型类添加事件系统。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Eventing &#125; <span class="keyword">from</span> <span class="string">&quot;./Eventing&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 为当前模型类中添加事件系统</span></span><br><span class="line">  <span class="keyword">public</span> events: Eventing = <span class="keyword">new</span> Eventing();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-3-3-提取状态同步"><a href="#8-3-3-提取状态同步" class="headerlink" title="8.3.3 提取状态同步"></a>8.3.3 提取状态同步</h4><p>第一步：创建 Sync 类，用于放置和状态同步相关的代码。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Sync.ts</span></span><br><span class="line"><span class="keyword">import</span> axios, &#123; AxiosPromise &#125; <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;./User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Sync</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> rootUrl: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  fetch(id: <span class="built_in">number</span>): AxiosPromise &#123;</span><br><span class="line">    <span class="keyword">return</span> axios.get(<span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.rootUrl&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  save(data: UserProps): AxiosPromise &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = data;</span><br><span class="line">    <span class="keyword">if</span> (id) &#123;</span><br><span class="line">      <span class="comment">// 修改</span></span><br><span class="line">      <span class="keyword">return</span> axios.patch(<span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.rootUrl&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>, data);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 添加</span></span><br><span class="line">      <span class="keyword">return</span> axios.post(<span class="built_in">this</span>.rootUrl, data);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二步：通过泛型将要同步的数据的类型传递到 Sync 类中，使用泛型约束 save 方法的参数，使 Sync 类可重用。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Sync.ts</span></span><br><span class="line"><span class="keyword">interface</span> HasId &#123;</span><br><span class="line">  id?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Sync</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">HasId</span>&gt; </span>&#123;</span><br><span class="line">  save(data: T): AxiosPromise &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = data;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：在以上代码中，泛型 T 对应的实际类型中要有一个可选属性 id，在 save 方法中从 data 中解构 id 时，由于 id 可能有也可能没有，所以它的类型应该是 number | undefined，但实际上 TypeScript 编译器推断出的 id 的类型就是 number，这是为什么呢？</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const id: number</span></span><br><span class="line"><span class="keyword">const</span> &#123; id &#125; = data;</span><br></pre></td></tr></table></figure>
<p>这是因为在应用中目前没有开启 TypeScript 类型的严格检查模式，通过 tsconfig.json 中的 strict: true 可开启。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;strict&quot;</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const id: number | undefined</span></span><br><span class="line"><span class="keyword">const</span> &#123; id &#125; = data;</span><br></pre></td></tr></table></figure>
<p>所以通过 if 判断 id 是否为真是不严谨的，如果 id 为 0 的话，代码便会走到 else，就走向了错误的逻辑。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (id) &#123;&#125; <span class="keyword">else</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>严谨的判断应该是检测 id 是否不为 undefined 类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> id != <span class="string">&quot;undefined&quot;</span>) &#123;&#125; <span class="keyword">else</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>第三步：为 User 类添加同步状态功能。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Sync &#125; <span class="keyword">from</span> <span class="string">&quot;./Sync&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基准请求地址</span></span><br><span class="line"><span class="keyword">const</span> rootUrl = <span class="string">&quot;http://localhost:3000/users&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 为当前模型类中添加同步状态功能</span></span><br><span class="line">  <span class="keyword">public</span> sync: Sync&lt;UserProps&gt; = <span class="keyword">new</span> Sync&lt;UserProps&gt;(rootUrl);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-3-4-提取对象属性"><a href="#8-3-4-提取对象属性" class="headerlink" title="8.3.4 提取对象属性"></a>8.3.4 提取对象属性</h4><p>目标：提取 User 类中的 data 属性、get、set 方法，使用这部分代码在任何其他模型类中可以被复用。</p>
<p>第一步：创建 Attributes 类，用于存储 data 属性、get、set 方法。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Attributes.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Attributes</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">private</span> data: T</span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  get(propName: <span class="built_in">string</span>): <span class="built_in">string</span> | <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data[propName];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">set</span>(<span class="params">update: T</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">Object</span>.assign(<span class="built_in">this</span>.data, update);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二步：优化 get 方法参数的类型。</p>
<p>在以上代码中存在的问题是 get 方法的参数的取值范围并没有被限制，就是说在调用 get 方法时可以传递任何参数，但实际上应该是 data 对象中存在什么属性 get 方法中才允许被传递什么参数。比如在 user 对象中，它只有三个属性，id、name、age，那么当 user 对象调用 get 方法时它就应该只允许传递这三个参数。</p>
<p>要解决以上问题，我们需要先学习两个前置知识点。</p>
<p>① 在 TypeScript 中，字面量也可以作为类型使用。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义类型 BestName</span></span><br><span class="line"><span class="keyword">type</span> BestName = <span class="string">&quot;张三&quot;</span> | <span class="string">&quot;李四&quot;</span>;</span><br><span class="line"><span class="comment">// 参数 name 的类型为字面量的类型, 参数 name 的取值范围为字面量的值</span></span><br><span class="line"><span class="comment">// 即参数 name 的类型为字符串, 参数 name 的取值范围为张三和李四</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params">name: BestName</span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">printName(<span class="string">&quot;李四&quot;</span>);</span><br><span class="line">printName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line"><span class="comment">// 类型&quot;王五&quot;的参数不能赋给类型&quot;BestName&quot;的参数</span></span><br><span class="line">printName(<span class="string">&quot;王五&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>② 在 JavaScript 中，所有对象的键都是字符串类型，TypeScript 中也是一样。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> colors = &#123;&#125;;</span><br><span class="line">colors[<span class="number">0</span>] = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">colors[<span class="number">0</span>] <span class="comment">// &quot;red&quot;</span></span><br><span class="line"><span class="comment">// 在这段代码中，虽然看起来我们使用了数值作为了对象的键, 但仅仅是看起来是这样</span></span><br><span class="line"><span class="comment">// 当我们使用数值键取值时, 内部会将数值转换为字符串再进行取值</span></span><br><span class="line"><span class="comment">// 所以以下代码也是可以取到值的</span></span><br><span class="line">colors[<span class="string">&quot;0&quot;</span>] <span class="comment">// &quot;red&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> color = &#123;&#125;;</span><br><span class="line">color[<span class="number">0</span>] = <span class="string">&quot;a&quot;</span>;</span><br><span class="line">color[&#123;&#125;] = <span class="string">&quot;b&quot;</span>;</span><br><span class="line"><span class="comment">// Colors &#123; &#x27;0&#x27;: &#x27;a&#x27;, &#x27;[object Object]&#x27;: &#x27;b&#x27; &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(color);</span><br></pre></td></tr></table></figure>
<p><strong>在 TypeScript 中字符串字面量可以作为类型使用，对象的键又都是字符串类型，由此我们能够想到对象的键也可以作为类型使用。</strong></p>
<p>对于 user 对象来说，它的 get 方法的取值范围为 id、name、age，也就是说我们可以通过以下方式限制 user 对象的 get 方法的参数类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">get</span>(<span class="params">key: <span class="string">&quot;id&quot;</span> | <span class="string">&quot;name&quot;</span> | <span class="string">&quot;age&quot;</span></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.data[key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/img/ts/images/11.png" /></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="comment">// src/models/Attributes.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;./User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userAttributes = <span class="keyword">new</span> Attributes&lt;UserProps&gt;(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;);</span><br><span class="line"><span class="comment">// 类型 &quot;sex&quot; 的参数不能赋给类型 &quot;id&quot; | &quot;name&quot; | &quot;age&quot; 的参数</span></span><br><span class="line">userAttributes.get(<span class="string">&quot;sex&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>虽然以上代码解决了 get 方法的参数类型问题，但是代码如果这样写的话就不能复用了，因为不同的数据拥有的属性是不一样的。</p>
<p>在 TypeScript 中通过 keyof 运算符可以得到类型属性字面量联合类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> UserProps &#123;</span><br><span class="line">  id?: <span class="built_in">number</span>;</span><br><span class="line">  name?: <span class="built_in">string</span>;</span><br><span class="line">  age?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;id&quot; | &quot;name&quot; | &quot;age&quot;</span></span><br><span class="line"><span class="keyword">type</span> UserPropsKeys = keyof UserProps;</span><br></pre></td></tr></table></figure>
<p>所以最终 get 方法参数的类型可以通过以下方式进行限制。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Attributes</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">private</span> data: T</span>)</span> &#123;&#125;</span><br><span class="line">	<span class="comment">// 使用 keyof 运算符获取 T 类型中的属性名称字符串联合类型</span></span><br><span class="line">  <span class="comment">// 通过泛型及泛型约束限制 key 参数的类型及取值范围</span></span><br><span class="line">  <span class="comment">// 泛型 K 的类型被 keyof 运算符得到的类型进行约束</span></span><br><span class="line">  <span class="comment">// 虽然此处 K 为泛型, 但是在调用 get 方法时可以不传递具体类型, TypeScript 编译器可以自己推断</span></span><br><span class="line">  get&lt;K <span class="keyword">extends</span> keyof T&gt;(key: K) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data[key];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/img/ts/images/11.png" /></p>
<p>第三步：优化 get 方法的返回值类型。</p>
<p>通过 get 方法获取到属性值后，属性值是什么类型 get 方法的返回值就应该是什么类型。</p>
<p><img src="/img/ts/images/12.png"/></p>
<p>但是在以上代码中 get 方法的返回值被写死了，被写成了联合类型 string | number，这是不对的。</p>
<p><strong>特别注意: 在演示测试代码时, 先临时删除 get 方法的参数的类型。</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Attributes.ts</span></span><br><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="keyword">import</span> &#123; UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;./User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userAttributes = <span class="keyword">new</span> Attributes&lt;UserProps&gt;(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// const id: string | number</span></span><br><span class="line"><span class="keyword">const</span> id = userAttributes.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line"><span class="comment">// const name: string | number</span></span><br><span class="line"><span class="keyword">const</span> name = userAttributes.get(<span class="string">&quot;name&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>而我们期望返回值类型是唯一的，这样在使用时编辑器就可以提示确切的提示出该类型下面有哪些属性和方法了。</p>
<p>解决方法一就是在使用返回值前先使用类型守卫对其进行验证。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> name === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// const name: string</span></span><br><span class="line">  name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>解决办法二是使用类型断言，告诉 TypeScript 编译器它的确切类型是什么。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// const id: number</span></span><br><span class="line"><span class="keyword">const</span> id = userAttributes.get(<span class="string">&quot;id&quot;</span>) <span class="keyword">as</span> <span class="built_in">number</span>;</span><br></pre></td></tr></table></figure>
<p>解决办法三是根据类型的属性获取属性值的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="comment">// type nameType = string;</span></span><br><span class="line"><span class="keyword">type</span> nameType = UserProps[<span class="string">&quot;name&quot;</span>];</span><br><span class="line"><span class="comment">// type ageType = number</span></span><br><span class="line"><span class="keyword">type</span> ageType = UserProps[<span class="string">&quot;age&quot;</span>];</span><br></pre></td></tr></table></figure>
<p>所以最终 get 方法的返回值类型可以通过以下方式进行设置。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Attributes.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Attributes</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">private</span> data: T</span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  get&lt;K <span class="keyword">extends</span> keyof T&gt;(key: K): T[K] &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data[key];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Attributes.ts</span></span><br><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="keyword">const</span> userAttributes = <span class="keyword">new</span> Attributes&lt;UserProps&gt;(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;);</span><br><span class="line"><span class="comment">// const name: string</span></span><br><span class="line"><span class="keyword">const</span> name = userAttributes.get(<span class="string">&quot;name&quot;</span>);</span><br><span class="line"><span class="comment">// const age: number</span></span><br><span class="line"><span class="keyword">const</span> age = userAttributes.get(<span class="string">&quot;age&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>第四步：在 User 模型类中添加模型数据。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Attributes &#125; <span class="keyword">from</span> <span class="string">&quot;./Attributes&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 为当前模型类添加模型</span></span><br><span class="line">  <span class="keyword">public</span> attributes: Attributes&lt;UserProps&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">user: UserProps</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.attributes = <span class="keyword">new</span> Attributes&lt;UserProps&gt;(user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-3-5-减少调用属性层级"><a href="#8-3-5-减少调用属性层级" class="headerlink" title="8.3.5 减少调用属性层级"></a>8.3.5 减少调用属性层级</h4><p>经过以上优化以后，解决了内部代码复用的问题，但是新的问题也产生了，就是在调用数据模型类内部的方法时代码变得冗长。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;王五&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上一轮优化后</span></span><br><span class="line">user.attributes.get(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">user.sync.fetch(<span class="number">1</span>);</span><br><span class="line">user.events.trigger(<span class="string">&quot;click&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上一轮优化前</span></span><br><span class="line">user.get(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">user.fetch();</span><br><span class="line">user.trigger(<span class="string">&quot;click&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>目标：通过类中的 getter 属性实现调用时属性层级的缩减。</p>
<p>先来看一段我们能够想到的最直接的缩减调用属性层级的办法。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">on</span>(<span class="params">eventName: <span class="built_in">string</span>, callback: Callback</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.events.on(eventName, callback);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">user.on(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>
<p>以上代码中虽然可以缩减调用属性的层级，但是代码过于啰嗦。</p>
<p>可以利用类的 getter 属性优化以上代码。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">on</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.events.on;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">trigger</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.events.trigger;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">get</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.attributes.get;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">user.on(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;clicked&quot;</span>));</span><br></pre></td></tr></table></figure>
<p>但是在以上代码中还隐藏着一个错误，尝试运行以下代码。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">user.get(<span class="string">&quot;name&quot;</span>);</span><br></pre></td></tr></table></figure>
<p><img src="/img/ts/images/13.png" /></p>
<p>产生以上错误的原因在于代码运行时 Attributes 类中 get 方法中的 this 指向出现了问题，它本应该指向 Attributes 类实例，现在指向了 User 类实例。User 类中没有 data 属性，访问 data 属性时返回 undefined，再通过 undefined 访问 name，自然就报错了。</p>
<p>解决以上问题的办法是将 Attributes 类中的 get 方法更改为箭头函数，因为箭头函数不绑定 this，所以外部无论怎样调用都不会更改 this 指向。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Attributes.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Attributes</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  get = <span class="xml"><span class="tag">&lt;<span class="name">K</span> <span class="attr">extends</span> <span class="attr">keyof</span> <span class="attr">T</span>&gt;</span>(key: K): T[K] =&gt; &#123;</span></span><br><span class="line"><span class="xml">    return this.data[key];</span></span><br><span class="line"><span class="xml">  &#125;;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Eventing.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Eventing</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 事件侦听器, 用于绑定事件</span></span><br><span class="line">  on = (eventName: <span class="built_in">string</span>, <span class="attr">callback</span>: Callback): <span class="function"><span class="params">void</span> =&gt;</span> &#123; &#125;;</span><br><span class="line">  <span class="comment">// 事件触发器, 用于触发事件</span></span><br><span class="line">  trigger = (eventName: <span class="built_in">string</span>): <span class="function"><span class="params">void</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;王五&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(user.get(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">user.on(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;clicked&quot;</span>));</span><br><span class="line">user.trigger(<span class="string">&quot;click&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="8-4-功能完善"><a href="#8-4-功能完善" class="headerlink" title="8.4 功能完善"></a>8.4 功能完善</h3><h4 id="8-4-1-添加-set-方法-User"><a href="#8-4-1-添加-set-方法-User" class="headerlink" title="8.4.1 添加 set 方法 (User)"></a>8.4.1 添加 set 方法 (User)</h4><p>目标：在 User 模型类中添加 set 方法，目的一的减少属性调用层级，目的二是在更改数据时要自动触发 change 事件。</p>
<p>自动触发 change 事件的原因是将来当数据发生更改时应用程序的其他部分要随之更新。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">set</span>(<span class="params">update: UserProps</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.attributes.set(update);</span><br><span class="line">    <span class="built_in">this</span>.events.trigger(<span class="string">&quot;change&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;王五&quot;</span> &#125;);</span><br><span class="line">user.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;changed&quot;</span>));</span><br><span class="line">user.set(&#123; <span class="attr">name</span>: <span class="string">&quot;李四&quot;</span> &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="8-4-2-添加-fetch-方法-User"><a href="#8-4-2-添加-fetch-方法-User" class="headerlink" title="8.4.2  添加 fetch 方法 (User)"></a>8.4.2  添加 fetch 方法 (User)</h4><p>目标：在 User 类中添加 fetch 方法用于与服务端通讯，根据 id 获取数据、数据获取完成后更新本地数据。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  fetch(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 获取数据id</span></span><br><span class="line">    <span class="keyword">const</span> id = <span class="built_in">this</span>.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    <span class="comment">// 如果没有id或者类型错误</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> id !== <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// 报错: 输出错误信息</span></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;没有id不能获取数据&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据id发送请求获取数据</span></span><br><span class="line">    <span class="built_in">this</span>.sync.fetch(id).then((response: AxiosResponse): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 更新本地数据</span></span><br><span class="line">      <span class="built_in">this</span>.set(response.data);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建用户实例</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123; <span class="attr">id</span>: <span class="number">1</span> &#125;);</span><br><span class="line"><span class="comment">// 监听用户数据发生变化</span></span><br><span class="line">user.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(user));</span><br><span class="line"><span class="comment">// 根据 id 获取用户数据</span></span><br><span class="line">user.fetch();</span><br></pre></td></tr></table></figure>
<h4 id="8-4-3-添加-save-方法-User"><a href="#8-4-3-添加-save-方法-User" class="headerlink" title="8.4.3 添加 save 方法 (User)"></a>8.4.3 添加 save 方法 (User)</h4><p>目标：在 User 类中添加 save 方法，用于与服务端通讯，添加用户、修改用户，成功后触发 save 事件，失败后触发 error 事件。</p>
<p>由于在执行创建和修改操作时，需要将模型实例整体传入到 Sync 类的 save 方法中，所以在 Model 中添要加一个用于获取实例的方法。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Attributes.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Attributes</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  getAll(): T &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 User 中添加 save 方法供实例使用。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  save(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.sync</span><br><span class="line">      .save(<span class="built_in">this</span>.attributes.getAll())</span><br><span class="line">      .then(<span class="function">() =&gt;</span> <span class="built_in">this</span>.trigger(<span class="string">&quot;save&quot;</span>))</span><br><span class="line">      .catch(<span class="function">() =&gt;</span> <span class="built_in">this</span>.trigger(<span class="string">&quot;error&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;赵六&quot;</span> &#125;);</span><br><span class="line">user.on(<span class="string">&quot;save&quot;</span>, <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(user));</span><br><span class="line">user.save();</span><br></pre></td></tr></table></figure>
<h3 id="8-5-重构-提取复用代码"><a href="#8-5-重构-提取复用代码" class="headerlink" title="8.5 重构-提取复用代码"></a>8.5 重构-提取复用代码</h3><h4 id="8-5-1-提取模型类公用逻辑"><a href="#8-5-1-提取模型类公用逻辑" class="headerlink" title="8.5.1 提取模型类公用逻辑"></a>8.5.1 提取模型类公用逻辑</h4><p>目前在表示用户的 User 模型类中，所有的属性和方法都可以被看做是数据模型类之间的可以复用的代码，比如表示文章的 Post 模型类，表示订单的 Order 模型类，都会有 get、set、fetch、save、on、trigger 等方法，而我们肯定不想在每个数据模型类中都将这些方法实现一遍。</p>
<p>所以接下来我们要做的事情就是创建一个 Model 类，用于存放数据模型类中可以复用的属性和方法，其他数据模型类通过继承的方式获取他们。</p>
<p><img src="/img/ts/images/46.png" /></p>
<p>第一步：创建 Model 类，让 User 数据模型类继承 Model 类，从而获取数据模型类中的可以复用的属性和方法。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Model.ts</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>第二步：将 User 类中的通用模型类方法拷贝到 Model 模型类中。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AxiosPromise, AxiosResponse &#125; <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> HasId &#123;</span><br><span class="line">  id?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">HasId</span>&gt; </span>&#123;  </span><br><span class="line">  <span class="keyword">public</span> events: Eventing = <span class="keyword">new</span> Eventing();</span><br><span class="line">  <span class="keyword">public</span> attributes: Attributes&lt;T&gt;;</span><br><span class="line">  <span class="keyword">public</span> sync: Sync&lt;T&gt; = <span class="keyword">new</span> Sync&lt;T&gt;(rootUrl);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">get</span> <span class="title">on</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.events.on;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">trigger</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.events.trigger;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">get</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.attributes.get;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">set</span>(<span class="params">update: T</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.attributes.set(update);</span><br><span class="line">    <span class="built_in">this</span>.events.trigger(<span class="string">&quot;change&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  fetch(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 获取数据id</span></span><br><span class="line">    <span class="keyword">const</span> id = <span class="built_in">this</span>.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    <span class="comment">// 如果没有id或者类型错误</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> id !== <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// 报错: 输出错误信息</span></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;没有id不能获取数据&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据id发送请求获取数据</span></span><br><span class="line">    <span class="built_in">this</span>.sync.fetch(id).then((response: AxiosResponse): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 更新本地数据</span></span><br><span class="line">      <span class="built_in">this</span>.set(response.data);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  save(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.sync</span><br><span class="line">      .save(<span class="built_in">this</span>.attributes.getAll())</span><br><span class="line">      .then(<span class="function">() =&gt;</span> <span class="built_in">this</span>.trigger(<span class="string">&quot;save&quot;</span>))</span><br><span class="line">      .catch(<span class="function">() =&gt;</span> <span class="built_in">this</span>.trigger(<span class="string">&quot;error&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第三步：通过参数的方式接收类实例，而不是直接在 Model 类中创建实例。</p>
<p>在以上代码中仍然存在的问题是在 Model 类中直接实例化了 Eventing、Attributes、Sync 等类，这样做并不好，以 Sync 举例，目前代码中 Sync 类用于与服务端交互，获取和保存模型数据，但如果将来数据源发生变化，比如变成了和本地存储进行交互，那么此处的代码就不太合适了，所以在 Model 类中，应该通过参数的方式接收这几个类的实例，至于接收的是 ApiSync 还是 LocalSync 就交给数据模型类，它根据需求决定。</p>
<p>既然现在要通过参数的方式接收类的实例，那么参数就需要被接口进行约束，约束在类中必须实现的属性和方法，这样才能确保拷贝到 Model 类中的其他属性和方法是可用的。所以接下来我们要先创建接口，约束 attributes、sync、events  参数的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> ModelAttributes&lt;T&gt; &#123;</span><br><span class="line">  get&lt;K <span class="keyword">extends</span> keyof T&gt;(key: K): T[K];</span><br><span class="line">  set(value: T): <span class="built_in">void</span>;</span><br><span class="line">  getAll(): T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Sync&lt;T&gt; &#123;</span><br><span class="line">  fetch(id: <span class="built_in">number</span>): AxiosPromise;</span><br><span class="line">  save(data: T): AxiosPromise;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Events &#123;</span><br><span class="line">  on(eventName: <span class="built_in">string</span>, <span class="attr">callback</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>): <span class="built_in">void</span>;</span><br><span class="line">  trigger(eventName: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">HasId</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 为什么 attributes、sync、events 属性是私有的呢?</span></span><br><span class="line">  <span class="comment">// 我们不想让开发者在类的外部直接操作这些属性，</span></span><br><span class="line">  <span class="comment">// 开发者没有必要在类的外部直接调用并操作这些属性, 他只可以调用类中的公共方法</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">private</span> attributes: ModelAttributes&lt;T&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">private</span> sync: Sync&lt;T&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">private</span> events: Events</span></span></span><br><span class="line"><span class="params"><span class="function">  </span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第四步：在 User 类中创建静态方法 buildUser，用于创建 User 类的实例。</p>
<p>由于 User 类继承了 Model 类，在实例化 User 类时需要传递 Model 类需要的参数，Model 类需要传递 attributes、sync、events 属性。</p>
<p>在创建 User 类的实例时，我只想关心 User 类中可以设置哪些属性，也就是 attributes 参数。如果每次创建用户还需要传递其他参数比如 sync、events，这对于创建用户来说就太麻烦了，所以接下来我们要做的事情就是在 User 类中创建 BuildUser 方法，通过该方法对创建用户的逻辑进行进一步的封装。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Attributes &#125; <span class="keyword">from</span> <span class="string">&quot;./Attributes&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Eventing &#125; <span class="keyword">from</span> <span class="string">&quot;./Eventing&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Model &#125; <span class="keyword">from</span> <span class="string">&quot;./Model&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ApiSync &#125; <span class="keyword">from</span> <span class="string">&quot;./ApiSync&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> UserProps &#123;</span><br><span class="line">  id?: <span class="built_in">number</span>;</span><br><span class="line">  name?: <span class="built_in">string</span>;</span><br><span class="line">  age?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootUrl = <span class="string">&quot;http://localhost:3000/users&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">UserProps</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> buildUser(attrs: UserProps): User &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> User(</span><br><span class="line">      <span class="keyword">new</span> Attributes&lt;UserProps&gt;(attrs),</span><br><span class="line">      <span class="keyword">new</span> ApiSync&lt;UserProps&gt;(rootUrl),</span><br><span class="line">      <span class="keyword">new</span> Eventing()</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;./models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = User.buildUser(&#123; <span class="attr">id</span>: <span class="number">1</span> &#125;);</span><br><span class="line"></span><br><span class="line">user.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(user);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">user.fetch();</span><br></pre></td></tr></table></figure>
<h4 id="8-5-2-进一步减少调用属性层级"><a href="#8-5-2-进一步减少调用属性层级" class="headerlink" title="8.5.2 进一步减少调用属性层级"></a>8.5.2 进一步减少调用属性层级</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Model.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">HasId</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">private</span> attributes: ModelAttributes&lt;T&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">private</span> sync: Sync&lt;T&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">private</span> events: Events</span></span></span><br><span class="line"><span class="params"><span class="function">  </span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  on = <span class="built_in">this</span>.events.on;</span><br><span class="line">  trigger = <span class="built_in">this</span>.events.trigger;</span><br><span class="line">  get = <span class="built_in">this</span>.attributes.get;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Model</span>(<span class="params">attributes</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.attributes = attributes;</span><br><span class="line">  <span class="built_in">this</span>.get = <span class="built_in">this</span>.attributes.get;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>特别注意：以下属于错误写法。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span> </span>&#123;</span><br><span class="line">  attributes;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">attributes</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.attributes = attributes;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// error: 属性&quot;attributes&quot;在其初始化前已被使用。</span></span><br><span class="line">  get = <span class="built_in">this</span>.attributes.get;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Model</span>(<span class="params">attributes</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.get = <span class="built_in">this</span>.attributes.get;</span><br><span class="line">  <span class="built_in">this</span>.attributes = attributes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-6-完善功能"><a href="#8-6-完善功能" class="headerlink" title="8.6 完善功能"></a>8.6 完善功能</h3><h4 id="8-6-1-创建用户集合"><a href="#8-6-1-创建用户集合" class="headerlink" title="8.6.1   创建用户集合"></a>8.6.1   创建用户集合</h4><p>目标：创建用户集合类，用于保存用户列表数据。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Collection.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User, UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;./User&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Eventing &#125; <span class="keyword">from</span> <span class="string">&quot;./Eventing&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios, &#123; AxiosResponse &#125; <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Collection</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储集合的属性</span></span><br><span class="line">  <span class="attr">models</span>: User[] = [];</span><br><span class="line">  <span class="comment">// 组装事件系统</span></span><br><span class="line">  events: Eventing = <span class="keyword">new</span> Eventing();</span><br><span class="line">  <span class="comment">// 缩短方法调用</span></span><br><span class="line">  on = <span class="built_in">this</span>.events.on;</span><br><span class="line">  trigger = <span class="built_in">this</span>.events.trigger;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 接收请求地址</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> rootUrl: <span class="built_in">string</span></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用于发送请求获取集合数据</span></span><br><span class="line">  <span class="function"><span class="title">fetch</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    axios.get(<span class="built_in">this</span>.rootUrl).then(<span class="function">(<span class="params">response: AxiosResponse&lt;UserProps[]&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 遍历集合</span></span><br><span class="line">      response.data.forEach(<span class="function">(<span class="params">value: UserProps</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 将网络数据转换成 User 类实例</span></span><br><span class="line">        <span class="keyword">const</span> user = User.buildUser(value);</span><br><span class="line">        <span class="comment">// 使用 models 数组存储 User 类实例</span></span><br><span class="line">        <span class="built_in">this</span>.models.push(user);</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 数据获取完成后触发 change 事件</span></span><br><span class="line">      <span class="built_in">this</span>.trigger(<span class="string">&quot;change&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Collection &#125; <span class="keyword">from</span> <span class="string">&quot;./models/Collection&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userCollection = <span class="keyword">new</span> Collection(<span class="string">&quot;http://localhost:3000/users&quot;</span>);</span><br><span class="line"></span><br><span class="line">userCollection.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(userCollection.models);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">userCollection.fetch();</span><br></pre></td></tr></table></figure>
<h3 id="8-7-重构-提取复用代码"><a href="#8-7-重构-提取复用代码" class="headerlink" title="8.7  重构-提取复用代码"></a>8.7  重构-提取复用代码</h3><h4 id="8-7-1-创建通用集合类"><a href="#8-7-1-创建通用集合类" class="headerlink" title="8.7.1-创建通用集合类"></a>8.7.1-创建通用集合类</h4><p>在刚刚创建的用户集合类中，它的问题就在于只能获取用户集合数据，接下来我们要将它改造成能够获取任何集合数据的通用集合类。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/Collection.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User, UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;./User&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Eventing &#125; <span class="keyword">from</span> <span class="string">&quot;./Eventing&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios, &#123; AxiosResponse &#125; <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Collection</span>&lt;<span class="title">T</span>, <span class="title">K</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储集合的属性</span></span><br><span class="line">  <span class="attr">models</span>: T[] = [];</span><br><span class="line">  <span class="comment">// 组装事件系统</span></span><br><span class="line">  events: Eventing = <span class="keyword">new</span> Eventing();</span><br><span class="line">  <span class="comment">// 缩短方法调用</span></span><br><span class="line">  on = <span class="built_in">this</span>.events.on;</span><br><span class="line">  trigger = <span class="built_in">this</span>.events.trigger;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 接收请求地址</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> rootUrl: <span class="built_in">string</span>, <span class="keyword">public</span> deserialize: (value: K) =&gt; T</span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用于发送请求获取集合数据</span></span><br><span class="line">  <span class="function"><span class="title">fetch</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    axios.get(<span class="built_in">this</span>.rootUrl).then(<span class="function">(<span class="params">response: AxiosResponse&lt;K[]&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 遍历集合</span></span><br><span class="line">      response.data.forEach(<span class="function">(<span class="params">value: K</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 将网络数据转换成模型数据并存储</span></span><br><span class="line">        <span class="built_in">this</span>.models.push(<span class="built_in">this</span>.deserialize(value));</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 数据获取完成后触发 change 事件</span></span><br><span class="line">      <span class="built_in">this</span>.trigger(<span class="string">&quot;change&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Collection &#125; <span class="keyword">from</span> <span class="string">&quot;./models/Collection&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; User, UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;./models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userCollection = <span class="keyword">new</span> Collection&lt;User, UserProps&gt;(</span><br><span class="line">  <span class="string">&quot;http://localhost:3000/users&quot;</span>,</span><br><span class="line">  <span class="function">(<span class="params">value: UserProps</span>) =&gt;</span> User.buildUser(value)</span><br><span class="line">);</span><br><span class="line">userCollection.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(userCollection.models);</span><br><span class="line">&#125;);</span><br><span class="line">userCollection.fetch();</span><br></pre></td></tr></table></figure>
<h4 id="8-7-2-创建获取集合的静态方法"><a href="#8-7-2-创建获取集合的静态方法" class="headerlink" title="8.7.2 创建获取集合的静态方法"></a>8.7.2 创建获取集合的静态方法</h4><p>目前代码中存在的问题是创建集合时泛型参数的传递还是比较麻烦的，我们可以在 User 类中暴露一个用于创建用户集合的静态方法，以简化创建用户集合的相关逻辑代码。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Collection &#125; <span class="keyword">from</span> <span class="string">&quot;./Collection&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">UserProps</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 创建用户集合</span></span><br><span class="line">  <span class="keyword">static</span> buildCollection(): Collection&lt;User, UserProps&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Collection&lt;User, UserProps&gt;(rootUrl, <span class="function">(<span class="params">value: UserProps</span>) =&gt;</span></span><br><span class="line">      User.buildUser(value)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;./models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userCollection = User.buildCollection();</span><br></pre></td></tr></table></figure>
<h3 id="8-8-功能完善"><a href="#8-8-功能完善" class="headerlink" title="8.8 功能完善"></a>8.8 功能完善</h3><h4 id="8-8-1-创建用户表单视图类"><a href="#8-8-1-创建用户表单视图类" class="headerlink" title="8.8.1 创建用户表单视图类"></a>8.8.1 创建用户表单视图类</h4><p>目标：创建用于渲染用户表单的视图类，并将用户表单渲染到页面中。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserForm.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserForm</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 模板父级</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> parent: Element</span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用于返回模板字符串的方法</span></span><br><span class="line">  template(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;用户表单&lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=&quot;text&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 渲染方法</span></span><br><span class="line">  <span class="comment">// 1. 获取模板 2. 将模板内容渲染至 parent</span></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> templateElement = <span class="built_in">document</span>.createElement(<span class="string">&quot;template&quot;</span>);</span><br><span class="line">    templateElement.innerHTML = <span class="built_in">this</span>.template();</span><br><span class="line">    <span class="built_in">this</span>.parent.append(templateElement.content);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; UserForm &#125; <span class="keyword">from</span> <span class="string">&quot;./views/UserForm&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userForm = <span class="keyword">new</span> UserForm(<span class="built_in">document</span>.querySelector(<span class="string">&quot;#root&quot;</span>));</span><br><span class="line">userForm.render();</span><br></pre></td></tr></table></figure>
<h4 id="8-8-2-为模板元素附加事件"><a href="#8-8-2-为模板元素附加事件" class="headerlink" title="8.8.2 为模板元素附加事件"></a>8.8.2 为模板元素附加事件</h4><p>目标：为模板中的任意元素附加任意事件。</p>
<p>第一步：创建事件关系映射表。</p>
<p>第二步：在渲染模板时为元素绑定事件。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserForm</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 返回[元素][事件名称][事件处理函数]映射表</span></span><br><span class="line">  eventsMap(): &#123; [key: <span class="built_in">string</span>]: <span class="function">() =&gt;</span> <span class="built_in">void</span> &#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="string">&quot;click:button&quot;</span>: <span class="built_in">this</span>.onButtonClick,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">onButtonClick</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;clicked&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.bindEvents(templateElement.content);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件绑定</span></span><br><span class="line">  bindEvents(fragment: DocumentFragment): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 获取元素事件映射表</span></span><br><span class="line">    <span class="keyword">const</span> eventsMap = <span class="built_in">this</span>.eventsMap();</span><br><span class="line">    <span class="comment">// 遍历映射表</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> eventKey <span class="keyword">in</span> eventsMap) &#123;</span><br><span class="line">      <span class="comment">// 获取事件名称、元素选择器</span></span><br><span class="line">      <span class="keyword">const</span> [eventName, selector] = eventKey.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">      <span class="comment">// 从模板代码片段中找出要添加事件的元素们</span></span><br><span class="line">      fragment.querySelectorAll(selector).forEach(<span class="function">(<span class="params">element</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 为元素绑定事件</span></span><br><span class="line">        element.addEventListener(eventName, eventsMap[eventKey]);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-8-3-绑定模型数据"><a href="#8-8-3-绑定模型数据" class="headerlink" title="8.8.3 绑定模型数据"></a>8.8.3 绑定模型数据</h4><p>目标：在视图模板中渲染模型数据，渲染用户的姓名和年龄。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserForm.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;../models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserForm</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收模型数据</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> parent: Element, <span class="keyword">public</span> model: User</span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  template(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="comment">// 渲染模型数据</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;div&gt;姓名: <span class="subst">$&#123;<span class="built_in">this</span>.model.get(<span class="string">&quot;name&quot;</span>)&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div&gt;年龄: <span class="subst">$&#123;<span class="built_in">this</span>.model.get(<span class="string">&quot;age&quot;</span>)&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; UserForm &#125; <span class="keyword">from</span> <span class="string">&quot;./views/UserForm&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;./models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = User.buildUser(&#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> userForm = <span class="keyword">new</span> UserForm(<span class="built_in">document</span>.querySelector(<span class="string">&quot;#root&quot;</span>), user);</span><br><span class="line">userForm.render();</span><br></pre></td></tr></table></figure>
<h4 id="8-8-4-随机年龄"><a href="#8-8-4-随机年龄" class="headerlink" title="8.8.4  随机年龄"></a>8.8.4  随机年龄</h4><p>目标：点击按钮生成随机年龄，年龄数据被更改后重新渲染视图。</p>
<p>第一步：创建用于生成随机年龄的方法。</p>
<p>由于生成随机年龄的逻辑是和 User 模型相关的，所以该方法应该写在 User 模型类中。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/models/User.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 随机设置年龄</span></span><br><span class="line">  <span class="function"><span class="title">setRandomAge</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.set(&#123; <span class="attr">age</span>: <span class="built_in">Math</span>.round(<span class="built_in">Math</span>.random() * <span class="number">100</span>) &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二步：为按钮绑定事件，事件触发后调用 setRandomAge 方法设置随机年龄。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserForm.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserForm</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 返回[元素][事件名称][事件处理函数]映射表</span></span><br><span class="line">  eventsMap(): &#123; [key: <span class="built_in">string</span>]: <span class="function">() =&gt;</span> <span class="built_in">void</span> &#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="string">&quot;click:.set-age&quot;</span>: <span class="built_in">this</span>.onSetAgeClick,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">	</span><br><span class="line">  <span class="comment">// 特别注意: 此处要使用箭头函数, 否则 this 指向错误</span></span><br><span class="line">  onSetAgeClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.model.setRandomAge();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用于返回模板字符串的方法</span></span><br><span class="line">  template(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;button class=&quot;set-age&quot;&gt;设置随机年龄&lt;/button&gt;`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第三步：随机年龄设置成功后，重新渲染视图。</p>
<p>由于模型数据更改后会自动触发 change 事件，所以此处需要监听 change 事件，事件触发后调用 render 方法重新渲染视图即可。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserForm.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserForm</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.bindModel();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.parent.innerHTML = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">bindModel</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.model.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.render();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-8-5-设置姓名"><a href="#8-8-5-设置姓名" class="headerlink" title="8.8.5 设置姓名"></a>8.8.5 设置姓名</h4><p>目标：在文本框中输入姓名，点击按钮更新姓名。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserForm.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserForm</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 返回[元素][事件名称][事件处理函数]映射表</span></span><br><span class="line">  eventsMap(): &#123; [key: <span class="built_in">string</span>]: <span class="function">() =&gt;</span> <span class="built_in">void</span> &#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="string">&quot;click:.set-name&quot;</span>: <span class="built_in">this</span>.onSetNameClick,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onSetNameClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> input = <span class="built_in">this</span>.parent.querySelector(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> name = input.value;</span><br><span class="line">    <span class="built_in">this</span>.model.set(&#123; name &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  template(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;input type=&quot;text&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;button class=&quot;set-name&quot;&gt;设置姓名&lt;/button&gt;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-8-6-严格空检查"><a href="#8-8-6-严格空检查" class="headerlink" title="8.8.6 严格空检查"></a>8.8.6 严格空检查</h4><p>目标：创建 tsconfig 配置文件，开启严格检查模式。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tsc --init</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserForm.ts</span></span><br><span class="line">onSetNameClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// const input: HTMLInputElement | null</span></span><br><span class="line">  <span class="keyword">const</span> input = <span class="built_in">this</span>.parent.querySelector(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (input) &#123;</span><br><span class="line">    <span class="keyword">const</span> name = input.value;</span><br><span class="line">    <span class="built_in">this</span>.model.set(&#123; name &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#root&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (root) &#123;</span><br><span class="line">  <span class="keyword">const</span> userForm = <span class="keyword">new</span> UserForm(root, user);</span><br><span class="line">  userForm.render();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;Root element not found&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-9-重构-提取复用代码"><a href="#8-9-重构-提取复用代码" class="headerlink" title="8.9 重构-提取复用代码"></a>8.9 重构-提取复用代码</h3><h4 id="8-9-1-创建通用视图类"><a href="#8-9-1-创建通用视图类" class="headerlink" title="8.9.1 创建通用视图类"></a>8.9.1 创建通用视图类</h4><p>目标：创建 View 类，包含和视图相关的通用逻辑，其他具体的视图类通过继承该类拥有一些特定功能。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/View.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;../models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 模板父级</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> parent: Element, <span class="keyword">public</span> model: User</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.bindModel();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">abstract</span> template(): <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">abstract</span> eventsMap(): &#123; [key: <span class="built_in">string</span>]: <span class="function">() =&gt;</span> <span class="built_in">void</span> &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 渲染方法</span></span><br><span class="line">  <span class="comment">// 1. 获取模板 2. 将模板内容渲染至 parent</span></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.parent.innerHTML = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">const</span> templateElement = <span class="built_in">document</span>.createElement(<span class="string">&quot;template&quot;</span>);</span><br><span class="line">    templateElement.innerHTML = <span class="built_in">this</span>.template();</span><br><span class="line">    <span class="built_in">this</span>.bindEvents(templateElement.content);</span><br><span class="line">    <span class="built_in">this</span>.parent.append(templateElement.content);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件绑定</span></span><br><span class="line">  bindEvents(fragment: DocumentFragment): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 获取元素事件映射表</span></span><br><span class="line">    <span class="keyword">const</span> eventsMap = <span class="built_in">this</span>.eventsMap();</span><br><span class="line">    <span class="comment">// 遍历映射表</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> eventKey <span class="keyword">in</span> eventsMap) &#123;</span><br><span class="line">      <span class="comment">// 获取事件名称、元素选择器</span></span><br><span class="line">      <span class="keyword">const</span> [eventName, selector] = eventKey.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">      <span class="comment">// 从模板代码片段中找出要添加事件的元素们</span></span><br><span class="line">      fragment.querySelectorAll(selector).forEach(<span class="function">(<span class="params">element</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 为元素绑定事件</span></span><br><span class="line">        element.addEventListener(eventName, eventsMap[eventKey]);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">bindModel</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.model.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.render();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserForm.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; View &#125; <span class="keyword">from</span> <span class="string">&quot;./View&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserForm</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 返回[元素][事件名称][事件处理函数]映射表</span></span><br><span class="line">  eventsMap(): &#123; [key: <span class="built_in">string</span>]: <span class="function">() =&gt;</span> <span class="built_in">void</span> &#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="string">&quot;click:.set-age&quot;</span>: <span class="built_in">this</span>.onSetAgeClick,</span><br><span class="line">      <span class="string">&quot;click:.set-name&quot;</span>: <span class="built_in">this</span>.onSetNameClick,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onSetAgeClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.model.setRandomAge();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  onSetNameClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> input = <span class="built_in">this</span>.parent.querySelector(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (input) &#123;</span><br><span class="line">      <span class="keyword">const</span> name = input.value;</span><br><span class="line">      <span class="built_in">this</span>.model.set(&#123; name &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用于返回模板字符串的方法</span></span><br><span class="line">  template(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;用户表单&lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;div&gt;姓名: <span class="subst">$&#123;<span class="built_in">this</span>.model.get(<span class="string">&quot;name&quot;</span>)&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div&gt;年龄: <span class="subst">$&#123;<span class="built_in">this</span>.model.get(<span class="string">&quot;age&quot;</span>)&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=&quot;text&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;button class=&quot;set-name&quot;&gt;设置姓名&lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;button class=&quot;set-age&quot;&gt;设置随机年龄&lt;/button&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-9-2-通过泛型指定模型参数类型"><a href="#8-9-2-通过泛型指定模型参数类型" class="headerlink" title="8.9.2  通过泛型指定模型参数类型"></a>8.9.2  通过泛型指定模型参数类型</h4><p>目标：通过泛型的方式指定视图类中接收的模型数据参数的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/View.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">View</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">K</span>&gt;, <span class="title">K</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 模板父级</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> model: T</span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserForm.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User, UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;../models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserForm</span> <span class="keyword">extends</span> <span class="title">View</span>&lt;<span class="title">User</span>, <span class="title">UserProps</span>&gt; </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-10-完善功能"><a href="#8-10-完善功能" class="headerlink" title="8.10 完善功能"></a>8.10 完善功能</h3><h4 id="8-10-1-保存用户"><a href="#8-10-1-保存用户" class="headerlink" title="8.10.1 保存用户"></a>8.10.1 保存用户</h4><p>目标：在用户表单类中，实现点击按钮创建用户，将用户信息同步到服务端。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserForm.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserForm</span> <span class="keyword">extends</span> <span class="title">View</span>&lt;<span class="title">User</span>, <span class="title">UserProps</span>&gt; </span>&#123;</span><br><span class="line">  eventsMap(): &#123; [key: <span class="built_in">string</span>]: <span class="function">() =&gt;</span> <span class="built_in">void</span> &#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="string">&quot;click:.save-user&quot;</span>: <span class="built_in">this</span>.onSaveUserClick,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onSaveUserClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.model.save();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  template(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;input type=&quot;text&quot; placeholder=&quot;<span class="subst">$&#123;<span class="built_in">this</span>.model.get(<span class="string">&quot;name&quot;</span>)&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;button class=&quot;save-user&quot;&gt;保存用户&lt;/button&gt;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-10-2-创建-UserShow-视图类"><a href="#8-10-2-创建-UserShow-视图类" class="headerlink" title="8.10.2 创建 UserShow 视图类"></a>8.10.2 创建 UserShow 视图类</h4><p>目标：创建用于展示用户信息的视图类。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; View &#125; <span class="keyword">from</span> <span class="string">&quot;./View&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; User, UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;../models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserShow</span> <span class="keyword">extends</span> <span class="title">View</span>&lt;<span class="title">User</span>, <span class="title">UserProps</span>&gt; </span>&#123;</span><br><span class="line">  template(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;用户信息&lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;div&gt;姓名: <span class="subst">$&#123;<span class="built_in">this</span>.model.get(<span class="string">&quot;name&quot;</span>)&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：由于 UserShow 视图类继承了 View 通用视图类，View 视图类要求子类实现 template 方法和 eventsMap 方法，但是在 UserShow 视图类中并不打算为元素绑定事件，所以仍然要写一个返回空对象的 eventsMap 方法，这显然是代码中考虑不周的地方。</p>
<p>要解决上述问题，我们只需要在 View 类中实现一个默认的返回空对象的 eventsMap 方法即可。如果子类要绑定事件，可以覆盖父类中的该方法。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/View.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">View</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">K</span>&gt;, <span class="title">K</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 子类如果有相同方法, 会覆盖父类的方法</span></span><br><span class="line">  eventsMap(): &#123; [key: <span class="built_in">string</span>]: <span class="function">() =&gt;</span> <span class="built_in">void</span> &#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-10-3-创建-UserEdit-视图类"><a href="#8-10-3-创建-UserEdit-视图类" class="headerlink" title="8.10.3 创建 UserEdit 视图类"></a>8.10.3 创建 UserEdit 视图类</h4><p>目标：创建 UserEdit 视图类，即将在该类中调用 UserShow 视图类和 UserForm 视图类。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserEdit.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; View &#125; <span class="keyword">from</span> <span class="string">&quot;./View&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; User, UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;../models/User&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserEdit</span> <span class="keyword">extends</span> <span class="title">View</span>&lt;<span class="title">User</span>, <span class="title">UserProps</span>&gt; </span>&#123;</span><br><span class="line">  template(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;user-show&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;user-form&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-10-4-视图嵌套"><a href="#8-10-4-视图嵌套" class="headerlink" title="8.10.4  视图嵌套"></a>8.10.4  视图嵌套</h4><p>目标：在 UserEdit 视图中渲染 UserShow 视图和 userForm 视图。</p>
<p>实现思路：由于在渲染其他视图时需要传递该视图的渲染位置，即渲染视图的目标父级元素，而目标父级元素的获取属于渲染视图中的公共逻辑，所以该逻辑要写在 View 视图类中，但是对于 View 类来说，它并不知道目标父级元素是谁，所以目标父级信息由子类提供，View 类通过子类提供的信息进行父级元素的获取和存储，子类再根根据获取结果渲染其他视图。</p>
<p>子类提供父类信息 -&gt; 父类获取元素 -&gt; 子类使用元素渲染其他视图</p>
<p>第一步：在 UserEdit 视图类中提供要渲染的其他视图需要的父类信息。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserEdit.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserEdit</span> <span class="keyword">extends</span> <span class="title">View</span>&lt;<span class="title">User</span>, <span class="title">UserProps</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 要渲染的其他视图的父级信息映射表</span></span><br><span class="line">  regionsMap(): &#123; [key: <span class="built_in">string</span>]: <span class="built_in">string</span> &#125; &#123;</span><br><span class="line">    <span class="comment">// key: 标识</span></span><br><span class="line">    <span class="comment">// value: 父类元素选择器</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">userShow</span>: <span class="string">&quot;.user-show&quot;</span>,</span><br><span class="line">      <span class="attr">userForm</span>: <span class="string">&quot;.user-form&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二步：父级在获取到模板元素以后，根据父级信息映射表从模板元素中获取父级元素</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Model &#125; <span class="keyword">from</span> <span class="string">&quot;../models/Model&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">View</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">K</span>&gt;, <span class="title">K</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储获取到的目标父级元素</span></span><br><span class="line">  <span class="attr">regions</span>: &#123; [key: <span class="built_in">string</span>]: Element &#125; = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  mapRegions(fragment: DocumentFragment): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 获取子类提供的父级信息映射表</span></span><br><span class="line">    <span class="keyword">const</span> regionsMap = <span class="built_in">this</span>.regionsMap();</span><br><span class="line">    <span class="comment">// 遍历父级信息映射表</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> regionsMap) &#123;</span><br><span class="line">      <span class="comment">// 从映射表中获取父级元素选择器</span></span><br><span class="line">      <span class="keyword">const</span> selector = regionsMap[key];</span><br><span class="line">      <span class="comment">// 在模板中获取目标父级元素</span></span><br><span class="line">      <span class="keyword">const</span> element = fragment.querySelector(selector);</span><br><span class="line">      <span class="comment">// 如果目标父级存在</span></span><br><span class="line">      <span class="keyword">if</span> (element) &#123;</span><br><span class="line">        <span class="comment">// 存储目标父级元素</span></span><br><span class="line">        <span class="built_in">this</span>.regions[key] = element;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 获取到组件模板以后根据组件模板获取目标父级元素</span></span><br><span class="line">    <span class="built_in">this</span>.mapRegions(templateElement.content);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第三步：子类根据父类获取到的父级元素渲染其他视图。</p>
<p>① 父类在获取到父级元素以后，调用子类提供的 onRender 方法开始渲染其他视图</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/View.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">View</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">K</span>&gt;, <span class="title">K</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.onRender();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>② 子类通过 onRender 方法进行其他视图的渲染</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserEdit.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; UserShow &#125; <span class="keyword">from</span> <span class="string">&quot;./UserShow&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; UserForm &#125; <span class="keyword">from</span> <span class="string">&quot;./UserForm&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserEdit</span> <span class="keyword">extends</span> <span class="title">View</span>&lt;<span class="title">User</span>, <span class="title">UserProps</span>&gt; </span>&#123;</span><br><span class="line">  onRender(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">new</span> UserShow(<span class="built_in">this</span>.regions.userShow, <span class="built_in">this</span>.model).render();</span><br><span class="line">    <span class="keyword">new</span> UserForm(<span class="built_in">this</span>.regions.userForm, <span class="built_in">this</span>.model).render();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第四步：在父类中定义默认的 onRender 方法和 regionsMap 方法，防止在子类不提供该方法时程序运行出错。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/View.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">View</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">K</span>&gt;, <span class="title">K</span>&gt; </span>&#123;</span><br><span class="line">  regionsMap(): &#123; [key: <span class="built_in">string</span>]: <span class="built_in">string</span> &#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  onRender(): <span class="built_in">void</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User &#125; <span class="keyword">from</span> <span class="string">&quot;./models/User&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; UserEdit &#125; <span class="keyword">from</span> <span class="string">&quot;./views/UserEdit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = User.buildUser(&#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> root = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#root&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (root) &#123;</span><br><span class="line">  <span class="keyword">const</span> userEdit = <span class="keyword">new</span> UserEdit(root, user);</span><br><span class="line">  userEdit.render();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;Root element not found&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-10-5-创建通用集合视图类"><a href="#8-10-5-创建通用集合视图类" class="headerlink" title="8.10.5 创建通用集合视图类"></a>8.10.5 创建通用集合视图类</h4><p>目标：创建一个用于渲染集合模型数据的通用视图类。</p>
<p>第一步：创建通用的渲染集合模型数据的视图类。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/CollectionView.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Collection &#125; <span class="keyword">from</span> <span class="string">&quot;../models/Collection&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用于渲染集合数据的视图类</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionView</span>&lt;<span class="title">T</span>, <span class="title">K</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// parent: 集合数据渲染的目标父级元素</span></span><br><span class="line">  <span class="comment">// collection: 即将要渲染的集合数据</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"><span class="keyword">public</span> parent: Element, <span class="keyword">public</span> collection: Collection&lt;T, K&gt;</span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 子类需要实现的渲染模型数据的方法</span></span><br><span class="line">  <span class="comment">// model: 要渲染的模型数据</span></span><br><span class="line">  <span class="comment">// itemParent: 模型数据渲染的目标父级</span></span><br><span class="line">  <span class="keyword">abstract</span> renderItem(model: T, <span class="attr">itemParent</span>: Element): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">  render(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 清空父级内容</span></span><br><span class="line">    <span class="built_in">this</span>.parent.innerHTML = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">// 创建 template 模板元素, 临时存放即将渲染的模型列表数据</span></span><br><span class="line">    <span class="keyword">const</span> templateElement = <span class="built_in">document</span>.createElement(<span class="string">&quot;template&quot;</span>);</span><br><span class="line">    <span class="comment">// 遍历模型列表数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> model <span class="keyword">of</span> <span class="built_in">this</span>.collection.models) &#123;</span><br><span class="line">      <span class="comment">// 创建当前模型列表数据的渲染目标父级</span></span><br><span class="line">      <span class="keyword">const</span> itemParent = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">      <span class="comment">// 调用子类实现的 renderItem 方法将模型数据渲染到 itemParent 父级中</span></span><br><span class="line">      <span class="built_in">this</span>.renderItem(model, itemParent);</span><br><span class="line">      <span class="comment">// 将当前渲染好的模型数据临时存放在 template 模板元素中</span></span><br><span class="line">      templateElement.content.append(itemParent);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将模型列表数据整体追加到它的父级</span></span><br><span class="line">    <span class="built_in">this</span>.parent.append(templateElement.content);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二步：创建用户列表视图类，用于渲染用户列表视图。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/views/UserList.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; User, UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;../models/User&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CollectionView &#125; <span class="keyword">from</span> <span class="string">&quot;./CollectionView&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; UserShow &#125; <span class="keyword">from</span> <span class="string">&quot;./UserShow&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserList</span> <span class="keyword">extends</span> <span class="title">CollectionView</span>&lt;<span class="title">User</span>, <span class="title">UserProps</span>&gt; </span>&#123;</span><br><span class="line">  renderItem(model: User, <span class="attr">itemParent</span>: Element): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">new</span> UserShow(itemParent, model).render();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下为测试代码</span></span><br><span class="line"><span class="comment">// src/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Collection &#125; <span class="keyword">from</span> <span class="string">&quot;./models/Collection&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; User, UserProps &#125; <span class="keyword">from</span> <span class="string">&quot;./models/User&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; UserList &#125; <span class="keyword">from</span> <span class="string">&quot;./views/UserList&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> users = <span class="keyword">new</span> Collection&lt;User, UserProps&gt;(</span><br><span class="line">  <span class="string">&quot;http://localhost:3000/users&quot;</span>,</span><br><span class="line">  <span class="function">(<span class="params">value: UserProps</span>) =&gt;</span> User.buildUser(value)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">users.on(<span class="string">&quot;change&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> root = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#root&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (root) &#123;</span><br><span class="line">    <span class="keyword">new</span> UserList(root, users).render();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">users.fetch();</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>typeScript</category>
      </categories>
      <tags>
        <tag>typeScript基础知识</tag>
        <tag>typeScript</tag>
      </tags>
  </entry>
  <entry>
    <title>array</title>
    <url>/archives/a10ceeb7.html</url>
    <content><![CDATA[<h1 id="面试官：数组新增了哪些扩展？"><a href="#面试官：数组新增了哪些扩展？" class="headerlink" title="面试官：数组新增了哪些扩展？"></a>面试官：数组新增了哪些扩展？</h1><p> <img src="https://static.vue-js.com/a156b8d0-53c5-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、扩展运算符的应用"><a href="#一、扩展运算符的应用" class="headerlink" title="一、扩展运算符的应用"></a>一、扩展运算符的应用</h2><p>ES6通过扩展元素符<code>...</code>，好比 <code>rest</code> 参数的逆运算，将一个数组转为用逗号分隔的参数序列</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(...[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="comment">// 1 2 3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>, ...[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="number">5</span>)</span><br><span class="line"><span class="comment">// 1 2 3 4 5</span></span><br><span class="line"></span><br><span class="line">[...document.querySelectorAll(<span class="string">&#x27;div&#x27;</span>)]</span><br><span class="line"><span class="comment">// [&lt;div&gt;, &lt;div&gt;, &lt;div&gt;]</span></span><br></pre></td></tr></table></figure>
<p>主要用于函数调用的时候，将一个数组变为参数序列</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push</span>(<span class="params">array, ...items</span>) </span>&#123;</span><br><span class="line">  array.push(...items);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> numbers = [<span class="number">4</span>, <span class="number">38</span>];</span><br><span class="line">add(...numbers) <span class="comment">// 42</span></span><br></pre></td></tr></table></figure>
<p>可以将某些数据结构转为数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[...document.querySelectorAll(<span class="string">&#x27;div&#x27;</span>)]</span><br></pre></td></tr></table></figure>
<p>能够更简单实现数组复制</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a1 = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">const</span> [...a2] = a1;</span><br><span class="line"><span class="comment">// [1,2]</span></span><br></pre></td></tr></table></figure>
<p>数组的合并也更为简洁了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> arr3 = [<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>];</span><br><span class="line">[...arr1, ...arr2, ...arr3]</span><br><span class="line"><span class="comment">// [ &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27; ]</span></span><br></pre></td></tr></table></figure>
<p>注意：通过扩展运算符实现的是浅拷贝，修改了引用指向的值，会同步反映到新数组</p>
<p>下面看个例子就清楚多了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>,[<span class="number">1</span>,<span class="number">2</span>]];</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> arr3  = [...arr1,...arr2]</span><br><span class="line">arr[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">9999</span> <span class="comment">// 修改arr1里面数组成员值</span></span><br><span class="line"><span class="built_in">console</span>.log(arr[<span class="number">3</span>]) <span class="comment">// 影响到arr3,[&#x27;a&#x27;,&#x27;b&#x27;,[9999,2],&#x27;c&#x27;]</span></span><br></pre></td></tr></table></figure>
<p>扩展运算符可以与解构赋值结合起来，用于生成数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> [first, ...rest] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">first <span class="comment">// 1</span></span><br><span class="line">rest  <span class="comment">// [2, 3, 4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [first, ...rest] = [];</span><br><span class="line">first <span class="comment">// undefined</span></span><br><span class="line">rest  <span class="comment">// []</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [first, ...rest] = [<span class="string">&quot;foo&quot;</span>];</span><br><span class="line">first  <span class="comment">// &quot;foo&quot;</span></span><br><span class="line">rest   <span class="comment">// []</span></span><br></pre></td></tr></table></figure>
<p>如果将扩展运算符用于数组赋值，只能放在参数的最后一位，否则会报错</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> [...butLast, last] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="comment">// 报错</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [first, ...middle, last] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
<p>可以将字符串转为真正的数组</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[...<span class="string">&#x27;hello&#x27;</span>]</span><br><span class="line"><span class="comment">// [ &quot;h&quot;, &quot;e&quot;, &quot;l&quot;, &quot;l&quot;, &quot;o&quot; ]</span></span><br></pre></td></tr></table></figure>
<p>定义了遍历器（Iterator）接口的对象，都可以用扩展运算符转为真正的数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> nodeList = <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> array = [...nodeList];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">  [<span class="number">1</span>, <span class="string">&#x27;one&#x27;</span>],</span><br><span class="line">  [<span class="number">2</span>, <span class="string">&#x27;two&#x27;</span>],</span><br><span class="line">  [<span class="number">3</span>, <span class="string">&#x27;three&#x27;</span>],</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [...map.keys()]; <span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure>
<p>如果对没有 Iterator 接口的对象，使用扩展运算符，将会报错</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> arr = [...obj]; <span class="comment">// TypeError: Cannot spread non-iterable object</span></span><br></pre></td></tr></table></figure>
<h2 id="二、构造函数新增的方法"><a href="#二、构造函数新增的方法" class="headerlink" title="二、构造函数新增的方法"></a>二、构造函数新增的方法</h2><p>关于构造函数，数组新增的方法有如下：</p>
<ul>
<li>Array.from()</li>
<li>Array.of()</li>
</ul>
<h3 id="Array-from"><a href="#Array-from" class="headerlink" title="Array.from()"></a>Array.from()</h3><p>将两类对象转为真正的数组：类似数组的对象和可遍历<code>（iterable）</code>的对象（包括 <code>ES6</code> 新增的数据结构 <code>Set</code> 和 <code>Map</code>）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arrayLike = &#123;</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;c&#x27;</span>,</span><br><span class="line">    <span class="attr">length</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> arr2 = <span class="built_in">Array</span>.from(arrayLike); <span class="comment">// [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]</span></span><br></pre></td></tr></table></figure>
<p>还可以接受第二个参数，用来对每个元素进行处理，将处理后的值放入返回的数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="function">(<span class="params">x</span>) =&gt;</span> x * x)</span><br><span class="line"><span class="comment">// [1, 4, 9]</span></span><br></pre></td></tr></table></figure>
<h3 id="Array-of"><a href="#Array-of" class="headerlink" title="Array.of()"></a>Array.of()</h3><p>用于将一组值，转换为数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Array</span>.of(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3,11,8]</span></span><br></pre></td></tr></table></figure>
<p>没有参数的时候，返回一个空数组</p>
<p>当参数只有一个的时候，实际上是指定数组的长度</p>
<p>参数个数不少于 2 个时，<code>Array()</code>才会返回由参数组成的新数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Array</span>() <span class="comment">// []</span></span><br><span class="line"><span class="built_in">Array</span>(<span class="number">3</span>) <span class="comment">// [, , ,]</span></span><br><span class="line"><span class="built_in">Array</span>(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3, 11, 8]</span></span><br></pre></td></tr></table></figure>
<h3 id="三、实例对象新增的方法"><a href="#三、实例对象新增的方法" class="headerlink" title="三、实例对象新增的方法"></a>三、实例对象新增的方法</h3><p>关于数组实例对象新增的方法有如下：</p>
<ul>
<li>copyWithin()</li>
<li>find()、findIndex()</li>
<li>fill()</li>
<li>entries()，keys()，values()</li>
<li>includes()</li>
<li>flat()，flatMap()</li>
</ul>
<h3 id="copyWithin"><a href="#copyWithin" class="headerlink" title="copyWithin()"></a>copyWithin()</h3><p>将指定位置的成员复制到其他位置（会覆盖原有成员），然后返回当前数组</p>
<p>参数如下：</p>
<ul>
<li>target（必需）：从该位置开始替换数据。如果为负值，表示倒数。</li>
<li>start（可选）：从该位置开始读取数据，默认为 0。如果为负值，表示从末尾开始计算。</li>
<li>end（可选）：到该位置前停止读取数据，默认等于数组长度。如果为负值，表示从末尾开始计算。</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">0</span>, <span class="number">3</span>) <span class="comment">// 将从 3 号位直到数组结束的成员（4 和 5），复制到从 0 号位开始的位置，结果覆盖了原来的 1 和 2</span></span><br><span class="line"><span class="comment">// [4, 5, 3, 4, 5] </span></span><br></pre></td></tr></table></figure>
<h3 id="find-、findIndex"><a href="#find-、findIndex" class="headerlink" title="find()、findIndex()"></a>find()、findIndex()</h3><p><code>find()</code>用于找出第一个符合条件的数组成员</p>
<p>参数是一个回调函数，接受三个参数依次为当前的值、当前的位置和原数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>].find(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">9</span>;</span><br><span class="line">&#125;) <span class="comment">// 10</span></span><br></pre></td></tr></table></figure>
<p><code>findIndex</code>返回第一个符合条件的数组成员的位置，如果所有成员都不符合条件，则返回<code>-1</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>].findIndex(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">9</span>;</span><br><span class="line">&#125;) <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<p>这两个方法都可以接受第二个参数，用来绑定回调函数的<code>this</code>对象。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> v &gt; <span class="built_in">this</span>.age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person = &#123;<span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span>&#125;;</span><br><span class="line">[<span class="number">10</span>, <span class="number">12</span>, <span class="number">26</span>, <span class="number">15</span>].find(f, person);    <span class="comment">// 26</span></span><br></pre></td></tr></table></figure>
<h3 id="fill"><a href="#fill" class="headerlink" title="fill()"></a>fill()</h3><p>使用给定值，填充一个数组</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].fill(<span class="number">7</span>)</span><br><span class="line"><span class="comment">// [7, 7, 7]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>).fill(<span class="number">7</span>)</span><br><span class="line"><span class="comment">// [7, 7, 7]</span></span><br></pre></td></tr></table></figure>
<p>还可以接受第二个和第三个参数，用于指定填充的起始位置和结束位置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].fill(<span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">// [&#x27;a&#x27;, 7, &#x27;c&#x27;]</span></span><br></pre></td></tr></table></figure>
<p>注意，如果填充的类型为对象，则是浅拷贝</p>
<h3 id="entries-，keys-，values"><a href="#entries-，keys-，values" class="headerlink" title="entries()，keys()，values()"></a>entries()，keys()，values()</h3><p><code>keys()</code>是对键名的遍历、<code>values()</code>是对键值的遍历，<code>entries()</code>是对键值对的遍历</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">or (<span class="keyword">let</span> index <span class="keyword">of</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>].keys()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> elem <span class="keyword">of</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>].values()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &#x27;a&#x27;</span></span><br><span class="line"><span class="comment">// &#x27;b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [index, elem] <span class="keyword">of</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>].entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index, elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0 &quot;a&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="includes"><a href="#includes" class="headerlink" title="includes()"></a>includes()</h3><p>用于判断数组是否包含给定的值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>)     <span class="comment">// true</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">4</span>)     <span class="comment">// false</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="literal">NaN</span>].includes(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>方法的第二个参数表示搜索的起始位置，默认为<code>0</code></p>
<p>参数为负数则表示倒数的位置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>, <span class="number">3</span>);  <span class="comment">// false</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>, -<span class="number">1</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="flat-，flatMap"><a href="#flat-，flatMap" class="headerlink" title="flat()，flatMap()"></a>flat()，flatMap()</h3><p>将数组扁平化处理，返回一个新数组，对原数据没有影响</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]].flat()</span><br><span class="line"><span class="comment">// [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>
<p><code>flat()</code>默认只会“拉平”一层，如果想要“拉平”多层的嵌套数组，可以将<code>flat()</code>方法的参数写成一个整数，表示想要拉平的层数，默认为1</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]].flat()</span><br><span class="line"><span class="comment">// [1, 2, 3, [4, 5]]</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]].flat(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
<p><code>flatMap()</code>方法对原数组的每个成员执行一个函数相当于执行<code>Array.prototype.map()</code>，然后对返回值组成的数组执行<code>flat()</code>方法。该方法返回一个新数组，不改变原数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 相当于 [[2, 4], [3, 6], [4, 8]].flat()</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>].flatMap(<span class="function">(<span class="params">x</span>) =&gt;</span> [x, x * <span class="number">2</span>])</span><br><span class="line"><span class="comment">// [2, 4, 3, 6, 4, 8]</span></span><br></pre></td></tr></table></figure>
<p><code>flatMap()</code>方法还可以有第二个参数，用来绑定遍历函数里面的<code>this</code></p>
<h3 id="四、数组的空位"><a href="#四、数组的空位" class="headerlink" title="四、数组的空位"></a>四、数组的空位</h3><p>数组的空位指，数组的某一个位置没有任何值</p>
<p>ES6 则是明确将空位转为<code>undefined</code>，包括<code>Array.from</code>、扩展运算符、<code>copyWithin()</code>、<code>fill()</code>、<code>entries()</code>、<code>keys()</code>、<code>values()</code>、<code>find()</code>和<code>findIndex()</code></p>
<p>建议大家在日常书写中，避免出现空位</p>
<h3 id="五、排序稳定性"><a href="#五、排序稳定性" class="headerlink" title="五、排序稳定性"></a>五、排序稳定性</h3><p>将<code>sort()</code>默认设置为稳定的排序算法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [</span><br><span class="line">  <span class="string">&#x27;peach&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;straw&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;apple&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;spork&#x27;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stableSorting = <span class="function">(<span class="params">s1, s2</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (s1[<span class="number">0</span>] &lt; s2[<span class="number">0</span>]) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">arr.sort(stableSorting)</span><br><span class="line"><span class="comment">// [&quot;apple&quot;, &quot;peach&quot;, &quot;straw&quot;, &quot;spork&quot;]</span></span><br></pre></td></tr></table></figure>
<p>排序结果中，<code>straw</code>在<code>spork</code>的前面，跟原始顺序一致</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://es6.ruanyifeng.com/#docs/array">https://es6.ruanyifeng.com/#docs/array</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>es6</tag>
      </tags>
  </entry>
  <entry>
    <title>ajax2</title>
    <url>/archives/50cfbdee.html</url>
    <content><![CDATA[<h1 id="面试官：ajax原理是什么？如何实现？"><a href="#面试官：ajax原理是什么？如何实现？" class="headerlink" title="面试官：ajax原理是什么？如何实现？"></a>面试官：ajax原理是什么？如何实现？</h1><p> <img src="https://static.vue-js.com/a35a2950-7b2a-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p><code>AJAX</code>全称(Async Javascript and XML)</p>
<p>即异步的<code>JavaScript</code> 和<code>XML</code>，是一种创建交互式网页应用的网页开发技术，可以在不重新加载整个网页的情况下，与服务器交换数据，并且更新部分网页</p>
<p><code>Ajax</code>的原理简单来说通过<code>XmlHttpRequest</code>对象来向服务器发异步请求，从服务器获得数据，然后用<code>JavaScript</code>来操作<code>DOM</code>而更新页面</p>
<p>流程图如下：</p>
<p> <img src="https://static.vue-js.com/af42de10-7b2a-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>下面举个例子：</p>
<p>领导想找小李汇报一下工作，就委托秘书去叫小李，自己就接着做其他事情，直到秘书告诉他小李已经到了，最后小李跟领导汇报工作</p>
<p><code>Ajax</code>请求数据流程与“领导想找小李汇报一下工作”类似，上述秘书就相当于<code>XMLHttpRequest</code>对象，领导相当于浏览器，响应数据相当于小李</p>
<p>浏览器可以发送<code>HTTP</code>请求后，接着做其他事情，等收到<code>XHR</code>返回来的数据再进行操作</p>
<h2 id="二、实现过程"><a href="#二、实现过程" class="headerlink" title="二、实现过程"></a>二、实现过程</h2><p>实现 <code>Ajax</code>异步交互需要服务器逻辑进行配合，需要完成以下步骤：</p>
<ul>
<li><p>创建 <code>Ajax</code>的核心对象 <code>XMLHttpRequest</code>对象</p>
</li>
<li><p>通过 <code>XMLHttpRequest</code> 对象的 <code>open()</code> 方法与服务端建立连接</p>
</li>
<li><p>构建请求所需的数据内容，并通过<code>XMLHttpRequest</code> 对象的 <code>send()</code> 方法发送给服务器端</p>
</li>
<li><p>通过 <code>XMLHttpRequest</code> 对象提供的 <code>onreadystatechange</code> 事件监听服务器端你的通信状态</p>
</li>
<li><p>接受并处理服务端向客户端响应的数据结果</p>
</li>
<li><p>将处理结果更新到 <code>HTML</code>页面中</p>
</li>
</ul>
<h3 id="创建XMLHttpRequest对象"><a href="#创建XMLHttpRequest对象" class="headerlink" title="创建XMLHttpRequest对象"></a>创建XMLHttpRequest对象</h3><p>通过<code>XMLHttpRequest()</code> 构造函数用于初始化一个 <code>XMLHttpRequest</code> 实例对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br></pre></td></tr></table></figure>
<h3 id="与服务器建立连接"><a href="#与服务器建立连接" class="headerlink" title="与服务器建立连接"></a>与服务器建立连接</h3><p>通过 <code>XMLHttpRequest</code> 对象的 <code>open()</code> 方法与服务器建立连接</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">xhr.open(method, url, [<span class="keyword">async</span>][, user][, password])</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><p><code>method</code>：表示当前的请求方式，常见的有<code>GET</code>、<code>POST</code></p>
</li>
<li><p><code>url</code>：服务端地址</p>
</li>
<li><p><code>async</code>：布尔值，表示是否异步执行操作，默认为<code>true</code></p>
</li>
<li><p><code>user</code>: 可选的用户名用于认证用途；默认为`null</p>
</li>
</ul>
<ul>
<li><code>password</code>: 可选的密码用于认证用途，默认为`null</li>
</ul>
<h3 id="给服务端发送数据"><a href="#给服务端发送数据" class="headerlink" title="给服务端发送数据"></a>给服务端发送数据</h3><p>通过 <code>XMLHttpRequest</code> 对象的 <code>send()</code> 方法，将客户端页面的数据发送给服务端</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">xhr.send([body])</span><br></pre></td></tr></table></figure>
<p><code>body</code>: 在 <code>XHR</code> 请求中要发送的数据体，如果不传递数据则为 <code>null</code></p>
<p>如果使用<code>GET</code>请求发送数据的时候，需要注意如下：</p>
<ul>
<li>将请求数据添加到<code>open()</code>方法中的<code>url</code>地址中</li>
<li>发送请求数据中的<code>send()</code>方法中参数设置为<code>null</code></li>
</ul>
<h3 id="绑定onreadystatechange事件"><a href="#绑定onreadystatechange事件" class="headerlink" title="绑定onreadystatechange事件"></a>绑定onreadystatechange事件</h3><p><code>onreadystatechange</code> 事件用于监听服务器端的通信状态，主要监听的属性为<code>XMLHttpRequest.readyState</code> ,</p>
<p>关于<code>XMLHttpRequest.readyState</code>属性有五个状态，如下图显示</p>
<p><img src="https://static.vue-js.com/9782fc90-7b31-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>只要 <code>readyState</code>属性值一变化，就会触发一次 <code>readystatechange</code> 事件</p>
<p><code>XMLHttpRequest.responseText</code>属性用于接收服务器端的响应结果</p>
<p>举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">request.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(request.readyState === <span class="number">4</span>)&#123; <span class="comment">// 整个请求过程完毕</span></span><br><span class="line">        <span class="keyword">if</span>(request.status &gt;= <span class="number">200</span> &amp;&amp; request.status &lt;= <span class="number">300</span>)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(request.responseText) <span class="comment">// 服务端返回的结果</span></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(request.status &gt;=<span class="number">400</span>)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;错误信息：&quot;</span> + request.status)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">request.open(<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;http://xxxx&#x27;</span>)</span><br><span class="line">request.send()</span><br></pre></td></tr></table></figure>
<h2 id="三、封装"><a href="#三、封装" class="headerlink" title="三、封装"></a>三、封装</h2><p>通过上面对<code>XMLHttpRequest</code>对象的了解，下面来封装一个简单的<code>ajax</code>请求</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//封装一个ajax请求</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//创建XMLHttpRequest对象</span></span><br><span class="line">    <span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化参数的内容</span></span><br><span class="line">    options = options || &#123;&#125;</span><br><span class="line">    options.type = (options.type || <span class="string">&#x27;GET&#x27;</span>).toUpperCase()</span><br><span class="line">    options.dataType = options.dataType || <span class="string">&#x27;json&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> params = options.data</span><br><span class="line"></span><br><span class="line">    <span class="comment">//发送请求</span></span><br><span class="line">    <span class="keyword">if</span> (options.type === <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">        xhr.open(<span class="string">&#x27;GET&#x27;</span>, options.url + <span class="string">&#x27;?&#x27;</span> + params, <span class="literal">true</span>)</span><br><span class="line">        xhr.send(<span class="literal">null</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (options.type === <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        xhr.open(<span class="string">&#x27;POST&#x27;</span>, options.url, <span class="literal">true</span>)</span><br><span class="line">        xhr.send(params)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接收请求</span></span><br><span class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> status = xhr.status</span><br><span class="line">            <span class="keyword">if</span> (status &gt;= <span class="number">200</span> &amp;&amp; status &lt; <span class="number">300</span>) &#123;</span><br><span class="line">                options.success &amp;&amp; options.success(xhr.responseText, xhr.responseXML)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                options.fail &amp;&amp; options.fail(status)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用方式如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ajax(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    <span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;https://xxxx&#x27;</span>,</span><br><span class="line">    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">text,xml</span>)</span>&#123;<span class="comment">//请求成功后的回调函数</span></span><br><span class="line">        <span class="built_in">console</span>.log(text)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">fail</span>: <span class="function"><span class="keyword">function</span>(<span class="params">status</span>)</span>&#123;<span class="comment">////请求失败后的回调函数</span></span><br><span class="line">        <span class="built_in">console</span>.log(status)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ajax</category>
      </categories>
      <tags>
        <tag>ajax2</tag>
        <tag>ajax</tag>
      </tags>
  </entry>
  <entry>
    <title>ajax</title>
    <url>/archives/c5a6a264.html</url>
    <content><![CDATA[<p> [hint]Http协议是什么？[/hint]</p>
<ul>
<li>http协议（ hypertext transport protocol协议）【超文本传输协议】，详细规定了浏览器和万维网之间通信的的规则 ；<br>[tag type=”primary” outline]常见状态码&amp;含义[/tag]</li>
<li>200 - 请求成功，已经正常处理完毕</li>
<li>301 - 请求永久重定向，转移到其它URL</li>
<li>302 - 请求临时重定向</li>
<li>304 - 请求被重定向到客户端本地缓存</li>
<li>400 - 客户端请求存在语法错误</li>
<li>401 - 客户端请求没有经过授权</li>
<li>403 - 客户端的请求被服务器拒绝，一般为客户端没有访问权限</li>
<li>404 - 客户端请求的URL在服务端不存在</li>
<li>500 - 服务端永久错误</li>
</ul>
<hr>
<ul>
<li>100-199 用于指定客户端应相应的某些动作。</li>
<li>200-299 用于表示请求成功。</li>
<li>300-399 用于已经移动的文件并且常被包含在定位头信息中指定新的地址信息。</li>
<li>400-499 用于指出客户端的错误。</li>
<li>500-599 用于支持服务器错误。</li>
</ul>
<hr>
<p>[tag type=”danger”]Ajax 概述[/tag]<br>​Ajax：标准读音 [ˈeɪˌdʒæks] ，中文音译：阿贾克斯<br>它是浏览器提供的一套方法，可以实现页面无刷新更新数据，提高用户浏览网站应用的体验。<br>[tag type=”success”]Ajax 应用场景[/tag]</p>
<ul>
<li>页面上拉加载更多数据</li>
<li>列表数据无刷新分页</li>
<li>表单项离开焦点数据验证</li>
<li>搜索框提示文字下拉列表</li>
</ul>
<hr>
<p>[tag type=”warn” outline]JSON[/tag]</p>
<ul>
<li>JSON是什么</li>
<li>JSON ( JavaScript Object Notation) ，是一种数据交互格式。</li>
<li>在真实的项目中，服务器端<strong>大多数情况下会以 JSON对象作为响应数据的格式</strong>。当客户端拿到响应数据时，要将 JSON 数据和 HTML 字符串进行拼接，然后将拼接的结果展示在页面中。</li>
<li><p>在 http 请求与响应的过程中，无论是请求参数还是响应内容，如果是对象类型，最终都会被转换为对象字符串进行传输。</p>
</li>
<li><p>注意事项</p>
</li>
<li>JSON 规定字符集是UTF-8，字符串必须使用””，Object 的键也必须使用””</li>
<li>数组或对象的最后一个成员，不能加 逗号</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">JSON</span>.parse() <span class="comment">// 将 json 字符串转换为json对象</span></span><br><span class="line"><span class="built_in">JSON</span>.stringify() <span class="comment">// 将json对象转换为json字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1 JSON对象</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;starcraft&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: <span class="string">&quot;12&quot;</span>,</span><br><span class="line">        <span class="string">&quot;price&quot;</span>: <span class="number">60</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2 JSON数组</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;person&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;jobs&quot;</span>,</span><br><span class="line">        <span class="number">60</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//3  JSON 数组对象</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;arr&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;tom&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;丽里&quot;</span>,</span><br><span class="line">            <span class="string">&quot;age&quot;</span>: <span class="number">12</span></span><br><span class="line">        &#125;</span><br><span class="line">      </span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[tabs]</span><br><span class="line"></span><br><span class="line"><span class="built_in">JSON</span>文件</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:<span class="string">&quot;圣诞节&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>:<span class="number">18</span>,</span><br><span class="line">    <span class="string">&quot;arr&quot;</span>:[<span class="number">10</span>,<span class="number">20</span>,<span class="number">39</span>,<span class="number">43</span>],</span><br><span class="line">    <span class="string">&quot;bl&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">    <span class="string">&quot;null&quot;</span>:<span class="string">&quot;null&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;接受文件&quot;</span></span><br><span class="line"><span class="keyword">var</span> data = <span class="built_in">require</span>(<span class="string">&quot;./home.json&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(data));</span><br><span class="line"><span class="comment">//&#123;&quot;name&quot;:&quot;圣诞节&quot;,&quot;age&quot;:18,&quot;arr&quot;:[10,20,39,43],&quot;bl&quot;:true,&quot;null&quot;:&quot;null&quot;&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>[tag type=”info” outline]简单获取接口渲染页面[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;获取接口渲染页面&quot;</span> </span><br><span class="line"> &lt;script&gt;</span><br><span class="line"><span class="comment">// 1.获取btn</span></span><br><span class="line">        <span class="keyword">let</span> btn = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">        <span class="comment">// 绑定事件</span></span><br><span class="line">        btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 发送数据</span></span><br><span class="line">            $.get(<span class="string">&#x27;http://www.liulongbin.top:3006/api/getbooks&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                <span class="comment">//    打印返回的数据</span></span><br><span class="line">                <span class="keyword">let</span> datas = data.data;</span><br><span class="line">                <span class="keyword">let</span> ul = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;ul&#x27;</span>);</span><br><span class="line">                ul.innerHTML = datas.map(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">                &lt;li&gt;</span></span><br><span class="line"><span class="string">                &lt;span&gt;<span class="subst">$&#123;item.bookname&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                &lt;span&gt;<span class="subst">$&#123;item.author&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                &lt;span&gt;<span class="subst">$&#123;item.publisher&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                &lt;/li&gt;</span></span><br><span class="line"><span class="string">                `</span></span><br><span class="line">                &#125;).join(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line"> &lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”warn” outline]get的实现步骤[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[collapse title=<span class="string">&quot;原生js的实现步骤&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span><br><span class="line">          <span class="comment">/* </span></span><br><span class="line"><span class="comment">            0：请求未初始化(还没有调用open())</span></span><br><span class="line"><span class="comment">            1：请求已经建立，但是还没有发送(还没有调用send())</span></span><br><span class="line"><span class="comment">            2：请求已经发送</span></span><br><span class="line"><span class="comment">            3：请求正在处理中，通常响应中已经有部分数据可以用了</span></span><br><span class="line"><span class="comment">            4：响应已经完成，可以获取并使用服务器的响应了</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line"><span class="number">1.</span> 创建ajax对象</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 告诉 Ajax 请求地址以及请求方式</span><br><span class="line"></span><br><span class="line">   xhr.open(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://www.example.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 发送请求</span><br><span class="line"></span><br><span class="line">   xhr.send();</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 获取服务器端给与客户端的响应数据</span><br><span class="line">    xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(xhr.responseText); <span class="comment">/* 4等于完全响应成功 */</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(xhr.responseText));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> <span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">----------</span></span><br><span class="line"><span class="string">[tag type=&quot;warn&quot; outline]post的实现步骤[/tag]</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>js</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 原生js实现post请求  404请求路径错误</span></span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        <span class="comment">// 监听事件</span></span><br><span class="line">        <span class="comment">// xhr.onreadystatechange = function () &#123;</span></span><br><span class="line">        <span class="comment">//     // 拿到服务端响应的数据</span></span><br><span class="line">        <span class="comment">//     console.log(xhr.responseText);</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.告诉ajax请求地址和请求方式</span></span><br><span class="line">        xhr.open(<span class="string">&#x27;post&#x27;</span>, <span class="string">&#x27;http://www.liulongbin.top:3006/api/addbook&#x27;</span>);</span><br><span class="line">        <span class="comment">// 设置请求头格式</span></span><br><span class="line">        xhr.setRequestHeader(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>);</span><br><span class="line">        <span class="comment">// 3.发送请求</span></span><br><span class="line">        xhr.send(<span class="string">&#x27;bookname=嘻嘻&amp;author=阿斯达克&amp;publisher=纳斯达克&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(xhr.readyState); <span class="comment">/* 4等于完全响应成功 */</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(xhr.responseText));</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”info” outline]ajax练习[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>gets<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>get<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>post<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>del<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">let</span> btns = <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;button&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// all</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        btns[<span class="number">0</span>].addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 原生js 发送aiax 获取所有数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span> &amp;&amp; (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>)) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(xhr.responseText));</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.open(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://www.liulongbin.top:3006/api/getbooks&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.send();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// one</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        btns[<span class="number">1</span>].addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 原生js 发送aiax 获取one数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">              <span class="comment">// 原生js 发送aiax del数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">              <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 2.告诉ajax请求地址和请求方式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.open(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://www.liulongbin.top:3006/api/getbooks?id=5706&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 设置请求头格式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 3.发送请求</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.send();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(xhr.readyState); <span class="comment">/* 4等于完全响应成功 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(xhr.responseText));</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// &#123;status: 200, msg: &quot;获取图书列表成功&quot;, data: Array(2)&#125;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// add</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        btns[<span class="number">2</span>].addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 原生js 发送aiax 获取所有数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// // 原生js实现post请求  404请求路径错误</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 监听事件</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// xhr.onreadystatechange = function () &#123;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">//     // 拿到服务端响应的数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">//     console.log(xhr.responseText);</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 2.告诉ajax请求地址和请求方式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.open(<span class="string">&#x27;post&#x27;</span>, <span class="string">&#x27;http://www.liulongbin.top:3006/api/addbook&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 设置请求头格式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.setRequestHeader(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 3.发送请求</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.send(<span class="string">&#x27;bookname=嘻嘻&amp;author=阿斯达克&amp;publisher=打开纳斯达克&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(xhr.readyState); <span class="comment">/* 4等于完全响应成功 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(xhr.responseText));</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// &#123;status: 200, msg: &quot;获取图书列表成功&quot;, data: Array(2)&#125;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// del</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        btns[<span class="number">3</span>].addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 原生js 发送aiax del数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 2.告诉ajax请求地址和请求方式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.open(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://www.liulongbin.top:3006/api/delbook?id=5716&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 设置请求头格式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 3.发送请求</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.send();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(xhr.readyState); <span class="comment">/* 4等于完全响应成功 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(xhr.responseText));</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// &#123;status: 200, msg: &quot;获取图书列表成功&quot;, data: Array(2)&#125;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”info” outline]express[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入express  npm i express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建应用对象</span></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"><span class="comment">// 创建路由规则</span></span><br><span class="line"><span class="comment">// request 请求报文的封装</span></span><br><span class="line"><span class="comment">// response 响应报文的封装</span></span><br><span class="line">app.get(<span class="string">&#x27;/server&#x27;</span>, <span class="function">(<span class="params">resquest, response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 设置 响应头 允许跨域</span></span><br><span class="line">    response.setHeader(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">    <span class="comment">// 响应体</span></span><br><span class="line">    response.send(<span class="string">&#x27;hello,express你好&#x27;</span>)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 监听端口</span></span><br><span class="line">app.listen(<span class="number">8000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;服务已经启动，8000端口监听中&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”danger”]编码，解码[/tag]<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> uname = <span class="string">&#x27;钟离&#x27;</span>;</span><br><span class="line">        <span class="comment">// 编码</span></span><br><span class="line">        <span class="keyword">var</span> r = <span class="built_in">encodeURIComponent</span>(uname);</span><br><span class="line">        <span class="comment">// 解码</span></span><br><span class="line">        <span class="keyword">var</span> res = <span class="built_in">decodeURIComponent</span>(r);</span><br><span class="line">        <span class="built_in">console</span>.log(r, <span class="string">&#x27;编码&#x27;</span>); <span class="comment">/* %E9%92%9F%E7%A6%BB 编码 */</span></span><br><span class="line">        <span class="built_in">console</span>.log(res, <span class="string">&#x27;解码&#x27;</span>); <span class="comment">/* 钟离 解码*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”primary” outline]hero练习[/tag]<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).keyup(<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (e.keyCode == <span class="number">13</span>) &#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;https://autumnfish.cn/api/hero/info&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: &#123; <span class="attr">name</span>: <span class="string">`<span class="subst">$&#123;$(<span class="string">&#x27;.hero&#x27;</span>).val()&#125;</span>`</span> &#125;,</span><br><span class="line">      <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        $(<span class="string">&#x27;.showname&#x27;</span>).text(data.name)</span><br><span class="line">        $(<span class="string">&#x27;.name&#x27;</span>).text(<span class="string">`名称:<span class="subst">$&#123;data.name&#125;</span>`</span>)</span><br><span class="line">        $(<span class="string">&#x27;.title&#x27;</span>).text(<span class="string">`外号：<span class="subst">$&#123;data.title&#125;</span>`</span>)</span><br><span class="line">        $(<span class="string">&#x27;.story&#x27;</span>).text(<span class="string">`简介：<span class="subst">$&#123;data.story&#125;</span>`</span>)</span><br><span class="line">        $(<span class="string">&#x27;.right&#x27;</span>).css(<span class="string">&#x27;background-image&#x27;</span>, <span class="string">`url(<span class="subst">$&#123;data.bg&#125;</span>)`</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).keyup(<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (e.keyCode == <span class="number">13</span>) &#123;</span><br><span class="line">    $.get(<span class="string">`https://autumnfish.cn/api/hero/info?name=<span class="subst">$&#123;$(<span class="string">&#x27;.hero&#x27;</span>).val()&#125;</span>`</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">      $(<span class="string">&#x27;.showname&#x27;</span>).text(data.name)</span><br><span class="line">      $(<span class="string">&#x27;.name&#x27;</span>).text(<span class="string">`名称:<span class="subst">$&#123;data.name&#125;</span>`</span>)</span><br><span class="line">      $(<span class="string">&#x27;.title&#x27;</span>).text(<span class="string">`外号：<span class="subst">$&#123;data.title&#125;</span>`</span>)</span><br><span class="line">      $(<span class="string">&#x27;.story&#x27;</span>).text(<span class="string">`简介：<span class="subst">$&#123;data.story&#125;</span>`</span>)</span><br><span class="line">      $(<span class="string">&#x27;.right&#x27;</span>).css(<span class="string">&#x27;background-image&#x27;</span>, <span class="string">`url(<span class="subst">$&#123;data.bg&#125;</span>)`</span>)</span><br><span class="line">      $(<span class="string">&#x27;.hero&#x27;</span>).val(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”info” outline]封装ajax[/tag]</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">objectToString</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> list = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">                list.push(<span class="string">`<span class="subst">$&#123;key&#125;</span>=<span class="subst">$&#123;data[key]&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> list.join(<span class="string">&#x27;&amp;&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ajax 封装</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> params = objectToString(options.data);</span><br><span class="line">            <span class="built_in">console</span>.log(params); <span class="comment">/* id=5996&amp;name=骄傲&amp;sex=男 */</span></span><br><span class="line">            <span class="comment">//  区分get ，post请求</span></span><br><span class="line">            <span class="comment">// 将type转化大写</span></span><br><span class="line">            <span class="keyword">let</span> type = options.type.toUpperCase();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">            xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span> &amp;&amp; xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">                    <span class="comment">// 将json字符串转化成json对象   JSON.parse()</span></span><br><span class="line">                    <span class="comment">// 将对象转化成对象   JSON.stringify()</span></span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(xhr.responseText));</span><br><span class="line">                    <span class="keyword">let</span> data = <span class="built_in">JSON</span>.parse(xhr.responseText)</span><br><span class="line">                    options.success(data);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 发送请求不一样，get在url地址中；post在请求参数send()</span></span><br><span class="line">            <span class="comment">// get 不需要请求头；post需要请求头</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (type == <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">                xhr.open(<span class="string">&#x27;get&#x27;</span>, <span class="string">`<span class="subst">$&#123;options.url&#125;</span>?<span class="subst">$&#123;params&#125;</span>`</span>);</span><br><span class="line">                xhr.send();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                xhr.open(<span class="string">&#x27;post&#x27;</span>, options.url);</span><br><span class="line">                <span class="comment">// 请求头</span></span><br><span class="line">                xhr.setRequestHeader(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>)</span><br><span class="line">                xhr.send(params);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ajax(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;http://www.liulongbin.top:3006/api/addbook&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: &#123;</span><br><span class="line">                <span class="attr">bookname</span>: <span class="string">&#x27;烧烤&#x27;</span>,</span><br><span class="line">                <span class="attr">author</span>: <span class="string">&#x27;dan&#x27;</span>,</span><br><span class="line">                <span class="attr">publisher</span>: <span class="string">&#x27;丹尼&#x27;</span>,</span><br><span class="line"></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(res, <span class="string">&#x27;success&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>
<hr>
<p>[tag type=”primary” outline]XHR2.0[/tag]</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1创建ajax对象  原生js实现get请求</span></span><br><span class="line">           <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">           <span class="comment">// 监听事件</span></span><br><span class="line">           <span class="comment">// xhr.onreadystatechange = function () &#123;</span></span><br><span class="line">           <span class="comment">//     // 拿到服务端响应的数据</span></span><br><span class="line">           <span class="comment">//     console.log(xhr.responseText);</span></span><br><span class="line">           <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">           <span class="comment">// 2.告诉ajax请求地址和请求方式</span></span><br><span class="line">           xhr.open(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://www.liulongbin.top:3006/api/getbooks&#x27;</span>);</span><br><span class="line">           <span class="comment">// 注意放在open，send之间</span></span><br><span class="line">           xhr.onloadstart = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">               <span class="built_in">console</span>.log(<span class="string">&#x27;之前&#x27;</span>);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="comment">// 3.发送请求</span></span><br><span class="line">           xhr.send();</span><br><span class="line">           <span class="comment">// 设置请求响应时间  单位毫秒</span></span><br><span class="line">           xhr.timeout = <span class="number">1000</span>;</span><br><span class="line">           <span class="comment">// 请求超时触发该函数</span></span><br><span class="line">           xhr.ontimeout = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">               alert(<span class="string">&#x27;刷新试试&#x27;</span>);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           xhr.onprogress = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">               <span class="built_in">console</span>.log(event);</span><br><span class="line">               <span class="built_in">console</span>.log(event.total,<span class="string">&#x27;总数据量&#x27;</span>); <span class="comment">/* 总数据量 */</span></span><br><span class="line">               <span class="built_in">console</span>.log(event.loaded,<span class="string">&#x27;已下载量&#x27;</span>); <span class="comment">/* 以完成的数据量 */</span></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           xhr.onloadend = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">               <span class="built_in">console</span>.log(<span class="string">&#x27;之后&#x27;</span>);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="comment">// 断网情况，请求失败</span></span><br><span class="line">           xhr.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">               <span class="built_in">console</span>.log(<span class="string">&#x27;是否网络连接ok&#x27;</span>);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="comment">// /* 4等于完全响应成功 */</span></span><br><span class="line">           xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">               <span class="keyword">if</span> (xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">                   <span class="built_in">console</span>.log(xhr.responseText);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;)</span><br></pre></td></tr></table></figure></h2><p>[tag type=”primary” outline]FormData[/tag]</p>
<ul>
<li><p>作用：</p>
<p>-模拟HTML表单，相当于将HTML表单映射成表单对象，自动将表单对象中的数据拼接成请求参数的格式。</p>
</li>
<li><p>异步上传二进制文件</p>
</li>
</ul>
<hr>
<p>[tag type=”info” outline]FormData 对象的实例方法[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> 获取表单对象中属性的值</span><br><span class="line"></span><br><span class="line">    formData.get(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 设置表单对象中属性的值</span><br><span class="line"></span><br><span class="line">   formData.set(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 删除表单对象中属性的值</span><br><span class="line"></span><br><span class="line">   formData.delete(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 向表单对象中追加属性值</span><br><span class="line"></span><br><span class="line">   formData.append(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>);</span><br></pre></td></tr></table></figure><br>   <strong>注意：set 方法与 append 方法的区别是，在属性名已存在的情况下，set 会覆盖已有键名的值，append会保留两个值。</strong></p>
<hr>
<p>[tag type=”warn” outline]formData练习[/tag]<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;form id=<span class="string">&quot;form&quot;</span>&gt;</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> /&gt;</span></span></span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span></span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> /&gt;</span></span></span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">var</span> form = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;form&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">var</span> btn = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;.btn&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 创建表单对象</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="keyword">var</span> formData = <span class="keyword">new</span> FormData(form);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 设置或修改表单中的属性</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            formData.set(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;你的名字&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 新增 **注意：set 方法与 append 方法的区别是，在属性名已存在的情况下，</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// set 会覆盖已有键名的值，append会保留两个值</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            formData.set(<span class="string">&#x27;uAge&#x27;</span>, <span class="string">&#x27;21&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            formData.append(<span class="string">&#x27;username&#x27;</span>,<span class="string">&#x27;我是新来的&#x27;</span>)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 设置请求方式和接口地址</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.open(<span class="string">&#x27;post&#x27;</span>, <span class="string">&#x27;http://121.5.153.184:3000/formData&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 监听事件</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="keyword">if</span> (xhr.status == <span class="number">200</span>) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(xhr.responseText));</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 发送请求</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            xhr.send(formData);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”info” outline]Mock[/tag]<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//模板来自官网 http://mockjs.com/ 前往下载</span></span><br><span class="line"> &lt;script src=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/Mock.js/1.0.1-beta3/mock.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"> <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// 相当于模拟服务器的接口</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// 参数1：接口名，参数2：返回的数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">var</span> data = Mock.mock(<span class="string">&#x27;getbooks&#x27;</span>, &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// | 代表返回1-100的随机数</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="string">&#x27;list|1-10&#x27;</span>: [&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// id|+1 ---&gt;  id每次加一</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;id|+1&#x27;</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;bookName&#x27;</span>: <span class="string">&#x27;西德斯&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// 字符串范围的长度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;]</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        $.ajax(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">url</span>: <span class="string">&#x27;getbooks&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(res));</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">var</span> data = Mock.mock(<span class="string">&#x27;getbooks&#x27;</span>, &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// | 代表返回1-100的随机数</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="string">&#x27;list|1-10&#x27;</span>: [&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// id|+1 ---&gt;  id每次加一</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;id|+1&#x27;</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;bookName&#x27;</span>: <span class="string">&#x27;西德斯&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// 字符串范围的长度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;str|1-10&#x27;</span>: <span class="string">&#x27;*&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;]</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// /* 0: &#123;id: 1, bookName: &quot;西德斯&quot;, str: &quot;******&quot;&#125;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//  1: &#123;id: 2, bookName: &quot;西德斯&quot;, str: &quot;****&quot;&#125;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//  2: &#123;id: 3, bookName: &quot;西德斯&quot;, str: &quot;*********&quot;&#125;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//  3: &#123;id: 4, bookName: &quot;西德斯&quot;, str: &quot;*********&quot;&#125;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//  4: &#123;id: 5, bookName: &quot;西德斯&quot;, str: &quot;******&quot;&#125;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//   */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        $.ajax(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">url</span>: <span class="string">&#x27;getbooks&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(res));</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">var</span> data = Mock.mock(<span class="string">&#x27;getbooks&#x27;</span>, &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// | 代表返回1-100的随机数</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="string">&#x27;list|1-10&#x27;</span>: [&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;data|1-3&#x27;</span>: Mock.Random.date(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;datas&#x27;</span>:Mock.mock(<span class="string">&#x27;@date(&quot;yyyy-MM-dd&quot;)&#x27;</span>),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;times&#x27;</span>:Mock.Random.time(<span class="string">&#x27;HH:mm:ss&#x27;</span>),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;color|1-5&#x27;</span>:Mock.mock(<span class="string">&#x27;@color&#x27;</span>),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;title&#x27;</span>:Mock.mock(<span class="string">&#x27;@cparagraph&#x27;</span>),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;name|1-10&#x27;</span>:Mock.mock(<span class="string">&#x27;@cname&#x27;</span>),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;]</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        $.ajax(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">url</span>: <span class="string">&#x27;getbooks&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(res));</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”primary” outline]fetch用法[/tag]</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//下面模板来自官网 http://www.axios-js.com/zh-cn/docs/ </span></span><br><span class="line">&lt;script src=<span class="string">&quot;https://unpkg.com/axios/dist/axios.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"> <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">         fetch(<span class="string">&#x27;http://www.liulongbin.top:3006/api/getbooks&#x27;</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="keyword">return</span> res.json();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="built_in">console</span>.log(data);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">/*  0: &#123;id: 1, bookname: &quot;西游记&quot;, author: &quot;吴承恩&quot;, publisher: &quot;北京图书出版社&quot;&#125;</span></span></span></span><br><span class="line"><span class="comment"><span class="javascript"><span class="xml">        1: &#123;id: 2, bookname: &quot;红楼梦&quot;, author: &quot;曹雪芹&quot;, publisher: &quot;上海图书出版社&quot;&#125;</span></span></span></span><br><span class="line"><span class="comment"><span class="javascript"><span class="xml">        2: &#123;id: 3, bookname: &quot;三国演义&quot;, author: &quot;罗贯中&quot;, publisher: &quot;北京图书出*/</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// add</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        fetch(<span class="string">&#x27;http://www.liulongbin.top:3006/api/addbook&#x27;</span>,&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">method</span>:<span class="string">&#x27;POST&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">body</span>:<span class="built_in">JSON</span>.stringify(&#123;<span class="attr">bookname</span>: <span class="string">&quot;西12&quot;</span>, <span class="attr">author</span>: <span class="string">&quot;吴12恩&quot;</span>, <span class="attr">publisher</span>: <span class="string">&quot;北京图书21出版社&quot;</span>&#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 被注释的是一类请求格式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// body:&#x27;bookname=&quot;西游记&quot;&amp;author=&quot;吴承恩&quot;&amp;publisher=&quot;北京图书出版社&quot;&#x27;,</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">headers</span>:<span class="keyword">new</span> Headers(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// &#x27;content-Type&#x27;:&#x27;application/x-www-form-urlencoded&#x27;,</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="string">&#x27;content-Type&#x27;</span>:<span class="string">&#x27;application/json&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="keyword">return</span> res.json();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="built_in">console</span>.log(data);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>[tag type=”success” outline=”1”]axios[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//引入连接</span></span><br><span class="line">&lt;script src=<span class="string">&quot;https://unpkg.com/axios/dist/axios.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"> <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// get 1</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        axios.get(<span class="string">&#x27;http://www.liulongbin.top:3006/api/getbooks&#x27;</span>)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            .then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(res,<span class="string">&#x27;get1&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(res.data.data[<span class="number">1</span>]);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 捕获异常</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            .catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(err);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// get  2</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        axios(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">url</span>: <span class="string">&#x27;http://www.liulongbin.top:3006/api/getbooks&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="built_in">console</span>.log(res,<span class="string">&#x27;get2&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//get3 </span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">          axios(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// url: `http://localhost:3000/cities?id=$&#123;pid&#125;`,</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">url</span>: <span class="string">&#x27;http://localhost:3000/cities&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">params</span>: &#123; <span class="attr">id</span>: pid &#125;  <span class="comment">/* get，传递参数，需用 params */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(res.data, <span class="string">&#x27;市&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(res);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// post  1</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        axios.post(<span class="string">&#x27;http://www.liulongbin.top:3006/api/addbook&#x27;</span>, &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">bookname</span>: <span class="string">&#x27;122&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">author</span>: <span class="string">&#x27;阿道夫&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">publisher</span>: <span class="string">&#x27;艾菲奖&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            .then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(res ,<span class="string">&#x27;post1&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(res.data.data[<span class="number">1</span>]);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="comment">// 捕获异常</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            .catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">console</span>.log(err);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// post  2</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        axios(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">url</span>: <span class="string">&#x27;http://www.liulongbin.top:3006/api/addbook&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">data</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">bookname</span>: <span class="string">&#x27;阿凡达&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">author</span>: <span class="string">&#x27;阿道夫&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">publisher</span>: <span class="string">&#x27;艾菲奖&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="built_in">console</span>.log(res,<span class="string">&#x27;post2&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”primary” outline]模板引擎[/tag]</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">模板官网地址：https:<span class="comment">//aui.github.io/art-template/zh-cn/index.html</span></span><br><span class="line">CDN： &lt;script src=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/art-template/4.13.2/lib/template-web.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;con&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &lt;!--<span class="number">1</span> 模板引擎 --&gt;</span><br><span class="line">    &lt;!-- html的写入，模板的唯一标识 --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- <span class="number">2</span>准备art-template模板 --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;tpl&quot;</span>&gt;</span><span class="handlebars"><span class="xml"></span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">username</span>&#125;&#125;</span><span class="xml">-</span><span class="template-variable">&#123;&#123;<span class="name">age</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"><span class="xml">    </span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&#x27;text/javascript&#x27;</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// 3告诉渲染引擎那个数据和那个模板进行拼接 template(),</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// 参数1 id，参数2 对象类型  返回值 拼接好的自己字符串</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">var</span> ht = template(<span class="string">&#x27;tpl&#x27;</span>, &#123; <span class="attr">username</span>: <span class="string">&#x27;发送请求&#x27;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="built_in">console</span>.log(ht);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// 4渲染页面</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        con.innerHTML = ht;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;con&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &lt;!--<span class="number">1</span> 模板引擎 --&gt;</span><br><span class="line">    &lt;!-- html的写入，模板的唯一标识 --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- <span class="number">2</span>准备art-template模板 --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;tpl&quot;</span>&gt;</span><span class="handlebars"><span class="xml"></span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"><span class="xml">        </span><span class="template-variable">&#123;&#123;<span class="name"><span class="builtin-name">each</span></span> list&#125;&#125;</span><span class="xml"></span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"><span class="xml">        <span class="comment">&lt;!-- index---下标    value -- 值--&gt;</span></span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"><span class="xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">$index</span>&#125;&#125;</span><span class="xml">----</span><span class="template-variable">&#123;&#123;<span class="name">$value</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"><span class="xml">        </span><span class="template-tag">&#123;&#123;/<span class="name"><span class="builtin-name">each</span></span>&#125;&#125;</span><span class="xml"></span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars"><span class="xml">    </span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&#x27;text/javascript&#x27;</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// 3告诉渲染引擎那个数据和那个模板进行拼接 template(),</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// 参数1 id，参数2 对象类型  返回值 拼接好的自己字符串</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">var</span> data = &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">list</span>: [<span class="string">&#x27;萨迦&#x27;</span>, <span class="string">&#x27;迪斯&#x27;</span>,<span class="number">1</span>,<span class="number">213</span>,<span class="string">&#x27;free&#x27;</span>]</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">var</span> ht = template(<span class="string">&#x27;tpl&#x27;</span>, data);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="built_in">console</span>.log(ht);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// 4渲染页面</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        con.innerHTML = ht;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>[tag type=”info”]git常用命令[/tag]</p>
<ul>
<li>初始化</li>
<li>git init    初始化配置，此时会出现一个隐藏的文件（.git）</li>
<li>git config —global user.name “xxx”    配置用户名</li>
<li>git config —global user.email “xxx@XXX.com”   配置邮箱<br>[tag type=”info” outline]查看状态[/tag]</li>
<li>git status    查看当前版本状态（是否修改）</li>
<li>git add .    增加当前的更改过的文件   提交到暂存区</li>
<li>git commit -m  “提交仓库”  并加以注释</li>
<li>git commit —amend -m “XXX”   合并提交，</li>
<li>pwd 查看此时在那个文件夹中<br>[tag type=”primary” outline]查看记录[/tag]</li>
<li>git log -n 查看最近n次的提价</li>
<li>git log —oneloine   单行查看简陋版日志</li>
<li>git —reflog —oneline   简陋日志</li>
<li>git relong  查看当前版本之后的日志，包括版本回退的记录</li>
<li>git log   查看当前的日志，不包括版本回退的记录</li>
<li>git reset —hard  版本号     回退当前的版本号，</li>
<li>新增文件  each  测试&gt;demo.txt    此时文件会多出此文件，内容为测试</li>
<li>cat demo.txt   查看demo.txt的内容</li>
<li>vi demo.txt   进入vi编辑器<br>[tag type=”info” outline]上传本地文件至GitHub[/tag]</li>
<li>1 首先右键你的项目，如果安装git成功，右键会出现两个新的选项，Git Gui Here ，Git Bash Here ，选择后者</li>
<li>2 把github上面的仓库克隆到本地，  git clone 仓库地址</li>
<li>3 此时会多出一个文件夹，把需要上传的文件复制到此文件夹</li>
<li>4 输入 cd  此文件夹的名字 ，进入此文件夹</li>
<li>5 输入命令 git add .   注意点号，不能省略，此操作是把修改的内容添加进来</li>
<li>6 输入 git commit -m  “提交信息”   （项目的说明）</li>
<li>7 若出现 **Please tell me who you are ,说明没有配置用户，配置用户命令即可，再次执行第6步</li>
<li>8 最后 git push -u origin master  (把本地仓库上传至github，需要输入密码)；<br>[tag type=”primary” outline]配置SSH[/tag]</li>
<li>1  ssh-keygen -t rsa -C “your email”</li>
<li>1.01 在Enter file in which to save the key (中时配置好的文件地址);</li>
<li>1.02 后缀为.pub 是生成后的密钥；</li>
<li>1.03打开github 点击头像选择Settings， 点击 SSH and GPG keys，在key中输入生成的密钥，</li>
<li>1.1  输入  $ ssh -T git@github.com  注意不是你的邮箱    在输入 yes </li>
<li>1.2 若出现 Hi freeXXXXX! You’ve successfully authenticated, but GitHub does not provide shell access.</li>
<li>1.3 证明成功</li>
<li>1.4 若出现 Hi “用户名” You’ve successfully ‘github.com does not provide shell access.</li>
<li>1.5 需要使用https访问</li>
<li>2 在管理git项目中，有两种克隆的方式</li>
<li>2.1 直接使用https url 克隆；  使用SSH url 克隆</li>
<li>2.2  前者需要每次输入密码，后者只需要一次<br>[tag type=”success” outline=”1”]删除github中的文件，而不是库[/tag]</li>
<li>1.进入本地仓库的master文件夹下，右键命令 Git Bash Here ，</li>
<li>2.git pull origin master  将远程仓库的项目拉取下来</li>
<li>3.dir  查看文件夹</li>
<li>4.git rm -r —cached 删除的文件名</li>
<li>5.git commit -m “添加删除的说明”</li>
<li>6.git push </li>
<li>删除时远程仓库的内容，跟本地没有任何关系</li>
<li><strong>注意每次增加文件或删除文件，都要先commit。然后再git push，就可以同步github</strong><br>[tag type=”danger” outline]远程仓库[/tag]</li>
<li>查看远程仓库别名, git remote</li>
<li>移出仓库别名 ， git remote remove  仓库别名</li>
<li>将远程仓库关联到本地  git remote add origin 地址<br>[tag type=”info” outline]分支[/tag]</li>
<li>分支就是当前项目的一个副本，（可以这样理解，但事实并不是如此）</li>
<li>初始化之后，git默认创建了一个master（主）分支，不允许在master开发，在其下的分支开发，对外开发（发布时合并），</li>
<li>git branch  查看本地所有分支</li>
<li>删除本地分支b,(合并过的分支)    git branch -d b </li>
<li>若出现提示内容，证明修改过没有合并</li>
<li>git branch -D d ，   强制删除，即使有修改，不会提醒，强制删除分支</li>
<li>删除远程分支a，     git push origin —delete a     </li>
<li>git branch  dev  创建新分支dev  * 表示当前所在的分支</li>
<li>切换分支  git checkout 分支名</li>
<li>创建同时切换分支（基于master),git checkout -b ‘分支名’</li>
<li>将dev的所有代码合并到master分支     git merge dev   前提是切回master分支</li>
<li>冲突现象：多人修改同一份代码，共同商议保留合并  冲突（CONFLICT:冲突文件）</li>
<li>git branch -av   查看本地和远程所有分支</li>
<li>分支合并1 ，快进合并：(fast )</li>
<li>两个分支a，b。基于a创建b分支，a分支不做任何更改，在b分支新增内容，将b合并到a分支。</li>
<li>分支合并2，三方合并：</li>
<li><img src="https://freelaeder.cn/usr/themes/Mirages/images/default/img/hebing.png" alt="三方合并"><br>[tag type=”primary” outline]深入[/tag]</li>
<li>快速查找SSH，</li>
<li>vim ~/.ssh/   查看文件目录</li>
<li>vim ~/.ssh/id_rsa.pub   查看内容</li>
<li>配置别名</li>
<li>vim ~/.gitconfig，进入命令</li>
<li>添加[alias] cm = commit; 替换别名</li>
<li>忽略上传文件</li>
<li>在文件根目录加入配置文件[.gitignore]  内容—-&gt;node_modules</li>
<li>git可视化</li>
<li>git gui 进入命令</li>
</ul>
]]></content>
      <categories>
        <category>ajax</category>
      </categories>
      <tags>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>animation</title>
    <url>/archives/8d5284dc.html</url>
    <content><![CDATA[<h1 id="面试官：css3动画有哪些？"><a href="#面试官：css3动画有哪些？" class="headerlink" title="面试官：css3动画有哪些？"></a>面试官：css3动画有哪些？</h1><p> <img src="https://static.vue-js.com/d12e2380-9c0a-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>CSS动画（CSS Animations）是为层叠样式表建议的允许可扩展标记语言（XML）元素使用CSS的动画的模块</p>
<p>即指元素从一种样式逐渐过渡为另一种样式的过程</p>
<p>常见的动画效果有很多，如平移、旋转、缩放等等，复杂动画则是多个简单动画的组合</p>
<p><code>css</code>实现动画的方式，有如下几种：</p>
<ul>
<li>transition 实现渐变动画</li>
<li>transform 转变动画</li>
<li>animation 实现自定义动画</li>
</ul>
<h2 id="二、实现方式"><a href="#二、实现方式" class="headerlink" title="二、实现方式"></a>二、实现方式</h2><h3 id="transition-实现渐变动画"><a href="#transition-实现渐变动画" class="headerlink" title="transition 实现渐变动画"></a>transition 实现渐变动画</h3><p><code>transition</code>的属性如下：</p>
<ul>
<li>property:填写需要变化的css属性</li>
<li>duration:完成过渡效果需要的时间单位(s或者ms)</li>
<li>timing-function:完成效果的速度曲线</li>
<li>delay: 动画效果的延迟触发时间</li>
</ul>
<p>其中<code>timing-function</code>的值有如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>linear</td>
<td>匀速（等于 cubic-bezier(0,0,1,1)）</td>
</tr>
<tr>
<td>ease</td>
<td>从慢到快再到慢（cubic-bezier(0.25,0.1,0.25,1)）</td>
</tr>
<tr>
<td>ease-in</td>
<td>慢慢变快（等于 cubic-bezier(0.42,0,1,1)）</td>
</tr>
<tr>
<td>ease-out</td>
<td>慢慢变慢（等于 cubic-bezier(0,0,0.58,1)）</td>
</tr>
<tr>
<td>ease-in-out</td>
<td>先变快再到慢（等于 cubic-bezier(0.42,0,0.58,1)），渐显渐隐效果</td>
</tr>
<tr>
<td>cubic-bezier(<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>)</td>
<td>在 cubic-bezier 函数中定义自己的值。可能的值是 0 至 1 之间的数值</td>
</tr>
</tbody>
</table>
</div>
<p>注意：并不是所有的属性都能使用过渡的，如<code>display:none&lt;-&gt;display:block</code></p>
<p>举个例子，实现鼠标移动上去发生变化动画效果</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">       <span class="selector-class">.base</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-color</span>: <span class="number">#0EA9FF</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">border-width</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">border-style</span>: solid;</span></span><br><span class="line"><span class="css">            <span class="attribute">border-color</span>: <span class="number">#5daf34</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">transition-property</span>: width, height, background-color, border-width;</span></span><br><span class="line"><span class="css">            <span class="attribute">transition-duration</span>: <span class="number">2s</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">transition-timing-function</span>: ease-in;</span></span><br><span class="line"><span class="css">            <span class="attribute">transition-delay</span>: <span class="number">500ms</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="comment">/*简写*/</span></span></span><br><span class="line"><span class="css">        <span class="comment">/*transition: all 2s ease-in 500ms;*/</span></span></span><br><span class="line"><span class="css">        <span class="selector-class">.base</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-color</span>: <span class="number">#5daf34</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">border-width</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">border-color</span>: <span class="number">#3a8ee6</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;base&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="transform-转变动画"><a href="#transform-转变动画" class="headerlink" title="transform 转变动画"></a>transform 转变动画</h3><p>包含四个常用的功能：</p>
<ul>
<li>translate：位移</li>
<li>scale：缩放</li>
<li>rotate：旋转</li>
<li>skew：倾斜</li>
</ul>
<p>一般配合<code>transition</code>过度使用</p>
<p>注意的是，<code>transform</code>不支持<code>inline</code>元素，使用前把它变成<code>block</code></p>
<p>举个例子</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.base</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="css">        <span class="attribute">background-color</span>: <span class="number">#0EA9FF</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">border-width</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">border-style</span>: solid;</span></span><br><span class="line"><span class="css">        <span class="attribute">border-color</span>: <span class="number">#5daf34</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">transition-property</span>: width, height, background-color, border-width;</span></span><br><span class="line"><span class="css">        <span class="attribute">transition-duration</span>: <span class="number">2s</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">transition-timing-function</span>: ease-in;</span></span><br><span class="line"><span class="css">        <span class="attribute">transition-delay</span>: <span class="number">500ms</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.base2</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">transform</span>: none;</span></span><br><span class="line"><span class="css">        <span class="attribute">transition-property</span>: transform;</span></span><br><span class="line"><span class="css">        <span class="attribute">transition-delay</span>: <span class="number">5ms</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.base2</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.8</span>, <span class="number">1.5</span>) <span class="built_in">rotate</span>(<span class="number">35deg</span>) <span class="built_in">skew</span>(<span class="number">5deg</span>) <span class="built_in">translate</span>(<span class="number">15px</span>, <span class="number">25px</span>);</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;base base2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以看到盒子发生了旋转，倾斜，平移，放大</p>
<h3 id="animation-实现自定义动画"><a href="#animation-实现自定义动画" class="headerlink" title="animation 实现自定义动画"></a>animation 实现自定义动画</h3><p><code>animation</code>是由 8 个属性的简写，分别如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
<th>属性值</th>
</tr>
</thead>
<tbody>
<tr>
<td>animation-duration</td>
<td>指定动画完成一个周期所需要时间，单位秒（s）或毫秒（ms），默认是 0</td>
<td></td>
</tr>
<tr>
<td>animation-timing-function</td>
<td>指定动画计时函数，即动画的速度曲线，默认是 “ease”</td>
<td>linear、ease、ease-in、ease-out、ease-in-out</td>
</tr>
<tr>
<td>animation-delay</td>
<td>指定动画延迟时间，即动画何时开始，默认是 0</td>
<td></td>
</tr>
<tr>
<td>animation-iteration-count</td>
<td>指定动画播放的次数，默认是 1</td>
<td></td>
</tr>
<tr>
<td>animation-direction 指定动画播放的方向</td>
<td>默认是 normal</td>
<td>normal、reverse、alternate、alternate-reverse</td>
</tr>
<tr>
<td>animation-fill-mode</td>
<td>指定动画填充模式。默认是 none</td>
<td>forwards、backwards、both</td>
</tr>
<tr>
<td>animation-play-state</td>
<td>指定动画播放状态，正在运行或暂停。默认是 running</td>
<td>running、pauser</td>
</tr>
<tr>
<td>animation-name</td>
<td>指定 @keyframes 动画的名称</td>
</tr>
</tbody>
</table>
</div>
<p><code>CSS</code> 动画只需要定义一些关键的帧，而其余的帧，浏览器会根据计时函数插值计算出来，</p>
<p>通过 <code>@keyframes</code> 来定义关键帧</p>
<p>因此，如果我们想要让元素旋转一圈，只需要定义开始和结束两帧即可：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> rotate&#123;</span><br><span class="line">    <span class="selector-tag">from</span>&#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span>&#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>from</code> 表示最开始的那一帧，<code>to</code> 表示结束时的那一帧</p>
<p>也可以使用百分比刻画生命周期</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> rotate&#123;</span><br><span class="line">    <span class="number">0%</span>&#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50%</span>&#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">180deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span>&#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>定义好了关键帧后，下来就可以直接用它了：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">animation</span>: rotate <span class="number">2s</span>;</span><br></pre></td></tr></table></figure>
<h2 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h2><div class="table-container">
<table>
<thead>
<tr>
<th>属性</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>transition（过度）</td>
<td>用于设置元素的样式过度，和animation有着类似的效果，但细节上有很大的不同</td>
</tr>
<tr>
<td>transform（变形）</td>
<td>用于元素进行旋转、缩放、移动或倾斜，和设置样式的动画并没有什么关系，就相当于color一样用来设置元素的“外表”</td>
</tr>
<tr>
<td>translate（移动）</td>
<td>只是transform的一个属性值，即移动</td>
</tr>
<tr>
<td>animation（动画）</td>
<td>用于设置动画属性，他是一个简写的属性，包含6个属性</td>
</tr>
</tbody>
</table>
</div>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://segmentfault.com/a/1190000022540857">https://segmentfault.com/a/1190000022540857</a></li>
<li><a href="https://zh.m.wikipedia.org/wiki/CSS%E5%8A%A8%E7%94%BB">https://zh.m.wikipedia.org/wiki/CSS%E5%8A%A8%E7%94%BB</a></li>
<li><a href="https://vue3js.cn/interview">https://vue3js.cn/interview</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>bind_call_apply</title>
    <url>/archives/17a85756.html</url>
    <content><![CDATA[<h1 id="面试官：bind、call、apply-区别？如何实现一个bind"><a href="#面试官：bind、call、apply-区别？如何实现一个bind" class="headerlink" title="面试官：bind、call、apply 区别？如何实现一个bind?"></a>面试官：bind、call、apply 区别？如何实现一个bind?</h1><p> <img src="https://static.vue-js.com/a900e460-7be4-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、作用"><a href="#一、作用" class="headerlink" title="一、作用"></a>一、作用</h2><p><code>call</code>、<code>apply</code>、<code>bind</code>作用是改变函数执行时的上下文，简而言之就是改变函数运行时的<code>this</code>指向</p>
<p>那么什么情况下需要改变<code>this</code>的指向呢？下面举个例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">&quot;lucy&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;martin&quot;</span>,</span><br><span class="line">    <span class="attr">say</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.say(); <span class="comment">// martin，this 指向 obj 对象</span></span><br><span class="line"><span class="built_in">setTimeout</span>(obj.say,<span class="number">0</span>); <span class="comment">// lucy，this 指向 window 对象</span></span><br></pre></td></tr></table></figure>
<p>从上面可以看到，正常情况<code>say</code>方法输出<code>martin</code></p>
<p>但是我们把<code>say</code>放在<code>setTimeout</code>方法中，在定时器中是作为回调函数来执行的，因此回到主栈执行时是在全局执行上下文的环境中执行的，这时候<code>this</code>指向<code>window</code>，所以输出<code>lucy</code></p>
<p>我们实际需要的是<code>this</code>指向<code>obj</code>对象，这时候就需要该改变<code>this</code>指向了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(obj.say.bind(obj),<span class="number">0</span>); <span class="comment">//martin，this指向obj对象</span></span><br></pre></td></tr></table></figure>
<h2 id="二、区别"><a href="#二、区别" class="headerlink" title="二、区别"></a>二、区别</h2><p>下面再来看看<code>apply</code>、<code>call</code>、<code>bind</code>的使用</p>
<h3 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h3><p><code>apply</code>接受两个参数，第一个参数是<code>this</code>的指向，第二个参数是函数接受的参数，以数组的形式传入</p>
<p>改变<code>this</code>指向后原函数会立即执行，且此方法只是临时改变<code>this</code>指向一次</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">...args</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>,args);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">myname</span>:<span class="string">&quot;张三&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fn.apply(obj,[<span class="number">1</span>,<span class="number">2</span>]); <span class="comment">// this会变成传入的obj，传入的参数必须是一个数组；</span></span><br><span class="line">fn(<span class="number">1</span>,<span class="number">2</span>) <span class="comment">// this指向window</span></span><br></pre></td></tr></table></figure>
<p>当第一个参数为<code>null</code>、<code>undefined</code>的时候，默认指向<code>window</code>(在浏览器中)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">fn.apply(<span class="literal">null</span>,[<span class="number">1</span>,<span class="number">2</span>]); <span class="comment">// this指向window</span></span><br><span class="line">fn.apply(<span class="literal">undefined</span>,[<span class="number">1</span>,<span class="number">2</span>]); <span class="comment">// this指向window</span></span><br></pre></td></tr></table></figure>
<h3 id="call"><a href="#call" class="headerlink" title="call"></a>call</h3><p><code>call</code>方法的第一个参数也是<code>this</code>的指向，后面传入的是一个参数列表</p>
<p>跟<code>apply</code>一样，改变<code>this</code>指向后原函数会立即执行，且此方法只是临时改变<code>this</code>指向一次</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">...args</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>,args);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">myname</span>:<span class="string">&quot;张三&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fn.call(obj,<span class="number">1</span>,<span class="number">2</span>); <span class="comment">// this会变成传入的obj，传入的参数必须是一个数组；</span></span><br><span class="line">fn(<span class="number">1</span>,<span class="number">2</span>) <span class="comment">// this指向window</span></span><br></pre></td></tr></table></figure>
<p>同样的，当第一个参数为<code>null</code>、<code>undefined</code>的时候，默认指向<code>window</code>(在浏览器中)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">fn.call(<span class="literal">null</span>,[<span class="number">1</span>,<span class="number">2</span>]); <span class="comment">// this指向window</span></span><br><span class="line">fn.call(<span class="literal">undefined</span>,[<span class="number">1</span>,<span class="number">2</span>]); <span class="comment">// this指向window</span></span><br></pre></td></tr></table></figure>
<h3 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h3><p>bind方法和call很相似，第一参数也是<code>this</code>的指向，后面传入的也是一个参数列表(但是这个参数列表可以分多次传入)</p>
<p>改变<code>this</code>指向后不会立即执行，而是返回一个永久改变<code>this</code>指向的函数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">...args</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>,args);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">myname</span>:<span class="string">&quot;张三&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bindFn = fn.bind(obj); <span class="comment">// this 也会变成传入的obj ，bind不是立即执行需要执行一次</span></span><br><span class="line">bindFn(<span class="number">1</span>,<span class="number">2</span>) <span class="comment">// this指向obj</span></span><br><span class="line">fn(<span class="number">1</span>,<span class="number">2</span>) <span class="comment">// this指向window</span></span><br></pre></td></tr></table></figure>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>从上面可以看到，<code>apply</code>、<code>call</code>、<code>bind</code>三者的区别在于：</p>
<ul>
<li>三者都可以改变函数的<code>this</code>对象指向</li>
<li>三者第一个参数都是<code>this</code>要指向的对象，如果如果没有这个参数或参数为<code>undefined</code>或<code>null</code>，则默认指向全局<code>window</code></li>
<li>三者都可以传参，但是<code>apply</code>是数组，而<code>call</code>是参数列表，且<code>apply</code>和<code>call</code>是一次性传入参数，而<code>bind</code>可以分为多次传入</li>
<li><code>bind</code>是返回绑定this之后的函数，<code>apply</code>、<code>call</code> 则是立即执行 </li>
</ul>
<h2 id="三、实现"><a href="#三、实现" class="headerlink" title="三、实现"></a>三、实现</h2><p>实现<code>bind</code>的步骤，我们可以分解成为三部分：</p>
<ul>
<li>修改<code>this</code>指向</li>
<li>动态传递参数</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 方式一：只在bind中传递函数参数</span></span><br><span class="line">fn.bind(obj,<span class="number">1</span>,<span class="number">2</span>)()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式二：在bind中传递函数参数，也在返回函数中传递参数</span></span><br><span class="line">fn.bind(obj,<span class="number">1</span>)(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>兼容<code>new</code>关键字</li>
</ul>
<p>整体实现代码如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myBind = <span class="function"><span class="keyword">function</span> (<span class="params">context</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 判断调用对象是否为函数</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">this</span> !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取参数</span></span><br><span class="line">    <span class="keyword">const</span> args = [...arguments].slice(<span class="number">1</span>),</span><br><span class="line">          fn = <span class="built_in">this</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">Fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据调用方式，传入不同绑定值</span></span><br><span class="line">        <span class="keyword">return</span> fn.apply(<span class="built_in">this</span> <span class="keyword">instanceof</span> Fn ? <span class="keyword">new</span> fn(...arguments) : context, args.concat(...arguments)); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>bind_call_apply</tag>
      </tags>
  </entry>
  <entry>
    <title>box</title>
    <url>/archives/8a9483a.html</url>
    <content><![CDATA[<h1 id="CSS面试系列"><a href="#CSS面试系列" class="headerlink" title="CSS面试系列"></a>CSS面试系列</h1><h2 id="1-盒子模型"><a href="#1-盒子模型" class="headerlink" title="1.盒子模型"></a>1.盒子模型</h2><p><img src="https://static.vue-js.com/8d0e9ca0-8f9b-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="1-概念"><a href="#1-概念" class="headerlink" title="1.概念"></a>1.概念</h3><p>当对一个文档进行布局（layout）的时候，浏览器的渲染引擎会根据标准之一的 CSS 基础框盒模型（CSS basic box model），将所有元素表示为一个个矩形的盒子（box）</p>
<p>一个盒子由四个部分组成：<code>content</code>、<code>padding</code>、<code>border</code>、<code>margin</code></p>
<p><code>content</code>，即实际内容，显示文本和图像</p>
<p><code>boreder</code>，即边框，围绕元素内容的内边距的一条或多条线，由粗细、样式、颜色三部分组成</p>
<p><code>padding</code>，即内边距，清除内容周围的区域，内边距是透明的，取值不能为负，受盒子的<code>background</code>属性影响</p>
<p><code>margin</code>，即外边距，在元素外创建额外的空白，空白通常指不能放其他元素的区域</p>
<p>下面来段代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">  盒子模型</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当我们在浏览器查看元素时，却发现元素的大小变成了<code>240px</code></p>
<p>这是因为，在<code>CSS</code>中，盒子模型可以分成：</p>
<ul>
<li>W3C 标准盒子模型</li>
<li>IE 怪异盒子模型</li>
</ul>
<p>默认情况下，盒子模型为<code>W3C</code> 标准盒子模型</p>
<h3 id="2-标准盒子模型"><a href="#2-标准盒子模型" class="headerlink" title="2.标准盒子模型"></a>2.标准盒子模型</h3><p>标准盒子模型，是浏览器默认的盒子模型</p>
<ul>
<li><p>盒子总宽度 = width + padding + border + margin;</p>
</li>
<li><p>盒子总高度 = height + padding + border + margin</p>
</li>
</ul>
<p>也就是，<code>width/height</code> 只是内容高度，不包含 <code>padding</code> 和 <code>border</code>值</p>
<p>所以上面问题中，设置<code>width</code>为200px，但由于存在<code>padding</code>，但实际上盒子的宽度有240px</p>
<h3 id="3-IE-怪异盒子模型"><a href="#3-IE-怪异盒子模型" class="headerlink" title="3.IE 怪异盒子模型"></a>3.IE 怪异盒子模型</h3><ul>
<li><p>盒子总宽度 = width </p>
</li>
<li><p>盒子总高度 = height </p>
</li>
</ul>
<p>也就是，<code>width/height</code> 包含了 <code>padding</code>和 <code>border</code>值</p>
<h3 id="4-Box-sizing"><a href="#4-Box-sizing" class="headerlink" title="4.Box-sizing"></a>4.Box-sizing</h3><p>CSS 中的 box-sizing 属性定义了引擎应该如何计算一个元素的总宽度和总高度</p>
<p>语法：<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">box-sizing</span>: content-box|border-box|inherit:</span><br></pre></td></tr></table></figure></p>
<ul>
<li>content-box 默认值，元素的 width/height 不包含padding，border，与标准盒子模型表现一致</li>
<li>border-box 元素的 width/height 包含 padding，border，与怪异盒子模型表现一致</li>
<li>inherit 指定 box-sizing 属性的值，应该从父元素继承</li>
</ul>
<p>回到上面的例子里，设置盒子为 border-box 模型</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">  盒子模型</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这时候，就可以发现盒子的所占据的宽度为200px</p>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>box</tag>
      </tags>
  </entry>
  <entry>
    <title>cache</title>
    <url>/archives/41476be7.html</url>
    <content><![CDATA[<h1 id="面试官：Javascript-本地存储的方式有哪些？区别及应用场景？"><a href="#面试官：Javascript-本地存储的方式有哪些？区别及应用场景？" class="headerlink" title="面试官：Javascript 本地存储的方式有哪些？区别及应用场景？"></a>面试官：Javascript 本地存储的方式有哪些？区别及应用场景？</h1><p><img src="https://static.vue-js.com/68dccf20-849f-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、方式"><a href="#一、方式" class="headerlink" title="一、方式"></a>一、方式</h2><p><code>javaScript</code>本地缓存的方法我们主要讲述以下四种：</p>
<ul>
<li>cookie</li>
<li>sessionStorage</li>
<li>localStorage</li>
<li>indexedDB</li>
</ul>
<h3 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h3><p><code>Cookie</code>，类型为「小型文本文件」，指某些网站为了辨别用户身份而储存在用户本地终端上的数据。是为了解决 <code>HTTP</code>无状态导致的问题</p>
<p>作为一段一般不超过 4KB 的小型文本数据，它由一个名称（Name）、一个值（Value）和其它几个用于控制 <code>cookie</code>有效期、安全性、使用范围的可选属性组成</p>
<p>但是<code>cookie</code>在每次请求中都会被发送，如果不使用 <code>HTTPS</code>并对其加密，其保存的信息很容易被窃取，导致安全风险。举个例子，在一些使用 <code>cookie</code>保持登录态的网站上，如果 <code>cookie</code>被窃取，他人很容易利用你的 <code>cookie</code>来假扮成你登录网站</p>
<p>关于<code>cookie</code>常用的属性如下：</p>
<ul>
<li>Expires 用于设置 Cookie 的过期时间</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Expires=Wed, <span class="number">21</span> Oct <span class="number">2015</span> <span class="number">07</span>:<span class="number">28</span>:<span class="number">00</span> GMT</span><br></pre></td></tr></table></figure>
<ul>
<li>Max-Age 用于设置在 Cookie 失效之前需要经过的秒数（优先级比<code>Expires</code>高）</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Max-Age=<span class="number">604800</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>Domain</code>指定了 <code>Cookie</code> 可以送达的主机名</li>
<li><code>Path</code>指定了一个 <code>URL</code>路径，这个路径必须出现在要请求的资源的路径中才可以发送 <code>Cookie</code> 首部</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Path=<span class="regexp">/docs   # /</span>docs/Web/ 下的资源会带 Cookie 首部</span><br></pre></td></tr></table></figure>
<ul>
<li>标记为 <code>Secure</code>的 <code>Cookie</code>只应通过被<code>HTTPS</code>协议加密过的请求发送给服务端</li>
</ul>
<p>通过上述，我们可以看到<code>cookie</code>又开始的作用并不是为了缓存而设计出来，只是借用了<code>cookie</code>的特性实现缓存</p>
<p>关于<code>cookie</code>的使用如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="string">&quot;名字=值&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>关于<code>cookie</code>的修改，首先要确定<code>domain</code>和<code>path</code>属性都是相同的才可以，其中有一个不同得时候都会创建出一个新的<code>cookie</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Set</span>-Cookie:name=aa; domain=aa.net; path=/  # 服务端设置</span><br><span class="line"><span class="built_in">document</span>.cookie =name=bb; domain=aa.net; path=/  # 客户端设置</span><br></pre></td></tr></table></figure>
<p>最后<code>cookie</code>的删除，最常用的方法就是给<code>cookie</code>设置一个过期的事件，这样<code>cookie</code>过期后会被浏览器删除</p>
<h3 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h3><p><code>HTML5</code>新方法，IE8 及以上浏览器都兼容</p>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li>生命周期：持久化的本地存储，除非主动删除数据，否则数据是永远不会过期的</li>
<li>存储的信息在同一域中是共享的</li>
<li>当本页操作（新增、修改、删除）了<code>localStorage</code>的时候，本页面不会触发<code>storage</code>事件,但是别的页面会触发<code>storage</code>事件。</li>
<li>大小：5M（跟浏览器厂商有关系）</li>
<li><code>localStorage</code>本质上是对字符串的读取，如果存储内容多的话会消耗内存空间，会导致页面变卡</li>
<li>受同源策略的限制</li>
</ul>
<p>下面再看看关于<code>localStorage</code>的使用</p>
<p>设置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">localStorage</span>.setItem(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;cfangxu&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>获取</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">localStorage</span>.getItem(<span class="string">&quot;username&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>获取键名</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">localStorage</span>.key(<span class="number">0</span>); <span class="comment">//获取第一个键名</span></span><br></pre></td></tr></table></figure>
<p>删除</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">localStorage</span>.removeItem(<span class="string">&quot;username&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>一次性清除所有存储</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">localStorage</span>.clear();</span><br></pre></td></tr></table></figure>
<p><code>localStorage</code> 也不是完美的，它有两个缺点：</p>
<ul>
<li>无法像<code>Cookie</code>一样设置过期时间</li>
<li>只能存入字符串，无法直接存对象</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">localStorage</span>.setItem(<span class="string">&quot;key&quot;</span>, &#123; <span class="attr">name</span>: <span class="string">&quot;value&quot;</span> &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">localStorage</span>.getItem(<span class="string">&quot;key&quot;</span>)); <span class="comment">// &#x27;[object, Object]&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="sessionStorage"><a href="#sessionStorage" class="headerlink" title="sessionStorage"></a>sessionStorage</h3><p><code>sessionStorage</code>和 <code>localStorage</code>使用方法基本一致，唯一不同的是生命周期，一旦页面（会话）关闭，<code>sessionStorage</code> 将会删除数据</p>
<h3 id="扩展的前端存储方式"><a href="#扩展的前端存储方式" class="headerlink" title="扩展的前端存储方式"></a>扩展的前端存储方式</h3><p><code>indexedDB</code>是一种低级 API，用于客户端存储大量结构化数据(包括, 文件/ blobs)。该 API 使用索引来实现对该数据的高性能搜索</p>
<p>虽然 <code>Web Storage</code>对于存储较少量的数据很有用，但对于存储更大量的结构化数据来说，这种方法不太有用。<code>IndexedDB</code>提供了一个解决方案</p>
<h4 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h4><ul>
<li>储存量理论上没有上限</li>
<li>所有操作都是异步的，相比 <code>LocalStorage</code> 同步操作性能更高，尤其是数据量较大时</li>
<li>原生支持储存<code>JS</code>的对象</li>
<li>是个正经的数据库，意味着数据库能干的事它都能干</li>
</ul>
<h4 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h4><ul>
<li>操作非常繁琐</li>
<li>本身有一定门槛</li>
</ul>
<p>关于<code>indexedDB</code>的使用基本使用步骤如下：</p>
<ul>
<li><p>打开数据库并且开始一个事务</p>
</li>
<li><p>创建一个 <code>object store</code></p>
</li>
<li>构建一个请求来执行一些数据库操作，像增加或提取数据等。</li>
<li>通过监听正确类型的 <code>DOM</code> 事件以等待操作完成。</li>
<li>在操作结果上进行一些操作（可以在 <code>request</code>对象中找到）</li>
</ul>
<p>关于使用<code>indexdb</code>的使用会比较繁琐，大家可以通过使用<code>Godb.js</code>库进行缓存，最大化的降低操作难度</p>
<h2 id="二、区别"><a href="#二、区别" class="headerlink" title="二、区别"></a>二、区别</h2><p>关于<code>cookie</code>、<code>sessionStorage</code>、<code>localStorage</code>三者的区别主要如下：</p>
<ul>
<li><p>存储大小：<code>cookie</code>数据大小不能超过<code>4k</code>，<code>sessionStorage</code>和<code>localStorage</code>虽然也有存储大小的限制，但比<code>cookie</code>大得多，可以达到 5M 或更大</p>
</li>
<li><p>有效时间：<code>localStorage</code>存储持久数据，浏览器关闭后数据不丢失除非主动删除数据； <code>sessionStorage</code>数据在当前浏览器窗口关闭后自动删除；<code>cookie</code>设置的<code>cookie</code>过期时间之前一直有效，即使窗口或浏览器关闭</p>
</li>
<li><p>数据与服务器之间的交互方式，<code>cookie</code>的数据会自动的传递到服务器，服务器端也可以写<code>cookie</code>到客户端； <code>sessionStorage</code>和<code>localStorage</code>不会自动把数据发给服务器，仅在本地保存</p>
</li>
</ul>
<h2 id="三、应用场景"><a href="#三、应用场景" class="headerlink" title="三、应用场景"></a>三、应用场景</h2><p>在了解了上述的前端的缓存方式后，我们可以看看针对不对场景的使用选择：</p>
<ul>
<li>标记用户与跟踪用户行为的情况，推荐使用<code>cookie</code></li>
<li>适合长期保存在本地的数据（令牌），推荐使用<code>localStorage</code></li>
<li>敏感账号一次性登录，推荐使用<code>sessionStorage</code></li>
<li>存储大量数据的情况、在线文档（富文本编辑器）保存编辑历史的情况，推荐使用<code>indexedDB</code></li>
</ul>
<h2 id="相关连接"><a href="#相关连接" class="headerlink" title="相关连接"></a>相关连接</h2><ul>
<li><a href="https://mp.weixin.qq.com/s/mROjtpoXarN--UDfEMqwhQ">https://mp.weixin.qq.com/s/mROjtpoXarN--UDfEMqwhQ</a></li>
<li><a href="https://github.com/chenstarx/GoDB.js">https://github.com/chenstarx/GoDB.js</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>cache</tag>
      </tags>
  </entry>
  <entry>
    <title>array_api</title>
    <url>/archives/ced3960e.html</url>
    <content><![CDATA[<h1 id="面试官：数组的常用方法有哪些？"><a href="#面试官：数组的常用方法有哪些？" class="headerlink" title="面试官：数组的常用方法有哪些？"></a>面试官：数组的常用方法有哪些？</h1><p><img src="https://static.vue-js.com/5842e560-67b6-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、操作方法"><a href="#一、操作方法" class="headerlink" title="一、操作方法"></a>一、操作方法</h2><p>数组基本操作可以归纳为 增、删、改、查，需要留意的是哪些方法会对原数组产生影响，哪些方法不会</p>
<p>下面对数组常用的操作方法做一个归纳</p>
<h3 id="增"><a href="#增" class="headerlink" title="增"></a>增</h3><p>下面前三种是对原数组产生影响的增添方法，第四种则不会对原数组产生影响</p>
<ul>
<li>push()</li>
<li>unshift()</li>
<li>splice()</li>
<li>concat()</li>
</ul>
<h4 id="push"><a href="#push" class="headerlink" title="push()"></a>push()</h4><p><code>push()</code>方法接收任意数量的参数，并将它们添加到数组末尾，返回数组的最新长度</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = []; <span class="comment">// 创建一个数组</span></span><br><span class="line"><span class="keyword">let</span> count = colors.push(<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>); <span class="comment">// 推入两项</span></span><br><span class="line"><span class="built_in">console</span>.log(count); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<h4 id="unshift"><a href="#unshift" class="headerlink" title="unshift()"></a>unshift()</h4><p>unshift()在数组开头添加任意多个值，然后返回新的数组长度</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = <span class="keyword">new</span> <span class="built_in">Array</span>(); <span class="comment">// 创建一个数组</span></span><br><span class="line"><span class="keyword">let</span> count = colors.unshift(<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>); <span class="comment">// 从数组开头推入两项</span></span><br><span class="line">alert(count); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<h4 id="splice"><a href="#splice" class="headerlink" title="splice"></a>splice</h4><p>传入三个参数，分别是开始位置、0（要删除的元素数量）、插入的元素，返回空数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> removed = colors.splice(<span class="number">1</span>, <span class="number">0</span>, <span class="string">&quot;yellow&quot;</span>, <span class="string">&quot;orange&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(colors); <span class="comment">// red,yellow,orange,green,blue</span></span><br><span class="line"><span class="built_in">console</span>.log(removed); <span class="comment">// []</span></span><br></pre></td></tr></table></figure>
<h4 id="concat"><a href="#concat" class="headerlink" title="concat()"></a>concat()</h4><p>首先会创建一个当前数组的副本，然后再把它的参数添加到副本末尾，最后返回这个新构建的数组，不会影响原始数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> colors2 = colors.concat(<span class="string">&quot;yellow&quot;</span>, [<span class="string">&quot;black&quot;</span>, <span class="string">&quot;brown&quot;</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(colors); <span class="comment">// [&quot;red&quot;, &quot;green&quot;,&quot;blue&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(colors2); <span class="comment">// [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;, &quot;yellow&quot;, &quot;black&quot;, &quot;brown&quot;]</span></span><br></pre></td></tr></table></figure>
<h3 id="删"><a href="#删" class="headerlink" title="删"></a>删</h3><p>下面三种都会影响原数组，最后一项不影响原数组：</p>
<ul>
<li>pop()</li>
<li>shift()</li>
<li>splice()</li>
<li>slice()</li>
</ul>
<h4 id="pop"><a href="#pop" class="headerlink" title="pop()"></a>pop()</h4><p><code>pop()</code> 方法用于删除数组的最后一项，同时减少数组的<code>length</code> 值，返回被删除的项</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> item = colors.pop(); <span class="comment">// 取得最后一项</span></span><br><span class="line"><span class="built_in">console</span>.log(item); <span class="comment">// green</span></span><br><span class="line"><span class="built_in">console</span>.log(colors.length); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<h4 id="shift"><a href="#shift" class="headerlink" title="shift()"></a>shift()</h4><p><code>shift()</code>方法用于删除数组的第一项，同时减少数组的<code>length</code> 值，返回被删除的项</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> item = colors.shift(); <span class="comment">// 取得第一项</span></span><br><span class="line"><span class="built_in">console</span>.log(item); <span class="comment">// red</span></span><br><span class="line"><span class="built_in">console</span>.log(colors.length); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<h4 id="splice-1"><a href="#splice-1" class="headerlink" title="splice()"></a>splice()</h4><p>传入两个参数，分别是开始位置，删除元素的数量，返回包含删除元素的数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> removed = colors.splice(<span class="number">0</span>, <span class="number">1</span>); <span class="comment">// 删除第一项</span></span><br><span class="line"><span class="built_in">console</span>.log(colors); <span class="comment">// green,blue</span></span><br><span class="line"><span class="built_in">console</span>.log(removed); <span class="comment">// red，只有一个元素的数组</span></span><br></pre></td></tr></table></figure>
<h3 id="slice"><a href="#slice" class="headerlink" title="slice()"></a>slice()</h3><p>slice() 用于创建一个包含原有数组中一个或多个元素的新数组，不会影响原始数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>, <span class="string">&quot;yellow&quot;</span>, <span class="string">&quot;purple&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> colors2 = colors.slice(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">let</span> colors3 = colors.slice(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(colors); <span class="comment">// red,green,blue,yellow,purple</span></span><br><span class="line">concole.log(colors2); <span class="comment">// green,blue,yellow,purple</span></span><br><span class="line">concole.log(colors3); <span class="comment">// green,blue,yellow</span></span><br></pre></td></tr></table></figure>
<h4 id="改"><a href="#改" class="headerlink" title="改"></a>改</h4><p>即修改原来数组的内容，常用<code>splice</code></p>
<h4 id="splice-2"><a href="#splice-2" class="headerlink" title="splice()"></a>splice()</h4><p>传入三个参数，分别是开始位置，要删除元素的数量，要插入的任意多个元素，返回删除元素的数组，对原数组产生影响</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> removed = colors.splice(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;red&quot;</span>, <span class="string">&quot;purple&quot;</span>); <span class="comment">// 插入两个值，删除一个元素</span></span><br><span class="line"><span class="built_in">console</span>.log(colors); <span class="comment">// red,red,purple,blue</span></span><br><span class="line"><span class="built_in">console</span>.log(removed); <span class="comment">// green，只有一个元素的数组</span></span><br></pre></td></tr></table></figure>
<h4 id="查"><a href="#查" class="headerlink" title="查"></a>查</h4><p>即查找元素，返回元素坐标或者元素值</p>
<ul>
<li>indexOf()</li>
<li>includes()</li>
<li>find()</li>
</ul>
<h4 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf()"></a>indexOf()</h4><p>返回要查找的元素在数组中的位置，如果没找到则返回 -1</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line">numbers.indexOf(<span class="number">4</span>); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<h4 id="includes"><a href="#includes" class="headerlink" title="includes()"></a>includes()</h4><p>返回要查找的元素在数组中的位置，找到返回<code>true</code>，否则<code>false</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line">numbers.includes(<span class="number">4</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h4 id="find"><a href="#find" class="headerlink" title="find()"></a>find()</h4><p>返回第一个匹配的元素</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> people = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Matt&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">27</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Nicholas&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">29</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line">people.find(<span class="function">(<span class="params">element, index, array</span>) =&gt;</span> element.age &lt; <span class="number">28</span>); <span class="comment">// // &#123;name: &quot;Matt&quot;, age: 27&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="二、排序方法"><a href="#二、排序方法" class="headerlink" title="二、排序方法"></a>二、排序方法</h2><p>数组有两个方法可以用来对元素重新排序：</p>
<ul>
<li>reverse()</li>
<li>sort()</li>
</ul>
<h3 id="reverse"><a href="#reverse" class="headerlink" title="reverse()"></a>reverse()</h3><p>顾名思义，将数组元素方向反转</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> values = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">values.reverse();</span><br><span class="line">alert(values); <span class="comment">// 5,4,3,2,1</span></span><br></pre></td></tr></table></figure>
<h3 id="sort"><a href="#sort" class="headerlink" title="sort()"></a>sort()</h3><p>sort()方法接受一个比较函数，用于判断哪个值应该排在前面</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compare</span>(<span class="params">value1, value2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (value1 &lt; value2) &#123;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value1 &gt; value2) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> values = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>];</span><br><span class="line">values.sort(compare);</span><br><span class="line">alert(values); <span class="comment">// 0,1,5,10,15</span></span><br></pre></td></tr></table></figure>
<h2 id="三、转换方法"><a href="#三、转换方法" class="headerlink" title="三、转换方法"></a>三、转换方法</h2><p>常见的转换方法有：</p>
<h3 id="join"><a href="#join" class="headerlink" title="join()"></a>join()</h3><p>join() 方法接收一个参数，即字符串分隔符，返回包含所有项的字符串</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line">alert(colors.join(<span class="string">&quot;,&quot;</span>)); <span class="comment">// red,green,blue</span></span><br><span class="line">alert(colors.join(<span class="string">&quot;||&quot;</span>)); <span class="comment">// red||green||blue</span></span><br></pre></td></tr></table></figure>
<h2 id="四、迭代方法"><a href="#四、迭代方法" class="headerlink" title="四、迭代方法"></a>四、迭代方法</h2><p>常用来迭代数组的方法（都不改变原数组）有如下：</p>
<ul>
<li>some()</li>
<li>every()</li>
<li>forEach()</li>
<li>filter()</li>
<li>map()</li>
</ul>
<h3 id="some"><a href="#some" class="headerlink" title="some()"></a>some()</h3><p>对数组每一项都运行传入的测试函数，如果至少有 1 个元素返回 true ，则这个方法返回 true</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> someResult = numbers.some(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> item &gt; <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(someResult); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="every"><a href="#every" class="headerlink" title="every()"></a>every()</h3><p>对数组每一项都运行传入的测试函数，如果所有元素都返回 true ，则这个方法返回 true</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> everyResult = numbers.every(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> item &gt; <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(everyResult); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="forEach"><a href="#forEach" class="headerlink" title="forEach()"></a>forEach()</h3><p>对数组每一项都运行传入的函数，没有返回值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line">numbers.forEach(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行某些操作</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="filter"><a href="#filter" class="headerlink" title="filter()"></a>filter()</h3><p>对数组每一项都运行传入的函数，函数返回 <code>true</code> 的项会组成数组之后返回</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> filterResult = numbers.filter(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> item &gt; <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(filterResult); <span class="comment">// 3,4,5,4,3</span></span><br></pre></td></tr></table></figure>
<h3 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h3><p>对数组每一项都运行传入的函数，返回由每次函数调用的结果构成的数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> mapResult = numbers.map(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> item * <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(mapResult); <span class="comment">// 2,4,6,8,10,8,6,4,2</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>array_api</tag>
      </tags>
  </entry>
  <entry>
    <title>chatbox使用</title>
    <url>/archives/7472fc2f.html</url>
    <content><![CDATA[<h4 id="github-地址"><a href="#github-地址" class="headerlink" title="github 地址"></a>github 地址</h4><p><a href="https://github.com/Bin-Huang/chatbox">https://github.com/Bin-Huang/chatbox</a></p>
<h4 id="下载地址-windows"><a href="#下载地址-windows" class="headerlink" title="下载地址-windows"></a>下载地址-windows</h4><p><a href="https://github.com/Bin-Huang/chatbox/releases">https://github.com/Bin-Huang/chatbox/releases</a></p>
<p><a href="https://imgse.com/i/ppsrzgf"><img src="https://s1.ax1x.com/2023/03/27/ppsrzgf.png" alt="ppsrzgf.png"></a></p>
<h4 id="chatGPt-keys-地址"><a href="#chatGPt-keys-地址" class="headerlink" title="chatGPt keys 地址"></a>chatGPt keys 地址</h4><p><a href="https://platform.openai.com/account/api-keys">https://platform.openai.com/account/api-keys</a></p>
<p><a href="https://imgse.com/i/ppssJ8x"><img src="https://s1.ax1x.com/2023/03/27/ppssJ8x.md.png" alt="ppssJ8x.md.png"></a></p>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>ai</tag>
        <tag>chatbox</tag>
        <tag>chatGPT</tag>
      </tags>
  </entry>
  <entry>
    <title>center</title>
    <url>/archives/40f0eb24.html</url>
    <content><![CDATA[<h2 id="1-水平垂直居中的方法"><a href="#1-水平垂直居中的方法" class="headerlink" title="1.水平垂直居中的方法"></a>1.水平垂直居中的方法</h2><h3 id="1-元素水平垂直居中"><a href="#1-元素水平垂直居中" class="headerlink" title="1.元素水平垂直居中"></a>1.元素水平垂直居中</h3><ul>
<li><p>利用定位+margin:auto</p>
</li>
<li><p>利用定位+margin:负值</p>
</li>
<li><p>利用定位+transform</p>
</li>
<li>table布局</li>
<li>flex布局</li>
<li>grid布局</li>
</ul>
<h3 id="2-定位-margin-auto"><a href="#2-定位-margin-auto" class="headerlink" title="2.定位+margin:auto"></a>2.定位+margin:auto</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.father</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>:<span class="number">500px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>:<span class="number">300px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">border</span>:<span class="number">1px</span> solid <span class="number">#0a3b98</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.son</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>:<span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>:<span class="number">40px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#f0a238</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">        <span class="attribute">top</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">left</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">right</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">bottom</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin</span>:auto;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>父级设置为相对定位，子级绝对定位 ，并且四个定位属性的值都设置了0，那么这时候如果子级没有设置宽高，则会被拉开到和父级一样宽高</p>
<p>这里子元素设置了宽高，所以宽高会按照我们的设置来显示，但是实际上子级的虚拟占位已经撑满了整个父级，这时候再给它一个<code>margin：auto</code>它就可以上下左右都居中了</p>
<h3 id="3-定位-margin-负值"><a href="#3-定位-margin-负值" class="headerlink" title="3.定位+margin:负值"></a>3.定位+margin:负值</h3><p>绝大多数情况下，设置父元素为相对定位， 子元素移动自身50%实现水平垂直居中</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: skyblue;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.son</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">        <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-left</span>:-<span class="number">50px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-top</span>:-<span class="number">50px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: red;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>整个实现思路如下图所示：</p>
<p> <img src="https://static.vue-js.com/922dc300-95f9-11eb-ab90-d9ae814b240d.png" alt=""></p>
<ul>
<li>初始位置为方块1的位置</li>
<li>当设置left、top为50%的时候，内部子元素为方块2的位置</li>
<li>设置margin为负数时，使内部子元素到方块3的位置，即中间位置</li>
</ul>
<p>这种方案不要求父元素的高度，也就是即使父元素的高度变化了，仍然可以保持在父元素的垂直居中位置，水平方向上是一样的操作</p>
<p>但是该方案需要知道子元素自身的宽高，但是我们可以通过下面<code>transform</code>属性进行移动</p>
<h3 id="4-定位-transform"><a href="#4-定位-transform" class="headerlink" title="4.定位+transform"></a>4.定位+transform</h3><p>实现代码如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    <span class="selector-class">.father</span> &#123;</span><br><span class="line">        <span class="attribute">position</span>: relative;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">background</span>: skyblue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.son</span> &#123;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>,-<span class="number">50%</span>);</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">        <span class="attribute">background</span>: red;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;father&quot;&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;son&quot;&gt;&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">&lt;/<span class="selector-tag">div</span>&gt;</span><br></pre></td></tr></table></figure>
<p><code>translate(-50%, -50%)</code>将会将元素位移自己宽度和高度的-50%</p>
<p>这种方法其实和最上面被否定掉的margin负值用法一样，可以说是<code>margin</code>负值的替代方案，并不需要知道自身元素的宽高</p>
<h3 id="4-table布局"><a href="#4-table布局" class="headerlink" title="4.table布局"></a>4.table布局</h3><p>设置父元素为<code>display:table-cell</code>，子元素设置 <code>display: inline-block</code>。利用<code>vertical</code>和<code>text-align</code>可以让所有的行内块级元素水平垂直居中</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: table-cell;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: skyblue;</span></span><br><span class="line"><span class="css">        <span class="attribute">vertical-align</span>: middle;</span></span><br><span class="line"><span class="css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.son</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: red;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="5-flex弹性布局"><a href="#5-flex弹性布局" class="headerlink" title="5.flex弹性布局"></a>5.flex弹性布局</h3><p>还是看看实现的整体代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">        <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">        <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: skyblue;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.son</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: red;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>css3</code>中了<code>flex</code>布局，可以非常简单实现垂直水平居中</p>
<p>这里可以简单看看<code>flex</code>布局的关键属性作用：</p>
<ul>
<li><p>display: flex时，表示该容器内部的元素将按照flex进行布局</p>
</li>
<li><p>align-items: center表示这些元素将相对于本容器水平居中</p>
</li>
<li>justify-content: center也是同样的道理垂直居中</li>
</ul>
<h3 id="6-grid网格布局"><a href="#6-grid网格布局" class="headerlink" title="6.grid网格布局"></a>6.grid网格布局</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: grid;</span></span><br><span class="line"><span class="css">            <span class="attribute">align-items</span>:center;</span></span><br><span class="line"><span class="css">            <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: skyblue;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        <span class="selector-class">.son</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: <span class="number">1px</span> solid red</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里看到，<code>gird</code>网格布局和<code>flex</code>弹性布局都简单粗暴</p>
<h2 id="2-内联和块级居中"><a href="#2-内联和块级居中" class="headerlink" title="2.内联和块级居中"></a>2.内联和块级居中</h2><p>根据元素标签的性质，可以分为：</p>
<ul>
<li>内联元素居中布局</li>
<li>块级元素居中布局</li>
</ul>
<h3 id="内联元素居中布局"><a href="#内联元素居中布局" class="headerlink" title="内联元素居中布局"></a>内联元素居中布局</h3><p>水平居中</p>
<ul>
<li>行内元素可设置：text-align: center</li>
<li>flex布局设置父元素：display: flex; justify-content: center</li>
</ul>
<p>垂直居中</p>
<ul>
<li>单行文本父元素确认高度：height === line-height</li>
<li>多行文本父元素确认高度：display: table-cell; vertical-align: middle</li>
</ul>
<h3 id="块级元素居中布局"><a href="#块级元素居中布局" class="headerlink" title="块级元素居中布局"></a>块级元素居中布局</h3><p>水平居中</p>
<ul>
<li>定宽: margin: 0 auto</li>
<li>绝对定位+left:50%+margin:负自身一半</li>
</ul>
<p>垂直居中</p>
<ul>
<li>position: absolute设置left、top、margin-left、margin-top(定高)</li>
<li>transform: translate(x, y)</li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>center</tag>
      </tags>
  </entry>
  <entry>
    <title>uniapp实现返回顶部</title>
    <url>/archives/e6437fbd.html</url>
    <content><![CDATA[<div class="note warning disabled"><h4 id="uniapp返回顶部"><a href="#uniapp返回顶部" class="headerlink" title="uniapp返回顶部"></a>uniapp返回顶部</h4></div>
<ul>
<li>官网地址 : <a href="https://uniapp.dcloud.io/api/ui/scroll.html#pagescrollto">https://uniapp.dcloud.io/api/ui/scroll.html#pagescrollto</a></li>
</ul>
<div class="tip warning faa-horizontal animated faa-fast"><p>实现流程</p>
</div>
<ul>
<li>新建子组件 my-backtop</li>
<li>在子组件中绑定事件(backToTop) 触发父组件事件 arcticleToTop</li>
<li>在父组件监听该事件 arcticleToTop,并绑定事件</li>
<li>在父组件data中定义 isShowBackTop 是否展示子组件状态，默认false 不展示</li>
<li>在父组件 methods 同级，绑定页面监听 onPageScroll </li>
<li>在父组件 通过判断 (e.scrollTop) 就是 当前页面滚动的距离，来动态改变isShowBackTop</li>
<li>需求实现</li>
</ul>
<div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>
            <p>子组件代码</p>
            </div>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;view class=&quot;my-backtop&quot; @click=&quot;backToTop&quot;&gt;</span><br><span class="line">		&lt;uni-icons type=&quot;arrow-up&quot; color=&quot;#fff&quot; size=&quot;18&quot;&gt;&lt;/uni-icons&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">	export default &#123;</span><br><span class="line">		name:&quot;my-backtop&quot;,</span><br><span class="line">		data() &#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods:&#123;</span><br><span class="line">			backToTop()&#123;</span><br><span class="line">				this.$emit(&#x27;arcticleToTop&#x27;,0)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">.my-backtop&#123;</span><br><span class="line">	position: fixed;</span><br><span class="line">	bottom: 85rpx;</span><br><span class="line">	right: 65rpx;</span><br><span class="line">	width: 85rpx;</span><br><span class="line">	background: #00b26a;</span><br><span class="line">	border-radius: 50%;</span><br><span class="line">	text-align: center;</span><br><span class="line">	line-height: 85rpx;</span><br><span class="line">	z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>
            <p>夫组件部分代码</p>
            </div>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">....</span><br><span class="line">	&lt;!-- 返回top --&gt;</span><br><span class="line">		&lt;my-backtop v-if=&quot;isShowBackTop&quot; @arcticleToTop=&#x27;arcticleToTop&#x27;&gt;&lt;/my-backtop&gt;</span><br><span class="line"></span><br><span class="line">   data() &#123;</span><br><span class="line">			return &#123; </span><br><span class="line">        ...</span><br><span class="line">        // 是否展示backtop按钮</span><br><span class="line">				isShowBackTop:false</span><br><span class="line">        &#125;,</span><br><span class="line">    // 监听页面滚动事件</span><br><span class="line">		onPageScroll(e) &#123;</span><br><span class="line">			// console.log(e);</span><br><span class="line">			//如果滚动距离大于1000 展示backtop 按钮</span><br><span class="line">			if(e.scrollTop &gt;= 1000)&#123;</span><br><span class="line">				this.isShowBackTop =true</span><br><span class="line">			&#125;else&#123;</span><br><span class="line">				this.isShowBackTop = false</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">      // totop</span><br><span class="line">			arcticleToTop(e) &#123;</span><br><span class="line">				// https://uniapp.dcloud.io/api/ui/scroll.html#pagescrollto</span><br><span class="line">				uni.pageScrollTo(&#123;</span><br><span class="line">					scrollTop: e,</span><br><span class="line">					duration: 600</span><br><span class="line">				&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>微信小程序</category>
      </categories>
      <tags>
        <tag>uniapp返回顶部</tag>
        <tag>微信小程序</tag>
      </tags>
  </entry>
  <entry>
    <title>continue_to_upload</title>
    <url>/archives/9e5f33b7.html</url>
    <content><![CDATA[<h1 id="面试官：大文件上传如何做断点续传？"><a href="#面试官：大文件上传如何做断点续传？" class="headerlink" title="面试官：大文件上传如何做断点续传？"></a>面试官：大文件上传如何做断点续传？</h1><p> <img src="https://static.vue-js.com/3ccb0e90-8ba4-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>不管怎样简单的需求，在量级达到一定层次时，都会变得异常复杂</p>
<p>文件上传简单，文件变大就复杂</p>
<p>上传大文件时，以下几个变量会影响我们的用户体验</p>
<ul>
<li>服务器处理数据的能力</li>
<li>请求超时</li>
<li>网络波动</li>
</ul>
<p>上传时间会变长，高频次文件上传失败，失败后又需要重新上传等等</p>
<p>为了解决上述问题，我们需要对大文件上传单独处理</p>
<p>这里涉及到分片上传及断点续传两个概念</p>
<h4 id="分片上传"><a href="#分片上传" class="headerlink" title="分片上传"></a>分片上传</h4><p>分片上传，就是将所要上传的文件，按照一定的大小，将整个文件分隔成多个数据块（Part）来进行分片上传</p>
<p>如下图</p>
<p> <img src="https://static.vue-js.com/21db7520-8ba4-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>上传完之后再由服务端对所有上传的文件进行汇总整合成原始的文件</p>
<p>大致流程如下：</p>
<ol>
<li>将需要上传的文件按照一定的分割规则，分割成相同大小的数据块；</li>
<li>初始化一个分片上传任务，返回本次分片上传唯一标识；</li>
<li>按照一定的策略（串行或并行）发送各个分片数据块；</li>
<li>发送完成后，服务端根据判断数据上传是否完整，如果完整，则进行数据块合成得到原始文件</li>
</ol>
<h4 id="断点续传"><a href="#断点续传" class="headerlink" title="断点续传"></a>断点续传</h4><p>断点续传指的是在下载或上传时，将下载或上传任务人为的划分为几个部分</p>
<p>每一个部分采用一个线程进行上传或下载，如果碰到网络故障，可以从已经上传或下载的部分开始继续上传下载未完成的部分，而没有必要从头开始上传下载。用户可以节省时间，提高速度</p>
<p>一般实现方式有两种：</p>
<ul>
<li>服务器端返回，告知从哪开始</li>
<li>浏览器端自行处理</li>
</ul>
<p>上传过程中将文件在服务器写为临时文件，等全部写完了（文件上传完），将此临时文件重命名为正式文件即可</p>
<p>如果中途上传中断过，下次上传的时候根据当前临时文件大小，作为在客户端读取文件的偏移量，从此位置继续读取文件数据块，上传到服务器从此偏移量继续写入文件即可</p>
<h2 id="二、实现思路"><a href="#二、实现思路" class="headerlink" title="二、实现思路"></a>二、实现思路</h2><p>整体思路比较简单，拿到文件，保存文件唯一性标识，切割文件，分段上传，每次上传一段，根据唯一性标识判断文件上传进度，直到文件的全部片段上传完毕</p>
<p><img src="https://static.vue-js.com/465d2920-8ba4-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>下面的内容都是伪代码</p>
<p>读取文件内容：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> input = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;input&#x27;</span>);</span><br><span class="line">input.addEventListener(<span class="string">&#x27;change&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> file = <span class="built_in">this</span>.files[<span class="number">0</span>];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>可以使用<code>md5</code>实现文件的唯一性</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> md5code = md5(file);</span><br></pre></td></tr></table></figure>
<p>然后开始对文件进行分割</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">reader.readAsArrayBuffer(file);</span><br><span class="line">reader.addEventListener(<span class="string">&quot;load&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//每10M切割一段,这里只做一个切割演示，实际切割需要循环切割，</span></span><br><span class="line">    <span class="keyword">var</span> slice = e.target.result.slice(<span class="number">0</span>, <span class="number">10</span>*<span class="number">1024</span>*<span class="number">1024</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>h5上传一个（一片）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> formdata = <span class="keyword">new</span> FormData();</span><br><span class="line">formdata.append(<span class="string">&#x27;0&#x27;</span>, slice);</span><br><span class="line"><span class="comment">//这里是有一个坑的，部分设备无法获取文件名称，和文件类型，这个在最后给出解决方案</span></span><br><span class="line">formdata.append(<span class="string">&#x27;filename&#x27;</span>, file.filename);</span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.addEventListener(<span class="string">&#x27;load&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//xhr.responseText</span></span><br><span class="line">&#125;);</span><br><span class="line">xhr.open(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">xhr.send(formdata);</span><br><span class="line">xhr.addEventListener(<span class="string">&#x27;progress&#x27;</span>, updateProgress);</span><br><span class="line">xhr.upload.addEventListener(<span class="string">&#x27;progress&#x27;</span>, updateProgress);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateProgress</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event.lengthComputable) &#123;</span><br><span class="line">        <span class="comment">//进度条</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里给出常见的图片和视频的文件类型判断</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFileType</span>(<span class="params">type, file, back</span>) </span>&#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* type png jpg mp4 ...</span></span><br><span class="line"><span class="comment">* file input.change=&gt; this.files[0]</span></span><br><span class="line"><span class="comment">* back callback(boolean)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">if</span> (args.length != <span class="number">3</span>) &#123;</span><br><span class="line">        back(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> type = args[<span class="number">0</span>]; <span class="comment">// type = &#x27;(png|jpg)&#x27; , &#x27;png&#x27;</span></span><br><span class="line">    <span class="keyword">var</span> file = args[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">var</span> back = <span class="keyword">typeof</span> args[<span class="number">2</span>] == <span class="string">&#x27;function&#x27;</span> ? args[<span class="number">2</span>] : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span> (file.type == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果系统无法获取文件类型，则读取二进制流，对二进制进行解析文件类型</span></span><br><span class="line">        <span class="keyword">var</span> imgType = [</span><br><span class="line">            <span class="string">&#x27;ff d8 ff&#x27;</span>, <span class="comment">//jpg</span></span><br><span class="line">            <span class="string">&#x27;89 50 4e&#x27;</span>, <span class="comment">//png</span></span><br><span class="line"></span><br><span class="line">            <span class="string">&#x27;0 0 0 14 66 74 79 70 69 73 6F 6D&#x27;</span>, <span class="comment">//mp4</span></span><br><span class="line">            <span class="string">&#x27;0 0 0 18 66 74 79 70 33 67 70 35&#x27;</span>, <span class="comment">//mp4</span></span><br><span class="line">            <span class="string">&#x27;0 0 0 0 66 74 79 70 33 67 70 35&#x27;</span>, <span class="comment">//mp4</span></span><br><span class="line">            <span class="string">&#x27;0 0 0 0 66 74 79 70 4D 53 4E 56&#x27;</span>, <span class="comment">//mp4</span></span><br><span class="line">            <span class="string">&#x27;0 0 0 0 66 74 79 70 69 73 6F 6D&#x27;</span>, <span class="comment">//mp4</span></span><br><span class="line"></span><br><span class="line">            <span class="string">&#x27;0 0 0 18 66 74 79 70 6D 70 34 32&#x27;</span>, <span class="comment">//m4v</span></span><br><span class="line">            <span class="string">&#x27;0 0 0 0 66 74 79 70 6D 70 34 32&#x27;</span>, <span class="comment">//m4v</span></span><br><span class="line"></span><br><span class="line">            <span class="string">&#x27;0 0 0 14 66 74 79 70 71 74 20 20&#x27;</span>, <span class="comment">//mov</span></span><br><span class="line">            <span class="string">&#x27;0 0 0 0 66 74 79 70 71 74 20 20&#x27;</span>, <span class="comment">//mov</span></span><br><span class="line">            <span class="string">&#x27;0 0 0 0 6D 6F 6F 76&#x27;</span>, <span class="comment">//mov</span></span><br><span class="line"></span><br><span class="line">            <span class="string">&#x27;4F 67 67 53 0 02&#x27;</span>, <span class="comment">//ogg</span></span><br><span class="line">            <span class="string">&#x27;1A 45 DF A3&#x27;</span>, <span class="comment">//ogg</span></span><br><span class="line"></span><br><span class="line">            <span class="string">&#x27;52 49 46 46 x x x x 41 56 49 20&#x27;</span>, <span class="comment">//avi (RIFF fileSize fileType LIST)(52 49 46 46,DC 6C 57 09,41 56 49 20,4C 49 53 54)</span></span><br><span class="line">        ];</span><br><span class="line">        <span class="keyword">var</span> typeName = [</span><br><span class="line">            <span class="string">&#x27;jpg&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;png&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mp4&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mp4&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mp4&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mp4&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mp4&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;m4v&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;m4v&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mov&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mov&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mov&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ogg&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ogg&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;avi&#x27;</span>,</span><br><span class="line">        ];</span><br><span class="line">        <span class="keyword">var</span> sliceSize = <span class="regexp">/png|jpg|jpeg/</span>.test(type) ? <span class="number">3</span> : <span class="number">12</span>;</span><br><span class="line">        <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">        reader.readAsArrayBuffer(file);</span><br><span class="line">        reader.addEventListener(<span class="string">&quot;load&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> slice = e.target.result.slice(<span class="number">0</span>, sliceSize);</span><br><span class="line">            reader = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (slice &amp;&amp; slice.byteLength == sliceSize) &#123;</span><br><span class="line">                <span class="keyword">var</span> view = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(slice);</span><br><span class="line">                <span class="keyword">var</span> arr = [];</span><br><span class="line">                view.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123;</span><br><span class="line">                    arr.push(v.toString(<span class="number">16</span>));</span><br><span class="line">                &#125;);</span><br><span class="line">                view = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">var</span> idx = arr.join(<span class="string">&#x27; &#x27;</span>).indexOf(imgType);</span><br><span class="line">                <span class="keyword">if</span> (idx &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">                    back(typeName[idx]);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    arr = arr.map(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> (i &gt; <span class="number">3</span> &amp;&amp; i &lt; <span class="number">8</span>) &#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">return</span> v;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">var</span> idx = arr.join(<span class="string">&#x27; &#x27;</span>).indexOf(imgType);</span><br><span class="line">                    <span class="keyword">if</span> (idx &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">                        back(typeName[idx]);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        back(<span class="literal">false</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                back(<span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> type = file.name.match(<span class="regexp">/\.(\w+)$/</span>)[<span class="number">1</span>];</span><br><span class="line">        back(type);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用方法如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">checkFileType(<span class="string">&#x27;(mov|mp4|avi)&#x27;</span>,file,<span class="function"><span class="keyword">function</span>(<span class="params">fileType</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// fileType = mp4,</span></span><br><span class="line">    <span class="comment">// 如果file的类型不在枚举之列，则返回false</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>上面上传文件的一步，可以改成：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">formdata.append(<span class="string">&#x27;filename&#x27;</span>, md5code+<span class="string">&#x27;.&#x27;</span>+fileType);</span><br></pre></td></tr></table></figure>
<p>有了切割上传后，也就有了文件唯一标识信息，断点续传变成了后台的一个小小的逻辑判断</p>
<p>后端主要做的内容为：根据前端传给后台的<code>md5</code>值，到服务器磁盘查找是否有之前未完成的文件合并信息（也就是未完成的半成品文件切片），取到之后根据上传切片的数量，返回数据告诉前端开始从第几节上传</p>
<p>如果想要暂停切片的上传，可以使用<code>XMLHttpRequest</code>的 <code>abort</code>方法</p>
<h2 id="三、使用场景"><a href="#三、使用场景" class="headerlink" title="三、使用场景"></a>三、使用场景</h2><ul>
<li>大文件加速上传：当文件大小超过预期大小时，使用分片上传可实现并行上传多个 Part， 以加快上传速度</li>
<li>网络环境较差：建议使用分片上传。当出现上传失败的时候，仅需重传失败的Part</li>
<li>流式上传：可以在需要上传的文件大小还不确定的情况下开始上传。这种场景在视频监控等行业应用中比较常见</li>
</ul>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>当前的伪代码，只是提供一个简单的思路，想要把事情做到极致，我们还需要考虑到更多场景，比如</p>
<ul>
<li>切片上传失败怎么办</li>
<li>上传过程中刷新页面怎么办</li>
<li>如何进行并行上传</li>
<li>切片什么时候按数量切，什么时候按大小切</li>
<li>如何结合 Web Worker 处理大文件上传</li>
<li>如何实现秒传</li>
</ul>
<p>人生又何尝不是如此，极致的人生体验有无限可能，越是后面才发现越是精彩 ~_~</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://segmentfault.com/a/1190000009448892">https://segmentfault.com/a/1190000009448892</a></li>
<li><a href="https://baike.baidu.com/">https://baike.baidu.com/</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>continue_to_upload</tag>
      </tags>
  </entry>
  <entry>
    <title>composition</title>
    <url>/archives/c7f4347.html</url>
    <content><![CDATA[<h1 id="面试官：Vue3-0-所采用的-Composition-Api-与-Vue2-x-使用的-Options-Api-有什么不同？"><a href="#面试官：Vue3-0-所采用的-Composition-Api-与-Vue2-x-使用的-Options-Api-有什么不同？" class="headerlink" title="面试官：Vue3.0 所采用的 Composition Api 与 Vue2.x 使用的 Options Api 有什么不同？"></a>面试官：Vue3.0 所采用的 Composition Api 与 Vue2.x 使用的 Options Api 有什么不同？</h1><p> <img src="https://static.vue-js.com/8d6dd7b0-6048-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="开始之前"><a href="#开始之前" class="headerlink" title="开始之前"></a>开始之前</h2><p><code>Composition API</code> 可以说是<code>Vue3</code>的最大特点，那么为什么要推出<code>Composition Api</code>，解决了什么问题？</p>
<p>通常使用<code>Vue2</code>开发的项目，普遍会存在以下问题：</p>
<ul>
<li>代码的可读性随着组件变大而变差</li>
<li>每一种代码复用的方式，都存在缺点</li>
<li>TypeScript支持有限</li>
</ul>
<p>以上通过使用<code>Composition Api</code>都能迎刃而解</p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h3 id="一、Options-Api"><a href="#一、Options-Api" class="headerlink" title="一、Options Api"></a>一、Options Api</h3><p><code>Options API</code>，即大家常说的选项API，即以<code>vue</code>为后缀的文件，通过定义<code>methods</code>，<code>computed</code>，<code>watch</code>，<code>data</code>等属性与方法，共同处理页面逻辑</p>
<p>如下图：</p>
<p> <img src="https://static.vue-js.com/9bf6d9d0-6048-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>可以看到<code>Options</code>代码编写方式，如果是组件状态，则写在<code>data</code>属性上，如果是方法，则写在<code>methods</code>属性上…</p>
<p>用组件的选项 (<code>data</code>、<code>computed</code>、<code>methods</code>、<code>watch</code>) 组织逻辑在大多数情况下都有效</p>
<p>然而，当组件变得复杂，导致对应属性的列表也会增长，这可能会导致组件难以阅读和理解</p>
<h3 id="二、Composition-Api"><a href="#二、Composition-Api" class="headerlink" title="二、Composition Api"></a>二、Composition Api</h3><p>在 Vue3 Composition API 中，组件根据逻辑功能来组织的，一个功能所定义的所有 API 会放在一起（更加的高内聚，低耦合）</p>
<p>即使项目很大，功能很多，我们都能快速的定位到这个功能所用到的所有 API</p>
<p> <img src="https://static.vue-js.com/acee9200-6048-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="三、对比"><a href="#三、对比" class="headerlink" title="三、对比"></a>三、对比</h3><p>下面对<code>Composition Api</code>与<code>Options Api</code>进行两大方面的比较</p>
<ul>
<li>逻辑组织</li>
<li>逻辑复用</li>
</ul>
<h4 id="逻辑组织"><a href="#逻辑组织" class="headerlink" title="逻辑组织"></a>逻辑组织</h4><h5 id="Options-API"><a href="#Options-API" class="headerlink" title="Options API"></a>Options API</h5><p>假设一个组件是一个大型组件，其内部有很多处理逻辑关注点（对应下图不用颜色）</p>
<p> <img src="https://static.vue-js.com/dc83d070-6048-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>可以看到，这种碎片化使得理解和维护复杂组件变得困难</p>
<p>选项的分离掩盖了潜在的逻辑问题。此外，在处理单个逻辑关注点时，我们必须不断地“跳转”相关代码的选项块</p>
<h5 id="Compostion-API"><a href="#Compostion-API" class="headerlink" title="Compostion API"></a>Compostion API</h5><p>而<code>Compositon API</code>正是解决上述问题，将某个逻辑关注点相关的代码全都放在一个函数里，这样当需要修改一个功能时，就不再需要在文件中跳来跳去</p>
<p>下面举个简单例子，将处理<code>count</code>属性相关的代码放在同一个函数了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useCount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> count = ref(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">let</span> double = computed(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> count.value * <span class="number">2</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleConut = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        count.value = count.value * <span class="number">2</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(count);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        count,</span><br><span class="line">        double,</span><br><span class="line">        handleConut,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>组件上中使用<code>count</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineComponent(&#123;</span><br><span class="line">    <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; count, double, handleConut &#125; = useCount();</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            count,</span><br><span class="line">            double,</span><br><span class="line">            handleConut</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>再来一张图进行对比，可以很直观地感受到 <code>Composition API</code>在逻辑组织方面的优势，以后修改一个属性功能的时候，只需要跳到控制该属性的方法中即可</p>
<p><img src="https://static.vue-js.com/e5804bc0-5c58-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h4 id="逻辑复用"><a href="#逻辑复用" class="headerlink" title="逻辑复用"></a>逻辑复用</h4><p>在<code>Vue2</code>中，我们是用过<code>mixin</code>去复用相同的逻辑</p>
<p>下面举个例子，我们会另起一个<code>mixin.js</code>文件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> MoveMixin = &#123;</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="function"><span class="title">handleKeyup</span>(<span class="params">e</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(e.code);</span><br><span class="line">      <span class="comment">// 上下左右 x y</span></span><br><span class="line">      <span class="keyword">switch</span> (e.code) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;ArrowUp&quot;</span>:</span><br><span class="line">          <span class="built_in">this</span>.y--;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;ArrowDown&quot;</span>:</span><br><span class="line">          <span class="built_in">this</span>.y++;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;ArrowLeft&quot;</span>:</span><br><span class="line">          <span class="built_in">this</span>.x--;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;ArrowRight&quot;</span>:</span><br><span class="line">          <span class="built_in">this</span>.x++;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&quot;keyup&quot;</span>, <span class="built_in">this</span>.handleKeyup);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">unmounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">&quot;keyup&quot;</span>, <span class="built_in">this</span>.handleKeyup);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后在组件中使用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    Mouse position: x &#123;&#123; x &#125;&#125; / y &#123;&#123; y &#125;&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> mousePositionMixin <span class="keyword">from</span> <span class="string">&#x27;./mouse&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="attr">mixins</span>: [mousePositionMixin]</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>使用单个<code>mixin</code>似乎问题不大，但是当我们一个组件混入大量不同的 <code>mixins</code> 的时候</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mixins: [mousePositionMixin, fooMixin, barMixin, otherMixin]</span><br></pre></td></tr></table></figure>
<p>会存在两个非常明显的问题：</p>
<ul>
<li>命名冲突</li>
<li>数据来源不清晰</li>
</ul>
<p>现在通过<code>Compositon API</code>这种方式改写上面的代码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; onMounted, onUnmounted, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">useMove</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> position = reactive(&#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> handleKeyup = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e.code);</span><br><span class="line">    <span class="comment">// 上下左右 x y</span></span><br><span class="line">    <span class="keyword">switch</span> (e.code) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;ArrowUp&quot;</span>:</span><br><span class="line">        <span class="comment">// y.value--;</span></span><br><span class="line">        position.y--;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;ArrowDown&quot;</span>:</span><br><span class="line">        <span class="comment">// y.value++;</span></span><br><span class="line">        position.y++;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;ArrowLeft&quot;</span>:</span><br><span class="line">        <span class="comment">// x.value--;</span></span><br><span class="line">        position.x--;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;ArrowRight&quot;</span>:</span><br><span class="line">        <span class="comment">// x.value++;</span></span><br><span class="line">        position.x++;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  onMounted(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&quot;keyup&quot;</span>, handleKeyup);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  onUnmounted(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">&quot;keyup&quot;</span>, handleKeyup);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; position &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在组件中使用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    Mouse position: x &#123;&#123; x &#125;&#125; / y &#123;&#123; y &#125;&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; useMove &#125; <span class="keyword">from</span> <span class="string">&quot;./useMove&quot;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; toRefs &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">const</span> &#123; position &#125; = useMove();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">const</span> &#123; x, y &#125; = toRefs(position);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      x,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      y,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>可以看到，整个数据来源清晰了，即使去编写更多的 hook 函数，也不会出现命名冲突的问题</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li>在逻辑组织和逻辑复用方面，<code>Composition API</code>是优于<code>Options  API</code></li>
<li>因为<code>Composition API</code>几乎是函数，会有更好的类型推断。</li>
<li><code>Composition API</code>对 <code>tree-shaking</code> 友好，代码也更容易压缩</li>
<li><code>Composition API</code>中见不到<code>this</code>的使用，减少了<code>this</code>指向不明的情况</li>
<li>如果是小型组件，可以继续使用<code>Options API</code>，也是十分友好的</li>
</ul>
]]></content>
      <categories>
        <category>vue3</category>
      </categories>
      <tags>
        <tag>vue3</tag>
        <tag>composition</tag>
      </tags>
  </entry>
  <entry>
    <title>closure</title>
    <url>/archives/48078dd1.html</url>
    <content><![CDATA[<h1 id="面试官：说说你对闭包的理解？闭包使用场景"><a href="#面试官：说说你对闭包的理解？闭包使用场景" class="headerlink" title="面试官：说说你对闭包的理解？闭包使用场景"></a>面试官：说说你对闭包的理解？闭包使用场景</h1><p> <img src="https://static.vue-js.com/c141a030-6a7a-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>一个函数和对其周围状态（lexical environment，词法环境）的引用捆绑在一起（或者说函数被引用包围），这样的组合就是闭包（closure）</p>
<p>也就是说，闭包让你可以在一个内层函数中访问到其外层函数的作用域</p>
<p>在 <code>JavaScript</code>中，每当创建一个函数，闭包就会在函数创建的同时被创建出来，作为函数内部与外部连接起来的一座桥梁</p>
<p>下面给出一个简单的例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">&quot;Mozilla&quot;</span>; <span class="comment">// name 是一个被 init 创建的局部变量</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">displayName</span>(<span class="params"></span>) </span>&#123; <span class="comment">// displayName() 是内部函数，一个闭包</span></span><br><span class="line">        alert(name); <span class="comment">// 使用了父函数中声明的变量</span></span><br><span class="line">    &#125;</span><br><span class="line">    displayName();</span><br><span class="line">&#125;</span><br><span class="line">init();</span><br></pre></td></tr></table></figure>
<p><code>displayName()</code> 没有自己的局部变量。然而，由于闭包的特性，它可以访问到外部函数的变量</p>
<h2 id="二、使用场景"><a href="#二、使用场景" class="headerlink" title="二、使用场景"></a>二、使用场景</h2><p>任何闭包的使用场景都离不开这两点：</p>
<ul>
<li>创建私有变量</li>
<li>延长变量的生命周期</li>
</ul>
<blockquote>
<p>一般函数的词法环境在函数返回后就被销毁，但是闭包会保存对创建时所在词法环境的引用，即便创建时所在的执行上下文被销毁，但创建时所在词法环境依然存在，以达到延长变量的生命周期的目的</p>
</blockquote>
<p>下面举个例子：</p>
<p>在页面上添加一些可以调整字号的按钮</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeSizer</span>(<span class="params">size</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.body.style.fontSize = size + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> size12 = makeSizer(<span class="number">12</span>);</span><br><span class="line"><span class="keyword">var</span> size14 = makeSizer(<span class="number">14</span>);</span><br><span class="line"><span class="keyword">var</span> size16 = makeSizer(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;size-12&#x27;</span>).onclick = size12;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;size-14&#x27;</span>).onclick = size14;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;size-16&#x27;</span>).onclick = size16;</span><br></pre></td></tr></table></figure>
<h3 id="柯里化函数"><a href="#柯里化函数" class="headerlink" title="柯里化函数"></a>柯里化函数</h3><p>柯里化的目的在于避免频繁调用具有相同参数函数的同时，又能够轻松的重用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 假设我们有一个求长方形面积的函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArea</span>(<span class="params">width, height</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> width * height</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 如果我们碰到的长方形的宽老是10</span></span><br><span class="line"><span class="keyword">const</span> area1 = getArea(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line"><span class="keyword">const</span> area2 = getArea(<span class="number">10</span>, <span class="number">30</span>)</span><br><span class="line"><span class="keyword">const</span> area3 = getArea(<span class="number">10</span>, <span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 我们可以使用闭包柯里化这个计算面积的函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArea</span>(<span class="params">width</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">height</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> width * height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getTenWidthArea = getArea(<span class="number">10</span>)</span><br><span class="line"><span class="comment">// 之后碰到宽度为10的长方形就可以这样计算面积</span></span><br><span class="line"><span class="keyword">const</span> area1 = getTenWidthArea(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 而且如果遇到宽度偶尔变化也可以轻松复用</span></span><br><span class="line"><span class="keyword">const</span> getTwentyWidthArea = getArea(<span class="number">20</span>)</span><br></pre></td></tr></table></figure>
<h3 id="使用闭包模拟私有方法"><a href="#使用闭包模拟私有方法" class="headerlink" title="使用闭包模拟私有方法"></a>使用闭包模拟私有方法</h3><p>在<code>JavaScript</code>中，没有支持声明私有变量，但我们可以使用闭包来模拟私有方法</p>
<p>下面举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Counter = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> privateCounter = <span class="number">0</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">changeBy</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">    privateCounter += val;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">increment</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      changeBy(<span class="number">1</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">decrement</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      changeBy(-<span class="number">1</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">value</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> privateCounter;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Counter1 = makeCounter();</span><br><span class="line"><span class="keyword">var</span> Counter2 = makeCounter();</span><br><span class="line"><span class="built_in">console</span>.log(Counter1.value()); <span class="comment">/* logs 0 */</span></span><br><span class="line">Counter1.increment();</span><br><span class="line">Counter1.increment();</span><br><span class="line"><span class="built_in">console</span>.log(Counter1.value()); <span class="comment">/* logs 2 */</span></span><br><span class="line">Counter1.decrement();</span><br><span class="line"><span class="built_in">console</span>.log(Counter1.value()); <span class="comment">/* logs 1 */</span></span><br><span class="line"><span class="built_in">console</span>.log(Counter2.value()); <span class="comment">/* logs 0 */</span></span><br></pre></td></tr></table></figure>
<p>上述通过使用闭包来定义公共函数，并令其可以访问私有函数和变量，这种方式也叫模块方式</p>
<p>两个计数器 <code>Counter1</code> 和 <code>Counter2</code> 是维护它们各自的独立性的，每次调用其中一个计数器时，通过改变这个变量的值，会改变这个闭包的词法环境，不会影响另一个闭包中的变量</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>例如计数器、延迟调用、回调等闭包的应用，其核心思想还是创建私有变量和延长变量的生命周期</p>
<h2 id="三、注意事项"><a href="#三、注意事项" class="headerlink" title="三、注意事项"></a>三、注意事项</h2><p>如果不是某些特定任务需要使用闭包，在其它函数中创建函数是不明智的，因为闭包在处理速度和内存消耗方面对脚本性能具有负面影响</p>
<p>例如，在创建新的对象或者类时，方法通常应该关联于对象的原型，而不是定义到对象的构造器中。</p>
<p>原因在于每个对象的创建，方法都会被重新赋值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyObject</span>(<span class="params">name, message</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name.toString();</span><br><span class="line">  <span class="built_in">this</span>.message = message.toString();</span><br><span class="line">  <span class="built_in">this</span>.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">this</span>.getMessage = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.message;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的代码中，我们并没有利用到闭包的好处，因此可以避免使用闭包。修改成如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyObject</span>(<span class="params">name, message</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name.toString();</span><br><span class="line">  <span class="built_in">this</span>.message = message.toString();</span><br><span class="line">&#125;</span><br><span class="line">MyObject.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">&#125;;</span><br><span class="line">MyObject.prototype.getMessage = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.message;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>closure</tag>
      </tags>
  </entry>
  <entry>
    <title>column_layout</title>
    <url>/archives/9a0dce2d.html</url>
    <content><![CDATA[<h2 id="1-双栏布局"><a href="#1-双栏布局" class="headerlink" title="1.双栏布局"></a>1.双栏布局</h2><h3 id="1-浮动实现"><a href="#1-浮动实现" class="headerlink" title="1.浮动实现"></a>1.浮动实现</h3><p>双栏布局非常常见，往往是以一个定宽栏和一个自适应的栏并排展示存在</p>
<p>实现思路也非常的简单：</p>
<ul>
<li>使用 float 左浮左边栏</li>
<li>右边模块使用 margin-left 撑出内容块做内容展示</li>
<li>为父级元素添加BFC，防止下方元素飞到上方内容</li>
</ul>
<p>代码如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.box</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">overflow</span>: hidden; 添加BFC</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background-color</span>: gray;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-left</span>: <span class="number">210px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background-color</span>: lightgray;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>还有一种更为简单的使用则是采取：flex弹性布局</p>
<h3 id="2-flex弹性布局"><a href="#2-flex弹性布局" class="headerlink" title="2.flex弹性布局"></a>2.flex弹性布局</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.box</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>flex</code>可以说是最好的方案了，代码少，使用简单</p>
<p>注意的是，<code>flex</code>容器的一个默认属性值:<code>align-items: stretch;</code></p>
<p>这个属性导致了列等高的效果。 为了让两个盒子高度自动，需要设置: <code>align-items: flex-start</code></p>
<h2 id="2-三栏布局"><a href="#2-三栏布局" class="headerlink" title="2.三栏布局"></a>2.三栏布局</h2><p>实现三栏布局中间自适应的布局方式有：</p>
<ul>
<li>两边使用 float，中间使用 margin</li>
<li>两边使用 absolute，中间使用 margin</li>
<li>两边使用 float 和负 margin</li>
<li>display: table 实现</li>
<li>flex实现</li>
<li>grid网格布局</li>
</ul>
<h3 id="1-两边float-中间-margin"><a href="#1-两边float-中间-margin" class="headerlink" title="1.两边float + 中间 margin"></a>1.两边float + 中间 margin</h3><p>需要将中间的内容放在<code>html</code>结构最后，否则右侧会在中间内容的下方</p>
<p>实现代码如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.wrap</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">overflow</span>: hidden; &lt;!-- 生成BFC，计算高度时考虑浮动的元素 --&gt;</span></span><br><span class="line"><span class="css">        <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: coral;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">120px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">float</span>: right;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: lightblue;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.middle</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-left</span>: <span class="number">220px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: lightpink;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-right</span>: <span class="number">140px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrap&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左侧<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右侧<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;middle&quot;</span>&gt;</span>中间<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>原理如下：</p>
<ul>
<li>两边固定宽度，中间宽度自适应。</li>
<li>利用中间元素的margin值控制两边的间距</li>
<li>宽度小于左右部分宽度之和时，右侧部分会被挤下去</li>
</ul>
<p>这种实现方式存在缺陷：</p>
<ul>
<li><p>主体内容是最后加载的。</p>
</li>
<li><p>右边在主体内容之前，如果是响应式设计，不能简单的换行展示</p>
</li>
</ul>
<h3 id="2-两边-absolute-中间-margin"><a href="#2-两边-absolute-中间-margin" class="headerlink" title="2.两边 absolute+中间 margin"></a>2.两边 absolute+中间 margin</h3><p>基于绝对定位的三栏布局：注意绝对定位的元素脱离文档流，相对于最近的已经定位的祖先元素进行定位。无需考虑HTML中结构的顺序</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.container</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">  </span></span><br><span class="line"><span class="css">  <span class="selector-class">.left</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.right</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.main</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background</span>: green;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background</span>: green;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.main</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">110px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background</span>: black;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左边固定宽度<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右边固定宽度<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span>中间自适应<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>实现流程：</p>
<ul>
<li>左右两边使用绝对定位，固定在两侧。</li>
<li>中间占满一行，但通过 margin和左右两边留出10px的间隔</li>
</ul>
<h3 id="3-两边使用-float-和负-margin"><a href="#3-两边使用-float-和负-margin" class="headerlink" title="3.两边使用 float 和负 margin"></a>3.两边使用 float 和负 margin</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.left</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.right</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.main</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.main-wrapper</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.main</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">110px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background</span>: black;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.left</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-left</span>: -<span class="number">100%</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background</span>: green;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-left</span>: -<span class="number">100px</span>; <span class="comment">/* 同自身宽度 */</span></span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main-wrapper&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span>中间自适应<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左边固定宽度<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右边固定宽度<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>实现过程：</p>
<ul>
<li>中间使用了双层标签，外层是浮动的，以便左中右能在同一行展示</li>
<li>左边通过使用负 margin-left:-100%，相当于中间的宽度，所以向上偏移到左侧</li>
<li>右边通过使用负 margin-left:-100px，相当于自身宽度，所以向上偏移到最右侧</li>
</ul>
<p>缺点：</p>
<ul>
<li>增加了 .main-wrapper 一层，结构变复杂</li>
<li>使用负 margin，调试也相对麻烦</li>
</ul>
<h3 id="4-display-table-实现"><a href="#4-display-table-实现" class="headerlink" title="4.display: table 实现"></a>4.display: table 实现</h3><p><code>&lt;table&gt;</code> 标签用于展示行列数据，不适合用于布局。但是可以使用 <code>display: table</code> 来实现布局的效果</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.container</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: table;</span></span><br><span class="line"><span class="css">    <span class="attribute">table-layout</span>: fixed;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.left</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.right</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.main</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: table-cell;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.left</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background</span>: green;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.main</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">background</span>: black;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左边固定宽度<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span>中间自适应<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右边固定宽度<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>实现原理：</p>
<ul>
<li>层通过 display: table设置为表格，设置 table-layout: fixed`表示列宽自身宽度决定，而不是自动计算。</li>
<li>内层的左中右通过 display: table-cell设置为表格单元。</li>
<li>左右设置固定宽度，中间设置 width: 100% 填充剩下的宽度</li>
</ul>
<h3 id="5-flex实现"><a href="#5-flex实现" class="headerlink" title="5.flex实现"></a>5.flex实现</h3><p>利用<code>flex</code>弹性布局，可以简单实现中间自适应</p>
<p>代码如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.wrap</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">        <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.left</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.right</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.middle</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: coral;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">120px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: lightblue;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.middle</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#555</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrap&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左侧<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;middle&quot;</span>&gt;</span>中间<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右侧<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>实现过程：</p>
<ul>
<li>仅需将容器设置为<code>display:flex;</code>，</li>
<li>盒内元素两端对其，将中间元素设置为<code>100%</code>宽度，或者设为<code>flex:1</code>，即可填充空白</li>
<li>盒内元素的高度撑开容器的高度</li>
</ul>
<p>优点：</p>
<ul>
<li>结构简单直观</li>
<li>可以结合 flex的其他功能实现更多效果，例如使用 order属性调整显示顺序，让主体内容优先加载，但展示在中间</li>
</ul>
<h3 id="6-grid网格布局"><a href="#6-grid网格布局" class="headerlink" title="6.grid网格布局"></a>6.grid网格布局</h3><p>代码如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.wrap</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: grid;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        grid-template-<span class="attribute">columns</span>: <span class="number">300px</span> auto <span class="number">300px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.left</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.right</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.middle</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: coral;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: lightblue;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.middle</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#555</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrap&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左侧<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;middle&quot;</span>&gt;</span>中间<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右侧<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>跟<code>flex</code>弹性布局一样的简单</p>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>column_layout</tag>
      </tags>
  </entry>
  <entry>
    <title>context_stack</title>
    <url>/archives/10bf1714.html</url>
    <content><![CDATA[<h1 id="面试官：JavaScript-中执行上下文和执行栈是什么？"><a href="#面试官：JavaScript-中执行上下文和执行栈是什么？" class="headerlink" title="面试官：JavaScript 中执行上下文和执行栈是什么？"></a>面试官：JavaScript 中执行上下文和执行栈是什么？</h1><p><img src="https://static.vue-js.com/8652b710-74c1-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、执行上下文"><a href="#一、执行上下文" class="headerlink" title="一、执行上下文"></a>一、执行上下文</h2><p>简单的来说，执行上下文是一种对<code>Javascript</code>代码执行环境的抽象概念，也就是说只要有<code>Javascript</code>代码运行，那么它就一定是运行在执行上下文中</p>
<p>执行上下文的类型分为三种：</p>
<ul>
<li>全局执行上下文：只有一个，浏览器中的全局对象就是 <code>window</code>对象，<code>this</code> 指向这个全局对象</li>
<li>函数执行上下文：存在无数个，只有在函数被调用的时候才会被创建，每次调用函数都会创建一个新的执行上下文</li>
<li>Eval 函数执行上下文： 指的是运行在 <code>eval</code> 函数中的代码，很少用而且不建议使用</li>
</ul>
<p>下面给出全局上下文和函数上下文的例子：</p>
<p><img src="https://static.vue-js.com/90dd3b60-74c1-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>紫色框住的部分为全局上下文，蓝色和橘色框起来的是不同的函数上下文。只有全局上下文（的变量）能被其他任何上下文访问</p>
<p>可以有任意多个函数上下文，每次调用函数创建一个新的上下文，会创建一个私有作用域，函数内部声明的任何变量都不能在当前函数作用域外部直接访问</p>
<h2 id="二、生命周期"><a href="#二、生命周期" class="headerlink" title="二、生命周期"></a>二、生命周期</h2><p>执行上下文的生命周期包括三个阶段：创建阶段 → 执行阶段 → 回收阶段</p>
<h3 id="创建阶段"><a href="#创建阶段" class="headerlink" title="创建阶段"></a>创建阶段</h3><p>创建阶段即当函数被调用，但未执行任何其内部代码之前</p>
<p>创建阶段做了三件事：</p>
<ul>
<li>确定 this 的值，也被称为 <code>This Binding</code></li>
<li>LexicalEnvironment（词法环境） 组件被创建</li>
<li>VariableEnvironment（变量环境） 组件被创建</li>
</ul>
<p>伪代码如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ExecutionContext = &#123;</span><br><span class="line">  ThisBinding = <span class="xml"><span class="tag">&lt;<span class="name">this</span> <span class="attr">value</span>&gt;</span>,     // 确定this</span></span><br><span class="line"><span class="xml">  LexicalEnvironment = &#123; ... &#125;,   // 词法环境</span></span><br><span class="line"><span class="xml">  VariableEnvironment = &#123; ... &#125;,  // 变量环境</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="This-Binding"><a href="#This-Binding" class="headerlink" title="This Binding"></a>This Binding</h4><p>确定<code>this</code>的值我们前面讲到，<code>this</code>的值是在执行的时候才能确认，定义的时候不能确认</p>
<h4 id="词法环境"><a href="#词法环境" class="headerlink" title="词法环境"></a>词法环境</h4><p>词法环境有两个组成部分：</p>
<ul>
<li><p>全局环境：是一个没有外部环境的词法环境，其外部环境引用为<code>null</code>，有一个全局对象，<code>this</code> 的值指向这个全局对象</p>
</li>
<li><p>函数环境：用户在函数中定义的变量被存储在环境记录中，包含了<code>arguments</code> 对象，外部环境的引用可以是全局环境，也可以是包含内部函数的外部函数环境</p>
</li>
</ul>
<p>伪代码如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">GlobalExectionContext = &#123;  <span class="comment">// 全局执行上下文</span></span><br><span class="line">  <span class="attr">LexicalEnvironment</span>: &#123;       <span class="comment">// 词法环境</span></span><br><span class="line">    <span class="attr">EnvironmentRecord</span>: &#123;     <span class="comment">// 环境记录</span></span><br><span class="line">      <span class="attr">Type</span>: <span class="string">&quot;Object&quot;</span>,           <span class="comment">// 全局环境</span></span><br><span class="line">      <span class="comment">// 标识符绑定在这里</span></span><br><span class="line">      <span class="attr">outer</span>: &lt;<span class="literal">null</span>&gt;           <span class="comment">// 对外部环境的引用</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">FunctionExectionContext = &#123; <span class="comment">// 函数执行上下文</span></span><br><span class="line">  <span class="attr">LexicalEnvironment</span>: &#123;     <span class="comment">// 词法环境</span></span><br><span class="line">    <span class="attr">EnvironmentRecord</span>: &#123;    <span class="comment">// 环境记录</span></span><br><span class="line">      <span class="attr">Type</span>: <span class="string">&quot;Declarative&quot;</span>,      <span class="comment">// 函数环境</span></span><br><span class="line">      <span class="comment">// 标识符绑定在这里      // 对外部环境的引用</span></span><br><span class="line">      <span class="attr">outer</span>: <span class="xml"><span class="tag">&lt;<span class="name">Global</span> <span class="attr">or</span> <span class="attr">outer</span> <span class="attr">function</span> <span class="attr">environment</span> <span class="attr">reference</span>&gt;</span></span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="变量环境"><a href="#变量环境" class="headerlink" title="变量环境"></a>变量环境</h4><p>变量环境也是一个词法环境，因此它具有上面定义的词法环境的所有属性</p>
<p>在 ES6 中，词法环境和变量环境的区别在于前者用于存储函数声明和变量（ <code>let</code> 和 <code>const</code> ）绑定，而后者仅用于存储变量（ <code>var</code> ）绑定</p>
<p>举个例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">var</span> c;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">multiply</span>(<span class="params">e, f</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> g = <span class="number">20</span>;</span><br><span class="line">  <span class="keyword">return</span> e * f * g;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c = multiply(<span class="number">20</span>, <span class="number">30</span>);</span><br></pre></td></tr></table></figure>
<p>执行上下文如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">GlobalExectionContext = &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attr">ThisBinding</span>: &lt;Global Object&gt;,</span><br><span class="line"></span><br><span class="line">  LexicalEnvironment: &#123;  // 词法环境</span><br><span class="line">    EnvironmentRecord: &#123;</span><br><span class="line">      Type: &quot;Object&quot;,</span><br><span class="line">      // 标识符绑定在这里</span><br><span class="line">      a: &lt; uninitialized &gt;,</span><br><span class="line">      b: &lt; uninitialized &gt;,</span><br><span class="line">      multiply: &lt; func &gt;</span><br><span class="line">    &#125;</span><br><span class="line">    outer: &lt;null&gt;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  VariableEnvironment: &#123;  // 变量环境</span><br><span class="line">    EnvironmentRecord: &#123;</span><br><span class="line">      Type: &quot;Object&quot;,</span><br><span class="line">      // 标识符绑定在这里</span><br><span class="line">      c: undefined,</span><br><span class="line">    &#125;</span><br><span class="line">    outer: &lt;null&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">FunctionExectionContext = &#123;</span><br><span class="line"></span><br><span class="line">  ThisBinding: &lt;Global Object&gt;,</span><br><span class="line"></span><br><span class="line">  LexicalEnvironment: &#123;</span><br><span class="line">    EnvironmentRecord: &#123;</span><br><span class="line">      Type: &quot;Declarative&quot;,</span><br><span class="line">      // 标识符绑定在这里</span><br><span class="line">      Arguments: &#123;0: 20, 1: 30, length: 2&#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    outer: &lt;GlobalLexicalEnvironment&gt;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  VariableEnvironment: &#123;</span><br><span class="line">    EnvironmentRecord: &#123;</span><br><span class="line">      Type: &quot;Declarative&quot;,</span><br><span class="line">      // 标识符绑定在这里</span><br><span class="line">      g: undefined</span><br><span class="line">    &#125;,</span><br><span class="line">    outer: &lt;GlobalLexicalEnvironment&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>留意上面的代码，<code>let</code>和<code>const</code>定义的变量<code>a</code>和<code>b</code>在创建阶段没有被赋值，但<code>var</code>声明的变量从在创建阶段被赋值为<code>undefined</code></p>
<p>这是因为，创建阶段，会在代码中扫描变量和函数声明，然后将函数声明存储在环境中</p>
<p>但变量会被初始化为<code>undefined</code>(<code>var</code>声明的情况下)和保持<code>uninitialized</code>(未初始化状态)(使用<code>let</code>和<code>const</code>声明的情况下)</p>
<p>这就是变量提升的实际原因</p>
<h3 id="执行阶段"><a href="#执行阶段" class="headerlink" title="执行阶段"></a>执行阶段</h3><p>在这阶段，执行变量赋值、代码执行</p>
<p>如果 <code>Javascript</code> 引擎在源代码中声明的实际位置找不到变量的值，那么将为其分配 <code>undefined</code> 值</p>
<h3 id="回收阶段"><a href="#回收阶段" class="headerlink" title="回收阶段"></a>回收阶段</h3><p>执行上下文出栈等待虚拟机回收执行上下文</p>
<h2 id="二、执行栈"><a href="#二、执行栈" class="headerlink" title="二、执行栈"></a>二、执行栈</h2><p>执行栈，也叫调用栈，具有 LIFO（后进先出）结构，用于存储在代码执行期间创建的所有执行上下文</p>
<p><img src="https://static.vue-js.com/9eda0310-74c1-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>当<code>Javascript</code>引擎开始执行你第一行脚本代码的时候，它就会创建一个全局执行上下文然后将它压到执行栈中</p>
<p>每当引擎碰到一个函数的时候，它就会创建一个函数执行上下文，然后将这个执行上下文压到执行栈中</p>
<p>引擎会执行位于执行栈栈顶的执行上下文(一般是函数执行上下文)，当该函数执行结束后，对应的执行上下文就会被弹出，然后控制流程到达执行栈的下一个执行上下文</p>
<p>举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">first</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Inside first function&quot;</span>);</span><br><span class="line">  second();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Again inside first function&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">second</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Inside second function&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">first();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;Inside Global Execution Context&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>转化成图的形式</p>
<p><img src="https://static.vue-js.com/ac11a600-74c1-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>简单分析一下流程：</p>
<ul>
<li>创建全局上下文请压入执行栈</li>
<li><code>first</code>函数被调用，创建函数执行上下文并压入栈</li>
<li>执行<code>first</code>函数过程遇到<code>second</code>函数，再创建一个函数执行上下文并压入栈</li>
<li><code>second</code>函数执行完毕，对应的函数执行上下文被推出执行栈，执行下一个执行上下文<code>first</code>函数</li>
<li><code>first</code>函数执行完毕，对应的函数执行上下文也被推出栈中，然后执行全局上下文</li>
<li>所有代码执行完毕，全局上下文也会被推出栈中，程序结束</li>
</ul>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://zhuanlan.zhihu.com/p/107552264">https://zhuanlan.zhihu.com/p/107552264</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>context_stack</tag>
      </tags>
  </entry>
  <entry>
    <title>copy</title>
    <url>/archives/4dbabb82.html</url>
    <content><![CDATA[<h1 id="面试官：深拷贝浅拷贝的区别？如何实现一个深拷贝？"><a href="#面试官：深拷贝浅拷贝的区别？如何实现一个深拷贝？" class="headerlink" title="面试官：深拷贝浅拷贝的区别？如何实现一个深拷贝？"></a>面试官：深拷贝浅拷贝的区别？如何实现一个深拷贝？</h1><p><img src="https://static.vue-js.com/cdf952e0-69b8-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、数据类型存储"><a href="#一、数据类型存储" class="headerlink" title="一、数据类型存储"></a>一、数据类型存储</h2><p>前面文章我们讲到，<code>JavaScript</code>中存在两大数据类型：</p>
<ul>
<li>基本类型</li>
<li>引用类型</li>
</ul>
<p>基本类型数据保存在在栈内存中</p>
<p>引用类型数据保存在堆内存中，引用数据类型的变量是一个指向堆内存中实际对象的引用，存在栈中</p>
<h2 id="二、浅拷贝"><a href="#二、浅拷贝" class="headerlink" title="二、浅拷贝"></a>二、浅拷贝</h2><p>浅拷贝，指的是创建新的数据，这个数据有着原始数据属性值的一份精确拷贝</p>
<p>如果属性是基本类型，拷贝的就是基本类型的值。如果属性是引用类型，拷贝的就是内存地址</p>
<p>即浅拷贝是拷贝一层，深层次的引用类型则共享内存地址</p>
<p>下面简单实现一个浅拷贝</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shallowClone</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> newObj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> prop <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.hasOwnProperty(prop)) &#123;</span><br><span class="line">      newObj[prop] = obj[prop];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newObj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在<code>JavaScript</code>中，存在浅拷贝的现象有：</p>
<ul>
<li><code>Object.assign</code></li>
<li><code>Array.prototype.slice()</code>, <code>Array.prototype.concat()</code></li>
<li>使用拓展运算符实现的复制</li>
</ul>
<h3 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign"></a>Object.assign</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">nature</span>: [<span class="string">&quot;smart&quot;</span>, <span class="string">&quot;good&quot;</span>],</span><br><span class="line">  <span class="attr">names</span>: &#123;</span><br><span class="line">    <span class="attr">name1</span>: <span class="string">&quot;fx&quot;</span>,</span><br><span class="line">    <span class="attr">name2</span>: <span class="string">&quot;xka&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">love</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;fx is a great girl&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> newObj = <span class="built_in">Object</span>.assign(&#123;&#125;, fxObj);</span><br></pre></td></tr></table></figure>
<h3 id="slice"><a href="#slice" class="headerlink" title="slice()"></a>slice()</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fxArr = [<span class="string">&quot;One&quot;</span>, <span class="string">&quot;Two&quot;</span>, <span class="string">&quot;Three&quot;</span>];</span><br><span class="line"><span class="keyword">const</span> fxArrs = fxArr.slice(<span class="number">0</span>);</span><br><span class="line">fxArrs[<span class="number">1</span>] = <span class="string">&quot;love&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(fxArr); <span class="comment">// [&quot;One&quot;, &quot;Two&quot;, &quot;Three&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(fxArrs); <span class="comment">// [&quot;One&quot;, &quot;love&quot;, &quot;Three&quot;]</span></span><br></pre></td></tr></table></figure>
<h3 id="concat"><a href="#concat" class="headerlink" title="concat()"></a>concat()</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fxArr = [<span class="string">&quot;One&quot;</span>, <span class="string">&quot;Two&quot;</span>, <span class="string">&quot;Three&quot;</span>];</span><br><span class="line"><span class="keyword">const</span> fxArrs = fxArr.concat();</span><br><span class="line">fxArrs[<span class="number">1</span>] = <span class="string">&quot;love&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(fxArr); <span class="comment">// [&quot;One&quot;, &quot;Two&quot;, &quot;Three&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(fxArrs); <span class="comment">// [&quot;One&quot;, &quot;love&quot;, &quot;Three&quot;]</span></span><br></pre></td></tr></table></figure>
<h3 id="拓展运算符"><a href="#拓展运算符" class="headerlink" title="拓展运算符"></a>拓展运算符</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fxArr = [<span class="string">&quot;One&quot;</span>, <span class="string">&quot;Two&quot;</span>, <span class="string">&quot;Three&quot;</span>];</span><br><span class="line"><span class="keyword">const</span> fxArrs = [...fxArr];</span><br><span class="line">fxArrs[<span class="number">1</span>] = <span class="string">&quot;love&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(fxArr); <span class="comment">// [&quot;One&quot;, &quot;Two&quot;, &quot;Three&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(fxArrs); <span class="comment">// [&quot;One&quot;, &quot;love&quot;, &quot;Three&quot;]</span></span><br></pre></td></tr></table></figure>
<h2 id="三、深拷贝"><a href="#三、深拷贝" class="headerlink" title="三、深拷贝"></a>三、深拷贝</h2><p>深拷贝开辟一个新的栈，两个对象属完成相同，但是对应两个不同的地址，修改一个对象的属性，不会改变另一个对象的属性</p>
<p>常见的深拷贝方式有：</p>
<ul>
<li><p>_.cloneDeep()</p>
</li>
<li><p>jQuery.extend()</p>
</li>
<li>JSON.stringify()</li>
<li>手写循环递归</li>
</ul>
<h3 id="cloneDeep"><a href="#cloneDeep" class="headerlink" title="_.cloneDeep()"></a>_.cloneDeep()</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> _ = <span class="built_in">require</span>(<span class="string">&quot;lodash&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: &#123; <span class="attr">f</span>: &#123; <span class="attr">g</span>: <span class="number">1</span> &#125; &#125;,</span><br><span class="line">  <span class="attr">c</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = _.cloneDeep(obj1);</span><br><span class="line"><span class="built_in">console</span>.log(obj1.b.f === obj2.b.f); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="jQuery-extend"><a href="#jQuery-extend" class="headerlink" title="jQuery.extend()"></a>jQuery.extend()</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> $ = <span class="built_in">require</span>(<span class="string">&quot;jquery&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: &#123; <span class="attr">f</span>: &#123; <span class="attr">g</span>: <span class="number">1</span> &#125; &#125;,</span><br><span class="line">  <span class="attr">c</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = $.extend(<span class="literal">true</span>, &#123;&#125;, obj1);</span><br><span class="line"><span class="built_in">console</span>.log(obj1.b.f === obj2.b.f); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="JSON-stringify"><a href="#JSON-stringify" class="headerlink" title="JSON.stringify()"></a>JSON.stringify()</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj2 = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj1));</span><br></pre></td></tr></table></figure>
<p>但是这种方式存在弊端，会忽略<code>undefined</code>、<code>symbol</code>和<code>函数</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;A&quot;</span>,</span><br><span class="line">  <span class="attr">name1</span>: <span class="literal">undefined</span>,</span><br><span class="line">  <span class="attr">name3</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  <span class="attr">name4</span>: <span class="built_in">Symbol</span>(<span class="string">&quot;A&quot;</span>),</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line"><span class="built_in">console</span>.log(obj2); <span class="comment">// &#123;name: &quot;A&quot;&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="循环递归"><a href="#循环递归" class="headerlink" title="循环递归"></a>循环递归</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">obj, hash = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (obj === <span class="literal">null</span>) <span class="keyword">return</span> obj; <span class="comment">// 如果是null或者undefined我就不进行拷贝操作</span></span><br><span class="line">  <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="built_in">Date</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(obj);</span><br><span class="line">  <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">RegExp</span>(obj);</span><br><span class="line">  <span class="comment">// 可能是对象或者普通的值  如果是函数的话是不需要深拷贝</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&quot;object&quot;</span>) <span class="keyword">return</span> obj;</span><br><span class="line">  <span class="comment">// 是对象的话就要进行深拷贝</span></span><br><span class="line">  <span class="keyword">if</span> (hash.get(obj)) <span class="keyword">return</span> hash.get(obj);</span><br><span class="line">  <span class="keyword">let</span> cloneObj = <span class="keyword">new</span> obj.constructor();</span><br><span class="line">  <span class="comment">// 找到的是所属类原型上的constructor,而原型上的 constructor指向的是当前类本身</span></span><br><span class="line">  hash.set(obj, cloneObj);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.hasOwnProperty(key)) &#123;</span><br><span class="line">      <span class="comment">// 实现一个递归拷贝</span></span><br><span class="line">      cloneObj[key] = deepClone(obj[key], hash);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cloneObj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="四、区别"><a href="#四、区别" class="headerlink" title="四、区别"></a>四、区别</h2><p>下面首先借助两张图，可以更加清晰看到浅拷贝与深拷贝的区别</p>
<p><img src="https://static.vue-js.com/d9862c00-69b8-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>从上图发现，浅拷贝和深拷贝都创建出一个新的对象，但在复制对象属性的时候，行为就不一样</p>
<p>浅拷贝只复制属性指向某个对象的指针，而不复制对象本身，新旧对象还是共享同一块内存，修改对象属性会影响原对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 浅拷贝</span></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;init&quot;</span>,</span><br><span class="line">  <span class="attr">arr</span>: [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj3 = shallowClone(obj1); <span class="comment">// 一个浅拷贝方法</span></span><br><span class="line">obj3.name = <span class="string">&quot;update&quot;</span>;</span><br><span class="line">obj3.arr[<span class="number">1</span>] = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]; <span class="comment">// 新旧对象还是共享同一块内存</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;obj1&quot;</span>, obj1); <span class="comment">// obj1 &#123; name: &#x27;init&#x27;,  arr: [ 1, [ 5, 6, 7 ], 4 ] &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;obj3&quot;</span>, obj3); <span class="comment">// obj3 &#123; name: &#x27;update&#x27;, arr: [ 1, [ 5, 6, 7 ], 4 ] &#125;</span></span><br></pre></td></tr></table></figure>
<p>但深拷贝会另外创造一个一模一样的对象，新对象跟原对象不共享内存，修改新对象不会改到原对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 深拷贝</span></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;init&quot;</span>,</span><br><span class="line">  <span class="attr">arr</span>: [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj4 = deepClone(obj1); <span class="comment">// 一个深拷贝方法</span></span><br><span class="line">obj4.name = <span class="string">&quot;update&quot;</span>;</span><br><span class="line">obj4.arr[<span class="number">1</span>] = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]; <span class="comment">// 新对象跟原对象不共享内存</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;obj1&quot;</span>, obj1); <span class="comment">// obj1 &#123; name: &#x27;init&#x27;, arr: [ 1, [ 2, 3 ], 4 ] &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;obj4&quot;</span>, obj4); <span class="comment">// obj4 &#123; name: &#x27;update&#x27;, arr: [ 1, [ 5, 6, 7 ], 4 ] &#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>前提为拷贝类型为引用类型的情况下：</p>
<ul>
<li><p>浅拷贝是拷贝一层，属性为对象时，浅拷贝是复制，两个对象指向同一个地址</p>
</li>
<li><p>深拷贝是递归拷贝深层次，属性为对象时，深拷贝是新开栈，两个对象指向不同的地址</p>
</li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>copy</tag>
      </tags>
  </entry>
  <entry>
    <title>css</title>
    <url>/archives/78cea6d8.html</url>
    <content><![CDATA[<hr>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-attr">[tag type=<span class="string">&quot;info&quot;</span>]</span>渐变<span class="selector-attr">[/tag]</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[collapse title=<span class="string">&quot;纯css实现&quot;</span> show=<span class="string">&quot;true&quot;</span>]</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="comment">/* 此处可以加入自己的图片 */</span></span><br><span class="line">    <span class="comment">/* background: #000 url(&#x27;../images/5.png&#x27;) no-repeat center; */</span></span><br><span class="line">    <span class="comment">/* background-size: cover;     to之后 可以改变颜色渐变方向 bottom,left,top */</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, skyblue, <span class="number">#496eaa</span>, <span class="built_in">rgb</span>(<span class="number">226</span>, <span class="number">111</span>, <span class="number">111</span>), <span class="number">#944fa8</span>, <span class="number">#a8804f</span>, <span class="number">#496eaa</span>);</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">1400%</span> <span class="number">300%</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">animation</span>: mymove <span class="number">20s</span> ease infinite;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: flex-start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> mymove &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">0%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">50%</span> <span class="number">100%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">0%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[/collapse]</span></span><br></pre></td></tr></table></figure>
<hr>
<p>[tag type=”warn”]flex[/tag]<br>[collapse title=”flex布局”]<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">        * &#123;</span><br><span class="line">            <span class="attr">margin</span>: <span class="number">0</span>;</span><br><span class="line">            padding: <span class="number">0</span>;</span><br><span class="line">            box-sizing: border-box;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ul &#123;</span><br><span class="line">            <span class="attr">display</span>: flex;</span><br><span class="line">            width: 600px;</span><br><span class="line">            height: 340px;</span><br><span class="line">            line-height: 80px;</span><br><span class="line">            text-align: center;</span><br><span class="line">            margin: 10px auto;</span><br><span class="line">            border:1px slateblue solid;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 主轴排序方式 */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 水平方向X 1234 */</span></span><br><span class="line">            <span class="comment">/* flex-direction: row;  默认*/</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 水平方向反转 4321 */</span></span><br><span class="line">            <span class="comment">/* flex-direction: row-reverse; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 垂直方向1234 */</span></span><br><span class="line">            <span class="comment">/* flex-direction: column; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 垂直方向4321 */</span></span><br><span class="line">            <span class="comment">/* flex-direction: column-reverse; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 设置子元素空间分布 */</span></span><br><span class="line">            <span class="comment">/* 两边不贴边，中间平分，左右空白距离相等 */</span></span><br><span class="line">            <span class="comment">/* justify-content: space-around;  */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 两边贴边，中间平分 */</span></span><br><span class="line">            <span class="comment">/* justify-content: space-between;  */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 平分每一块空间 */</span></span><br><span class="line">            <span class="comment">/* justify-content: space-evenly; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 沿主轴结束排列  1234 */</span></span><br><span class="line">            <span class="comment">/* justify-content: flex-end; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 沿主轴开始排列  1234  默认*/</span></span><br><span class="line">            <span class="comment">/* justify-content: flex-start; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 沿主轴中间分布 */</span></span><br><span class="line">            <span class="comment">/* justify-content: center; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 让其子元素沿其y轴底部排列 */</span></span><br><span class="line">            <span class="comment">/* align-items: flex-end; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* flex-flow 沿着垂直轴,换行*/</span></span><br><span class="line">            <span class="comment">/* flex-flow: column wrap; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 切换主轴为垂直轴y */</span></span><br><span class="line">            <span class="comment">/* flex-direction: column; */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 设置子盒子是否换行 */</span></span><br><span class="line">            <span class="comment">/* flex-wrap: wrap;   换行 */</span></span><br><span class="line">            <span class="comment">/* flex-wrap: nowrap;  不换行 */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 设置换行后的排列方式 */</span></span><br><span class="line">            align-content: center;</span><br><span class="line">            align-content: flex-end;</span><br><span class="line">            align-content: flex-start;</span><br><span class="line">            align-content: stretch; <span class="comment">/* 拉伸 */</span></span><br><span class="line">            align-content: space-around;</span><br><span class="line">            align-content: space-between;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        li &#123;</span><br><span class="line">            <span class="comment">/* flex: 0.5; */</span></span><br><span class="line">            <span class="comment">/* margin-right: 10px; */</span></span><br><span class="line">            <span class="attr">background</span>: aqua;</span><br><span class="line">            list-style: none;</span><br><span class="line">            width: 100px;</span><br><span class="line">            height: 90px;</span><br><span class="line">            color: rgb(<span class="number">60</span>, <span class="number">8</span>, <span class="number">128</span>);</span><br><span class="line">            border: 1px salmon solid;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="attr">li</span>:nth-<span class="function"><span class="title">child</span>(<span class="params"><span class="number">1</span></span>)</span>&#123;</span><br><span class="line">            <span class="comment">/* 控制子盒子沿主轴开始排列 */</span></span><br><span class="line">            <span class="comment">/* align-self: flex-start; */</span></span><br><span class="line">            <span class="attr">order</span>: <span class="number">9</span>; <span class="comment">/* 数值越大，越靠后排列 */</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="attr">li</span>:nth-<span class="function"><span class="title">child</span>(<span class="params"><span class="number">2</span></span>)</span>&#123;</span><br><span class="line">             <span class="comment">/* 控制子盒子沿主轴中间排列 */</span></span><br><span class="line">            <span class="comment">/* align-self: center; */</span></span><br><span class="line">            <span class="attr">order</span>: -<span class="number">2</span>; <span class="comment">/* 数值越小，越靠前排列 */</span></span><br><span class="line">            flex: <span class="number">1</span> <span class="number">2</span> 300px;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="attr">li</span>:nth-<span class="function"><span class="title">child</span>(<span class="params"><span class="number">3</span></span>)</span>&#123;</span><br><span class="line">             <span class="comment">/* 控制子盒子沿主轴结束排列 */</span></span><br><span class="line">            <span class="comment">/* align-self: flex-end; */</span></span><br><span class="line">            <span class="comment">/* 定义flex-shrink，项目的缩小比例默认为1，如果空间不足，则将该项目缩小 */</span></span><br><span class="line">            <span class="comment">/* flex-shrink: 2; 此时缩小 */</span></span><br><span class="line">            flex-shrink: <span class="number">2</span>; </span><br><span class="line">            <span class="comment">/* 此时、扩大 */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 扩充的原理公式flex-grow，如果空间剩余，则会生效该属性，、</span></span><br><span class="line"><span class="comment">            1.计算剩余空间，伸缩容器宽度 - 所有伸缩项的宽度和</span></span><br><span class="line"><span class="comment">            2，计算每份剩余空间的宽度，  剩余空间 / 需要的份数</span></span><br><span class="line"><span class="comment">            3.计算每个伸缩项最终宽度 ， 伸缩项的宽度 + 需要的份数 *每份的宽度</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            flex-grow: <span class="number">1</span>;             <span class="comment">/* 默认 */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/* flex:flex-grow: ,flex-shrink,flex-basis; */</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        body &#123;</span><br><span class="line">            max-width: 460px;</span><br><span class="line">            min-width: 360px;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><br>[/collapse]</p>
<p>[hint]下方flex详解—作者：阮一峰[/hint]<br><a href="https://www.ruanyifeng.com/blog/2015/07/flex-grammar.html">https://www.ruanyifeng.com/blog/2015/07/flex-grammar.html</a></p>
<hr>
<p>[tag type=”success”]px&amp;rem&amp;em[/tag]</p>
<ul>
<li>px  px像素（Pixel）。<strong>相对长度单位。</strong>像素px是相对于显示器屏幕分辨率而言的</li>
<li><ol>
<li>IE无法调整那些使用px作为单位的字体大小；</li>
</ol>
</li>
<li><ol>
<li>国外的大部分网站能够调整的原因在于其使用了em或rem作为字体单位；</li>
</ol>
</li>
<li><ol>
<li>Firefox能够调整px和em，rem，但是96%以上的中国网民使用IE浏览器(或内核)。</li>
</ol>
</li>
<li>em<strong>，em是相对长度单位。相对于当前对象内文本的字体尺寸</strong>。如当前对行内文本的字体尺寸未被人为设置，则相对于浏览器的默认字体尺寸</li>
<li><ol>
<li>em的值并不是固定的；</li>
</ol>
</li>
<li><ol>
<li>em会继承父级元素的字体大小。</li>
</ol>
</li>
<li><strong>rem是CSS3新增的一个相对单位（root em，根em）</strong></li>
<li>rem 相对于 html元素 字体大小来说的</li>
<li>rem的优点就是可以通过修改html里面的文字大小来改变页面中元素的大小可以整体控制 </li>
</ul>
<hr>
<p>[tag type=”danger”]媒体查询[/tag]</p>
<ul>
<li><strong>媒体查询Media Queries，可以根据不同的设备为其实现不同的样式。</strong></li>
<li>@media可以根据不同的屏幕尺寸设置不同的样式，页面布局分别适应移动端、pc端等，</li>
<li>在调整浏览器的大小，页面会根据媒体的宽度和高度来重新布置样式。</li>
<li>媒体查询可以用于检测很多东西：自动检测viewpoint（视窗）的宽度和高度；</li>
<li>设备的宽度和高度；旋转方向（智能手机横屏或竖屏）；分辨率大小。</li>
<li><strong>在media queries中，使用max / min来表示大于等于小于以此作为逻辑判断。而不是使用大于号&gt;或小于号(&lt;)符号进行判断</strong></li>
<li>（一）最小宽度min-width :当媒体类型<strong>大于或是等于</strong>指定的宽度时，大括号内的样式生效；</li>
<li>（二）最大宽度max-width：当媒体类型<strong>小于或是等于</strong>指定的宽度时，大括号内的样式生效；</li>
<li>orientation: portrait (竖屏模式) | landscape (横屏模式)</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">        <span class="comment">/* 这句话的意思就是： 在我们屏幕上 并且 最大的宽度是 800像素 设置我们想要的样式 */</span></span><br><span class="line">        <span class="comment">/* max-width 小于等于800 */</span></span><br><span class="line">        <span class="comment">/* 媒体查询可以根据不同的屏幕尺寸在改变不同的样式 */</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">800px</span>) &#123;</span><br><span class="line">            <span class="selector-tag">body</span> &#123;</span><br><span class="line">                <span class="attribute">background-color</span>: pink;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">500px</span>) &#123;</span><br><span class="line">            <span class="selector-tag">body</span> &#123;</span><br><span class="line">                <span class="attribute">background-color</span>: purple;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>[tag type=”info”]书写顺序建议[/tag]<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 1. 媒体查询一般按照从大到小或者 从小到大的顺序来 */</span></span><br><span class="line">      <span class="comment">/* 2. 小于540px 页面的背景颜色变为蓝色 */</span></span><br><span class="line">      <span class="selector-tag">body</span> &#123;</span><br><span class="line">          <span class="attribute">background-color</span>: gold;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">539px</span>) &#123;</span><br><span class="line">          <span class="selector-tag">body</span> &#123;</span><br><span class="line">              <span class="attribute">background-color</span>: blue;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">      <span class="comment">/* 3. 540 ~ 669 我们的页面颜色改为 绿色 */</span></span><br><span class="line">      <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">540px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">669px</span>) &#123;</span><br><span class="line">          <span class="selector-tag">body</span> &#123;</span><br><span class="line">              <span class="attribute">background-color</span>: green;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">700px</span>) &#123;</span><br><span class="line">          <span class="selector-tag">body</span> &#123;</span><br><span class="line">              <span class="attribute">background-color</span>:red;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/* 4. 大于等于970 我们页面的颜色改为 红色 */</span></span><br><span class="line">      </span><br><span class="line">      <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">970px</span>) &#123;</span><br><span class="line">          <span class="selector-tag">body</span> &#123;</span><br><span class="line">              <span class="attribute">background-color</span>: yellow;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/* 5. screen 还有 and 必须带上不能省略的 */</span></span><br><span class="line">      <span class="comment">/* 6. 我们的数字后面必须跟单位  970px   这个 px 不能省略的 */</span></span><br><span class="line">     </span><br><span class="line">  &lt;/style&gt;</span><br></pre></td></tr></table></figure><br>[tag type=”danger” outline]引入资源[/tag]<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">       <span class="comment">/* 当我们屏幕大于等于 640px以上的，我们让div 一行显示2个 */</span></span><br><span class="line">       <span class="comment">/* 当我们屏幕小于640 我们让div一行显示一个 */</span></span><br><span class="line">       <span class="comment">/* 一个建议： 我们媒体查询最好的方法是从小到大 */</span></span><br><span class="line">       <span class="comment">/* 引入资源就是 针对于不同的屏幕尺寸 调用不同的css文件 */</span></span><br><span class="line">     <span class="selector-tag">body</span> &#123;</span><br><span class="line">         <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="selector-tag">div</span> &#123;</span><br><span class="line">         <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">         <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">         <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">         <span class="attribute">background</span>: aqua;</span><br><span class="line">         <span class="attribute">text-align</span>: center;</span><br><span class="line">         <span class="attribute">margin-top</span>: <span class="number">12pc</span>;</span><br><span class="line">     &#125;</span><br><span class="line">   &lt;/style&gt;</span><br><span class="line">   &lt;link rel=&quot;stylesheet&quot; href=&quot;style320<span class="selector-class">.css</span>&quot; media=&quot;(<span class="attribute">min-width</span>: <span class="number">320px</span>) and (max-width:<span class="number">636px</span>)<span class="string">&quot;&gt;</span></span><br><span class="line"><span class="string">   &lt;link rel=&quot;</span>stylesheet<span class="string">&quot; href=&quot;</span>style640.css<span class="string">&quot; media=&quot;</span>(min-width: <span class="number">640px</span>) and (max-width :<span class="number">900px</span>)<span class="string">&quot;&gt;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure><br>[tag type=”warn” outline]识别不同屏幕状态[/tag]<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*orientation: portrait（竖屏，即设备中的页面可见区域高度&gt;=宽度）</span></span><br><span class="line"><span class="comment">　 　orientation: landscape（横屏，即设备中的页面可见区域高度&lt;=宽度） */</span></span><br><span class="line">   <span class="keyword">@media</span> (<span class="attribute">orientation</span>:landscape) &#123;</span><br><span class="line">         <span class="selector-tag">div</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">             <span class="attribute">content</span>: <span class="string">&#x27;横屏状态&#x27;</span>;</span><br><span class="line">             <span class="attribute">color</span>: royalblue;</span><br><span class="line">            </span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">@media</span> (<span class="attribute">orientation</span>:portrait) &#123;</span><br><span class="line">         <span class="selector-tag">div</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">             <span class="attribute">content</span>: <span class="string">&#x27;竖屏状态&#x27;</span>;</span><br><span class="line">             <span class="attribute">color</span>: gold;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure><br>[tag outline]区分不同的屏幕分辨率[/tag]<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">         <span class="attribute">width</span>: <span class="number">60px</span>;</span><br><span class="line">         <span class="attribute">height</span>: <span class="number">60px</span>;</span><br><span class="line">         <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">         <span class="attribute">color</span>: gold;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">/* 区分不同的屏幕分辨率 参数单位 dppx */</span></span><br><span class="line">     <span class="keyword">@media</span> (<span class="attribute">resolution</span> :<span class="number">3dppx</span>)&#123;</span><br><span class="line">         <span class="selector-tag">div</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">             <span class="attribute">content</span>: <span class="string">&#x27;3倍屏&#x27;</span>;</span><br><span class="line">             <span class="attribute">color</span>: gold;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">@media</span> (<span class="attribute">resolution</span>:<span class="number">2dppx</span>) &#123;</span><br><span class="line">         <span class="selector-tag">div</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">             <span class="attribute">content</span>: <span class="string">&#x27;2倍屏&#x27;</span>;</span><br><span class="line">             <span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">88</span>, <span class="number">79</span>, <span class="number">26</span>);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>[tag type=”danger”]识别不同设备[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;!-- 常见移动端 navigator.userAgent --&gt;</span><br><span class="line">   &lt;!-- <span class="string">&quot;Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1&quot;</span> --&gt;</span><br><span class="line">   &lt;!-- <span class="string">&quot;Mozilla/5.0 (Linux; Android 6.0.1; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Mobile Safari/537.36&quot;</span> --&gt;</span><br><span class="line">   &lt;!-- pc端 --&gt;</span><br><span class="line">   &lt;!-- <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36&quot;</span><span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36&quot;</span> --&gt;</span><br><span class="line">   <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">       <span class="function"><span class="keyword">function</span> <span class="title">isApp</span>(<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="comment">// 是否是苹果</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="keyword">if</span> (<span class="regexp">/iPhone/i</span>.test(navigator.userAgent)) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">               <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="comment">// 是否是安卓</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="keyword">if</span> (<span class="regexp">/android/i</span>.test(navigator.userAgent)) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">               <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="comment">// 是否是window phone</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="keyword">if</span> (<span class="regexp">/window phone/i</span>.test(navigator.userAgent)) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">               <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="comment">// pc</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">       &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">       <span class="keyword">if</span> (isApp()) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           location.href = <span class="string">&#x27;https://m.jd.com&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">       &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           location.href = <span class="string">&quot;https://www.jd.com&quot;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">       &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">   </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>[tag type=”primary” outline]内联操作符[/tag]</p>
<ul>
<li>内联操作符转自<strong>CSDN博主「小白张幺幺」的原创文章</strong></li>
<li>原文地址:<a href="https://blog.csdn.net/zzh1251994430/article/details/109477505">https://blog.csdn.net/zzh1251994430/article/details/109477505</a></li>
<li>媒体查询由多媒体组成，可以包含一个或多个表达式，根据表达式条件判断是否成立，返回 true 或 false。</li>
<li>如果指定的多媒体类型匹配设备类型则返回查询结果为true，文档会在匹配的设备上显示指定样式效果。</li>
<li>可以使用操作符’not’或 ‘only’ 或’and’或，限定。</li>
<li><strong>and：表示并且</strong>，要求必须满足所有的表达式要求时，才能使用media定义样式。</li>
<li><strong>not：不，表示除…外，</strong>即排除掉某些特定的设备的，如 @media not print（非打印设备）。</li>
<li><strong>注意：’not’针对的是一整条媒体查询语句，而非其中的某一个条件。</strong><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> <span class="keyword">not</span> print <span class="keyword">and</span>(<span class="attribute">max-width</span>:<span class="number">1024px</span>)&#123;...&#125;</span><br><span class="line"><span class="comment">/* 或者 */</span></span><br><span class="line"><span class="keyword">@media</span> <span class="keyword">not</span>(print <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">1024px</span>))&#123;..&#125;</span><br></pre></td></tr></table></figure></li>
<li>only： 表示只有 仅仅，表示某一种的媒体类型设备。</li>
<li>注意：对于支持Media Queries的移动设备来说，如果存在only关键字，移动设备的Web浏览器会忽略only关键字并直接根据后面的表达式应用样式文件。对于不支持Media Queries的设备但能够读取Media Type类型的Web浏览器，遇到only关键字时会忽略这个样式文件。</li>
<li>多个条件设定使用逗号分隔，表手或者or，满足其中之一。</li>
</ul>
<hr>
<p>[tag type=”primary” outline]兼容移动端[/tag]</p>
<p><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"></p>
<ul>
<li>width = device-width：宽度等于当前设备的宽度</li>
<li>initial-scale：初始的缩放比例（默认设置为1.0）  </li>
<li>minimum-scale：允许用户缩放到的最小比例（默认设置为1.0）    </li>
<li>maximum-scale：允许用户缩放到的最大比例（默认设置为1.0）   </li>
<li>user-scalable：用户是否可以手动缩放（默认设置为no，因为我们不希望用户放大缩小页面） </li>
</ul>
<hr>
<p>[tag type=”danger”]常见报错处理[/tag]</p>
<ol>
<li>首先css本身存在问题</li>
<li>div{display:flex;}/<em>那么div所有的display效果都将无法生效</em>/ </li>
<li>and 之后要有空格 <figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span>(<span class="attribute">max-width</span>: <span class="number">800px</span>) &#123;</span><br><span class="line">         <span class="selector-tag">body</span> &#123;</span><br><span class="line">             <span class="attribute">background-color</span>: pink;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     //此时页面就算大于<span class="number">500px</span>，页面也是没有pink色，</span><br><span class="line">     <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">500px</span>) &#123;</span><br><span class="line">         <span class="selector-tag">body</span> &#123;</span><br><span class="line">             <span class="attribute">background-color</span>: purple;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></li>
<li>样式冲突；@media查询代码的样式被后面的css所覆盖</li>
<li>注意：建议在书写css的过程中，@media查询带的css写在后面，以免这样避免被前面的css覆盖<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">   </span><br><span class="line">        <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">800px</span>) &#123;</span><br><span class="line">            <span class="selector-tag">body</span> &#123;</span><br><span class="line">                <span class="attribute">background-color</span>: pink;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">500px</span>) &#123;</span><br><span class="line">            <span class="selector-tag">body</span> &#123;</span><br><span class="line">                <span class="attribute">background-color</span>: purple;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-tag">body</span> &#123;</span><br><span class="line">            <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">//此时页面就算如何缩放，页面始终呈现<span class="selector-id">#000</span>色</span><br></pre></td></tr></table></figure></li>
<li>暂时就这些，以后补充…</li>
</ol>
<hr>
<p>[tag type=”warn” outline]文字超出显示省略号[/tag]</p>
<ol>
<li>单行文本</li>
<li>注意加宽度</li>
</ol>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line"><span class="attribute">text-overflow</span>:ellipsis;</span><br><span class="line"><span class="attribute">white-space</span>: nowrap;</span><br></pre></td></tr></table></figure>
<ul>
<li>多行文本</li>
<li>适用范围：</li>
<li>因使用了WebKit的CSS扩展属性，该方法适用于WebKit浏览器及移动端；</li>
<li>-webkit-line-clamp用来限制在一个块元素显示的文本的行数。</li>
<li>为了实现该效果，它需要组合其他的WebKit属性。常见结合属性：</li>
<li>display: -webkit-box; 必须结合的属性 ，将对象作为弹性伸缩盒子模型显示 。</li>
<li>-webkit-box-orient 必须结合的属性 ，设置或检索伸缩盒对象的子元素的排列方式 。</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">display</span>: -webkit-box; </span><br><span class="line">-webkit-box-orient: vertical; //盒子内容垂直布局</span><br><span class="line">-webkit-line-clamp: <span class="number">2</span>; // 超出<span class="number">2</span>行显示<span class="number">3</span>个点</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line"><span class="attribute">text-overflow</span>:ellipsis;</span><br><span class="line"><span class="attribute">word-break</span>:break-all; //解决长英文单词不换行问题</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>css_performance</title>
    <url>/archives/b21f48b9.html</url>
    <content><![CDATA[<h1 id="面试官：如果要做优化，CSS提高性能的方法有哪些？"><a href="#面试官：如果要做优化，CSS提高性能的方法有哪些？" class="headerlink" title="面试官：如果要做优化，CSS提高性能的方法有哪些？"></a>面试官：如果要做优化，CSS提高性能的方法有哪些？</h1><p> <img src="https://static.vue-js.com/c071c820-9fa3-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>每一个网页都离不开<code>css</code>，但是很多人又认为，<code>css</code>主要是用来完成页面布局的，像一些细节或者优化，就不需要怎么考虑，实际上这种想法是不正确的</p>
<p>作为页面渲染和内容展现的重要环节，<code>css</code>影响着用户对整个网站的第一体验</p>
<p>因此，在整个产品研发过程中，<code>css</code>性能优化同样需要贯穿全程</p>
<h2 id="二、实现方式"><a href="#二、实现方式" class="headerlink" title="二、实现方式"></a>二、实现方式</h2><p>实现方式有很多种，主要有如下：</p>
<ul>
<li>内联首屏关键CSS</li>
<li>异步加载CSS</li>
<li>资源压缩</li>
<li>合理使用选择器</li>
<li>减少使用昂贵的属性</li>
<li>不要使用@import</li>
</ul>
<h3 id="内联首屏关键CSS"><a href="#内联首屏关键CSS" class="headerlink" title="内联首屏关键CSS"></a>内联首屏关键CSS</h3><p>在打开一个页面，页面首要内容出现在屏幕的时间影响着用户的体验，而通过内联<code>css</code>关键代码能够使浏览器在下载完<code>html</code>后就能立刻渲染</p>
<p>而如果外部引用<code>css</code>代码，在解析<code>html</code>结构过程中遇到外部<code>css</code>文件，才会开始下载<code>css</code>代码，再渲染</p>
<p>所以，<code>CSS</code>内联使用使渲染时间提前</p>
<p>注意：但是较大的<code>css</code>代码并不合适内联（初始拥塞窗口、没有缓存），而其余代码则采取外部引用方式</p>
<h3 id="异步加载CSS"><a href="#异步加载CSS" class="headerlink" title="异步加载CSS"></a>异步加载CSS</h3><p>在<code>CSS</code>文件请求、下载、解析完成之前，<code>CSS</code>会阻塞渲染，浏览器将不会渲染任何已处理的内容</p>
<p>前面加载内联代码后，后面的外部引用<code>css</code>则没必要阻塞浏览器渲染。这时候就可以采取异步加载的方案，主要有如下：</p>
<ul>
<li>使用javascript将link标签插到head标签最后</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建link标签</span></span><br><span class="line"><span class="keyword">const</span> myCSS = <span class="built_in">document</span>.createElement( <span class="string">&quot;link&quot;</span> );</span><br><span class="line">myCSS.rel = <span class="string">&quot;stylesheet&quot;</span>;</span><br><span class="line">myCSS.href = <span class="string">&quot;mystyles.css&quot;</span>;</span><br><span class="line"><span class="comment">// 插入到header的最后位置</span></span><br><span class="line"><span class="built_in">document</span>.head.insertBefore( myCSS, <span class="built_in">document</span>.head.childNodes[ <span class="built_in">document</span>.head.childNodes.length - <span class="number">1</span> ].nextSibling );</span><br></pre></td></tr></table></figure>
<ul>
<li>设置link标签media属性为noexis，浏览器会认为当前样式表不适用当前类型，会在不阻塞页面渲染的情况下再进行下载。加载完成后，将<code>media</code>的值设为<code>screen</code>或<code>all</code>，从而让浏览器开始解析CSS</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mystyles.css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;noexist&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.media=&#x27;all&#x27;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>通过rel属性将link元素标记为alternate可选样式表，也能实现浏览器异步加载。同样别忘了加载完成之后，将rel设回stylesheet</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;alternate stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mystyles.css&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.rel=&#x27;stylesheet&#x27;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="资源压缩"><a href="#资源压缩" class="headerlink" title="资源压缩"></a>资源压缩</h3><p>利用<code>webpack</code>、<code>gulp/grunt</code>、<code>rollup</code>等模块化工具，将<code>css</code>代码进行压缩，使文件变小，大大降低了浏览器的加载时间</p>
<h3 id="合理使用选择器"><a href="#合理使用选择器" class="headerlink" title="合理使用选择器"></a>合理使用选择器</h3><p><code>css</code>匹配的规则是从右往左开始匹配，例如<code>#markdown .content h3</code>匹配规则如下：</p>
<ul>
<li>先找到h3标签元素</li>
<li>然后去除祖先不是.content的元素</li>
<li>最后去除祖先不是#markdown的元素</li>
</ul>
<p>如果嵌套的层级更多，页面中的元素更多，那么匹配所要花费的时间代价自然更高</p>
<p>所以我们在编写选择器的时候，可以遵循以下规则：</p>
<ul>
<li>不要嵌套使用过多复杂选择器，最好不要三层以上</li>
<li>使用id选择器就没必要再进行嵌套</li>
<li>通配符和属性选择器效率最低，避免使用</li>
</ul>
<h3 id="减少使用昂贵的属性"><a href="#减少使用昂贵的属性" class="headerlink" title="减少使用昂贵的属性"></a>减少使用昂贵的属性</h3><p>在页面发生重绘的时候，昂贵属性如<code>box-shadow</code>/<code>border-radius</code>/<code>filter</code>/透明度/<code>:nth-child</code>等，会降低浏览器的渲染性能</p>
<h3 id="不要使用-import"><a href="#不要使用-import" class="headerlink" title="不要使用@import"></a>不要使用@import</h3><p>css样式文件有两种引入方式，一种是<code>link</code>元素，另一种是<code>@import</code></p>
<p><code>@import</code>会影响浏览器的并行下载，使得页面在加载时增加额外的延迟，增添了额外的往返耗时</p>
<p>而且多个<code>@import</code>可能会导致下载顺序紊乱</p>
<p>比如一个css文件<code>index.css</code>包含了以下内容：<code>@import url(&quot;reset.css&quot;)</code></p>
<p>那么浏览器就必须先把<code>index.css</code>下载、解析和执行后，才下载、解析和执行第二个文件<code>reset.css</code></p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>减少重排操作，以及减少不必要的重绘</li>
<li>了解哪些属性可以继承而来，避免对这些属性重复编写</li>
<li>cssSprite，合成所有icon图片，用宽高加上backgroud-position的背景图方式显现出我们要的icon图，减少了http请求</li>
<li>把小的icon图片转成base64编码</li>
<li>CSS3动画或者过渡尽量使用transform和opacity来实现动画，不要使用left和top属性</li>
</ul>
<h2 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h2><p><code>css</code>实现性能的方式可以从选择器嵌套、属性特性、减少<code>http</code>这三面考虑，同时还要注意<code>css</code>代码的加载顺序</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://www.zhihu.com/question/19886806">https://www.zhihu.com/question/19886806</a></li>
<li><a href="https://juejin.cn/post/6844903649605320711#heading-1">https://juejin.cn/post/6844903649605320711#heading-1</a></li>
<li><a href="https://vue3js.cn/interview/">https://vue3js.cn/interview/</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>css_performance</tag>
      </tags>
  </entry>
  <entry>
    <title>css3_features</title>
    <url>/archives/7c942302.html</url>
    <content><![CDATA[<h1 id="面试官：CSS3新增了哪些新特性？"><a href="#面试官：CSS3新增了哪些新特性？" class="headerlink" title="面试官：CSS3新增了哪些新特性？"></a>面试官：CSS3新增了哪些新特性？</h1><p> <img src="https://static.vue-js.com/d58f6df0-9b5e-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p><code>css</code>，即层叠样式表（Cascading Style Sheets）的简称，是一种标记语言，由浏览器解释执行用来使页面变得更美观</p>
<p><code>css3</code>是<code>css</code>的最新标准，是向后兼容的，<code>CSS1/2</code>的特性在<code>CSS3</code> 里都是可以使用的</p>
<p>而<code>CSS3</code> 也增加了很多新特性，为开发带来了更佳的开发体验</p>
<h2 id="二、选择器"><a href="#二、选择器" class="headerlink" title="二、选择器"></a>二、选择器</h2><p><code>css3</code>中新增了一些选择器，主要为如下图所示：</p>
<p> <img src="https://static.vue-js.com/e368cf20-9b5e-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="三、新样式"><a href="#三、新样式" class="headerlink" title="三、新样式"></a>三、新样式</h2><h3 id="边框"><a href="#边框" class="headerlink" title="边框"></a>边框</h3><p><code>css3</code>新增了三个边框属性，分别是：</p>
<ul>
<li>border-radius：创建圆角边框</li>
<li><p>box-shadow：为元素添加阴影</p>
</li>
<li><p>border-image：使用图片来绘制边框</p>
</li>
</ul>
<h4 id="box-shadow"><a href="#box-shadow" class="headerlink" title="box-shadow"></a>box-shadow</h4><p>设置元素阴影，设置属性如下：</p>
<ul>
<li>水平阴影</li>
<li>垂直阴影</li>
<li>模糊距离(虚实)</li>
<li>阴影尺寸(影子大小)</li>
<li>阴影颜色</li>
<li>内/外阴影</li>
</ul>
<p>其中水平阴影和垂直阴影是必须设置的</p>
<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>新增了几个关于背景的属性，分别是<code>background-clip</code>、<code>background-origin</code>、<code>background-size</code>和<code>background-break</code></p>
<h4 id="background-clip"><a href="#background-clip" class="headerlink" title="background-clip"></a>background-clip</h4><p>用于确定背景画区，有以下几种可能的属性：</p>
<ul>
<li>background-clip: border-box; 背景从border开始显示</li>
<li>background-clip: padding-box; 背景从padding开始显示</li>
<li>background-clip: content-box; 背景显content区域开始显示</li>
<li>background-clip: no-clip; 默认属性，等同于border-box</li>
</ul>
<p>通常情况，背景都是覆盖整个元素的，利用这个属性可以设定背景颜色或图片的覆盖范围</p>
<h4 id="background-origin"><a href="#background-origin" class="headerlink" title="background-origin"></a>background-origin</h4><p>当我们设置背景图片时，图片是会以左上角对齐，但是是以<code>border</code>的左上角对齐还是以<code>padding</code>的左上角或者<code>content</code>的左上角对齐? <code>border-origin</code>正是用来设置这个的</p>
<ul>
<li>background-origin: border-box; 从border开始计算background-position</li>
<li>background-origin: padding-box; 从padding开始计算background-position</li>
<li>background-origin: content-box; 从content开始计算background-position</li>
</ul>
<p>默认情况是<code>padding-box</code>，即以<code>padding</code>的左上角为原点</p>
<h4 id="background-size"><a href="#background-size" class="headerlink" title="background-size"></a>background-size</h4><p>background-size属性常用来调整背景图片的大小，主要用于设定图片本身。有以下可能的属性：</p>
<ul>
<li>background-size: contain; 缩小图片以适合元素（维持像素长宽比）</li>
<li>background-size: cover; 扩展元素以填补元素（维持像素长宽比）</li>
<li>background-size: 100px 100px; 缩小图片至指定的大小</li>
<li>background-size: 50% 100%; 缩小图片至指定的大小，百分比是相对包 含元素的尺寸</li>
</ul>
<h3 id="background-break"><a href="#background-break" class="headerlink" title="background-break"></a>background-break</h3><p>元素可以被分成几个独立的盒子（如使内联元素span跨越多行），<code>background-break</code> 属性用来控制背景怎样在这些不同的盒子中显示</p>
<ul>
<li>background-break: continuous; 默认值。忽略盒之间的距离（也就是像元素没有分成多个盒子，依然是一个整体一样）</li>
<li>background-break: bounding-box; 把盒之间的距离计算在内；</li>
<li>background-break: each-box; 为每个盒子单独重绘背景</li>
</ul>
<h3 id="文字"><a href="#文字" class="headerlink" title="文字"></a>文字</h3><h3 id="word-wrap"><a href="#word-wrap" class="headerlink" title="word-wrap"></a>word-wrap</h3><p>语法：<code>word-wrap: normal|break-word</code></p>
<ul>
<li>normal：使用浏览器默认的换行</li>
<li>break-all：允许在单词内换行</li>
</ul>
<h3 id="text-overflow"><a href="#text-overflow" class="headerlink" title="text-overflow"></a>text-overflow</h3><p><code>text-overflow</code>设置或检索当当前行超过指定容器的边界时如何显示，属性有两个值选择：</p>
<ul>
<li>clip：修剪文本</li>
<li>ellipsis：显示省略符号来代表被修剪的文本</li>
</ul>
<h3 id="text-shadow"><a href="#text-shadow" class="headerlink" title="text-shadow"></a>text-shadow</h3><p><code>text-shadow</code>可向文本应用阴影。能够规定水平阴影、垂直阴影、模糊距离，以及阴影的颜色</p>
<h3 id="text-decoration"><a href="#text-decoration" class="headerlink" title="text-decoration"></a>text-decoration</h3><p>CSS3里面开始支持对文字的更深层次的渲染，具体有三个属性可供设置：</p>
<ul>
<li><p>text-fill-color: 设置文字内部填充颜色</p>
</li>
<li><p>text-stroke-color: 设置文字边界填充颜色</p>
</li>
<li><p>text-stroke-width: 设置文字边界宽度</p>
</li>
</ul>
<h3 id="颜色"><a href="#颜色" class="headerlink" title="颜色"></a>颜色</h3><p><code>css3</code>新增了新的颜色表示方式<code>rgba</code>与<code>hsla</code></p>
<ul>
<li>rgba分为两部分，rgb为颜色值，a为透明度</li>
<li>hala分为四部分，h为色相，s为饱和度，l为亮度，a为透明度</li>
</ul>
<h2 id="四、transition-过渡"><a href="#四、transition-过渡" class="headerlink" title="四、transition 过渡"></a>四、transition 过渡</h2><p><code>transition</code>属性可以被指定为一个或多个<code>CSS</code>属性的过渡效果，多个属性之间用逗号进行分隔，必须规定两项内容：</p>
<ul>
<li>过度效果</li>
<li>持续时间</li>
</ul>
<p>语法如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">transition</span>： CSS属性，花费时间，效果曲线(默认ease)，延迟时间(默认<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>上面为简写模式，也可以分开写各个属性</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">transition-property</span>: width; </span><br><span class="line"><span class="attribute">transition-duration</span>: <span class="number">1s</span>;</span><br><span class="line"><span class="attribute">transition-timing-function</span>: linear;</span><br><span class="line"><span class="attribute">transition-delay</span>: <span class="number">2s</span>;</span><br></pre></td></tr></table></figure>
<h3 id="五、transform-转换"><a href="#五、transform-转换" class="headerlink" title="五、transform 转换"></a>五、transform 转换</h3><p><code>transform</code>属性允许你旋转，缩放，倾斜或平移给定元素</p>
<p><code>transform-origin</code>：转换元素的位置（围绕那个点进行转换），默认值为<code>(x,y,z):(50%,50%,0)</code></p>
<p>使用方式：</p>
<ul>
<li>transform: translate(120px, 50%)：位移</li>
<li>transform: scale(2, 0.5)：缩放</li>
<li>transform: rotate(0.5turn)：旋转</li>
<li>transform: skew(30deg, 20deg)：倾斜</li>
</ul>
<h3 id="六、animation-动画"><a href="#六、animation-动画" class="headerlink" title="六、animation 动画"></a>六、animation 动画</h3><p>动画这个平常用的也很多，主要是做一个预设的动画。和一些页面交互的动画效果，结果和过渡应该一样，让页面不会那么生硬</p>
<p>animation也有很多的属性</p>
<ul>
<li>animation-name：动画名称</li>
<li>animation-duration：动画持续时间</li>
<li>animation-timing-function：动画时间函数</li>
<li>animation-delay：动画延迟时间</li>
<li>animation-iteration-count：动画执行次数，可以设置为一个整数，也可以设置为infinite，意思是无限循环</li>
<li>animation-direction：动画执行方向</li>
<li>animation-paly-state：动画播放状态</li>
<li>animation-fill-mode：动画填充模式</li>
</ul>
<h2 id="七、渐变"><a href="#七、渐变" class="headerlink" title="七、渐变"></a>七、渐变</h2><p>颜色渐变是指在两个颜色之间平稳的过渡，<code>css3</code>渐变包括</p>
<ul>
<li>linear-gradient：线性渐变</li>
</ul>
<blockquote>
<p>background-image: linear-gradient(direction, color-stop1, color-stop2, …);</p>
</blockquote>
<ul>
<li>radial-gradient：径向渐变</li>
</ul>
<blockquote>
<p>linear-gradient(0deg, red, green); </p>
</blockquote>
<h2 id="八、其他"><a href="#八、其他" class="headerlink" title="八、其他"></a>八、其他</h2><p>关于<code>css3</code>其他的新特性还包括<code>flex</code>弹性布局、<code>Grid</code>栅格布局，这两个布局在以前就已经讲过，这里就不再展示</p>
<p>除此之外，还包括多列布局、媒体查询、混合模式等等……</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><p><a href="https://juejin.cn/post/6844903518520901639#heading-1">https://juejin.cn/post/6844903518520901639#heading-1</a></p>
</li>
<li><p><a href="https://www.w3school.com.cn/css/index.asp">https://www.w3school.com.cn/css/index.asp</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>css3_features</tag>
      </tags>
  </entry>
  <entry>
    <title>data_type</title>
    <url>/archives/37919ccb.html</url>
    <content><![CDATA[<h1 id="面试官：说说JavaScript中的数据类型？存储上的差别？"><a href="#面试官：说说JavaScript中的数据类型？存储上的差别？" class="headerlink" title="面试官：说说JavaScript中的数据类型？存储上的差别？"></a>面试官：说说JavaScript中的数据类型？存储上的差别？</h1><p> <img src="https://static.vue-js.com/6d133f90-6463-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在<code>JavaScript</code>中，我们可以分成两种类型：</p>
<ul>
<li>基本类型</li>
<li>复杂类型</li>
</ul>
<p>两种类型的区别是：存储位置不同</p>
<h2 id="一、基本类型"><a href="#一、基本类型" class="headerlink" title="一、基本类型"></a>一、基本类型</h2><p>基本类型主要为以下6种：</p>
<ul>
<li>Number</li>
<li>String</li>
<li>Boolean</li>
<li>Undefined</li>
<li>null</li>
<li>symbol</li>
</ul>
<h3 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h3><p>数值最常见的整数类型格式则为十进制，还可以设置八进制（零开头）、十六进制（0x开头）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> intNum = <span class="number">55</span> <span class="comment">// 10进制的55</span></span><br><span class="line"><span class="keyword">let</span> num1 = <span class="number">070</span> <span class="comment">// 8进制的56</span></span><br><span class="line"><span class="keyword">let</span> hexNum1 = <span class="number">0xA</span> <span class="comment">//16进制的10</span></span><br></pre></td></tr></table></figure>
<p>浮点类型则在数值汇总必须包含小数点，还可通过科学计数法表示</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> floatNum1 = <span class="number">1.1</span>;</span><br><span class="line"><span class="keyword">let</span> floatNum2 = <span class="number">0.1</span>;</span><br><span class="line"><span class="keyword">let</span> floatNum3 = <span class="number">.1</span>; <span class="comment">// 有效，但不推荐</span></span><br><span class="line"><span class="keyword">let</span> floatNum = <span class="number">3.125e7</span>; <span class="comment">// 等于 31250000</span></span><br></pre></td></tr></table></figure>
<p>在数值类型中，存在一个特殊数值<code>NaN</code>，意为“不是数值”，用于表示本来要返回数值的操作失败了（而不是抛出错误）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">0</span>/<span class="number">0</span>); <span class="comment">// NaN</span></span><br><span class="line"><span class="built_in">console</span>.log(-<span class="number">0</span>/+<span class="number">0</span>); <span class="comment">// NaN</span></span><br></pre></td></tr></table></figure>
<h3 id="Undefined"><a href="#Undefined" class="headerlink" title="Undefined"></a>Undefined</h3><p><code>Undefined</code> 类型只有一个值，就是特殊值 <code>undefined</code>。当使用 <code>var</code>或 <code>let</code>声明了变量但没有初始化时，就相当于给变量赋予了 <code>undefined</code>值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> message;</span><br><span class="line"><span class="built_in">console</span>.log(message == <span class="literal">undefined</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>包含<code>undefined</code> 值的变量跟未定义变量是有区别的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> message; <span class="comment">// 这个变量被声明了，只是值为 undefined</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(message); <span class="comment">// &quot;undefined&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(age); <span class="comment">// 没有声明过这个变量，报错</span></span><br></pre></td></tr></table></figure>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>字符串可以使用双引号（”）、单引号（’）或反引号（`）标示</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> firstName = <span class="string">&quot;John&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> lastName = <span class="string">&#x27;Jacob&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> lastName = <span class="string">`Jingleheimerschmidt`</span></span><br></pre></td></tr></table></figure>
<p>字符串是不可变的，意思是一旦创建，它们的值就不能变了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> lang = <span class="string">&quot;Java&quot;</span>;</span><br><span class="line">lang = lang + <span class="string">&quot;Script&quot;</span>;  <span class="comment">// 先销毁再创建</span></span><br></pre></td></tr></table></figure>
<h3 id="Null"><a href="#Null" class="headerlink" title="Null"></a>Null</h3><p><code>Null</code>类型同样只有一个值，即特殊值 <code>null</code></p>
<p>逻辑上讲， null 值表示一个空对象指针，这也是给<code>typeof</code>传一个 <code>null</code> 会返回 <code>&quot;object&quot;</code> 的原因</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> car = <span class="literal">null</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> car); <span class="comment">// &quot;object&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>undefined</code> 值是由 <code>null</code>值派生而来</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="literal">null</span> == <span class="literal">undefined</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>只要变量要保存对象，而当时又没有那个对象可保存，就可用 <code>null</code>来填充该变量</p>
<h3 id="Boolean"><a href="#Boolean" class="headerlink" title="Boolean"></a>Boolean</h3><p><code>Boolean</code>（布尔值）类型有两个字面值： <code>true</code> 和<code>false</code></p>
<p>通过<code>Boolean</code>可以将其他类型的数据转化成布尔值</p>
<p>规则如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">数据类型      				转换为 <span class="literal">true</span> 的值      				转换为 <span class="literal">false</span> 的值</span><br><span class="line"> <span class="built_in">String</span>        				 非空字符串          					<span class="string">&quot;&quot;</span> </span><br><span class="line"> <span class="built_in">Number</span> 				非零数值（包括无穷值）						<span class="number">0</span> 、 <span class="literal">NaN</span> </span><br><span class="line"> <span class="built_in">Object</span> 					 任意对象 							   <span class="literal">null</span></span><br><span class="line">Undefined 					N/A （不存在） 						<span class="literal">undefined</span></span><br></pre></td></tr></table></figure>
<h3 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h3><p>Symbol （符号）是原始值，且符号实例是唯一、不可变的。符号的用途是确保对象属性使用唯一标识符，不会发生属性冲突的危险</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> genericSymbol = <span class="built_in">Symbol</span>();</span><br><span class="line"><span class="keyword">let</span> otherGenericSymbol = <span class="built_in">Symbol</span>();</span><br><span class="line"><span class="built_in">console</span>.log(genericSymbol == otherGenericSymbol); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fooSymbol = <span class="built_in">Symbol</span>(<span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> otherFooSymbol = <span class="built_in">Symbol</span>(<span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(fooSymbol == otherFooSymbol); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h2 id="二、引用类型"><a href="#二、引用类型" class="headerlink" title="二、引用类型"></a>二、引用类型</h2><p>复杂类型统称为<code>Object</code>，我们这里主要讲述下面三种：</p>
<ul>
<li>Object</li>
<li>Array</li>
<li>Function</li>
</ul>
<h3 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h3><p>创建<code>object</code>常用方式为对象字面量表示法，属性名可以是字符串或数值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Nicholas&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="number">29</span>,</span><br><span class="line">    <span class="number">5</span>: <span class="literal">true</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h3><p><code>JavaScript</code>数组是一组有序的数据，但跟其他语言不同的是，数组中每个槽位可以存储任意类型的数据。并且，数组也是动态大小的，会随着数据添加而自动增长</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="number">2</span>, &#123;<span class="attr">age</span>: <span class="number">20</span> &#125;]</span><br><span class="line">colors.push(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><p>函数实际上是对象，每个函数都是 <code>Function</code>类型的实例，而 <code>Function</code>也有属性和方法，跟其他引用类型一样</p>
<p>函数存在三种常见的表达方式：</p>
<ul>
<li>函数声明</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 函数声明</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span> (<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>函数表达式</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> sum = <span class="function"><span class="keyword">function</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>箭头函数</li>
</ul>
<p>函数声明和函数表达式两种方式</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> sum = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="其他引用类型"><a href="#其他引用类型" class="headerlink" title="其他引用类型"></a>其他引用类型</h3><p>除了上述说的三种之外，还包括<code>Date</code>、<code>RegExp</code>、<code>Map</code>、<code>Set</code>等……</p>
<h2 id="三、存储区别"><a href="#三、存储区别" class="headerlink" title="三、存储区别"></a>三、存储区别</h2><p>基本数据类型和引用数据类型存储在内存中的位置不同：</p>
<ul>
<li><p>基本数据类型存储在栈中</p>
</li>
<li><p>引用类型的对象存储于堆中</p>
</li>
</ul>
<p>当我们把变量赋值给一个变量时，解析器首先要确认的就是这个值是基本类型值还是引用类型值</p>
<p>下面来举个例子</p>
<h3 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">let</span> b = a; <span class="comment">// 赋值操作</span></span><br><span class="line">b = <span class="number">20</span>;</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 10值</span></span><br></pre></td></tr></table></figure>
<p><code>a</code>的值为一个基本类型，是存储在栈中，将<code>a</code>的值赋给<code>b</code>，虽然两个变量的值相等，但是两个变量保存了两个不同的内存地址</p>
<p>下图演示了基本类型赋值的过程：</p>
<p> <img src="https://static.vue-js.com/906ffb90-6463-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h3 id="引用类型"><a href="#引用类型" class="headerlink" title="引用类型"></a>引用类型</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = obj1;</span><br><span class="line">obj2.name = <span class="string">&quot;Xxx&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(obj1.name); <span class="comment">// xxx</span></span><br></pre></td></tr></table></figure>
<p>引用类型数据存放在内对内中，每个堆内存中有一个引用地址，该引用地址存放在栈中</p>
<p><code>obj1</code>是一个引用类型，在赋值操作过程汇总，实际是将堆内存对象在栈内存的引用地址复制了一份给了<code>obj2</code>，实际上他们共同指向了同一个堆内存对象，所以更改<code>obj2</code>会对<code>obj1</code>产生影响</p>
<p>下图演示这个引用类型赋值过程</p>
<p> <img src="https://static.vue-js.com/a34bdd10-6463-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li>声明变量时不同的内存地址分配：<ul>
<li>简单类型的值存放在栈中，在栈中存放的是对应的值</li>
<li>引用类型对应的值存储在堆中，在栈中存放的是指向堆内存的地址</li>
</ul>
</li>
<li>不同的类型数据导致赋值变量时的不同：<ul>
<li>简单类型赋值，是生成相同的值，两个对象对应不同的地址</li>
<li>复杂类型赋值，是将保存对象的内存地址赋值给另一个变量。也就是两个变量指向堆内存中同一个对象</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>data_type</tag>
      </tags>
  </entry>
  <entry>
    <title>debounce_throttle</title>
    <url>/archives/1be48ee.html</url>
    <content><![CDATA[<h1 id="面试官：什么是防抖和节流？有什么区别？如何实现？"><a href="#面试官：什么是防抖和节流？有什么区别？如何实现？" class="headerlink" title="面试官：什么是防抖和节流？有什么区别？如何实现？"></a>面试官：什么是防抖和节流？有什么区别？如何实现？</h1><p> <img src="https://static.vue-js.com/912f1a10-8787-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>本质上是优化高频率执行代码的一种手段</p>
<p>如：浏览器的 <code>resize</code>、<code>scroll</code>、<code>keypress</code>、<code>mousemove</code> 等事件在触发时，会不断地调用绑定在事件上的回调函数，极大地浪费资源，降低前端性能</p>
<p>为了优化体验，需要对这类事件进行调用次数的限制，对此我们就可以采用 <strong>防抖（debounce）</strong> 和 <strong>节流（throttle）</strong> 的方式来减少调用频率</p>
<h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><ul>
<li>节流: n 秒内只运行一次，若在 n 秒内重复触发，只有一次生效</li>
<li>防抖: n 秒后在执行该事件，若在 n 秒内被重复触发，则重新计时</li>
</ul>
<p>一个经典的比喻:</p>
<p>想象每天上班大厦底下的电梯。把电梯完成一次运送，类比为一次函数的执行和响应</p>
<p>假设电梯有两种运行策略 <code>debounce</code> 和 <code>throttle</code>，超时设定为15秒，不考虑容量限制</p>
<p>电梯第一个人进来后，15秒后准时运送一次，这是节流</p>
<p>电梯第一个人进来后，等待15秒。如果过程中又有人进来，15秒等待重新计时，直到15秒后开始运送，这是防抖</p>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><h3 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h3><p>完成节流可以使用时间戳与定时器的写法</p>
<p>使用时间戳写法，事件会立即执行，停止触发后没有办法再次执行</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttled1</span>(<span class="params">fn, delay = <span class="number">500</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> oldtime = <span class="built_in">Date</span>.now()</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> newtime = <span class="built_in">Date</span>.now()</span><br><span class="line">        <span class="keyword">if</span> (newtime - oldtime &gt;= delay) &#123;</span><br><span class="line">            fn.apply(<span class="literal">null</span>, args)</span><br><span class="line">            oldtime = <span class="built_in">Date</span>.now()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>使用定时器写法，<code>delay</code>毫秒后第一次执行，第二次事件停止触发后依然会再一次执行</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttled2</span>(<span class="params">fn, delay = <span class="number">500</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timer = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!timer) &#123;</span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                fn.apply(<span class="built_in">this</span>, args)</span><br><span class="line">                timer = <span class="literal">null</span></span><br><span class="line">            &#125;, delay);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以将时间戳写法的特性与定时器写法的特性相结合，实现一个更加精确的节流。实现如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttled</span>(<span class="params">fn, delay</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timer = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">let</span> starttime = <span class="built_in">Date</span>.now()</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> curTime = <span class="built_in">Date</span>.now() <span class="comment">// 当前时间</span></span><br><span class="line">        <span class="keyword">let</span> remaining = delay - (curTime - starttime)  <span class="comment">// 从上一次到现在，还剩下多少多余时间</span></span><br><span class="line">        <span class="keyword">let</span> context = <span class="built_in">this</span></span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span></span><br><span class="line">        <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">        <span class="keyword">if</span> (remaining &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            fn.apply(context, args)</span><br><span class="line">            starttime = <span class="built_in">Date</span>.now()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(fn, remaining);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h3><p>简单版本的实现</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="built_in">this</span>; <span class="comment">// 保存this指向</span></span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>; <span class="comment">// 拿到event对象</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">clearTimeout</span>(timeout)</span><br><span class="line">        timeout = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            func.apply(context, args)</span><br><span class="line">        &#125;, wait);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>防抖如果需要立即执行，可加入第三个参数用于判断，实现如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait, immediate</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="built_in">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (timeout) <span class="built_in">clearTimeout</span>(timeout); <span class="comment">// timeout 不为null</span></span><br><span class="line">        <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">            <span class="keyword">let</span> callNow = !timeout; <span class="comment">// 第一次会立即执行，以后只有事件执行后才会再次触发</span></span><br><span class="line">            timeout = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                timeout = <span class="literal">null</span>;</span><br><span class="line">            &#125;, wait)</span><br><span class="line">            <span class="keyword">if</span> (callNow) &#123;</span><br><span class="line">                func.apply(context, args)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            timeout = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                func.apply(context, args)</span><br><span class="line">            &#125;, wait);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二、区别"><a href="#二、区别" class="headerlink" title="二、区别"></a>二、区别</h2><p>相同点：</p>
<ul>
<li>都可以通过使用 <code>setTimeout</code> 实现</li>
<li>目的都是，降低回调执行频率。节省计算资源</li>
</ul>
<p>不同点：</p>
<ul>
<li>函数防抖，在一段连续操作结束后，处理回调，利用<code>clearTimeout</code>和 <code>setTimeout</code>实现。函数节流，在一段连续操作中，每一段时间只执行一次，频率较高的事件中使用来提高性能</li>
<li>函数防抖关注一定时间连续触发的事件，只在最后执行一次，而函数节流一段时间内只执行一次</li>
</ul>
<p>例如，都设置时间频率为500ms，在2秒时间内，频繁触发函数，节流，每隔 500ms 就执行一次。防抖，则不管调动多少次方法，在2s后，只会执行一次</p>
<p>如下图所示：</p>
<p> <img src="https://static.vue-js.com/a2c81b50-8787-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="三、应用场景"><a href="#三、应用场景" class="headerlink" title="三、应用场景"></a>三、应用场景</h2><p>防抖在连续的事件，只需触发一次回调的场景有：</p>
<ul>
<li>搜索框搜索输入。只需用户最后一次输入完，再发送请求</li>
<li>手机号、邮箱验证输入检测</li>
<li>窗口大小<code>resize</code>。只需窗口调整完成后，计算窗口大小。防止重复渲染。</li>
</ul>
<p>节流在间隔一段时间执行一次回调的场景有：</p>
<ul>
<li>滚动加载，加载更多或滚到底部监听</li>
<li>搜索框，搜索联想功能</li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>防抖节流</tag>
      </tags>
  </entry>
  <entry>
    <title>em_px_rem_vh_vw</title>
    <url>/archives/92004154.html</url>
    <content><![CDATA[<h1 id="面试官：说说em-px-rem-vh-vw区别"><a href="#面试官：说说em-px-rem-vh-vw区别" class="headerlink" title="面试官：说说em/px/rem/vh/vw区别?"></a>面试官：说说em/px/rem/vh/vw区别?</h1><p><img src="https://static.vue-js.com/51b036e0-9131-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h2><p>传统的项目开发中，我们只会用到<code>px</code>、<code>%</code>、<code>em</code>这几个单位，它可以适用于大部分的项目开发，且拥有比较良好的兼容性</p>
<p>从<code>CSS3</code>开始，浏览器对计量单位的支持又提升到了另外一个境界，新增了<code>rem</code>、<code>vh</code>、<code>vw</code>、<code>vm</code>等一些新的计量单位</p>
<p>利用这些新的单位开发出比较良好的响应式页面，适应多种不同分辨率的终端，包括移动设备等</p>
<h2 id="二、单位"><a href="#二、单位" class="headerlink" title="二、单位"></a>二、单位</h2><p>在<code>css</code>单位中，可以分为长度单位、绝对单位，如下表所指示</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>CSS单位</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>相对长度单位</td>
<td>em、ex、ch、rem、vw、vh、vmin、vmax、%</td>
</tr>
<tr>
<td>绝对长度单位</td>
<td>cm、mm、in、px、pt、pc</td>
</tr>
</tbody>
</table>
</div>
<p>这里我们主要讲述px、em、rem、vh、vw</p>
<h3 id="px"><a href="#px" class="headerlink" title="px"></a>px</h3><p>px，表示像素，所谓像素就是呈现在我们显示器上的一个个小点，每个像素点都是大小等同的，所以像素为计量单位被分在了绝对长度单位中</p>
<p>有些人会把<code>px</code>认为是相对长度，原因在于在移动端中存在设备像素比，<code>px</code>实际显示的大小是不确定的</p>
<p>这里之所以认为<code>px</code>为绝对单位，在于<code>px</code>的大小和元素的其他属性无关</p>
<h3 id="em"><a href="#em" class="headerlink" title="em"></a>em</h3><p>em是相对长度单位。相对于当前对象内文本的字体尺寸。如当前对行内文本的字体尺寸未被人为设置，则相对于浏览器的默认字体尺寸（<code>1em = 16px</code>）</p>
<p>为了简化 <code>font-size</code> 的换算，我们需要在<code>css</code>中的 <code>body</code> 选择器中声明<code>font-size</code>= <code>62.5%</code>，这就使 em 值变为 <code>16px*62.5% = 10px</code></p>
<p>这样 <code>12px = 1.2em</code>, <code>10px = 1em</code>, 也就是说只需要将你的原来的<code>px</code> 数值除以 10，然后换上 <code>em</code>作为单位就行了</p>
<p>特点：</p>
<ul>
<li>em 的值并不是固定的</li>
<li>em 会继承父级元素的字体大小</li>
<li>em 是相对长度单位。相对于当前对象内文本的字体尺寸。如当前对行内文本的字体尺寸未被人为设置，则相对于浏览器的默认字体尺寸</li>
<li>任意浏览器的默认字体高都是 16px</li>
</ul>
<p>举个例子</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;big&quot;</span>&gt;</span></span><br><span class="line">    我是14px=1.4rem<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;small&quot;</span>&gt;</span>我是12px=1.2rem<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>样式为</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    <span class="selector-tag">html</span> &#123;<span class="attribute">font-size</span>: <span class="number">10px</span>;  &#125; <span class="comment">/*  公式16px*62.5%=10px  */</span>  </span><br><span class="line">    <span class="selector-class">.big</span>&#123;<span class="attribute">font-size</span>: <span class="number">1.4rem</span>&#125;</span><br><span class="line">    <span class="selector-class">.small</span>&#123;<span class="attribute">font-size</span>: <span class="number">1.2rem</span>&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>这时候<code>.big</code>元素的<code>font-size</code>为14px，而<code>.small</code>元素的<code>font-size</code>为12px</p>
<h3 id="rem"><a href="#rem" class="headerlink" title="rem"></a>rem</h3><p>rem，相对单位，相对的只是HTML根元素<code>font-size</code>的值</p>
<p>同理，如果想要简化<code>font-size</code>的转化，我们可以在根元素<code>html</code>中加入<code>font-size: 62.5%</code></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;<span class="attribute">font-size</span>: <span class="number">62.5%</span>;  &#125; <span class="comment">/*  公式16px*62.5%=10px  */</span> </span><br></pre></td></tr></table></figure>
<p>这样页面中1rem=10px、1.2rem=12px、1.4rem=14px、1.6rem=16px;使得视觉、使用、书写都得到了极大的帮助</p>
<p>特点：</p>
<ul>
<li>rem单位可谓集相对大小和绝对大小的优点于一身</li>
<li>和em不同的是rem总是相对于根元素，而不像em一样使用级联的方式来计算尺寸</li>
</ul>
<h3 id="vh、vw"><a href="#vh、vw" class="headerlink" title="vh、vw"></a>vh、vw</h3><p>vw ，就是根据窗口的宽度，分成100等份，100vw就表示满宽，50vw就表示一半宽。（vw 始终是针对窗口的宽），同理，<code>vh</code>则为窗口的高度</p>
<p>这里的窗口分成几种情况：</p>
<ul>
<li><p>在桌面端，指的是浏览器的可视区域</p>
</li>
<li><p>移动端指的就是布局视口</p>
</li>
</ul>
<p>像<code>vw</code>、<code>vh</code>，比较容易混淆的一个单位是<code>%</code>，不过百分比宽泛的讲是相对于父元素：</p>
<ul>
<li>对于普通定位元素就是我们理解的父元素</li>
<li>对于position: absolute;的元素是相对于已定位的父元素</li>
<li>对于position: fixed;的元素是相对于 ViewPort（可视窗口）</li>
</ul>
<h2 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h2><p><strong>px</strong>：绝对单位，页面按精确像素展示</p>
<p><strong>em</strong>：相对单位，基准点为父节点字体的大小，如果自身定义了<code>font-size</code>按自身来计算，整个页面内<code>1em</code>不是一个固定的值</p>
<p><strong>rem</strong>：相对单位，可理解为<code>root em</code>, 相对根节点<code>html</code>的字体大小来计算</p>
<p><strong>vh、vw</strong>：主要用于页面视口大小布局，在页面布局上更加方便简单</p>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>em_px_rem_vh_vw</tag>
      </tags>
  </entry>
  <entry>
    <title>dp_px_dpr_ppi</title>
    <url>/archives/14015a55.html</url>
    <content><![CDATA[<h1 id="面试官：说说设备像素、css像素、设备独立像素、dpr、ppi-之间的区别？"><a href="#面试官：说说设备像素、css像素、设备独立像素、dpr、ppi-之间的区别？" class="headerlink" title="面试官：说说设备像素、css像素、设备独立像素、dpr、ppi 之间的区别？"></a>面试官：说说设备像素、css像素、设备独立像素、dpr、ppi 之间的区别？</h1><p> <img src="https://static.vue-js.com/c4d9bfd0-91f2-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h2><p>在<code>css</code>中我们通常使用px作为单位，在PC浏览器中<code>css</code>的1个像素都是对应着电脑屏幕的1个物理像素</p>
<p>这会造成一种错觉，我们会认为<code>css</code>中的像素就是设备的物理像素</p>
<p>但实际情况却并非如此，<code>css</code>中的像素只是一个抽象的单位，在不同的设备或不同的环境中，<code>css</code>中的1px所代表的设备物理像素是不同的</p>
<p>当我们做移动端开发时，同为1px的设置，在不同分辨率的移动设备上显示效果却有很大差异</p>
<p>这背后就涉及了css像素、设备像素、设备独立像素、dpr、ppi的概念</p>
<h2 id="二、介绍"><a href="#二、介绍" class="headerlink" title="二、介绍"></a>二、介绍</h2><h3 id="CSS像素"><a href="#CSS像素" class="headerlink" title="CSS像素"></a>CSS像素</h3><p>CSS像素（css pixel, px）: 适用于web编程，在 CSS 中以 px 为后缀，是一个长度单位</p>
<p>在 CSS 规范中，长度单位可以分为两类，绝对单位以及相对单位</p>
<p>px是一个相对单位，相对的是设备像素（device pixel）</p>
<p>一般情况，页面缩放比为1，1个CSS像素等于1个设备独立像素</p>
<p><code>CSS</code>像素又具有两个方面的相对性：</p>
<ul>
<li>在同一个设备上，每1个 CSS 像素所代表的设备像素是可以变化的（比如调整屏幕的分辨率）</li>
<li>在不同的设备之间，每1个 CSS 像素所代表的设备像素是可以变化的（比如两个不同型号的手机）</li>
</ul>
<p>在页面进行缩放操作也会 引起<code>css</code>中<code>px</code>的变化，假设页面放大一倍，原来的 1px 的东西变成 2px，在实际宽度不变的情况下1px 变得跟原来的 2px 的长度（长宽）一样了（元素会占据更多的设备像素）</p>
<p>假设原来需要 320px 才能填满的宽度现在只需要 160px</p>
<p>px会受到下面的因素的影响而变化：</p>
<ul>
<li>每英寸像素（PPI）</li>
<li>设备像素比（DPR）</li>
</ul>
<h3 id="设备像素"><a href="#设备像素" class="headerlink" title="设备像素"></a>设备像素</h3><p>设备像素（device pixels），又称为物理像素</p>
<p>指设备能控制显示的最小物理单位，不一定是一个小正方形区块，也没有标准的宽高，只是用于显示丰富色彩的一个“点”而已</p>
<p>可以参考公园里的景观变色彩灯，一个彩灯(物理像素)由红、蓝、绿小灯组成，三盏小灯不同的亮度混合出各种色彩</p>
<p> <img src="https://static.vue-js.com/cffc6570-91f2-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>从屏幕在工厂生产出的那天起，它上面设备像素点就固定不变了，单位为<code>pt</code></p>
<h3 id="设备独立像素"><a href="#设备独立像素" class="headerlink" title="设备独立像素"></a>设备独立像素</h3><p>设备独立像素（Device Independent Pixel）：与设备无关的逻辑像素，代表可以通过程序控制使用的虚拟像素，是一个总体概念，包括了CSS像素</p>
<p>在<code>javaScript</code>中可以通过<code>window.screen.width/ window.screen.height</code> 查看</p>
<p>比如我们会说“电脑屏幕在 2560x1600分辨率下不适合玩游戏，我们把它调为 1440x900”，这里的“分辨率”（非严谨说法）指的就是设备独立像素</p>
<p>一个设备独立像素里可能包含1个或者多个物理像素点，包含的越多则屏幕看起来越清晰</p>
<p>至于为什么出现设备独立像素这种虚拟像素单位概念，下面举个例子：</p>
<p>iPhone 3GS 和 iPhone 4/4s 的尺寸都是 3.5 寸，但 iPhone 3GS 的分辨率是 320x480，iPhone 4/4s 的分辨率是 640x960</p>
<p>这意味着，iPhone 3GS 有 320 个物理像素，iPhone 4/4s 有 640 个物理像素</p>
<p>如果我们按照真实的物理像素进行布局，比如说我们按照 320 物理像素进行布局，到了 640 物理像素的手机上就会有一半的空白，为了避免这种问题，就产生了虚拟像素单位</p>
<p>我们统一 iPhone 3GS 和 iPhone 4/4s 都是 320 个虚拟像素，只是在 iPhone 3GS 上，最终 1 个虚拟像素换算成 1 个物理像素，在 iphone 4s 中，1 个虚拟像素最终换算成 2 个物理像素</p>
<p>至于 1 个虚拟像素被换算成几个物理像素，这个数值我们称之为设备像素比，也就是下面介绍的<code>dpr</code></p>
<h3 id="dpr"><a href="#dpr" class="headerlink" title="dpr"></a>dpr</h3><p>dpr（device pixel ratio），设备像素比，代表设备独立像素到设备像素的转换关系，在<code>JavaScript</code>中可以通过 <code>window.devicePixelRatio</code> 获取</p>
<p>计算公式如下：</p>
<p> <img src="https://static.vue-js.com/dd45e2b0-91f2-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>当设备像素比为1:1时，使用1（1×1）个设备像素显示1个CSS像素</p>
<p>当设备像素比为2:1时，使用4（2×2）个设备像素显示1个CSS像素</p>
<p>当设备像素比为3:1时，使用9（3×3）个设备像素显示1个CSS像素</p>
<p>如下图所示：</p>
<p><img src="https://static.vue-js.com/e63cceb0-91f2-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>当<code>dpr</code>为3，那么<code>1px</code>的<code>CSS</code>像素宽度对应<code>3px</code>的物理像素的宽度，1px的<code>CSS</code>像素高度对应<code>3px</code>的物理像素高度</p>
<h3 id="ppi"><a href="#ppi" class="headerlink" title="ppi"></a>ppi</h3><p>ppi （pixel per inch），每英寸像素，表示每英寸所包含的像素点数目，更确切的说法应该是像素密度。数值越高，说明屏幕能以更高密度显示图像</p>
<p>计算公式如下：</p>
<p> <img src="https://static.vue-js.com/f734adf0-91f2-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h2><p>无缩放情况下，1个CSS像素等于1个设备独立像素</p>
<p>设备像素由屏幕生产之后就不发生改变，而设备独立像素是一个虚拟单位会发生改变</p>
<p>PC端中，1个设备独立像素 = 1个设备像素 （在100%，未缩放的情况下）</p>
<p>在移动端中，标准屏幕（160ppi）下 1个设备独立像素 = 1个设备像素</p>
<p>设备像素比（dpr） = 设备像素 / 设备独立像素</p>
<p>每英寸像素（ppi），值越大，图像越清晰</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Glossary/CSS_pixel">https://developer.mozilla.org/zh-CN/docs/Glossary/CSS_pixel</a></li>
<li><a href="https://hijiangtao.github.io/2017/07/09/Device-Viewport-and-Pixel-Introduction/">https://hijiangtao.github.io/2017/07/09/Device-Viewport-and-Pixel-Introduction/</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>dp_px_dpr_ppi</tag>
      </tags>
  </entry>
  <entry>
    <title>Dynamic list</title>
    <url>/archives/36044e1a.html</url>
    <content><![CDATA[<div class="tip ban"><h3 id="根据服务器返回的列表数动态渲染列表按钮"><a href="#根据服务器返回的列表数动态渲染列表按钮" class="headerlink" title="根据服务器返回的列表数动态渲染列表按钮"></a>根据服务器返回的列表数动态渲染列表按钮</h3></div>
<h4 id="js-实现"><a href="#js-实现" class="headerlink" title="js 实现"></a>js 实现</h4><div class='checkbox green checked'><input type="checkbox" checked="checked"/>
            <p>要实现这样的功能，您可以使用以下步骤来生成动态列表和按钮：</p>
            </div>
<p>数字渲染动态列表按钮，一个数字代表 10 条数据，如何实现<br>根据传入的数字计算出需要生成的列表数。例如，如果传入的数字是 23，则需要生成 3 个列表，前两个列表各包含 10 个数据项，最后一个列表包含 3 个数据项。<br>创建一个包含所有数据的数组。例如，对于 23，该数组将包含 23 个数据项。<br>创建一个包含所有列表的数组。根据上一步中计算的列表数，创建一个包含指定数量元素的空数组。<br>将所有数据项分配给各个列表。遍历所有数据项，并计算当前元素所属的列表的索引。然后，将该元素添加到相应列表的数组中。<br>创建一个包含所有列表按钮的数组。按照列表的顺序，为每个列表创建一个按钮，并将这些按钮添加到数组中。<br>在页面上渲染所有列表和按钮。遍历列表数组和按钮数组，在页面上动态创建列表和按钮。<br>以下是一个简单的 JavaScript 示例代码，展示了如何实现上述功能：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">renderDynamicList</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 计算列表数和数据项数</span></span><br><span class="line">  <span class="keyword">const</span> listCount = <span class="built_in">Math</span>.ceil(num / <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">const</span> itemCount = num;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建总数据数组</span></span><br><span class="line">  <span class="keyword">const</span> dataArray = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: itemCount &#125;, <span class="function">(<span class="params">_, i</span>) =&gt;</span> i + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建列表数组并分配数据</span></span><br><span class="line">  <span class="keyword">const</span> listArray = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: listCount &#125;, <span class="function">() =&gt;</span> []);</span><br><span class="line">  dataArray.forEach(<span class="function">(<span class="params">item, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> listIndex = <span class="built_in">Math</span>.floor(i / <span class="number">10</span>);</span><br><span class="line">    listArray[listIndex].push(item);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建按钮数组</span></span><br><span class="line">  <span class="keyword">const</span> buttonArray = listArray.map(<span class="function">(<span class="params">_, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> button = <span class="built_in">document</span>.createElement(<span class="string">&quot;button&quot;</span>);</span><br><span class="line">    button.innerText = <span class="string">`List <span class="subst">$&#123;i + <span class="number">1</span>&#125;</span>`</span>;</span><br><span class="line">    button.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> renderList(listArray[i]));</span><br><span class="line">    <span class="keyword">return</span> button;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 渲染页面</span></span><br><span class="line">  buttonArray.forEach(<span class="function">(<span class="params">button</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(button);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">renderList</span>(<span class="params">list</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 清空当前内容</span></span><br><span class="line">  <span class="built_in">document</span>.body.innerHTML = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建列表元素并渲染所有数据项</span></span><br><span class="line">  <span class="keyword">const</span> listElement = <span class="built_in">document</span>.createElement(<span class="string">&quot;ul&quot;</span>);</span><br><span class="line">  list.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> listItem = <span class="built_in">document</span>.createElement(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">    listItem.innerText = item;</span><br><span class="line">    listElement.appendChild(listItem);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建返回按钮并渲染</span></span><br><span class="line">  <span class="keyword">const</span> backButton = <span class="built_in">document</span>.createElement(<span class="string">&quot;button&quot;</span>);</span><br><span class="line">  backButton.innerText = <span class="string">&quot;Back&quot;</span>;</span><br><span class="line">  backButton.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> renderDynamicList(<span class="number">23</span>));</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(listElement);</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(backButton);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用渲染函数</span></span><br><span class="line">renderDynamicList(<span class="number">23</span>);</span><br></pre></td></tr></table></figure>
<p>这个示例代码将生成三个包含数据的列表，每个列表包含 10 个或更少数据项，每个列表对应一个按钮。单击按钮将显示相应的列表，而导航按钮将返回初始状态。</p>
<p>请注意，该示例代码并没有进行大量的 CSS 渲染。如果您需要更美观适合具体需求的 UI，需要在此基础上进行一些界面美化的工作。</p>
<h4 id="react-实现"><a href="#react-实现" class="headerlink" title="react 实现"></a>react 实现</h4><div class='checkbox green checked'><input type="checkbox" checked="checked"/>
            <p>以下是一个简单的 React 组件示例代码，展示了如何实现数字渲染动态列表按钮的功能：</p>
            </div>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DynamicList</span>(<span class="params">&#123; itemCount &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> listCount = <span class="built_in">Math</span>.ceil(itemCount / <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">const</span> dataArray = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: itemCount &#125;, <span class="function">(<span class="params">_, i</span>) =&gt;</span> i + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">const</span> listArray = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: listCount &#125;, <span class="function">() =&gt;</span> []);</span><br><span class="line"></span><br><span class="line">  dataArray.forEach(<span class="function">(<span class="params">item, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> listIndex = <span class="built_in">Math</span>.floor(i / <span class="number">10</span>);</span><br><span class="line">    listArray[listIndex].push(item);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [currentList, setCurrentList] = useState(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">renderList</span>(<span class="params">list</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> items = list.map(<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;items&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCurrentList(null)&#125;&gt;Back<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">renderLists</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> buttons = listArray.map(<span class="function">(<span class="params">list, index</span>) =&gt;</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCurrentList(list)&#125;&gt;</span></span><br><span class="line"><span class="xml">        List &#123;index + 1&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    ));</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;buttons&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> currentList ? renderList(currentList) : renderLists();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> DynamicList;</span><br></pre></td></tr></table></figure>
<p>使用 <code>&lt;DynamicList itemCount=&#123;23&#125; /&gt;</code> 就可以渲染这个组件，并为所有数据项创建一个动态列表和按钮。</p>
<p>这个示例中，我们使用了 React 中的 useState 钩子来存储当前显示的列表状态。在 renderLists 函数中，我们生成了所有的列表按钮，并分别使用 onClick 属性将每个按钮的点击事件绑定到为其所属的列表设置当前状态的函数。在 renderList 函数中，我们渲染了当前的列表数据，并创建了一个返回按钮。</p>
<p>请注意，该示例代码并没有进行大量的样式渲染。如果您需要更美观适合具体需求的 UI，需要在此基础上进行一些样式美化的工作。</p>
<h4 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DynamicList</span>(<span class="params">&#123; itemCount &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//向上取整的场景</span></span><br><span class="line">  <span class="keyword">const</span> listCount = <span class="built_in">Math</span>.ceil(itemCount / <span class="number">10</span>);</span><br><span class="line">  <span class="comment">// 根据listCount生成空数组</span></span><br><span class="line">  <span class="keyword">const</span> listArray = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: listCount &#125;, <span class="function">() =&gt;</span> []);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//渲染listArray 每一项的内容方法</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">renderLists</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> buttons = listArray.map(<span class="function">(<span class="params">list, index</span>) =&gt;</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">className</span>=<span class="string">&quot;page-item ng-scope&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">className</span>=<span class="string">&quot;page-link ng-binding&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">          &#123;index + 1&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    ));</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;buttons&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 若没有传递 itemCount 返回 null</span></span><br><span class="line">  <span class="keyword">return</span> listCount ? renderLists() : <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> DynamicList;</span><br></pre></td></tr></table></figure>
<h4 id="部分代码解释说明"><a href="#部分代码解释说明" class="headerlink" title="部分代码解释说明"></a>部分代码解释说明</h4><div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>
            <p>const listArray = Array.from({ length: listCount }</p>
            </div>
<p>ASSISTANT</p>
<p>这行代码使用了 JavaScript 的 Array.from() 方法来生成一个包含指定数量元素的数组 listArray。这个数组的长度由 listCount 变量指定，每个元素都是一个空数组。</p>
<p>Array.from() 方法可以接受一个类数组对象（如字符串、数组、Set、Map 等）或一个可迭代对象，并返回一个新数组，其中包含从输入对象中收集的所有值（或转换的部分值）的副本。在这个例子中，我们使用对象的长度来创建一个空数组，因此从这个角度说，也可以认为 listArray 是一个由 listCount 个空数组组成的新数组。</p>
<p>第二个参数是一个可选参数，指定构造每个元素的函数。在这个例子中，我们传递了一个无参数的箭头函数 () =&gt; []，以便在数组的每个位置生成一个空数组。这是因为我们想要在之后的代码中，将所有的数据项分配到各自的列表中，所以需要先创建这些列表并初始化为空数组，以便放置数据。</p>
<p>因此，listArray 数组现在将由具有指定长度的空数组组成，可以用于存储我们将从数据中分配到每个列表中的元素。</p>
<div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>
            <p>Array.from({length: itemCount}</p>
            </div>
<p>ASSISTANT<br>这段代码使用了 Array.from() 方法来创建一个数组，用于存储 itemCount 个数字。该数组包含从 1 到 itemCount 的所有数字。</p>
<p>Array.from() 方法的第一个参数可以是任何可迭代对象，该对象的属性将成为返回数组的元素。在这个例子中，我们创建了一个有 itemCount 个属性的对象，这些属性都是未定义的。这实际上不重要，因为我们仅使用这个对象的长度来生成一个数组。</p>
<p>第二个参数是一个可选函数，该函数将被应用于数组中的每个元素以生成新值。在这个例子中，我们使用了一个带有两个参数的箭头函数，其中第一个参数 _ 是忽略的占位符，因为当前要使用的只有第二个参数 i，表示数值从 0 开始的索引。我们将 i 加上 1，以确保数组包含从 1 开始的数字值。</p>
<p>因此，这段代码生成的数组包含从 1 到 itemCount 的所有数字，并可以随后用于将这些数字渲染到 UI 中。</p>
<div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>
            <p>ceil</p>
            </div>
<p>ceil 是 JavaScript Math 内置对象的方法之一，用于获取大于或等于给定数字的最小整数。这个方法以一个单独的数字参数 x 作为输入，并返回不小于 x 的最小整数。</p>
<p>语法：Math.ceil(x)</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">4.56</span>)); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">99</span>)); <span class="comment">// 99</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(-<span class="number">4.56</span>)); <span class="comment">// -4</span></span><br><span class="line"><span class="built_in">Math</span>.ceil() 方法通常用于向上取整的场景，如对于需要整数参数的计算、在 UI 中将元素对齐到网格等。</span><br></pre></td></tr></table></figure>
<p>在这个例子中，我们使用 ceil 方法来计算所需的列表数量（即 itemCount / 10）并向上取整，以确保所有数据项都被分配到正确数量的列表中，而不会出现一个列表项比其他列表项多的情况。</p>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>ai</tag>
        <tag>chatbox</tag>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>decorator</title>
    <url>/archives/336f0513.html</url>
    <content><![CDATA[<h1 id="面试官：你是怎么理解ES6中-Decorator-的？使用场景？"><a href="#面试官：你是怎么理解ES6中-Decorator-的？使用场景？" class="headerlink" title="面试官：你是怎么理解ES6中 Decorator 的？使用场景？"></a>面试官：你是怎么理解ES6中 Decorator 的？使用场景？</h1><p> <img src="https://static.vue-js.com/7df43560-5ba5-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h2><p>Decorator，即装饰器，从名字上很容易让我们联想到装饰者模式</p>
<p>简单来讲，装饰者模式就是一种在不改变原类和使用继承的情况下，动态地扩展对象功能的设计理论。</p>
<p><code>ES6</code>中<code>Decorator</code>功能亦如此，其本质也不是什么高大上的结构，就是一个普通的函数，用于扩展类属性和类方法</p>
<p>这里定义一个士兵，这时候他什么装备都没有</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">soldier</span></span>&#123; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>定义一个得到 AK 装备的函数，即装饰器</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strong</span>(<span class="params">target</span>)</span>&#123;</span><br><span class="line">    target.AK = <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用该装饰器对士兵进行增强</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@strong</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">soldier</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时候士兵就有武器了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">soldier.AK <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>上述代码虽然简单，但也能够清晰看到了使用<code>Decorator</code>两大优点：</p>
<ul>
<li>代码可读性变强了，装饰器命名相当于一个注释</li>
<li>在不改变原有代码情况下，对原来功能进行扩展</li>
</ul>
<h2 id="二、用法"><a href="#二、用法" class="headerlink" title="二、用法"></a>二、用法</h2><p><code>Docorator</code>修饰对象为下面两种：</p>
<ul>
<li>类的装饰</li>
<li>类属性的装饰</li>
</ul>
<h3 id="类的装饰"><a href="#类的装饰" class="headerlink" title="类的装饰"></a>类的装饰</h3><p>当对类本身进行装饰的时候，能够接受一个参数，即类本身</p>
<p>将装饰器行为进行分解，大家能够有个更深入的了解</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@decorator</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line">A = decorator(A) || A;</span><br></pre></td></tr></table></figure>
<p>下面<code>@testable</code>就是一个装饰器，<code>target</code>就是传入的类，即<code>MyTestableClass</code>，实现了为类添加静态属性</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@testable</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTestableClass</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testable</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">  target.isTestable = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyTestableClass.isTestable <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>如果想要传递参数，可以在装饰器外层再封装一层函数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testable</span>(<span class="params">isTestable</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">    target.isTestable = isTestable;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@testable(<span class="literal">true</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTestableClass</span> </span>&#123;&#125;</span><br><span class="line">MyTestableClass.isTestable <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">@testable(<span class="literal">false</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line">MyClass.isTestable <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="类属性的装饰"><a href="#类属性的装饰" class="headerlink" title="类属性的装饰"></a>类属性的装饰</h3><p>当对类属性进行装饰的时候，能够接受三个参数：</p>
<ul>
<li>类的原型对象</li>
<li>需要装饰的属性名</li>
<li>装饰属性名的描述对象</li>
</ul>
<p>首先定义一个<code>readonly</code>装饰器</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readonly</span>(<span class="params">target, name, descriptor</span>)</span>&#123;</span><br><span class="line">  descriptor.writable = <span class="literal">false</span>; <span class="comment">// 将可写属性设为false</span></span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用<code>readonly</code>装饰类的<code>name</code>方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @readonly</span><br><span class="line">  <span class="function"><span class="title">name</span>(<span class="params"></span>)</span> &#123; <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.first&#125;</span> <span class="subst">$&#123;<span class="built_in">this</span>.last&#125;</span>`</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>相当于以下调用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">readonly(Person.prototype, <span class="string">&#x27;name&#x27;</span>, descriptor);</span><br></pre></td></tr></table></figure>
<p>如果一个方法有多个装饰器，就像洋葱一样，先从外到内进入，再由内到外执行</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dec</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;evaluated&#x27;</span>, id);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">target, property, descriptor</span>) =&gt;</span><span class="built_in">console</span>.log(<span class="string">&#x27;executed&#x27;</span>, id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">    @dec(<span class="number">1</span>)</span><br><span class="line">    @dec(<span class="number">2</span>)</span><br><span class="line">    <span class="function"><span class="title">method</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// evaluated 1</span></span><br><span class="line"><span class="comment">// evaluated 2</span></span><br><span class="line"><span class="comment">// executed 2</span></span><br><span class="line"><span class="comment">// executed 1</span></span><br></pre></td></tr></table></figure>
<p>外层装饰器<code>@dec(1)</code>先进入，但是内层装饰器<code>@dec(2)</code>先执行</p>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>装饰器不能用于修饰函数，因为函数存在变量声明情况</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  counter++;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@add</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译阶段，变成下面</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> counter;</span><br><span class="line"><span class="keyword">var</span> add;</span><br><span class="line"></span><br><span class="line">@add</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  counter++;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>意图是执行后<code>counter</code>等于 1，但是实际上结果是<code>counter</code>等于 0</p>
<h2 id="三、使用场景"><a href="#三、使用场景" class="headerlink" title="三、使用场景"></a>三、使用场景</h2><p>基于<code>Decorator</code>强大的作用，我们能够完成各种场景的需求，下面简单列举几种：</p>
<p>使用<code>react-redux</code>的时候，如果写成下面这种形式，既不雅观也很麻烦</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyReactComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps, mapDispatchToProps)(MyReactComponent);</span><br></pre></td></tr></table></figure>
<p>通过装饰器就变得简洁多了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@connect(mapStateToProps, mapDispatchToProps)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">MyReactComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>将<code>mixins</code>，也可以写成装饰器，让使用更为简洁了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mixins</span>(<span class="params">...list</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">target</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.assign(target.prototype, ...list);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="keyword">const</span> Foo = &#123;</span><br><span class="line">  <span class="function"><span class="title">foo</span>(<span class="params"></span>)</span> &#123; <span class="built_in">console</span>.log(<span class="string">&#x27;foo&#x27;</span>) &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@mixins(Foo)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</span><br><span class="line">obj.foo() <span class="comment">// &quot;foo&quot;</span></span><br></pre></td></tr></table></figure>
<p>下面再讲讲<code>core-decorators.js</code>几个常见的装饰器</p>
<h4 id="antobind"><a href="#antobind" class="headerlink" title="@antobind"></a>@antobind</h4><p><code>autobind</code>装饰器使得方法中的<code>this</code>对象，绑定原始对象</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; autobind &#125; <span class="keyword">from</span> <span class="string">&#x27;core-decorators&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @autobind</span><br><span class="line">  <span class="function"><span class="title">getPerson</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="keyword">let</span> getPerson = person.getPerson;</span><br><span class="line"></span><br><span class="line">getPerson() === person;</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h4 id="readonly"><a href="#readonly" class="headerlink" title="@readonly"></a>@readonly</h4><p><code>readonly</code>装饰器使得属性或方法不可写</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; readonly &#125; <span class="keyword">from</span> <span class="string">&#x27;core-decorators&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Meal</span> </span>&#123;</span><br><span class="line">  @readonly</span><br><span class="line">  entree = <span class="string">&#x27;steak&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dinner = <span class="keyword">new</span> Meal();</span><br><span class="line">dinner.entree = <span class="string">&#x27;salmon&#x27;</span>;</span><br><span class="line"><span class="comment">// Cannot assign to read only property &#x27;entree&#x27; of [object Object]</span></span><br></pre></td></tr></table></figure>
<h4 id="deprecate"><a href="#deprecate" class="headerlink" title="@deprecate"></a>@deprecate</h4><p><code>deprecate</code>或<code>deprecated</code>装饰器在控制台显示一条警告，表示该方法将废除</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; deprecate &#125; <span class="keyword">from</span> <span class="string">&#x27;core-decorators&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @deprecate</span><br><span class="line">  <span class="function"><span class="title">facepalm</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  @deprecate(<span class="string">&#x27;功能废除了&#x27;</span>)</span><br><span class="line">  <span class="function"><span class="title">facepalmHard</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line">person.facepalm();</span><br><span class="line"><span class="comment">// DEPRECATION Person#facepalm: This function will be removed in future versions.</span></span><br><span class="line"></span><br><span class="line">person.facepalmHard();</span><br><span class="line"><span class="comment">// DEPRECATION Person#facepalmHard: 功能废除了</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://es6.ruanyifeng.com/#docs/decorator">https://es6.ruanyifeng.com/#docs/decorator</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>es6</tag>
        <tag>decorator</tag>
      </tags>
  </entry>
  <entry>
    <title>event_loop</title>
    <url>/archives/be945145.html</url>
    <content><![CDATA[<h1 id="面试官：说说你对事件循环的理解"><a href="#面试官：说说你对事件循环的理解" class="headerlink" title="面试官：说说你对事件循环的理解"></a>面试官：说说你对事件循环的理解</h1><p> <img src="https://static.vue-js.com/50f062d0-7cb8-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>首先，<code>JavaScript</code>是一门单线程的语言，意味着同一时间内只能做一件事，但是这并不意味着单线程就是阻塞，而实现单线程非阻塞的方法就是事件循环</p>
<p>在<code>JavaScript</code>中，所有的任务都可以分为</p>
<ul>
<li><p>同步任务：立即执行的任务，同步任务一般会直接进入到主线程中执行</p>
</li>
<li><p>异步任务：异步执行的任务，比如<code>ajax</code>网络请求，<code>setTimeout</code>定时函数等</p>
</li>
</ul>
<p>同步任务与异步任务的运行流程图如下：</p>
<p> <img src="https://static.vue-js.com/61efbc20-7cb8-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>从上面我们可以看到，同步任务进入主线程，即主执行栈，异步任务进入任务队列，主线程内的任务执行完毕为空，会去任务队列读取对应的任务，推入主线程执行。上述过程的不断重复就事件循环</p>
<h2 id="二、宏任务与微任务"><a href="#二、宏任务与微任务" class="headerlink" title="二、宏任务与微任务"></a>二、宏任务与微任务</h2><p>如果将任务划分为同步任务和异步任务并不是那么的准确，举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new Promise&#x27;</span>)</span><br><span class="line">    resolve()</span><br><span class="line">&#125;).then(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;then&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>如果按照上面流程图来分析代码，我们会得到下面的执行步骤：</p>
<ul>
<li><code>console.log(1)</code>，同步任务，主线程中执行</li>
<li><code>setTimeout()</code> ，异步任务，放到 <code>Event Table</code>，0 毫秒后<code>console.log(2)</code>回调推入 <code>Event Queue</code> 中</li>
<li><code>new Promise</code> ，同步任务，主线程直接执行</li>
<li><code>.then</code> ，异步任务，放到 <code>Event Table</code></li>
<li><code>console.log(3)</code>，同步任务，主线程执行</li>
</ul>
<p>所以按照分析，它的结果应该是 <code>1</code> =&gt; <code>&#39;new Promise&#39;</code> =&gt; <code>3</code> =&gt; <code>2</code> =&gt; <code>&#39;then&#39;</code></p>
<p>但是实际结果是：<code>1</code>=&gt;<code>&#39;new Promise&#39;</code>=&gt; <code>3</code> =&gt; <code>&#39;then&#39;</code> =&gt; <code>2</code></p>
<p>出现分歧的原因在于异步任务执行顺序，事件队列其实是一个“先进先出”的数据结构，排在前面的事件会优先被主线程读取</p>
<p>例子中 <code>setTimeout</code>回调事件是先进入队列中的，按理说应该先于 <code>.then</code> 中的执行，但是结果却偏偏相反</p>
<p>原因在于异步任务还可以细分为微任务与宏任务</p>
<h3 id="微任务"><a href="#微任务" class="headerlink" title="微任务"></a>微任务</h3><p>一个需要异步执行的函数，执行时机是在主函数执行结束之后、当前宏任务结束之前</p>
<p>常见的微任务有：</p>
<ul>
<li><p>Promise.then</p>
</li>
<li><p>MutaionObserver</p>
</li>
<li><p>Object.observe（已废弃；Proxy 对象替代）</p>
</li>
<li><p>process.nextTick（Node.js）</p>
</li>
</ul>
<h3 id="宏任务"><a href="#宏任务" class="headerlink" title="宏任务"></a>宏任务</h3><p>宏任务的时间粒度比较大，执行的时间间隔是不能精确控制的，对一些高实时性的需求就不太符合</p>
<p>常见的宏任务有：</p>
<ul>
<li>script (可以理解为外层同步代码) </li>
<li>setTimeout/setInterval </li>
<li>UI rendering/UI事件 </li>
<li>postMessage、MessageChannel </li>
<li>setImmediate、I/O（Node.js）</li>
</ul>
<p>这时候，事件循环，宏任务，微任务的关系如图所示</p>
<p> <img src="https://static.vue-js.com/6e80e5e0-7cb8-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>按照这个流程，它的执行机制是：</p>
<ul>
<li>执行一个宏任务，如果遇到微任务就将它放到微任务的事件队列中</li>
<li>当前宏任务执行完成后，会查看微任务的事件队列，然后将里面的所有微任务依次执行完</li>
</ul>
<p>回到上面的题目</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new Promise&#x27;</span>)</span><br><span class="line">    resolve()</span><br><span class="line">&#125;).then(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;then&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>流程如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 遇到 console.log(1) ，直接打印 1</span></span><br><span class="line"><span class="comment">// 遇到定时器，属于新的宏任务，留着后面执行</span></span><br><span class="line"><span class="comment">// 遇到 new Promise，这个是直接执行的，打印 &#x27;new Promise&#x27;</span></span><br><span class="line"><span class="comment">// .then 属于微任务，放入微任务队列，后面再执行</span></span><br><span class="line"><span class="comment">// 遇到 console.log(3) 直接打印 3</span></span><br><span class="line"><span class="comment">// 好了本轮宏任务执行完毕，现在去微任务列表查看是否有微任务，发现 .then 的回调，执行它，打印 &#x27;then&#x27;</span></span><br><span class="line"><span class="comment">// 当一次宏任务执行完，再去执行新的宏任务，这里就剩一个定时器的宏任务了，执行它，打印 2</span></span><br></pre></td></tr></table></figure>
<h2 id="三、async与await"><a href="#三、async与await" class="headerlink" title="三、async与await"></a>三、async与await</h2><p><code>async</code> 是异步的意思，<code>await</code>则可以理解为 <code>async wait</code>。所以可以理解<code>async</code>就是用来声明一个异步方法，而 <code>await</code>是用来等待异步方法执行</p>
<h3 id="async"><a href="#async" class="headerlink" title="async"></a>async</h3><p><code>async</code>函数返回一个<code>promise</code>对象，下面两种方法是等效的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(<span class="string">&#x27;TEST&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// asyncF is equivalent to f!</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">asyncF</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;TEST&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="await"><a href="#await" class="headerlink" title="await"></a>await</h3><p>正常情况下，<code>await</code>命令后面是一个 <code>Promise</code>对象，返回该对象的结果。如果不是 <code>Promise</code>对象，就直接返回对应的值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 等同于</span></span><br><span class="line">    <span class="comment">// return 123</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="number">123</span></span><br><span class="line">&#125;</span><br><span class="line">f().then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v)) <span class="comment">// 123</span></span><br></pre></td></tr></table></figure>
<p>不管<code>await</code>后面跟着的是什么，<code>await</code>都会阻塞后面的代码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn1</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">await</span> fn2()</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>) <span class="comment">// 阻塞</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn2</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;fn2&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fn1()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>上面的例子中，<code>await</code> 会阻塞下面的代码（即加入微任务队列），先执行 <code>async</code>外面的同步代码，同步代码执行完，再回到 <code>async</code> 函数中，再执行之前阻塞的代码</p>
<p>所以上述输出结果为：<code>1</code>，<code>fn2</code>，<code>3</code>，<code>2</code></p>
<h2 id="四、流程分析"><a href="#四、流程分析" class="headerlink" title="四、流程分析"></a>四、流程分析</h2><p>通过对上面的了解，我们对<code>JavaScript</code>对各种场景的执行顺序有了大致的了解</p>
<p>这里直接上代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;async1 start&#x27;</span>)</span><br><span class="line">    <span class="keyword">await</span> async2()</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;async1 end&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;async2&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;script start&#x27;</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;settimeout&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">async1()</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;promise1&#x27;</span>)</span><br><span class="line">    resolve()</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;promise2&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;script end&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>分析过程：</p>
<ol>
<li>执行整段代码，遇到 <code>console.log(&#39;script start&#39;)</code> 直接打印结果，输出 <code>script start</code></li>
<li>遇到定时器了，它是宏任务，先放着不执行</li>
<li>遇到 <code>async1()</code>，执行 <code>async1</code> 函数，先打印 <code>async1 start</code>，下面遇到<code>await</code>怎么办？先执行 <code>async2</code>，打印 <code>async2</code>，然后阻塞下面代码（即加入微任务列表），跳出去执行同步代码</li>
<li>跳到 <code>new Promise</code> 这里，直接执行，打印 <code>promise1</code>，下面遇到 <code>.then()</code>，它是微任务，放到微任务列表等待执行</li>
<li>最后一行直接打印 <code>script end</code>，现在同步代码执行完了，开始执行微任务，即 <code>await</code>下面的代码，打印 <code>async1 end</code></li>
<li>继续执行下一个微任务，即执行 <code>then</code> 的回调，打印 <code>promise2</code></li>
<li>上一个宏任务所有事都做完了，开始下一个宏任务，就是定时器，打印 <code>settimeout</code></li>
</ol>
<p>所以最后的结果是：<code>script start</code>、<code>async1 start</code>、<code>async2</code>、<code>promise1</code>、<code>script end</code>、<code>async1 end</code>、<code>promise2</code>、<code>settimeout</code></p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>event_loop</tag>
      </tags>
  </entry>
  <entry>
    <title>event_Model</title>
    <url>/archives/574fecf1.html</url>
    <content><![CDATA[<h1 id="面试官：说说JavaScript中的事件模型"><a href="#面试官：说说JavaScript中的事件模型" class="headerlink" title="面试官：说说JavaScript中的事件模型"></a>面试官：说说JavaScript中的事件模型</h1><p><img src="https://static.vue-js.com/32a182f0-74cf-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、事件与事件流"><a href="#一、事件与事件流" class="headerlink" title="一、事件与事件流"></a>一、事件与事件流</h2><p><code>javascript</code>中的事件，可以理解就是在<code>HTML</code>文档或者浏览器中发生的一种交互操作，使得网页具备互动性， 常见的有加载事件、鼠标事件、自定义事件等</p>
<p>由于<code>DOM</code>是一个树结构，如果在父子节点绑定事件时候，当触发子节点的时候，就存在一个顺序问题，这就涉及到了事件流的概念</p>
<p>事件流都会经历三个阶段：</p>
<ul>
<li>事件捕获阶段(capture phase)</li>
<li>处于目标阶段(target phase)</li>
<li><p>事件冒泡阶段(bubbling phase)</p>
<p><img src="https://static.vue-js.com/3e9a6450-74cf-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
</li>
</ul>
<p>事件冒泡是一种从下往上的传播方式，由最具体的元素（触发节点）然后逐渐向上传播到最不具体的那个节点，也就是<code>DOM</code>中最高层的父节点</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Event Bubbling<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;clickMe&quot;</span>&gt;</span>Click Me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后，我们给<code>button</code>和它的父元素，加入点击事件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> button = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;clickMe&#x27;</span>);</span><br><span class="line"></span><br><span class="line">button.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;1.Button&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">document</span>.body.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;2.body&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">document</span>.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;3.document&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;4.window&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>点击按钮，输出如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>button</span><br><span class="line"><span class="number">2.</span>body</span><br><span class="line"><span class="number">3.</span><span class="built_in">document</span></span><br><span class="line"><span class="number">4.</span><span class="built_in">window</span></span><br></pre></td></tr></table></figure>
<p>点击事件首先在<code>button</code>元素上发生，然后逐级向上传播</p>
<p>事件捕获与事件冒泡相反，事件最开始由不太具体的节点最早接受事件, 而最具体的节点（触发节点）最后接受事件</p>
<h2 id="二、事件模型"><a href="#二、事件模型" class="headerlink" title="二、事件模型"></a>二、事件模型</h2><p>事件模型可以分为三种：</p>
<ul>
<li>原始事件模型（DOM0级）</li>
<li>标准事件模型（DOM2级）</li>
<li>IE事件模型（基本不用）</li>
</ul>
<h3 id="原始事件模型"><a href="#原始事件模型" class="headerlink" title="原始事件模型"></a>原始事件模型</h3><p>事件绑定监听函数比较简单, 有两种方式：</p>
<ul>
<li>HTML代码中直接绑定</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;button&quot;</span> onclick=<span class="string">&quot;fun()&quot;</span>&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>通过<code>JS</code>代码绑定</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;.btn&#x27;</span>);</span><br><span class="line">btn.onclick = fun;</span><br></pre></td></tr></table></figure>
<h4 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h4><ul>
<li>绑定速度快</li>
</ul>
<p><code>DOM0</code>级事件具有很好的跨浏览器优势，会以最快的速度绑定，但由于绑定速度太快，可能页面还未完全加载出来，以至于事件可能无法正常运行</p>
<ul>
<li><p>只支持冒泡，不支持捕获</p>
</li>
<li><p>同一个类型的事件只能绑定一次</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;button&quot;</span> id=<span class="string">&quot;btn&quot;</span> onclick=<span class="string">&quot;fun1()&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;.btn&#x27;</span>);</span><br><span class="line">btn.onclick = fun2;</span><br></pre></td></tr></table></figure>
<p>如上，当希望为同一个元素绑定多个同类型事件的时候（上面的这个<code>btn</code>元素绑定2个点击事件），是不被允许的，后绑定的事件会覆盖之前的事件</p>
<p>删除 <code>DOM0</code> 级事件处理程序只要将对应事件属性置为<code>null</code>即可</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">btn.onclick = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
<h3 id="标准事件模型"><a href="#标准事件模型" class="headerlink" title="标准事件模型"></a>标准事件模型</h3><p>在该事件模型中，一次事件共有三个过程:</p>
<ul>
<li>事件捕获阶段：事件从<code>document</code>一直向下传播到目标元素, 依次检查经过的节点是否绑定了事件监听函数，如果有则执行</li>
<li>事件处理阶段：事件到达目标元素, 触发目标元素的监听函数</li>
<li>事件冒泡阶段：事件从目标元素冒泡到<code>document</code>, 依次检查经过的节点是否绑定了事件监听函数，如果有则执行</li>
</ul>
<p>事件绑定监听函数的方式如下:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">addEventListener(eventType, handler, useCapture)</span><br></pre></td></tr></table></figure>
<p>事件移除监听函数的方式如下:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">removeEventListener(eventType, handler, useCapture)</span><br></pre></td></tr></table></figure>
<p>参数如下：</p>
<ul>
<li><code>eventType</code>指定事件类型(不要加on)</li>
<li><code>handler</code>是事件处理函数</li>
<li><code>useCapture</code>是一个<code>boolean</code>用于指定是否在捕获阶段进行处理，一般设置为<code>false</code>与IE浏览器保持一致</li>
</ul>
<p>举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;.btn&#x27;</span>);</span><br><span class="line">btn.addEventListener(‘click’, showMessage, <span class="literal">false</span>);</span><br><span class="line">btn.removeEventListener(‘click’, showMessage, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<h4 id="特性-1"><a href="#特性-1" class="headerlink" title="特性"></a>特性</h4><ul>
<li>可以在一个<code>DOM</code>元素上绑定多个事件处理器，各自并不会冲突</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">btn.addEventListener(‘click’, showMessage1, <span class="literal">false</span>);</span><br><span class="line">btn.addEventListener(‘click’, showMessage2, <span class="literal">false</span>);</span><br><span class="line">btn.addEventListener(‘click’, showMessage3, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>执行时机</li>
</ul>
<p>当第三个参数(<code>useCapture</code>)设置为<code>true</code>就在捕获过程中执行，反之在冒泡过程中执行处理函数</p>
<p>下面举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&#x27;div&#x27;</span>&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&#x27;p&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&#x27;span&#x27;</span>&gt;</span>Click Me!<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">    &lt;/p &gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>设置点击事件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onClickFn</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tagName = event.currentTarget.tagName;</span><br><span class="line">    <span class="keyword">var</span> phase = event.eventPhase;</span><br><span class="line">    <span class="built_in">console</span>.log(tagName, phase);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">div.addEventListener(<span class="string">&#x27;click&#x27;</span>, onClickFn, <span class="literal">false</span>);</span><br><span class="line">p.addEventListener(<span class="string">&#x27;click&#x27;</span>, onClickFn, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>上述使用了<code>eventPhase</code>，返回一个代表当前执行阶段的整数值。1为捕获阶段、2为事件对象触发阶段、3为冒泡阶段</p>
<p>点击<code>Click Me!</code>，输出如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">P <span class="number">3</span></span><br><span class="line">DIV <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>可以看到，<code>p</code>和<code>div</code>都是在冒泡阶段响应了事件，由于冒泡的特性，裹在里层的<code>p</code>率先做出响应</p>
<p>如果把第三个参数都改为<code>true</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">div.addEventListener(<span class="string">&#x27;click&#x27;</span>, onClickFn, <span class="literal">true</span>);</span><br><span class="line">p.addEventListener(<span class="string">&#x27;click&#x27;</span>, onClickFn, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>
<p>输出如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">DIV <span class="number">1</span></span><br><span class="line">P <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>两者都是在捕获阶段响应事件，所以<code>div</code>比<code>p</code>标签先做出响应</p>
<h3 id="IE事件模型"><a href="#IE事件模型" class="headerlink" title="IE事件模型"></a>IE事件模型</h3><p>IE事件模型共有两个过程:</p>
<ul>
<li>事件处理阶段：事件到达目标元素, 触发目标元素的监听函数。</li>
<li>事件冒泡阶段：事件从目标元素冒泡到<code>document</code>, 依次检查经过的节点是否绑定了事件监听函数，如果有则执行</li>
</ul>
<p>事件绑定监听函数的方式如下:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">attachEvent(eventType, handler)</span><br></pre></td></tr></table></figure>
<p>事件移除监听函数的方式如下:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">detachEvent(eventType, handler)</span><br></pre></td></tr></table></figure>
<p>举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;.btn&#x27;</span>);</span><br><span class="line">btn.attachEvent(‘onclick’, showMessage);</span><br><span class="line">btn.detachEvent(‘onclick’, showMessage);</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>event_Model</tag>
      </tags>
  </entry>
  <entry>
    <title>event_agent</title>
    <url>/archives/67902db1.html</url>
    <content><![CDATA[<h1 id="面试官：解释下什么是事件代理？应用场景？"><a href="#面试官：解释下什么是事件代理？应用场景？" class="headerlink" title="面试官：解释下什么是事件代理？应用场景？"></a>面试官：解释下什么是事件代理？应用场景？</h1><p><img src="https://static.vue-js.com/a33f0ab0-797e-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>事件代理，俗地来讲，就是把一个元素响应事件（<code>click</code>、<code>keydown</code>……）的函数委托到另一个元素</p>
<p>前面讲到，事件流的都会经过三个阶段： 捕获阶段 -&gt; 目标阶段 -&gt; 冒泡阶段，而事件委托就是在冒泡阶段完成</p>
<p>事件委托，会把一个或者一组元素的事件委托到它的父层或者更外层元素上，真正绑定事件的是外层元素，而不是目标元素</p>
<p>当事件响应到目标元素上时，会通过事件冒泡机制从而触发它的外层元素的绑定事件上，然后在外层元素上去执行函数</p>
<p>下面举个例子：</p>
<p>比如一个宿舍的同学同时快递到了，一种笨方法就是他们一个个去领取</p>
<p>较优方法就是把这件事情委托给宿舍长，让一个人出去拿好所有快递，然后再根据收件人一一分发给每个同学</p>
<p>在这里，取快递就是一个事件，每个同学指的是需要响应事件的 <code>DOM</code>元素，而出去统一领取快递的宿舍长就是代理的元素</p>
<p>所以真正绑定事件的是这个元素，按照收件人分发快递的过程就是在事件执行中，需要判断当前响应的事件应该匹配到被代理元素中的哪一个或者哪几个</p>
<h2 id="二、应用场景"><a href="#二、应用场景" class="headerlink" title="二、应用场景"></a>二、应用场景</h2><p>如果我们有一个列表，列表之中有大量的列表项，我们需要在点击列表项的时候响应一个事件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;ul id=<span class="string">&quot;list&quot;</span>&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  ......</span><br><span class="line">  &lt;li&gt;item n&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
<p>如果给每个列表项一一都绑定一个函数，那对于内存消耗是非常大的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取目标元素</span></span><br><span class="line"><span class="keyword">const</span> lis = <span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;li&quot;</span>)</span><br><span class="line"><span class="comment">// 循环遍历绑定事件</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; lis.length; i++) &#123;</span><br><span class="line">    lis[i].onclick = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e.target.innerHTML)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时候就可以事件委托，把点击事件绑定在父级元素<code>ul</code>上面，然后执行事件的时候再去匹配目标元素</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 给父层元素绑定事件</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;list&#x27;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 兼容性处理</span></span><br><span class="line">    <span class="keyword">var</span> event = e || <span class="built_in">window</span>.event;</span><br><span class="line">    <span class="keyword">var</span> target = event.target || event.srcElement;</span><br><span class="line">    <span class="comment">// 判断是否匹配目标元素</span></span><br><span class="line">    <span class="keyword">if</span> (target.nodeName.toLocaleLowerCase === <span class="string">&#x27;li&#x27;</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;the content is: &#x27;</span>, target.innerHTML);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>还有一种场景是上述列表项并不多，我们给每个列表项都绑定了事件</p>
<p>但是如果用户能够随时动态的增加或者去除列表项元素，那么在每一次改变的时候都需要重新给新增的元素绑定事件，给即将删去的元素解绑事件</p>
<p>如果用了事件委托就没有这种麻烦了，因为事件是绑定在父层的，和目标元素的增减是没有关系的，执行到目标元素是在真正响应执行事件函数的过程中去匹配的</p>
<p>举个例子：</p>
<p>下面<code>html</code>结构中，点击<code>input</code>可以动态添加元素</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">value</span>=<span class="string">&quot;添加&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;ul1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用事件委托</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> oBtn = <span class="built_in">document</span>.getElementById(<span class="string">&quot;btn&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> oUl = <span class="built_in">document</span>.getElementById(<span class="string">&quot;ul1&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> num = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//事件委托，添加的子元素也有事件</span></span><br><span class="line">oUl.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    ev = ev || <span class="built_in">window</span>.event;</span><br><span class="line">    <span class="keyword">const</span> target = ev.target || ev.srcElement;</span><br><span class="line">    <span class="keyword">if</span> (target.nodeName.toLowerCase() == <span class="string">&#x27;li&#x27;</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;the content is: &#x27;</span>, target.innerHTML);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加新节点</span></span><br><span class="line">oBtn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    num++;</span><br><span class="line">    <span class="keyword">const</span> oLi = <span class="built_in">document</span>.createElement(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">    oLi.innerHTML = <span class="string">`item <span class="subst">$&#123;num&#125;</span>`</span>;</span><br><span class="line">    oUl.appendChild(oLi);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>可以看到，使用事件委托，在动态绑定事件的情况下是可以减少很多重复工作的</p>
<h2 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h2><p>适合事件委托的事件有：<code>click</code>，<code>mousedown</code>，<code>mouseup</code>，<code>keydown</code>，<code>keyup</code>，<code>keypress</code></p>
<p>从上面应用场景中，我们就可以看到使用事件委托存在两大优点：</p>
<ul>
<li>减少整个页面所需的内存，提升整体性能</li>
<li>动态绑定，减少重复工作</li>
</ul>
<p>但是使用事件委托也是存在局限性：</p>
<ul>
<li><p><code>focus</code>、<code>blur</code>这些事件没有事件冒泡机制，所以无法进行委托绑定事件</p>
</li>
<li><p><code>mousemove</code>、<code>mouseout</code>这样的事件，虽然有事件冒泡，但是只能不断通过位置去计算定位，对性能消耗高，因此也是不适合于事件委托的</p>
</li>
</ul>
<p>如果把所有事件都用事件代理，可能会出现事件误判，即本不该被触发的事件被绑定上了事件</p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>event_agent</tag>
      </tags>
  </entry>
  <entry>
    <title>flexbox</title>
    <url>/archives/28d88e6.html</url>
    <content><![CDATA[<h1 id="面试官：说说flexbox（弹性盒布局模型）-以及适用场景？"><a href="#面试官：说说flexbox（弹性盒布局模型）-以及适用场景？" class="headerlink" title="面试官：说说flexbox（弹性盒布局模型）,以及适用场景？"></a>面试官：说说flexbox（弹性盒布局模型）,以及适用场景？</h1><p> <img src="https://static.vue-js.com/ef25b0a0-9837-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p><code>Flexible Box</code> 简称 <code>flex</code>，意为”弹性布局”，可以简便、完整、响应式地实现各种页面布局</p>
<p>采用Flex布局的元素，称为<code>flex</code>容器<code>container</code></p>
<p>它的所有子元素自动成为容器成员，称为<code>flex</code>项目<code>item</code></p>
<p> <img src="https://static.vue-js.com/fbc5f590-9837-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>容器中默认存在两条轴，主轴和交叉轴，呈90度关系。项目默认沿主轴排列，通过<code>flex-direction</code>来决定主轴的方向</p>
<p>每根轴都有起点和终点，这对于元素的对齐非常重要</p>
<h2 id="二、属性"><a href="#二、属性" class="headerlink" title="二、属性"></a>二、属性</h2><p>关于<code>flex</code>常用的属性，我们可以划分为容器属性和容器成员属性</p>
<p>容器属性有：</p>
<ul>
<li>flex-direction</li>
<li>flex-wrap</li>
<li>flex-flow</li>
<li>justify-content</li>
<li>align-items</li>
<li>align-content</li>
</ul>
<h3 id="flex-direction"><a href="#flex-direction" class="headerlink" title="flex-direction"></a>flex-direction</h3><p>决定主轴的方向(即项目的排列方向)</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;   </span><br><span class="line">    <span class="attribute">flex-direction</span>: row | row-reverse | column | column-reverse;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>属性对应如下：</p>
<ul>
<li>row（默认值）：主轴为水平方向，起点在左端</li>
<li>row-reverse：主轴为水平方向，起点在右端</li>
<li>column：主轴为垂直方向，起点在上沿。</li>
<li>column-reverse：主轴为垂直方向，起点在下沿</li>
</ul>
<p>如下图所示：</p>
<p> <img src="https://static.vue-js.com/0c9abc70-9838-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="flex-wrap"><a href="#flex-wrap" class="headerlink" title="flex-wrap"></a>flex-wrap</h3><p>弹性元素永远沿主轴排列，那么如果主轴排不下，通过<code>flex-wrap</code>决定容器内项目是否可换行</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;  </span><br><span class="line">    <span class="attribute">flex-wrap</span>: nowrap | wrap | wrap-reverse;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>属性对应如下：</p>
<ul>
<li>nowrap（默认值）：不换行</li>
<li>wrap：换行，第一行在下方</li>
<li>wrap-reverse：换行，第一行在上方</li>
</ul>
<p>默认情况是不换行，但这里也不会任由元素直接溢出容器，会涉及到元素的弹性伸缩</p>
<h3 id="flex-flow"><a href="#flex-flow" class="headerlink" title="flex-flow"></a>flex-flow</h3><p>是<code>flex-direction</code>属性和<code>flex-wrap</code>属性的简写形式，默认值为<code>row nowrap</code></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">flex-flow</span>: &lt;flex-direction&gt; || &lt;flex-wrap&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="justify-content"><a href="#justify-content" class="headerlink" title="justify-content"></a>justify-content</h3><p>定义了项目在主轴上的对齐方式</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">justify-content</span>: flex-start | flex-end | center | space-between | space-around;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>属性对应如下：</p>
<ul>
<li>flex-start（默认值）：左对齐</li>
<li>flex-end：右对齐</li>
<li>center：居中</li>
<li>space-between：两端对齐，项目之间的间隔都相等</li>
<li>space-around：两个项目两侧间隔相等</li>
</ul>
<p>效果图如下：</p>
<p> <img src="https://static.vue-js.com/2d5ca950-9838-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h3 id="align-items"><a href="#align-items" class="headerlink" title="align-items"></a>align-items</h3><p>定义项目在交叉轴上如何对齐</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">align-items</span>: flex-start | flex-end | center | baseline | stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>属性对应如下：</p>
<ul>
<li>flex-start：交叉轴的起点对齐</li>
<li>flex-end：交叉轴的终点对齐</li>
<li>center：交叉轴的中点对齐</li>
<li>baseline: 项目的第一行文字的基线对齐</li>
<li>stretch（默认值）：如果项目未设置高度或设为auto，将占满整个容器的高度</li>
</ul>
<h3 id="align-content"><a href="#align-content" class="headerlink" title="align-content"></a>align-content</h3><p>定义了多根轴线的对齐方式。如果项目只有一根轴线，该属性不起作用</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">align-content</span>: flex-start | flex-end | center | space-between | space-around | stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>属性对应如吓：</p>
<ul>
<li>flex-start：与交叉轴的起点对齐</li>
<li>flex-end：与交叉轴的终点对齐</li>
<li>center：与交叉轴的中点对齐</li>
<li>space-between：与交叉轴两端对齐，轴线之间的间隔平均分布</li>
<li>space-around：每根轴线两侧的间隔都相等。所以，轴线之间的间隔比轴线与边框的间隔大一倍</li>
<li>stretch（默认值）：轴线占满整个交叉轴</li>
</ul>
<p>效果图如下：</p>
<p> <img src="https://static.vue-js.com/39bcb0f0-9838-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>容器成员属性如下：</p>
<ul>
<li><code>order</code></li>
<li><code>flex-grow</code></li>
<li><code>flex-shrink</code></li>
<li><code>flex-basis</code></li>
<li><code>flex</code></li>
<li><code>align-self</code></li>
</ul>
<h3 id="order"><a href="#order" class="headerlink" title="order"></a>order</h3><p>定义项目的排列顺序。数值越小，排列越靠前，默认为0</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">order</span>: &lt;integer&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="flex-grow"><a href="#flex-grow" class="headerlink" title="flex-grow"></a>flex-grow</h3><p>上面讲到当容器设为<code>flex-wrap: nowrap;</code>不换行的时候，容器宽度有不够分的情况，弹性元素会根据<code>flex-grow</code>来决定</p>
<p>定义项目的放大比例（容器宽度&gt;元素总宽度时如何伸展）</p>
<p>默认为<code>0</code>，即如果存在剩余空间，也不放大</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">flex-grow</span>: &lt;number&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果所有项目的<code>flex-grow</code>属性都为1，则它们将等分剩余空间（如果有的话）</p>
<p> <img src="https://static.vue-js.com/48c8c5c0-9838-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>如果一个项目的<code>flex-grow</code>属性为2，其他项目都为1，则前者占据的剩余空间将比其他项多一倍</p>
<p> <img src="https://static.vue-js.com/5b822b20-9838-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>弹性容器的宽度正好等于元素宽度总和，无多余宽度，此时无论<code>flex-grow</code>是什么值都不会生效</p>
<h3 id="flex-shrink"><a href="#flex-shrink" class="headerlink" title="flex-shrink"></a>flex-shrink</h3><p>定义了项目的缩小比例（容器宽度&lt;元素总宽度时如何收缩），默认为1，即如果空间不足，该项目将缩小</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: &lt;number&gt;; <span class="comment">/* default 1 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果所有项目的<code>flex-shrink</code>属性都为1，当空间不足时，都将等比例缩小</p>
<p>如果一个项目的<code>flex-shrink</code>属性为0，其他项目都为1，则空间不足时，前者不缩小</p>
<p> <img src="https://static.vue-js.com/658c5be0-9838-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>在容器宽度有剩余时，<code>flex-shrink</code>也是不会生效的</p>
<h3 id="flex-basis"><a href="#flex-basis" class="headerlink" title="flex-basis"></a>flex-basis</h3><p>设置的是元素在主轴上的初始尺寸，所谓的初始尺寸就是元素在<code>flex-grow</code>和<code>flex-shrink</code>生效前的尺寸</p>
<p>浏览器根据这个属性，计算主轴是否有多余空间，默认值为<code>auto</code>，即项目的本来大小，如设置了<code>width</code>则元素尺寸由<code>width/height</code>决定（主轴方向），没有设置则由内容决定</p>
 <figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">flex-basis</span>: &lt;length&gt; | auto; <span class="comment">/* default auto */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当设置为0的是，会根据内容撑开</p>
<p>它可以设为跟<code>width</code>或<code>height</code>属性一样的值（比如350px），则项目将占据固定空间</p>
<h3 id="flex"><a href="#flex" class="headerlink" title="flex"></a>flex</h3><p><code>flex</code>属性是<code>flex-grow</code>, <code>flex-shrink</code> 和 <code>flex-basis</code>的简写，默认值为<code>0 1 auto</code>，也是比较难懂的一个复合属性</p>
 <figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: none | [ &lt;<span class="string">&#x27;flex-grow&#x27;</span>&gt; &lt;<span class="string">&#x27;flex-shrink&#x27;</span>&gt;? || &lt;<span class="string">&#x27;flex-basis&#x27;</span>&gt; ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一些属性有：</p>
<ul>
<li>flex: 1 = flex: 1 1 0%</li>
<li>flex: 2 = flex: 2 1 0%</li>
<li>flex: auto = flex: 1 1 auto</li>
<li>flex: none = flex: 0 0 auto，常用于固定尺寸不伸缩</li>
</ul>
<p><code>flex:1</code> 和 <code>flex:auto</code> 的区别，可以归结于<code>flex-basis:0</code>和<code>flex-basis:auto</code>的区别</p>
<p>当设置为0时（绝对弹性元素），此时相当于告诉<code>flex-grow</code>和<code>flex-shrink</code>在伸缩的时候不需要考虑我的尺寸</p>
<p>当设置为<code>auto</code>时（相对弹性元素），此时则需要在伸缩时将元素尺寸纳入考虑</p>
<p>注意：建议优先使用这个属性，而不是单独写三个分离的属性，因为浏览器会推算相关值</p>
<h3 id="align-self"><a href="#align-self" class="headerlink" title="align-self"></a>align-self</h3><p>允许单个项目有与其他项目不一样的对齐方式，可覆盖<code>align-items</code>属性</p>
<p>默认值为<code>auto</code>，表示继承父元素的<code>align-items</code>属性，如果没有父元素，则等同于<code>stretch</code></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">align-self</span>: auto | flex-start | flex-end | center | baseline | stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果图如下：</p>
<p> <img src="https://static.vue-js.com/6f8304a0-9838-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="三、应用场景"><a href="#三、应用场景" class="headerlink" title="三、应用场景"></a>三、应用场景</h2><p>在以前的文章中，我们能够通过<code>flex</code>简单粗暴的实现元素水平垂直方向的居中，以及在两栏三栏自适应布局中通过<code>flex</code>完成，这里就不再展开代码的演示</p>
<p>包括现在在移动端、小程序这边的开发，都建议使用<code>flex</code>进行布局</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex">https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html">http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>flexbox</tag>
      </tags>
  </entry>
  <entry>
    <title>function</title>
    <url>/archives/caae163d.html</url>
    <content><![CDATA[<h1 id="面试官：对象新增了哪些扩展？"><a href="#面试官：对象新增了哪些扩展？" class="headerlink" title="面试官：对象新增了哪些扩展？"></a>面试官：对象新增了哪些扩展？</h1><p><img src="https://static.vue-js.com/54a04a10-5569-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、参数"><a href="#一、参数" class="headerlink" title="一、参数"></a>一、参数</h2><p><code>ES6</code>允许为函数的参数设置默认值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">x, y = <span class="string">&#x27;World&#x27;</span></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Hello&#x27;</span>) <span class="comment">// Hello World</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;China&#x27;</span>) <span class="comment">// Hello China</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="comment">// Hello</span></span><br></pre></td></tr></table></figure>
<p>函数的形参是默认声明的，不能使用<code>let</code>或<code>const</code>再次声明</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x = <span class="number">5</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="number">1</span>; <span class="comment">// error</span></span><br><span class="line">    <span class="keyword">const</span> x = <span class="number">2</span>; <span class="comment">// error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参数默认值可以与解构赋值的默认值结合起来使用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">&#123;x, y = <span class="number">5</span>&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(&#123;&#125;) <span class="comment">// undefined 5</span></span><br><span class="line">foo(&#123;<span class="attr">x</span>: <span class="number">1</span>&#125;) <span class="comment">// 1 5</span></span><br><span class="line">foo(&#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>&#125;) <span class="comment">// 1 2</span></span><br><span class="line">foo() <span class="comment">// TypeError: Cannot read property &#x27;x&#x27; of undefined</span></span><br></pre></td></tr></table></figure>
<p>上面的<code>foo</code>函数，当参数为对象的时候才能进行解构，如果没有提供参数的时候，变量<code>x</code>和<code>y</code>就不会生成，从而报错，这里设置默认值避免</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">&#123;x, y = <span class="number">5</span>&#125; = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo() <span class="comment">// undefined 5</span></span><br></pre></td></tr></table></figure>
<p>参数默认值应该是函数的尾参数，如果不是非尾部的参数设置默认值，实际上这个参数是没发省略的</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x = <span class="number">1</span>, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f() <span class="comment">// [1, undefined]</span></span><br><span class="line">f(<span class="number">2</span>) <span class="comment">// [2, undefined]</span></span><br><span class="line">f(, <span class="number">1</span>) <span class="comment">// 报错</span></span><br><span class="line">f(<span class="literal">undefined</span>, <span class="number">1</span>) <span class="comment">// [1, 1]</span></span><br></pre></td></tr></table></figure>
<h2 id="二、属性"><a href="#二、属性" class="headerlink" title="二、属性"></a>二、属性</h2><h3 id="函数的length属性"><a href="#函数的length属性" class="headerlink" title="函数的length属性"></a>函数的length属性</h3><p><code>length</code>将返回没有指定默认值的参数个数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;&#125;).length <span class="comment">// 1</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a = <span class="number">5</span></span>) </span>&#123;&#125;).length <span class="comment">// 0</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a, b, c = <span class="number">5</span></span>) </span>&#123;&#125;).length <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<p><code>rest</code> 参数也不会计入<code>length</code>属性</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;&#125;).length <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
<p>如果设置了默认值的参数不是尾参数，那么<code>length</code>属性也不再计入后面的参数了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a = <span class="number">0</span>, b, c</span>) </span>&#123;&#125;).length <span class="comment">// 0</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a, b = <span class="number">1</span>, c</span>) </span>&#123;&#125;).length <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<h3 id="name属性"><a href="#name属性" class="headerlink" title="name属性"></a>name属性</h3><p>返回该函数的函数名</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5</span></span><br><span class="line">f.name <span class="comment">// &quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6</span></span><br><span class="line">f.name <span class="comment">// &quot;f&quot;</span></span><br></pre></td></tr></table></figure>
<p>如果将一个具名函数赋值给一个变量，则 <code>name</code>属性都返回这个具名函数原本的名字</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> bar = <span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">bar.name <span class="comment">// &quot;baz&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>Function</code>构造函数返回的函数实例，<code>name</code>属性的值为<code>anonymous</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">new</span> <span class="built_in">Function</span>).name <span class="comment">// &quot;anonymous&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>bind</code>返回的函数，<code>name</code>属性值会加上<code>bound</code>前缀</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">foo.bind(&#123;&#125;).name <span class="comment">// &quot;bound foo&quot;</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).bind(&#123;&#125;).name <span class="comment">// &quot;bound &quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="三、作用域"><a href="#三、作用域" class="headerlink" title="三、作用域"></a>三、作用域</h2><p>一旦设置了参数的默认值，函数进行声明初始化时，参数会形成一个单独的作用域</p>
<p>等到初始化结束，这个作用域就会消失。这种语法行为，在不设置参数默认值时，是不会出现的</p>
<p>下面例子中，<code>y=x</code>会形成一个单独作用域，<code>x</code>没有被定义，所以指向全局变量<code>x</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">y = x</span>) </span>&#123; </span><br><span class="line">  <span class="comment">// 等同于 let y = x  </span></span><br><span class="line">  <span class="keyword">let</span> x = <span class="number">2</span>; </span><br><span class="line">  <span class="built_in">console</span>.log(y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f() <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<h2 id="四、严格模式"><a href="#四、严格模式" class="headerlink" title="四、严格模式"></a>四、严格模式</h2><p>只要函数参数使用了默认值、解构赋值、或者扩展运算符，那么函数内部就不能显式设定为严格模式，否则会报错</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">a, b = a</span>) </span>&#123;</span><br><span class="line"><span class="meta">  &#x27;use strict&#x27;</span>;</span><br><span class="line">  <span class="comment">// code</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">const</span> doSomething = <span class="function"><span class="keyword">function</span> (<span class="params">&#123;a, b&#125;</span>) </span>&#123;</span><br><span class="line"><span class="meta">  &#x27;use strict&#x27;</span>;</span><br><span class="line">  <span class="comment">// code</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">const</span> doSomething = <span class="function">(<span class="params">...a</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">  <span class="comment">// code</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="comment">// 报错</span></span><br><span class="line">  <span class="function"><span class="title">doSomething</span>(<span class="params">&#123;a, b&#125;</span>)</span> &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    <span class="comment">// code</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="五、箭头函数"><a href="#五、箭头函数" class="headerlink" title="五、箭头函数"></a>五、箭头函数</h2><p>使用“箭头”（<code>=&gt;</code>）定义函数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> f = <span class="function"><span class="params">v</span> =&gt;</span> v;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span> (<span class="params">v</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> v;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>如果箭头函数不需要参数或需要多个参数，就使用一个圆括号代表参数部分</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> f = <span class="function">() =&gt;</span> <span class="number">5</span>;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> num1 + num2;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="function"><span class="keyword">function</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> num1 + num2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>如果箭头函数的代码块部分多于一条语句，就要使用大括号将它们括起来，并且使用<code>return</code>语句返回</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123; <span class="keyword">return</span> num1 + num2; &#125;</span><br></pre></td></tr></table></figure>
<p>如果返回对象，需要加括号将对象包裹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> getTempItem = <span class="function"><span class="params">id</span> =&gt;</span> (&#123; <span class="attr">id</span>: id, <span class="attr">name</span>: <span class="string">&quot;Temp&quot;</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>注意点：</p>
<ul>
<li>函数体内的<code>this</code>对象，就是定义时所在的对象，而不是使用时所在的对象</li>
<li>不可以当作构造函数，也就是说，不可以使用<code>new</code>命令，否则会抛出一个错误</li>
<li>不可以使用<code>arguments</code>对象，该对象在函数体内不存在。如果要用，可以用 <code>rest</code> 参数代替</li>
<li>不可以使用<code>yield</code>命令，因此箭头函数不能用作 Generator 函数</li>
</ul>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://es6.ruanyifeng.com/#docs/function">https://es6.ruanyifeng.com/#docs/function</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>es6</tag>
        <tag>function</tag>
      </tags>
  </entry>
  <entry>
    <title>generator</title>
    <url>/archives/caae7b70.html</url>
    <content><![CDATA[<h1 id="面试官：你是怎么理解ES6中-Generator的？使用场景？"><a href="#面试官：你是怎么理解ES6中-Generator的？使用场景？" class="headerlink" title="面试官：你是怎么理解ES6中 Generator的？使用场景？"></a>面试官：你是怎么理解ES6中 Generator的？使用场景？</h1><p> <img src="https://static.vue-js.com/7db499b0-5947-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h2><p>Generator 函数是 ES6 提供的一种异步编程解决方案，语法行为与传统函数完全不同</p>
<p>回顾下上文提到的解决异步的手段：</p>
<ul>
<li>回调函数</li>
<li>promise</li>
</ul>
<p>那么，上文我们提到<code>promsie</code>已经是一种比较流行的解决异步方案，那么为什么还出现<code>Generator</code>？甚至<code>async/await</code>呢？</p>
<p>该问题我们留在后面再进行分析，下面先认识下<code>Generator</code></p>
<h3 id="Generator函数"><a href="#Generator函数" class="headerlink" title="Generator函数"></a>Generator函数</h3><p>执行 <code>Generator</code> 函数会返回一个遍历器对象，可以依次遍历 <code>Generator</code> 函数内部的每一个状态</p>
<p>形式上，<code>Generator</code>函数是一个普通函数，但是有两个特征：</p>
<ul>
<li><code>function</code>关键字与函数名之间有一个星号</li>
<li>函数体内部使用<code>yield</code>表达式，定义不同的内部状态</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">helloWorldGenerator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;ending&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h2><p><code>Generator</code> 函数会返回一个遍历器对象，即具有<code>Symbol.iterator</code>属性，并且返回给自己</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">// some code</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> g = gen();</span><br><span class="line"></span><br><span class="line">g[<span class="built_in">Symbol</span>.iterator]() === g</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>通过<code>yield</code>关键字可以暂停<code>generator</code>函数返回的遍历器对象的状态</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">helloWorldGenerator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;ending&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> hw = helloWorldGenerator();</span><br></pre></td></tr></table></figure>
<p>上述存在三个状态：<code>hello</code>、<code>world</code>、<code>return</code></p>
<p>通过<code>next</code>方法才会遍历到下一个内部状态，其运行逻辑如下：</p>
<ul>
<li>遇到<code>yield</code>表达式，就暂停执行后面的操作，并将紧跟在<code>yield</code>后面的那个表达式的值，作为返回的对象的<code>value</code>属性值。</li>
<li>下一次调用<code>next</code>方法时，再继续往下执行，直到遇到下一个<code>yield</code>表达式</li>
<li>如果没有再遇到新的<code>yield</code>表达式，就一直运行到函数结束，直到<code>return</code>语句为止，并将<code>return</code>语句后面的表达式的值，作为返回的对象的<code>value</code>属性值。</li>
<li>如果该函数没有<code>return</code>语句，则返回的对象的<code>value</code>属性值为<code>undefined</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">hw.next()</span><br><span class="line"><span class="comment">// &#123; value: &#x27;hello&#x27;, done: false &#125;</span></span><br><span class="line"></span><br><span class="line">hw.next()</span><br><span class="line"><span class="comment">// &#123; value: &#x27;world&#x27;, done: false &#125;</span></span><br><span class="line"></span><br><span class="line">hw.next()</span><br><span class="line"><span class="comment">// &#123; value: &#x27;ending&#x27;, done: true &#125;</span></span><br><span class="line"></span><br><span class="line">hw.next()</span><br><span class="line"><span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure>
<p><code>done</code>用来判断是否存在下个状态，<code>value</code>对应状态值</p>
<p><code>yield</code>表达式本身没有返回值，或者说总是返回<code>undefined</code></p>
<p>通过调用<code>next</code>方法可以带一个参数，该参数就会被当作上一个<code>yield</code>表达式的返回值</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">foo</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> y = <span class="number">2</span> * (<span class="keyword">yield</span> (x + <span class="number">1</span>));</span><br><span class="line">  <span class="keyword">var</span> z = <span class="keyword">yield</span> (y / <span class="number">3</span>);</span><br><span class="line">  <span class="keyword">return</span> (x + y + z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = foo(<span class="number">5</span>);</span><br><span class="line">a.next() <span class="comment">// Object&#123;value:6, done:false&#125;</span></span><br><span class="line">a.next() <span class="comment">// Object&#123;value:NaN, done:false&#125;</span></span><br><span class="line">a.next() <span class="comment">// Object&#123;value:NaN, done:true&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = foo(<span class="number">5</span>);</span><br><span class="line">b.next() <span class="comment">// &#123; value:6, done:false &#125;</span></span><br><span class="line">b.next(<span class="number">12</span>) <span class="comment">// &#123; value:8, done:false &#125;</span></span><br><span class="line">b.next(<span class="number">13</span>) <span class="comment">// &#123; value:42, done:true &#125;</span></span><br></pre></td></tr></table></figure>
<p>正因为<code>Generator</code>函数返回<code>Iterator</code>对象，因此我们还可以通过<code>for...of</code>进行遍历<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">4</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> foo()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1 2 3 4 5</span></span><br></pre></td></tr></table></figure></p>
<p>原生对象没有遍历接口，通过<code>Generator</code>函数为它加上这个接口，就能使用<code>for...of</code>进行遍历了</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">objectEntries</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> propKeys = <span class="built_in">Reflect</span>.ownKeys(obj);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> propKey <span class="keyword">of</span> propKeys) &#123;</span><br><span class="line">    <span class="keyword">yield</span> [propKey, obj[propKey]];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> jane = &#123; <span class="attr">first</span>: <span class="string">&#x27;Jane&#x27;</span>, <span class="attr">last</span>: <span class="string">&#x27;Doe&#x27;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> objectEntries(jane)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>: <span class="subst">$&#123;value&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// first: Jane</span></span><br><span class="line"><span class="comment">// last: Doe</span></span><br></pre></td></tr></table></figure>
<h2 id="三、异步解决方案"><a href="#三、异步解决方案" class="headerlink" title="三、异步解决方案"></a>三、异步解决方案</h2><p>回顾之前展开异步解决的方案：</p>
<ul>
<li>回调函数</li>
<li>Promise 对象</li>
<li>generator 函数</li>
<li>async/await</li>
</ul>
<p>这里通过文件读取案例，将几种解决异步的方案进行一个比较：</p>
<h3 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h3><p>所谓回调函数，就是把任务的第二段单独写在一个函数里面，等到重新执行这个任务的时候，再调用这个函数</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">fs.readFile(<span class="string">&#x27;/etc/fstab&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">  fs.readFile(<span class="string">&#x27;/etc/shells&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><code>readFile</code>函数的第三个参数，就是回调函数，等到操作系统返回了<code>/etc/passwd</code>这个文件以后，回调函数才会执行</p>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><p><code>Promise</code>就是为了解决回调地狱而产生的，将回调函数的嵌套，改成链式调用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> readFile = <span class="function"><span class="keyword">function</span> (<span class="params">fileName</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    fs.readFile(fileName, <span class="function"><span class="keyword">function</span>(<span class="params">error, data</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (error) <span class="keyword">return</span> reject(error);</span><br><span class="line">      resolve(data);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">readFile(<span class="string">&#x27;/etc/fstab&#x27;</span>).then(<span class="function"><span class="params">data</span> =&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">    <span class="keyword">return</span> readFile(<span class="string">&#x27;/etc/shells&#x27;</span>)</span><br><span class="line">&#125;).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这种链式操作形式，使异步任务的两段执行更清楚了，但是也存在了很明显的问题，代码变得冗杂了，语义化并不强</p>
<h3 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h3><p><code>yield</code>表达式可以暂停函数执行，<code>next</code>方法用于恢复函数执行，这使得<code>Generator</code>函数非常适合将异步任务同步化</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> gen = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> f1 = <span class="keyword">yield</span> readFile(<span class="string">&#x27;/etc/fstab&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> f2 = <span class="keyword">yield</span> readFile(<span class="string">&#x27;/etc/shells&#x27;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(f1.toString());</span><br><span class="line">  <span class="built_in">console</span>.log(f2.toString());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="async-await"><a href="#async-await" class="headerlink" title="async/await"></a>async/await</h3><p>将上面<code>Generator</code>函数改成<code>async/await</code>形式，更为简洁，语义化更强了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> asyncReadFile = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> f1 = <span class="keyword">await</span> readFile(<span class="string">&#x27;/etc/fstab&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> f2 = <span class="keyword">await</span> readFile(<span class="string">&#x27;/etc/shells&#x27;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(f1.toString());</span><br><span class="line">  <span class="built_in">console</span>.log(f2.toString());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="区别："><a href="#区别：" class="headerlink" title="区别："></a>区别：</h3><p>通过上述代码进行分析，将<code>promise</code>、<code>Generator</code>、<code>async/await</code>进行比较：</p>
<ul>
<li><code>promise</code>和<code>async/await</code>是专门用于处理异步操作的</li>
<li><code>Generator</code>并不是为异步而设计出来的，它还有其他功能（对象迭代、控制输出、部署<code>Interator</code>接口…）</li>
<li><p><code>promise</code>编写代码相比<code>Generator</code>、<code>async</code>更为复杂化，且可读性也稍差</p>
</li>
<li><p><code>Generator</code>、<code>async</code>需要与<code>promise</code>对象搭配处理异步情况</p>
</li>
<li><code>async</code>实质是<code>Generator</code>的语法糖，相当于会自动执行<code>Generator</code>函数</li>
<li><code>async</code>使用上更为简洁，将异步代码以同步的形式进行编写，是处理异步编程的最终方案</li>
</ul>
<h2 id="四、使用场景"><a href="#四、使用场景" class="headerlink" title="四、使用场景"></a>四、使用场景</h2><p><code>Generator</code>是异步解决的一种方案，最大特点则是将异步操作同步化表达出来</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">loadUI</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  showLoadingScreen();</span><br><span class="line">  <span class="keyword">yield</span> loadUIDataAsynchronously();</span><br><span class="line">  hideLoadingScreen();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> loader = loadUI();</span><br><span class="line"><span class="comment">// 加载UI</span></span><br><span class="line">loader.next()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 卸载UI</span></span><br><span class="line">loader.next()</span><br></pre></td></tr></table></figure>
<p>包括<code>redux-saga</code>中间件也充分利用了<code>Generator</code>特性</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; call, put, takeEvery, takeLatest &#125; <span class="keyword">from</span> <span class="string">&#x27;redux-saga/effects&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Api <span class="keyword">from</span> <span class="string">&#x27;...&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">fetchUser</span>(<span class="params">action</span>) </span>&#123;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">yield</span> call(Api.fetchUser, action.payload.userId);</span><br><span class="line">      <span class="keyword">yield</span> put(&#123;<span class="attr">type</span>: <span class="string">&quot;USER_FETCH_SUCCEEDED&quot;</span>, <span class="attr">user</span>: user&#125;);</span><br><span class="line">   &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">yield</span> put(&#123;<span class="attr">type</span>: <span class="string">&quot;USER_FETCH_FAILED&quot;</span>, <span class="attr">message</span>: e.message&#125;);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">mySaga</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> takeEvery(<span class="string">&quot;USER_FETCH_REQUESTED&quot;</span>, fetchUser);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">mySaga</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> takeLatest(<span class="string">&quot;USER_FETCH_REQUESTED&quot;</span>, fetchUser);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> mySaga;</span><br></pre></td></tr></table></figure>
<p>还能利用<code>Generator</code>函数，在对象上实现<code>Iterator</code>接口</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">iterEntries</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> keys = <span class="built_in">Object</span>.keys(obj);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i &lt; keys.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> key = keys[i];</span><br><span class="line">    <span class="keyword">yield</span> [key, obj[key]];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myObj = &#123; <span class="attr">foo</span>: <span class="number">3</span>, <span class="attr">bar</span>: <span class="number">7</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> iterEntries(myObj)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// foo 3</span></span><br><span class="line"><span class="comment">// bar 7</span></span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://es6.ruanyifeng.com/#docs/generator-async">https://es6.ruanyifeng.com/#docs/generator-async</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>es6</tag>
        <tag>generator</tag>
      </tags>
  </entry>
  <entry>
    <title>gametime</title>
    <url>/archives/39a5927a.html</url>
    <content><![CDATA[<div class="tip ban faa-flash animated-hover"><p>一分半高亮操作</p>
</div>
<p> 这个 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> 不要笑。</p>

<div class="dplayer" style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">
<iframe src="//player.bilibili.com/player.html?aid=593762502&bvid=BV15q4y1b7tT&cid=502918784&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; Left: 0; top: 0;" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts" ></iframe></div>

<p>就这 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> 就这。</p>
]]></content>
      <categories>
        <category>fine</category>
      </categories>
      <tags>
        <tag>fine</tag>
        <tag>gametime</tag>
      </tags>
  </entry>
  <entry>
    <title>functional_programming</title>
    <url>/archives/eab5cc79.html</url>
    <content><![CDATA[<h1 id="面试官：说说你对函数式编程的理解？优缺点？"><a href="#面试官：说说你对函数式编程的理解？优缺点？" class="headerlink" title="面试官：说说你对函数式编程的理解？优缺点？"></a>面试官：说说你对函数式编程的理解？优缺点？</h1><p> <img src="https://static.vue-js.com/ec0f6e80-8534-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>函数式编程是一种”编程范式”（programming paradigm），一种编写程序的方法论</p>
<p>主要的编程范式有三种：命令式编程，声明式编程和函数式编程</p>
<p>相比命令式编程，函数式编程更加强调程序执行的结果而非执行的过程，倡导利用若干简单的执行单元让计算结果不断渐进，逐层推导复杂的运算，而非设计一个复杂的执行过程</p>
<p>举个例子，将数组每个元素进行平方操作，命令式编程与函数式编程如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 命令式编程</span></span><br><span class="line"><span class="keyword">var</span> array = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">    array[i] = <span class="built_in">Math</span>.pow(array[i], <span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数式方式</span></span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(<span class="function"><span class="params">num</span> =&gt;</span> <span class="built_in">Math</span>.pow(num, <span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<p>简单来讲，就是要把过程逻辑写成函数，定义好输入参数，只关心它的输出结果</p>
<p>即是一种描述集合和集合之间的转换关系，输入通过函数都会返回有且只有一个输出值</p>
<p> <img src="https://static.vue-js.com/f9f83900-8534-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>可以看到，函数实际上是一个关系，或者说是一种映射，而这种映射关系是可以组合的，一旦我们知道一个函数的输出类型可以匹配另一个函数的输入，那他们就可以进行组合</p>
<h2 id="二、概念"><a href="#二、概念" class="headerlink" title="二、概念"></a>二、概念</h2><h3 id="纯函数"><a href="#纯函数" class="headerlink" title="纯函数"></a>纯函数</h3><p>函数式编程旨在尽可能的提高代码的无状态性和不变性。要做到这一点，就要学会使用无副作用的函数，也就是纯函数</p>
<p>纯函数是对给定的输入返还相同输出的函数，并且要求你所有的数据都是不可变的，即纯函数=无状态+数据不可变</p>
<p> <img src="https://static.vue-js.com/04f50720-8535-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>举一个简单的例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> double = <span class="function"><span class="params">value</span>=&gt;</span>value*<span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p>特性：</p>
<ul>
<li>函数内部传入指定的值，就会返回确定唯一的值</li>
<li>不会造成超出作用域的变化，例如修改全局变量或引用传递的参数</li>
</ul>
<p>优势：</p>
<ul>
<li>使用纯函数，我们可以产生可测试的代码</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">test(<span class="string">&#x27;double(2) 等于 4&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(double(<span class="number">2</span>)).toBe(<span class="number">4</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>不依赖外部环境计算，不会产生副作用，提高函数的复用性</p>
</li>
<li><p>可读性更强 ，函数不管是否是纯函数  都会有一个语义化的名称，更便于阅读</p>
</li>
<li><p>可以组装成复杂任务的可能性。符合模块化概念及单一职责原则</p>
</li>
</ul>
<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><p>在我们的编程世界中，我们需要处理的其实也只有“数据”和“关系”，而关系就是函数</p>
<p>编程工作也就是在找一种映射关系，一旦关系找到了，问题就解决了，剩下的事情，就是让数据流过这种关系，然后转换成另一个数据，如下图所示</p>
<p> <img src="https://static.vue-js.com/104af1c0-8535-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>在这里，就是高阶函数的作用。高级函数，就是以函数作为输入或者输出的函数被称为高阶函数</p>
<p>通过高阶函数抽象过程，注重结果，如下面例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> forEach = <span class="function"><span class="keyword">function</span>(<span class="params">arr,fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">        fn(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">forEach(arr,<span class="function">(<span class="params">item</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>上面通过高阶函数 <code>forEach</code>来抽象循环如何做的逻辑，直接关注做了什么</p>
<p>高阶函数存在缓存的特性，主要是利用闭包作用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> once = <span class="function">(<span class="params">fn</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> done = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!done)&#123;</span><br><span class="line">            fn.apply(<span class="built_in">this</span>,fn);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;该函数已经执行&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        done = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="柯里化"><a href="#柯里化" class="headerlink" title="柯里化"></a>柯里化</h3><p>柯里化是把一个多参数函数转化成一个嵌套的一元函数的过程</p>
<p>一个二元函数如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = <span class="function">(<span class="params">x,y</span>)=&gt;</span>x+y;</span><br></pre></td></tr></table></figure>
<p>转化成柯里化函数如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> curry = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">y</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> fn(x,y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> myfn = curry(fn);</span><br><span class="line"><span class="built_in">console</span>.log( myfn(<span class="number">1</span>)(<span class="number">2</span>) );</span><br></pre></td></tr></table></figure>
<p>上面的<code>curry</code>函数只能处理二元情况，下面再来实现一个实现多参数的情况</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 多参数柯里化；</span></span><br><span class="line"><span class="keyword">const</span> curry = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">curriedFn</span>(<span class="params">...args</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(args.length&lt;fn.length)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> curriedFn(...args.concat([...arguments]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fn(...args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fn = <span class="function">(<span class="params">x,y,z,a</span>)=&gt;</span>x+y+z+a;</span><br><span class="line"><span class="keyword">const</span> myfn = curry(fn);</span><br><span class="line"><span class="built_in">console</span>.log(myfn(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>)(<span class="number">1</span>));</span><br></pre></td></tr></table></figure>
<p>关于柯里化函数的意义如下：</p>
<ul>
<li>让纯函数更纯，每次接受一个参数，松散解耦</li>
<li>惰性执行</li>
</ul>
<h3 id="组合与管道"><a href="#组合与管道" class="headerlink" title="组合与管道"></a>组合与管道</h3><p>组合函数，目的是将多个函数组合成一个函数</p>
<p>举个简单的例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">afn</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a*<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bfn</span>(<span class="params">b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b*<span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> compose = <span class="function">(<span class="params">a,b</span>)=&gt;</span><span class="function"><span class="params">c</span>=&gt;</span>a(b(c));</span><br><span class="line"><span class="keyword">let</span> myfn =  compose(afn,bfn);</span><br><span class="line"><span class="built_in">console</span>.log( myfn(<span class="number">2</span>));</span><br></pre></td></tr></table></figure>
<p>可以看到<code>compose</code>实现一个简单的功能：形成了一个新的函数，而这个函数就是一条从 <code>bfn -&gt; afn</code> 的流水线</p>
<p>下面再来看看如何实现一个多函数组合：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> compose = <span class="function">(<span class="params">...fns</span>)=&gt;</span><span class="function"><span class="params">val</span>=&gt;</span>fns.reverse().reduce(<span class="function">(<span class="params">acc,fn</span>)=&gt;</span>fn(acc),val);</span><br></pre></td></tr></table></figure>
<p><code>compose</code>执行是从右到左的。而管道函数，执行顺序是从左到右执行的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> pipe = <span class="function">(<span class="params">...fns</span>)=&gt;</span><span class="function"><span class="params">val</span>=&gt;</span>fns.reduce(<span class="function">(<span class="params">acc,fn</span>)=&gt;</span>fn(acc),val);</span><br></pre></td></tr></table></figure>
<p>组合函数与管道函数的意义在于：可以把很多小函数组合起来完成更复杂的逻辑</p>
<h2 id="三、优缺点"><a href="#三、优缺点" class="headerlink" title="三、优缺点"></a>三、优缺点</h2><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul>
<li><p>更好的管理状态：因为它的宗旨是无状态，或者说更少的状态，能最大化的减少这些未知、优化代码、减少出错情况</p>
</li>
<li><p>更简单的复用：固定输入-&gt;固定输出，没有其他外部变量影响，并且无副作用。这样代码复用时，完全不需要考虑它的内部实现和外部影响</p>
</li>
<li><p>更优雅的组合：往大的说，网页是由各个组件组成的。往小的说，一个函数也可能是由多个小函数组成的。更强的复用性，带来更强大的组合性</p>
</li>
<li><p>隐性好处。减少代码量，提高维护性</p>
</li>
</ul>
<h4 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h4><ul>
<li><p>性能：函数式编程相对于指令式编程，性能绝对是一个短板，因为它往往会对一个方法进行过度包装，从而产生上下文切换的性能开销</p>
</li>
<li><p>资源占用：在 JS 中为了实现对象状态的不可变，往往会创建新的对象，因此，它对垃圾回收所产生的压力远远超过其他编程方式</p>
</li>
<li><p>递归陷阱：在函数式编程中，为了实现迭代，通常会采用递归操作</p>
</li>
</ul>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://zhuanlan.zhihu.com/p/81302150">https://zhuanlan.zhihu.com/p/81302150</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>functional_programming</tag>
      </tags>
  </entry>
  <entry>
    <title>function_cache</title>
    <url>/archives/adb78c8a.html</url>
    <content><![CDATA[<h1 id="面试官：Javascript中如何实现函数缓存？函数缓存有哪些应用场景？"><a href="#面试官：Javascript中如何实现函数缓存？函数缓存有哪些应用场景？" class="headerlink" title="面试官：Javascript中如何实现函数缓存？函数缓存有哪些应用场景？"></a>面试官：Javascript中如何实现函数缓存？函数缓存有哪些应用场景？</h1><p> <img src="https://static.vue-js.com/2ae9dda0-85fa-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>函数缓存，就是将函数运算过的结果进行缓存</p>
<p>本质上就是用空间（缓存存储）换时间（计算过程）</p>
<p>常用于缓存数据计算结果和缓存对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">a,b</span>) =&gt;</span> a+b;</span><br><span class="line"><span class="keyword">const</span> calc = memoize(add); <span class="comment">// 函数缓存</span></span><br><span class="line">calc(<span class="number">10</span>,<span class="number">20</span>);<span class="comment">// 30</span></span><br><span class="line">calc(<span class="number">10</span>,<span class="number">20</span>);<span class="comment">// 30 缓存</span></span><br></pre></td></tr></table></figure>
<p>缓存只是一个临时的数据存储，它保存数据，以便将来对该数据的请求能够更快地得到处理</p>
<h2 id="二、如何实现"><a href="#二、如何实现" class="headerlink" title="二、如何实现"></a>二、如何实现</h2><p>实现函数缓存主要依靠闭包、柯里化、高阶函数，这里再简单复习下：</p>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>闭包可以理解成，函数 + 函数体内可访问的变量总和</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> b = <span class="number">2</span></span><br><span class="line">        <span class="keyword">let</span> sum = b + a</span><br><span class="line">        <span class="built_in">console</span>.log(sum); <span class="comment">// 3</span></span><br><span class="line">    &#125;</span><br><span class="line">    add()</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<p><code>add</code>函数本身，以及其内部可访问的变量，即 <code>a = 1</code>，这两个组合在⼀起就形成了闭包</p>
<h3 id="柯里化"><a href="#柯里化" class="headerlink" title="柯里化"></a>柯里化</h3><p>把接受多个参数的函数转换成接受一个单一参数的函数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 非函数柯里化</span></span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params">x,y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x+y;</span><br><span class="line">&#125;</span><br><span class="line">add(<span class="number">3</span>,<span class="number">4</span>) <span class="comment">//7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数柯里化</span></span><br><span class="line"><span class="keyword">var</span> add2 = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//**返回函数**</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">y</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x+y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">add2(<span class="number">3</span>)(<span class="number">4</span>) <span class="comment">//7</span></span><br></pre></td></tr></table></figure>
<p>将一个二元函数拆分成两个一元函数</p>
<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><p>通过接收其他函数作为参数或返回其他函数的函数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> bar;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> baz = foo();</span><br><span class="line">baz();<span class="comment">//2</span></span><br></pre></td></tr></table></figure>
<p>函数 <code>foo</code> 如何返回另一个函数 <code>bar</code>，<code>baz</code> 现在持有对 <code>foo</code> 中定义的<code>bar</code> 函数的引用。由于闭包特性，<code>a</code>的值能够得到</p>
<p>下面再看看如何实现函数缓存，实现原理也很简单，把参数和对应的结果数据存在一个对象中，调用时判断参数对应的数据是否存在，存在就返回对应的结果数据，否则就返回计算结果</p>
<p>如下所示</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> memoize = <span class="function"><span class="keyword">function</span> (<span class="params">func, content</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> cache = <span class="built_in">Object</span>.create(<span class="literal">null</span>)</span><br><span class="line">  content = content || <span class="built_in">this</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">...key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!cache[key]) &#123;</span><br><span class="line">      cache[key] = func.apply(content, key)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cache[key]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用方式也很简单</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> calc = memoize(add);</span><br><span class="line"><span class="keyword">const</span> num1 = calc(<span class="number">100</span>,<span class="number">200</span>)</span><br><span class="line"><span class="keyword">const</span> num2 = calc(<span class="number">100</span>,<span class="number">200</span>) <span class="comment">// 缓存得到的结果</span></span><br></pre></td></tr></table></figure>
<p>过程分析：</p>
<ul>
<li>在当前函数作用域定义了一个空对象，用于缓存运行结果</li>
<li>运用柯里化返回一个函数，返回的函数由于闭包特性，可以访问到<code>cache</code></li>
<li>然后判断输入参数是不是在<code>cache</code>的中。如果已经存在，直接返回<code>cache</code>的内容，如果没有存在，使用函数<code>func</code>对输入参数求值，然后把结果存储在<code>cache</code>中</li>
</ul>
<h2 id="三、应用场景"><a href="#三、应用场景" class="headerlink" title="三、应用场景"></a>三、应用场景</h2><p>虽然使用缓存效率是非常高的，但并不是所有场景都适用，因此千万不要极端的将所有函数都添加缓存</p>
<p>以下几种情况下，适合使用缓存：</p>
<ul>
<li>对于昂贵的函数调用，执行复杂计算的函数</li>
<li>对于具有有限且高度重复输入范围的函数</li>
<li>对于具有重复输入值的递归函数</li>
<li>对于纯函数，即每次使用特定输入调用时返回相同输出的函数</li>
</ul>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://zhuanlan.zhihu.com/p/112505577">https://zhuanlan.zhihu.com/p/112505577</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>function_cache</tag>
      </tags>
  </entry>
  <entry>
    <title>goal</title>
    <url>/archives/fcdceb2e.html</url>
    <content><![CDATA[<!-- 
<div class="dplayer" style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">
<iframe src="//player.bilibili.com/player.html?aid=593762502&bvid=BV15q4y1b7tT&cid=502918784&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; Left: 0; top: 0;" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts" ></iframe></div>
 -->
<h1 id="面试官：Vue3-0的设计目标是什么？做了哪些优化"><a href="#面试官：Vue3-0的设计目标是什么？做了哪些优化" class="headerlink" title="面试官：Vue3.0的设计目标是什么？做了哪些优化"></a>面试官：Vue3.0的设计目标是什么？做了哪些优化</h1><p><img src="https://static.vue-js.com/b93b49c0-5c58-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、设计目标"><a href="#一、设计目标" class="headerlink" title="一、设计目标"></a>一、设计目标</h2><p>不以解决实际业务痛点的更新都是耍流氓，下面我们来列举一下<code>Vue3</code>之前我们或许会面临的问题</p>
<ul>
<li><p>随着功能的增长，复杂组件的代码变得越来越难以维护</p>
</li>
<li><p>缺少一种比较「干净」的在多个组件之间提取和复用逻辑的机制</p>
</li>
<li><p>类型推断不够友好</p>
</li>
<li><p><code>bundle</code>的时间太久了</p>
</li>
</ul>
<p>而 <code>Vue3</code> 经过长达两三年时间的筹备，做了哪些事情？</p>
<p>我们从结果反推</p>
<ul>
<li>更小</li>
<li>更快</li>
<li>TypeScript支持</li>
<li>API设计一致性</li>
<li>提高自身可维护性</li>
<li>开放更多底层功能</li>
</ul>
<p>一句话概述，就是更小更快更友好了</p>
<h3 id="更小"><a href="#更小" class="headerlink" title="更小"></a>更小</h3><p><code>Vue3</code>移除一些不常用的 <code>API</code></p>
<p>引入<code>tree-shaking</code>，可以将无用模块“剪辑”，仅打包需要的，使打包的整体体积变小了</p>
<h3 id="更快"><a href="#更快" class="headerlink" title="更快"></a>更快</h3><p>主要体现在编译方面：</p>
<ul>
<li>diff算法优化</li>
<li>静态提升</li>
<li>事件监听缓存</li>
<li>SSR优化</li>
</ul>
<p>下篇文章我们会进一步介绍</p>
<h3 id="更友好"><a href="#更友好" class="headerlink" title="更友好"></a>更友好</h3><p><code>vue3</code>在兼顾<code>vue2</code>的<code>options API</code>的同时还推出了<code>composition API</code>，大大增加了代码的逻辑组织和代码复用能力</p>
<p>这里代码简单演示下：</p>
<p>存在一个获取鼠标位置的函数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; toRefs, reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useMouse</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> state = reactive(&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:<span class="number">0</span>&#125;);</span><br><span class="line">    <span class="keyword">const</span> update = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        state.x = e.pageX;</span><br><span class="line">        state.y = e.pageY;</span><br><span class="line">    &#125;</span><br><span class="line">    onMounted(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">&#x27;mousemove&#x27;</span>,update);</span><br><span class="line">    &#125;)</span><br><span class="line">    onUnmounted(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.removeEventListener(<span class="string">&#x27;mousemove&#x27;</span>,update);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> toRefs(state);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们只需要调用这个函数，即可获取<code>x</code>、<code>y</code>的坐标，完全不用关注实现过程</p>
<p>试想一下，如果很多类似的第三方库，我们只需要调用即可，不必关注实现过程，开发效率大大提高</p>
<p>同时，<code>VUE3</code>是基于<code>typescipt</code>编写的，可以享受到自动的类型定义提示</p>
<h2 id="三、优化方案"><a href="#三、优化方案" class="headerlink" title="三、优化方案"></a>三、优化方案</h2><p><code>vue3</code>从很多层面都做了优化，可以分成三个方面：</p>
<ul>
<li>源码</li>
<li>性能</li>
<li>语法 API</li>
</ul>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><p>源码可以从两个层面展开：</p>
<ul>
<li>源码管理</li>
<li>TypeScript</li>
</ul>
<h4 id="源码管理"><a href="#源码管理" class="headerlink" title="源码管理"></a>源码管理</h4><p><code>vue3</code>整个源码是通过 <code>monorepo</code>的方式维护的，根据功能将不同的模块拆分到<code>packages</code>目录下面不同的子目录中</p>
<p> <img src="https://static.vue-js.com/d7c32520-5c58-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>这样使得模块拆分更细化，职责划分更明确，模块之间的依赖关系也更加明确，开发人员也更容易阅读、理解和更改所有模块源码，提高代码的可维护性</p>
<p>另外一些 <code>package</code>（比如 <code>reactivity</code> 响应式库）是可以独立于 <code>Vue</code> 使用的，这样用户如果只想使用 <code>Vue3</code>的响应式能力，可以单独依赖这个响应式库而不用去依赖整个 <code>Vue</code></p>
<h4 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h4><p><code>Vue3</code>是基于<code>typeScript</code>编写的，提供了更好的类型检查，能支持复杂的类型推导</p>
<h3 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h3><p><code>vue3</code>是从什么哪些方面对性能进行进一步优化呢？</p>
<ul>
<li>体积优化</li>
<li>编译优化</li>
<li>数据劫持优化</li>
</ul>
<p>这里讲述数据劫持：</p>
<p>在<code>vue2</code>中，数据劫持是通过<code>Object.defineProperty</code>，这个 API 有一些缺陷，并不能检测对象属性的添加和删除</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(data, <span class="string">&#x27;a&#x27;</span>,&#123;</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// track</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">set</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// trigger</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>尽管<code>Vue</code>为了解决这个问题提供了 <code>set</code>和<code>delete</code>实例方法，但是对于用户来说，还是增加了一定的心智负担</p>
<p>同时在面对嵌套层级比较深的情况下，就存在性能问题</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">a</span>: &#123;</span><br><span class="line">      <span class="attr">b</span>: &#123;</span><br><span class="line">          <span class="attr">c</span>: &#123;</span><br><span class="line">          <span class="attr">d</span>: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>相比之下，<code>vue3</code>是通过<code>proxy</code>监听整个对象，那么对于删除还是监听当然也能监听到</p>
<p>同时<code>Proxy</code> 并不能监听到内部深层次的对象变化，而 <code>Vue3</code> 的处理方式是在<code>getter</code> 中去递归响应式，这样的好处是真正访问到的内部对象才会变成响应式，而不是无脑递归</p>
<h3 id="语法-API"><a href="#语法-API" class="headerlink" title="语法 API"></a>语法 API</h3><p>这里当然说的就是<code>composition API</code>，其两大显著的优化：</p>
<ul>
<li>优化逻辑组织</li>
<li>优化逻辑复用</li>
</ul>
<h4 id="逻辑组织"><a href="#逻辑组织" class="headerlink" title="逻辑组织"></a>逻辑组织</h4><p>一张图，我们可以很直观地感受到 <code>Composition API</code>在逻辑组织方面的优势</p>
<p> <img src="https://static.vue-js.com/e5804bc0-5c58-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>相同功能的代码编写在一块，而不像<code>options API</code>那样，各个功能的代码混成一块</p>
<h4 id="逻辑复用"><a href="#逻辑复用" class="headerlink" title="逻辑复用"></a>逻辑复用</h4><p>在<code>vue2</code>中，我们是通过<code>mixin</code>实现功能混合，如果多个<code>mixin</code>混合，会存在两个非常明显的问题：命名冲突和数据来源不清晰</p>
<p>而通过<code>composition</code>这种形式，可以将一些复用的代码抽离出来作为一个函数，只要的使用的地方直接进行调用即可</p>
<p>同样是上文的获取鼠标位置的例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; toRefs, reactive, onUnmounted, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useMouse</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> state = reactive(&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:<span class="number">0</span>&#125;);</span><br><span class="line">    <span class="keyword">const</span> update = <span class="function"><span class="params">e</span>=&gt;</span>&#123;</span><br><span class="line">        state.x = e.pageX;</span><br><span class="line">        state.y = e.pageY;</span><br><span class="line">    &#125;</span><br><span class="line">    onMounted(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">&#x27;mousemove&#x27;</span>,update);</span><br><span class="line">    &#125;)</span><br><span class="line">    onUnmounted(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.removeEventListener(<span class="string">&#x27;mousemove&#x27;</span>,update);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> toRefs(state);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>组件使用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> useMousePosition <span class="keyword">from</span> <span class="string">&#x27;./mouse&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; x, y &#125; = useMousePosition()</span><br><span class="line">        <span class="keyword">return</span> &#123; x, y &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，整个数据来源清晰了，即使去编写更多的<code>hook</code>函数，也不会出现命名冲突的问题</p>
]]></content>
      <categories>
        <category>vue3</category>
      </categories>
      <tags>
        <tag>vue3</tag>
        <tag>goal</tag>
      </tags>
  </entry>
  <entry>
    <title>grid</title>
    <url>/archives/2e20d937.html</url>
    <content><![CDATA[<h1 id="面试官：介绍一下grid网格布局"><a href="#面试官：介绍一下grid网格布局" class="headerlink" title="面试官：介绍一下grid网格布局"></a>面试官：介绍一下grid网格布局</h1><p> <img src="https://static.vue-js.com/4d73e3d0-9a94-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p><code>Grid</code> 布局即网格布局，是一个二维的布局方式，由纵横相交的两组网格线形成的框架性布局结构，能够同时处理行与列</p>
<p>擅长将一个页面划分为几个主要区域，以及定义这些区域的大小、位置、层次等关系</p>
<p> <img src="https://static.vue-js.com/59680a40-9a94-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>这与之前讲到的<code>flex</code>一维布局不相同</p>
<p>设置<code>display:grid/inline-grid</code>的元素就是网格布局容器，这样就能出发浏览器渲染引擎的网格布局算法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;container&quot;</span>&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;sub-item&quot;</span>&gt;</span>&lt;/p &gt;</span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> </span><br></pre></td></tr></table></figure>
<p>上述代码实例中，<code>.container</code>元素就是网格布局容器，<code>.item</code>元素就是网格的项目，由于网格元素只能是容器的顶层子元素，所以<code>p</code>元素并不是网格元素</p>
<p>这里提一下，网格线概念，有助于下面对<code>grid-column</code>系列属性的理解</p>
<p>网格线，即划分网格的线，如下图所示：</p>
<p> <img src="https://static.vue-js.com/61be7080-9a94-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>上图是一个 2 x 3 的网格，共有3根水平网格线和4根垂直网格线</p>
<h2 id="二、属性"><a href="#二、属性" class="headerlink" title="二、属性"></a>二、属性</h2><p>同样，<code>Grid</code> 布局属性可以分为两大类：</p>
<ul>
<li>容器属性，</li>
<li>项目属性</li>
</ul>
<p>关于容器属性有如下：</p>
<h3 id="display-属性"><a href="#display-属性" class="headerlink" title="display 属性"></a>display 属性</h3><p>文章开头讲到，在元素上设置<code>display：grid</code> 或 <code>display：inline-grid</code> 来创建一个网格容器</p>
<ul>
<li><p>display：grid 则该容器是一个块级元素</p>
</li>
<li><p>display: inline-grid 则容器元素为行内元素</p>
</li>
</ul>
<h3 id="grid-template-columns-属性，grid-template-rows-属性"><a href="#grid-template-columns-属性，grid-template-rows-属性" class="headerlink" title="grid-template-columns 属性，grid-template-rows 属性"></a>grid-template-columns 属性，grid-template-rows 属性</h3><p><code>grid-template-columns</code> 属性设置列宽，<code>grid-template-rows</code> 属性设置行高</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/*  声明了三列，宽度分别为 200px 200px 200px */</span></span><br><span class="line">  grid-template-<span class="attribute">columns</span>: <span class="number">200px</span> <span class="number">200px</span> <span class="number">200px</span>;</span><br><span class="line">  grid-gap: <span class="number">5px</span>;</span><br><span class="line">  <span class="comment">/*  声明了两行，行高分别为 50px 50px  */</span></span><br><span class="line">  grid-template-rows: <span class="number">50px</span> <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上表示固定列宽为 200px 200px 200px，行高为 50px 50px</p>
<p>上述代码可以看到重复写单元格宽高，通过使用<code>repeat()</code>函数，可以简写重复的值</p>
<ul>
<li>第一个参数是重复的次数</li>
<li>第二个参数是重复的值</li>
</ul>
<p>所以上述代码可以简写成</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  grid-template-<span class="attribute">columns</span>: <span class="built_in">repeat</span>(<span class="number">3</span>,<span class="number">200px</span>);</span><br><span class="line">  grid-gap: <span class="number">5px</span>;</span><br><span class="line">  grid-template-rows:<span class="built_in">repeat</span>(<span class="number">2</span>,<span class="number">50px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>除了上述的<code>repeact</code>关键字，还有：</p>
<ul>
<li>auto-fill：示自动填充，让一行（或者一列）中尽可能的容纳更多的单元格</li>
</ul>
<blockquote>
<p><code>grid-template-columns: repeat(auto-fill, 200px)</code> 表示列宽是 200 px，但列的数量是不固定的，只要浏览器能够容纳得下，就可以放置元素</p>
</blockquote>
<ul>
<li>fr：片段，为了方便表示比例关系</li>
</ul>
<blockquote>
<p><code>grid-template-columns: 200px 1fr 2fr</code> 表示第一个列宽设置为 200px，后面剩余的宽度分为两部分，宽度分别为剩余宽度的 1/3 和 2/3</p>
</blockquote>
<ul>
<li>minmax：产生一个长度范围，表示长度就在这个范围之中都可以应用到网格项目中。第一个参数就是最小值，第二个参数就是最大值</li>
</ul>
<blockquote>
<p><code>minmax(100px, 1fr)</code>表示列宽不小于<code>100px</code>，不大于<code>1fr</code></p>
</blockquote>
<ul>
<li>auto：由浏览器自己决定长度</li>
</ul>
<blockquote>
<p><code>grid-template-columns: 100px auto 100px</code> 表示第一第三列为 100px，中间由浏览器决定长度</p>
</blockquote>
<h3 id="grid-row-gap-属性，-grid-column-gap-属性，-grid-gap-属性"><a href="#grid-row-gap-属性，-grid-column-gap-属性，-grid-gap-属性" class="headerlink" title="grid-row-gap 属性， grid-column-gap 属性， grid-gap 属性"></a>grid-row-gap 属性， grid-column-gap 属性， grid-gap 属性</h3><p><code>grid-row-gap</code> 属性、<code>grid-column-gap</code> 属性分别设置行间距和列间距。<code>grid-gap</code> 属性是两者的简写形式</p>
<p><code>grid-row-gap: 10px</code> 表示行间距是 10px</p>
<p><code>grid-column-gap: 20px</code> 表示列间距是 20px</p>
<p><code>grid-gap: 10px 20px</code> 等同上述两个属性</p>
<h3 id="grid-template-areas-属性"><a href="#grid-template-areas-属性" class="headerlink" title="grid-template-areas 属性"></a>grid-template-areas 属性</h3><p>用于定义区域，一个区域由一个或者多个单元格组成</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  grid-template-<span class="attribute">columns</span>: <span class="number">100px</span> <span class="number">100px</span> <span class="number">100px</span>;</span><br><span class="line">  grid-template-rows: <span class="number">100px</span> <span class="number">100px</span> <span class="number">100px</span>;</span><br><span class="line">  grid-template-areas: <span class="string">&#x27;a b c&#x27;</span></span><br><span class="line">                       <span class="string">&#x27;d e f&#x27;</span></span><br><span class="line">                       <span class="string">&#x27;g h i&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码先划分出9个单元格，然后将其定名为<code>a</code>到<code>i</code>的九个区域，分别对应这九个单元格。</p>
<p>多个单元格合并成一个区域的写法如下</p>
 <figure class="highlight css"><table><tr><td class="code"><pre><span class="line">grid-template-areas: <span class="string">&#x27;a a a&#x27;</span></span><br><span class="line">                     <span class="string">&#x27;b b b&#x27;</span></span><br><span class="line">                     <span class="string">&#x27;c c c&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>上面代码将9个单元格分成<code>a</code>、<code>b</code>、<code>c</code>三个区域</p>
<p>如果某些区域不需要利用，则使用”点”（<code>.</code>）表示</p>
<h3 id="grid-auto-flow-属性"><a href="#grid-auto-flow-属性" class="headerlink" title="grid-auto-flow 属性"></a>grid-auto-flow 属性</h3><p>划分网格以后，容器的子元素会按照顺序，自动放置在每一个网格。</p>
<p>顺序就是由<code>grid-auto-flow</code>决定，默认为行，代表”先行后列”，即先填满第一行，再开始放入第二行</p>
<p> <img src="https://static.vue-js.com/70fb3240-9a94-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>当修改成<code>column</code>后，放置变为如下：</p>
<p><img src="https://static.vue-js.com/7c26ffa0-9a94-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="justify-items-属性，-align-items-属性，-place-items-属性"><a href="#justify-items-属性，-align-items-属性，-place-items-属性" class="headerlink" title="justify-items 属性， align-items 属性， place-items 属性"></a>justify-items 属性， align-items 属性， place-items 属性</h3><p><code>justify-items</code> 属性设置单元格内容的水平位置（左中右），<code>align-items</code> 属性设置单元格的垂直位置（上中下）</p>
<p>两者属性的值完成相同</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  justify-items: start | end | center | stretch;</span><br><span class="line">  <span class="attribute">align-items</span>: start | end | center | stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>属性对应如下：</p>
<ul>
<li>start：对齐单元格的起始边缘</li>
<li>end：对齐单元格的结束边缘</li>
<li>center：单元格内部居中</li>
<li>stretch：拉伸，占满单元格的整个宽度（默认值）</li>
</ul>
<p><code>place-items</code>属性是<code>align-items</code>属性和<code>justify-items</code>属性的合并简写形式</p>
<h3 id="justify-content-属性，-align-content-属性，-place-content-属性"><a href="#justify-content-属性，-align-content-属性，-place-content-属性" class="headerlink" title="justify-content 属性， align-content 属性， place-content 属性"></a>justify-content 属性， align-content 属性， place-content 属性</h3><p><code>justify-content</code>属性是整个内容区域在容器里面的水平位置（左中右），<code>align-content</code>属性是整个内容区域的垂直位置（上中下）</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">justify-content</span>: start | end | center | stretch | space-around | space-between | space-evenly;</span><br><span class="line">  <span class="attribute">align-content</span>: start | end | center | stretch | space-around | space-between | space-evenly;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>两个属性的写法完全相同，都可以取下面这些值：</p>
<ul>
<li>start - 对齐容器的起始边框</li>
<li>end - 对齐容器的结束边框</li>
<li><p>center - 容器内部居中</p>
<p><img src="https://static.vue-js.com/9d1ec990-9a94-11eb-ab90-d9ae814b240d.png" alt=""></p>
</li>
<li><p>space-around - 每个项目两侧的间隔相等。所以，项目之间的间隔比项目与容器边框的间隔大一倍</p>
</li>
<li><p>space-between - 项目与项目的间隔相等，项目与容器边框之间没有间隔</p>
</li>
<li><p>space-evenly - 项目与项目的间隔相等，项目与容器边框之间也是同样长度的间隔</p>
</li>
<li><p>stretch - 项目大小没有指定时，拉伸占据整个网格容器</p>
<p><img src="https://static.vue-js.com/a620b210-9a94-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
</li>
</ul>
<h3 id="grid-auto-columns-属性和-grid-auto-rows-属性"><a href="#grid-auto-columns-属性和-grid-auto-rows-属性" class="headerlink" title="grid-auto-columns 属性和 grid-auto-rows 属性"></a>grid-auto-columns 属性和 grid-auto-rows 属性</h3><p>有时候，一些项目的指定位置，在现有网格的外部，就会产生显示网格和隐式网格</p>
<p>比如网格只有3列，但是某一个项目指定在第5行。这时，浏览器会自动生成多余的网格，以便放置项目。超出的部分就是隐式网格</p>
<p>而<code>grid-auto-rows</code>与<code>grid-auto-columns</code>就是专门用于指定隐式网格的宽高</p>
<p>关于项目属性，有如下：</p>
<h3 id="grid-column-start-属性、grid-column-end-属性、grid-row-start-属性以及grid-row-end-属性"><a href="#grid-column-start-属性、grid-column-end-属性、grid-row-start-属性以及grid-row-end-属性" class="headerlink" title="grid-column-start 属性、grid-column-end 属性、grid-row-start 属性以及grid-row-end 属性"></a>grid-column-start 属性、grid-column-end 属性、grid-row-start 属性以及grid-row-end 属性</h3><p>指定网格项目所在的四个边框，分别定位在哪根网格线，从而指定项目的位置</p>
<ul>
<li>grid-column-start 属性：左边框所在的垂直网格线</li>
<li>grid-column-end 属性：右边框所在的垂直网格线</li>
<li>grid-row-start 属性：上边框所在的水平网格线</li>
<li>grid-row-end 属性：下边框所在的水平网格线</li>
</ul>
<p>举个例子：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-id">#container</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: grid;</span></span><br><span class="line"><span class="css">        grid-template-<span class="attribute">columns</span>: <span class="number">100px</span> <span class="number">100px</span> <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        grid-template-rows: <span class="number">100px</span> <span class="number">100px</span> <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.item-1</span> &#123;</span></span><br><span class="line"><span class="css">        grid-column-start: <span class="number">2</span>;</span></span><br><span class="line"><span class="css">        grid-column-end: <span class="number">4</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-1&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-2&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-3&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>通过设置<code>grid-column</code>属性，指定1号项目的左边框是第二根垂直网格线，右边框是第四根垂直网格线</p>
<p> <img src="https://static.vue-js.com/b7925530-9a94-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="grid-area-属性"><a href="#grid-area-属性" class="headerlink" title="grid-area 属性"></a>grid-area 属性</h3><p><code>grid-area</code> 属性指定项目放在哪一个区域</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item-1</span> &#123;</span><br><span class="line">  grid-area: e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>意思为将1号项目位于<code>e</code>区域</p>
<p>与上述讲到的<code>grid-template-areas</code>搭配使用</p>
<h3 id="justify-self-属性、align-self-属性以及-place-self-属性"><a href="#justify-self-属性、align-self-属性以及-place-self-属性" class="headerlink" title="justify-self 属性、align-self 属性以及 place-self 属性"></a>justify-self 属性、align-self 属性以及 place-self 属性</h3><p><code>justify-self</code>属性设置单元格内容的水平位置（左中右），跟<code>justify-items</code>属性的用法完全一致，但只作用于单个项目。</p>
<p><code>align-self</code>属性设置单元格内容的垂直位置（上中下），跟<code>align-items</code>属性的用法完全一致，也是只作用于单个项目</p>
 <figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">  justify-self: start | end | center | stretch;</span><br><span class="line">  <span class="attribute">align-self</span>: start | end | center | stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这两个属性都可以取下面四个值。</p>
<ul>
<li>start：对齐单元格的起始边缘。<ul>
<li>end：对齐单元格的结束边缘。</li>
</ul>
</li>
<li>center：单元格内部居中。</li>
<li>stretch：拉伸，占满单元格的整个宽度（默认值）</li>
</ul>
<h2 id="三、应用场景"><a href="#三、应用场景" class="headerlink" title="三、应用场景"></a>三、应用场景</h2><p>文章开头就讲到，<code>Grid</code>是一个强大的布局，如一些常见的 CSS 布局，如居中，两列布局，三列布局等等是很容易实现的，在以前的文章中，也有使用<code>Grid</code>布局完成对应的功能</p>
<p>关于兼容性问题，结果如下：</p>
<p> <img src="https://static.vue-js.com/c24a2b10-9a94-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>总体兼容性还不错，但在 IE 10 以下不支持</p>
<p>目前，<code>Grid</code>布局在手机端支持还不算太友好</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Grid_Layout">https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Grid_Layout</a></li>
<li><a href="https://www.ruanyifeng.com/blog/2019/03/grid-layout-tutorial.html">https://www.ruanyifeng.com/blog/2019/03/grid-layout-tutorial.html</a></li>
<li><a href="https://juejin.cn/post/6854573220306255880#heading-2">https://juejin.cn/post/6854573220306255880#heading-2</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>grid</tag>
      </tags>
  </entry>
  <entry>
    <title>hide_attributes</title>
    <url>/archives/3f038ede.html</url>
    <content><![CDATA[<h1 id="面试官：css中，有哪些方式可以隐藏页面元素？区别"><a href="#面试官：css中，有哪些方式可以隐藏页面元素？区别" class="headerlink" title="面试官：css中，有哪些方式可以隐藏页面元素？区别?"></a>面试官：css中，有哪些方式可以隐藏页面元素？区别?</h1><p><img src="https://static.vue-js.com/ccf96f50-929a-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>在平常的样式排版中，我们经常遇到将某个模块隐藏的场景</p>
<p>通过<code>css</code>隐藏元素的方法有很多种，它们看起来实现的效果是一致的</p>
<p>但实际上每一种方法都有一丝轻微的不同，这些不同决定了在一些特定场合下使用哪一种方法</p>
<h2 id="二、实现方式"><a href="#二、实现方式" class="headerlink" title="二、实现方式"></a>二、实现方式</h2><p>通过<code>css</code>实现隐藏元素方法有如下：</p>
<ul>
<li>display:none</li>
<li>visibility:hidden</li>
<li>opacity:0</li>
<li>设置height、width模型属性为0</li>
<li>position:absolute</li>
<li>clip-path</li>
</ul>
<h3 id="display-none"><a href="#display-none" class="headerlink" title="display:none"></a>display:none</h3><p>设置元素的<code>display</code>为<code>none</code>是最常用的隐藏元素的方法</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.hide</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>:none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将元素设置为<code>display:none</code>后，元素在页面上将彻底消失</p>
<p>元素本身占有的空间就会被其他元素占有，也就是说它会导致浏览器的重排和重绘</p>
<p>消失后，自身绑定的事件不会触发，也不会有过渡效果</p>
<p>特点：元素不可见，不占据空间，无法响应点击事件</p>
<h3 id="visibility-hidden"><a href="#visibility-hidden" class="headerlink" title="visibility:hidden"></a>visibility:hidden</h3><p>设置元素的<code>visibility</code>为<code>hidden</code>也是一种常用的隐藏元素的方法</p>
<p>从页面上仅仅是隐藏该元素，DOM结果均会存在，只是当时在一个不可见的状态，不会触发重排，但是会触发重绘</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.hidden</span>&#123;</span><br><span class="line">    <span class="attribute">visibility</span>:hidden</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>给人的效果是隐藏了，所以他自身的事件不会触发</p>
<p>特点：元素不可见，占据页面空间，无法响应点击事件</p>
<h3 id="opacity-0"><a href="#opacity-0" class="headerlink" title="opacity:0"></a>opacity:0</h3><p><code>opacity</code>属性表示元素的透明度，将元素的透明度设置为0后，在我们用户眼中，元素也是隐藏的</p>
<p>不会引发重排，一般情况下也会引发重绘</p>
<blockquote>
<p>如果利用 animation 动画，对 opacity 做变化（animation会默认触发GPU加速），则只会触发 GPU 层面的 composite，不会触发重绘</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.transparent</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于其仍然是存在于页面上的，所以他自身的的事件仍然是可以触发的，但被他遮挡的元素是不能触发其事件的</p>
<p>需要注意的是：其子元素不能设置opacity来达到显示的效果</p>
<p>特点：改变元素透明度，元素不可见，占据页面空间，可以响应点击事件</p>
<h3 id="设置height、width属性为0"><a href="#设置height、width属性为0" class="headerlink" title="设置height、width属性为0"></a>设置height、width属性为0</h3><p>将元素的<code>margin</code>，<code>border</code>，<code>padding</code>，<code>height</code>和<code>width</code>等影响元素盒模型的属性设置成0，如果元素内有子元素或内容，还应该设置其<code>overflow:hidden</code>来隐藏其子元素</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.hiddenBox</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">0</span>;     </span><br><span class="line">    <span class="attribute">border</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">overflow</span>:hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>特点：元素不可见，不占据页面空间，无法响应点击事件</p>
<h3 id="position-absolute"><a href="#position-absolute" class="headerlink" title="position:absolute"></a>position:absolute</h3><p>将元素移出可视区域</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.hide</span> &#123;</span><br><span class="line">   <span class="attribute">position</span>: absolute;</span><br><span class="line">   <span class="attribute">top</span>: -<span class="number">9999px</span>;</span><br><span class="line">   <span class="attribute">left</span>: -<span class="number">9999px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>特点：元素不可见，不影响页面布局</p>
<h3 id="clip-path"><a href="#clip-path" class="headerlink" title="clip-path"></a>clip-path</h3><p>通过裁剪的形式</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.hide</span> &#123;</span><br><span class="line">  <span class="attribute">clip-path</span>: <span class="built_in">polygon</span>(<span class="number">0px</span> <span class="number">0px</span>,<span class="number">0px</span> <span class="number">0px</span>,<span class="number">0px</span> <span class="number">0px</span>,<span class="number">0px</span> <span class="number">0px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>特点：元素不可见，占据页面空间，无法响应点击事件</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>最常用的还是<code>display:none</code>和<code>visibility:hidden</code>，其他的方式只能认为是奇招，它们的真正用途并不是用于隐藏元素，所以并不推荐使用它们</p>
<h2 id="三、区别"><a href="#三、区别" class="headerlink" title="三、区别"></a>三、区别</h2><p>关于<code>display: none</code>、<code>visibility: hidden</code>、<code>opacity: 0</code>的区别，如下表所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">display: none</th>
<th style="text-align:left">visibility: hidden</th>
<th>opacity: 0</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">页面中</td>
<td style="text-align:left">不存在</td>
<td style="text-align:left">存在</td>
<td>存在</td>
</tr>
<tr>
<td style="text-align:left">重排</td>
<td style="text-align:left">会</td>
<td style="text-align:left">不会</td>
<td>不会</td>
</tr>
<tr>
<td style="text-align:left">重绘</td>
<td style="text-align:left">会</td>
<td style="text-align:left">会</td>
<td>不一定</td>
</tr>
<tr>
<td style="text-align:left">自身绑定事件</td>
<td style="text-align:left">不触发</td>
<td style="text-align:left">不触发</td>
<td>可触发</td>
</tr>
<tr>
<td style="text-align:left">transition</td>
<td style="text-align:left">不支持</td>
<td style="text-align:left">支持</td>
<td>支持</td>
</tr>
<tr>
<td style="text-align:left">子元素可复原</td>
<td style="text-align:left">不能</td>
<td style="text-align:left">能</td>
<td>不能</td>
</tr>
<tr>
<td style="text-align:left">被遮挡的元素可触发事件</td>
<td style="text-align:left">能</td>
<td style="text-align:left">能</td>
<td>不能</td>
</tr>
</tbody>
</table>
</div>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://www.cnblogs.com/a-cat/p/9039962.html">https://www.cnblogs.com/a-cat/p/9039962.html</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>hide_attributes</tag>
      </tags>
  </entry>
  <entry>
    <title>hooks使用</title>
    <url>/archives/33b9c85e.html</url>
    <content><![CDATA[<div class="tip cogs"><h4 id="需求-鼠标点击获取当前鼠标位置"><a href="#需求-鼠标点击获取当前鼠标位置" class="headerlink" title="需求: 鼠标点击获取当前鼠标位置"></a>需求: 鼠标点击获取当前鼠标位置</h4></div>
<ul>
<li>完整代码vue3+ts</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h6&gt;当前鼠标点击的坐标为 x:..&#123;&#123; point.x &#125;&#125;.. y:..&#123;&#123; point.y &#125;&#125;...&lt;/h6&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; defineComponent, onBeforeUnmount, onMounted, reactive &#125; from &quot;vue&quot;;</span><br><span class="line">// 导入ref</span><br><span class="line">// import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line">export default defineComponent(&#123;</span><br><span class="line">  name: &quot;App&quot;,</span><br><span class="line">  // 组合式API入口</span><br><span class="line"></span><br><span class="line">  setup() &#123;</span><br><span class="line">    // 定义参数</span><br><span class="line">    let point = reactive(&#123;</span><br><span class="line">      x: 0,</span><br><span class="line">      y: 0,</span><br><span class="line">    &#125;);</span><br><span class="line">    // 数据挂载之后 1.0</span><br><span class="line">    // onMounted(() =&gt; &#123;</span><br><span class="line">    //   window.addEventListener(&quot;click&quot;, (event) =&gt; &#123;</span><br><span class="line">    //     console.log(event.pageX, event.pageY);</span><br><span class="line">    //     // 绑定数据</span><br><span class="line">    //     point.x = event.pageX;</span><br><span class="line">    //     point.y = event.pageY;</span><br><span class="line">    //   &#125;);</span><br><span class="line">    // &#125;);</span><br><span class="line"></span><br><span class="line">    // 数据挂载之后 1.5</span><br><span class="line">    function savePoint(event: any) &#123;</span><br><span class="line">      console.log(event.pageX, event.pageY);</span><br><span class="line">      // 绑定数据</span><br><span class="line">      point.x = event.pageX;</span><br><span class="line">      point.y = event.pageY;</span><br><span class="line">    &#125;</span><br><span class="line">    onMounted(() =&gt; &#123;</span><br><span class="line">      // 需要接受两个参数</span><br><span class="line">      window.addEventListener(&quot;click&quot;, savePoint);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    // 数据卸载之前</span><br><span class="line">    onBeforeUnmount(() =&gt; &#123;</span><br><span class="line">      // 卸载点击事件</span><br><span class="line">      window.removeEventListener(&quot;click&quot;, savePoint);</span><br><span class="line">    &#125;);</span><br><span class="line">    // 返回值</span><br><span class="line">    return &#123;</span><br><span class="line">      point,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;&#125;,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">#app &#123;</span><br><span class="line">  font-family: Avenir, Helvetica, Arial, sans-serif;</span><br><span class="line">  -webkit-font-smoothing: antialiased;</span><br><span class="line">  -moz-osx-font-smoothing: grayscale;</span><br><span class="line">  text-align: center;</span><br><span class="line">  color: #2c3e50;</span><br><span class="line">  margin-top: 60px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<div class="note danger simple"><h4 id="不够优雅-引入hooks"><a href="#不够优雅-引入hooks" class="headerlink" title="不够优雅.引入hooks"></a>不够优雅.引入hooks</h4></div>
<p>   <img src="https://files.catbox.moe/5oitfj.png" alt=""></p>
<ul>
<li>什么是hook？—— 本质是一个函数，把setup函数中使用的Composition API进行了封装。</li>
<li>类似于vue2.x中的mixin。</li>
<li>自定义hook的优势: 复用代码, 让setup中的逻辑更清楚易懂。</li>
</ul>
<ol>
<li>在src下创建 hooks文件夹</li>
<li><p>效果</p>
<p> <img src="https://files.catbox.moe/nmb73k.png" alt=""></p>
</li>
<li><p>在hooks文件夹下定义usePoint.ts</p>
<ul>
<li>就是把组件中的方法，生命周期函数，数据抽离出来</li>
</ul>
</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  onBeforeUnmount,</span><br><span class="line">  onMounted,</span><br><span class="line">  reactive</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 定义参数</span></span><br><span class="line">  <span class="keyword">let</span> point = reactive(&#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 数据挂载之后 1.0</span></span><br><span class="line">  <span class="comment">// onMounted(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   window.addEventListener(&quot;click&quot;, (event) =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     console.log(event.pageX, event.pageY);</span></span><br><span class="line">  <span class="comment">//     // 绑定数据</span></span><br><span class="line">  <span class="comment">//     point.x = event.pageX;</span></span><br><span class="line">  <span class="comment">//     point.y = event.pageY;</span></span><br><span class="line">  <span class="comment">//   &#125;);</span></span><br><span class="line">  <span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数据挂载之后 1.5</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">savePoint</span>(<span class="params">event:<span class="built_in">any</span></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event.pageX, event.pageY);</span><br><span class="line">    <span class="comment">// 绑定数据</span></span><br><span class="line">    point.x = event.pageX;</span><br><span class="line">    point.y = event.pageY;</span><br><span class="line">  &#125;</span><br><span class="line">  onMounted(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 需要接受两个参数</span></span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&quot;click&quot;</span>, savePoint);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数据卸载之前</span></span><br><span class="line">  onBeforeUnmount(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 卸载点击事件</span></span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">&quot;click&quot;</span>, savePoint);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 记得返回 point</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> point</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>接着在Dome2.vue 中使用</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h6&gt;当前鼠标点击的坐标为 x:..&#123;&#123; point.x &#125;&#125;.. y:..&#123;&#123; point.y &#125;&#125;...&lt;/h6&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; defineComponent &#125; from &quot;vue&quot;;</span><br><span class="line">// 导入 hooks</span><br><span class="line">import usePoint from &quot;@/hooks/usePoint&quot;;</span><br><span class="line">// 导入ref</span><br><span class="line">// import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line">export default defineComponent(&#123;</span><br><span class="line">  name: &quot;App&quot;,</span><br><span class="line">  // 组合式API入口</span><br><span class="line"></span><br><span class="line">  setup() &#123;</span><br><span class="line">    // 定义参数</span><br><span class="line">    let point = usePoint();</span><br><span class="line"></span><br><span class="line">    // 返回值</span><br><span class="line">    return &#123;</span><br><span class="line">      point,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;&#125;,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>vue3</category>
      </categories>
      <tags>
        <tag>vue3</tag>
        <tag>hooks使用</tag>
      </tags>
  </entry>
  <entry>
    <title>路由守卫</title>
    <url>/archives/a9432027.html</url>
    <content><![CDATA[<blockquote>
<p>目标：通过路由守卫保护后台管理页面</p>
</blockquote>
<h4 id="①-创建路由守卫组件实现路由守卫逻辑"><a href="#①-创建路由守卫组件实现路由守卫逻辑" class="headerlink" title="① 创建路由守卫组件实现路由守卫逻辑"></a>① 创建路由守卫组件实现路由守卫逻辑</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/shared/routeGuard/index.tsx</span><br><span class="line">import React, &#123; ReactNode &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">interface Props &#123;</span><br><span class="line">  children: ReactNode;</span><br><span class="line">  guards: Array&lt;() =&gt; Promise&lt;boolean&gt;&gt;;</span><br><span class="line">  onRejected: () =&gt; ReactNode;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface States &#123;</span><br><span class="line">  status: &quot;idle&quot; | &quot;loading&quot; | &quot;success&quot; | &quot;error&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class RouteGuard extends React.Component&lt;Props, States&gt; &#123;</span><br><span class="line">  constructor(props: Props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    // 组件状态</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      // 验证请求状态</span><br><span class="line">      status: &quot;idle&quot;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  // 组件挂载完成之后</span><br><span class="line">  async componentDidMount() &#123;</span><br><span class="line">    // 获取验证函数数组</span><br><span class="line">    const &#123; guards &#125; = this.props;</span><br><span class="line">    // 更新状态</span><br><span class="line">    this.setState(&#123; status: &quot;loading&quot; &#125;);</span><br><span class="line">    // 执行异步验证</span><br><span class="line">    const isPassArray = await Promise.all(guards.map((guard) =&gt; guard()));</span><br><span class="line">    // 获取异步验证结果</span><br><span class="line">    const isPass = isPassArray.every((item) =&gt; item);</span><br><span class="line">    // 执行验证失败后要做的事情</span><br><span class="line">    this.setState(&#123; status: isPass ? &quot;success&quot; : &quot;error&quot; &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 正在验证时渲染</span><br><span class="line">  loading() &#123;</span><br><span class="line">    // 渲染加载等待提示效果</span><br><span class="line">    return (</span><br><span class="line">      &lt;div</span><br><span class="line">        style=&#123;&#123;</span><br><span class="line">          width: &quot;100%&quot;,</span><br><span class="line">          height: &quot;100%&quot;,</span><br><span class="line">          display: &quot;flex&quot;,</span><br><span class="line">          justifyContent: &quot;center&quot;,</span><br><span class="line">          alignItems: &quot;center&quot;,</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;i className=&quot;fas fa-spinner fa-pulse is-size-1&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 验证成功时渲染</span><br><span class="line">  success() &#123;</span><br><span class="line">    // 验证通过渲染路由组件</span><br><span class="line">    return this.props.children;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 验证失败时渲染</span><br><span class="line">  error() &#123;</span><br><span class="line">    // 获取验证失败后执行的方法</span><br><span class="line">    const &#123; onRejected &#125; = this.props;</span><br><span class="line">    // 判断 onRejected 是否存在</span><br><span class="line">    return onRejected();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    // 获取加载状态</span><br><span class="line">    const &#123; status &#125; = this.state;</span><br><span class="line">    if (status === &quot;loading&quot;) &#123;</span><br><span class="line">      return this.loading();</span><br><span class="line">    &#125; else if (status === &quot;error&quot;) &#123;</span><br><span class="line">      return this.error();</span><br><span class="line">    &#125; else if (status === &quot;success&quot;) &#123;</span><br><span class="line">      return this.success();</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return null;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="②-创建用于验证用户是否登录的守卫方法"><a href="#②-创建用于验证用户是否登录的守卫方法" class="headerlink" title="② 创建用于验证用户是否登录的守卫方法"></a>② 创建用于验证用户是否登录的守卫方法</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/utils/isLogin.ts</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@src/store&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">isLogin</span>(<span class="params"></span>): <span class="title">Promise</span>&lt;<span class="title">boolean</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 获取用户登录凭证</span></span><br><span class="line">  <span class="keyword">const</span> token = store.getState().userReducer.credentials.token;</span><br><span class="line">  <span class="comment">// 测试</span></span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">2000</span>));</span><br><span class="line">  <span class="comment">// 根据凭证是否存在返回布尔值</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> token !== <span class="string">&quot;undefined&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="③-使用路由守卫保护后台管理页面组件"><a href="#③-使用路由守卫保护后台管理页面组件" class="headerlink" title="③ 使用路由守卫保护后台管理页面组件"></a>③ 使用路由守卫保护后台管理页面组件</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/AppRouter.tsx</span><br><span class="line">import RouteGuard from &quot;@shared/routeGuard&quot;;</span><br><span class="line">import isLogin from &quot;@utils/isLogin&quot;;</span><br><span class="line"></span><br><span class="line">export default class AppRouter extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;Router&gt;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">          &lt;Route path=&quot;/admin&quot;&gt;</span><br><span class="line">            &lt;RouteGuard</span><br><span class="line">              guards=&#123;[isLogin]&#125;</span><br><span class="line">              onRejected=&#123;() =&gt; &lt;Redirect to=&quot;/login&quot; push=&#123;false&#125; /&gt;&#125;</span><br><span class="line">            &gt;</span><br><span class="line">              &lt;Layout&gt;&lt;/Layout&gt;</span><br><span class="line">            &lt;/RouteGuard&gt;</span><br><span class="line">          &lt;/Route&gt;</span><br><span class="line">        &lt;/Switch&gt;</span><br><span class="line">      &lt;/Router&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="部分代码解读"><a href="#部分代码解读" class="headerlink" title="部分代码解读"></a>部分代码解读</h4><h5 id="const-isPassArray-await-Promise-all-guards-map-guard-gt-guard"><a href="#const-isPassArray-await-Promise-all-guards-map-guard-gt-guard" class="headerlink" title="const isPassArray = await Promise.all(guards.map((guard) =&gt; guard()));"></a>const isPassArray = await Promise.all(guards.map((guard) =&gt; guard()));</h5><p>Promise.all() 方法可以接受一个可迭代对象（如数组或字符串）作为参数，并且返回一个 Promise。它会将传入的所有 Promise 实例，或者其它可迭代对象，包装成一个新的 Promise 对象。这个新返回的 Promise 对象会等待所有 Promise 都完成。</p>
<p>当所有 Promise 都成功完成时，Promise.all() 返回的 Promise 对象就会 resolve，它的 resolve 值是由每个 Promise resolve 值组成的数组。如果其中任何一个 Promise 拒绝（rejects），则返回的 Promise 对象会立即拒绝（reject），并带有拒绝原因。</p>
<p>下面是一个使用 Promise.all() 的示例：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Copy;</span><br><span class="line"><span class="comment">// Promise.all() 方法接收一个 Promise 实例数组</span></span><br><span class="line"><span class="keyword">const</span> promises = [<span class="built_in">Promise</span>.resolve(<span class="number">1</span>), <span class="built_in">Promise</span>.resolve(<span class="number">2</span>), <span class="built_in">Promise</span>.resolve(<span class="number">3</span>)];</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all(promises)</span><br><span class="line">  .then(<span class="function">(<span class="params">results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(results); <span class="comment">// [1, 2, 3]</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error); <span class="comment">// 所有 Promise 都拒绝后的错误</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p>在上面的例子中，我们创建了一个包含三个 Promise 实例的数组，每个 Promise 实例 resolve 值为一个数字。调用 Promise.all() 并传入这个数组，当所有 Promise 都 resolve 时，Promise.all() 返回的 Promise 对象 resolve 并带有 resolve 值 [1, 2, 3]。</p>
<p>如果其中一个 Promise 实例 reject，则 Promise.all() 返回的 Promise 对象就会 reject：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Copy;</span><br><span class="line"><span class="keyword">const</span> promises = [</span><br><span class="line">  <span class="built_in">Promise</span>.resolve(<span class="number">1</span>),</span><br><span class="line">  <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;error&quot;</span>)),</span><br><span class="line">  <span class="built_in">Promise</span>.resolve(<span class="number">3</span>),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all(promises)</span><br><span class="line">  .then(<span class="function">(<span class="params">results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(results);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error); <span class="comment">// Error: error</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p>在上面的例子中，第二个 Promise 实例 reject，并且它的 reject 原因为一个错误对象。因此，Promise.all() 返回的 Promise 对象也立即 reject，并且带有原因 Error 对象。</p>
]]></content>
      <categories>
        <category>react</category>
        <category>ts</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>ts</tag>
        <tag>router5</tag>
      </tags>
  </entry>
  <entry>
    <title>html</title>
    <url>/archives/1879f8e5.html</url>
    <content><![CDATA[<h2 id="html语法"><a href="#html语法" class="headerlink" title="html语法"></a>html语法</h2><div id="chakhsu" class="blog-title"></div> <script> var chakhsu = function (r) { function t() { return b[Math.floor(Math.random() * b.length)] } function e() { return String.fromCharCode(94 * Math.random() + 33) } function n(r) { for (var n = document.createDocumentFragment(), i = 0; r > i; i++) { var l = document.createElement("span"); l.textContent = e(), l.style.color = t(), n.appendChild(l) } return n } function i() { var t = o[c.skillI]; c.step ? c.step-- : (c.step = g, c.prefixP < l.length ? (c.prefixP >= 0 && (c.text += l[c.prefixP]), c.prefixP++) : "forward" === c.direction ? c.skillP < t.length ? (c.text += t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction = "backward", c.delay = a) : c.skillP > 0 ? (c.text = c.text.slice(0, -1), c.skillP--) : (c.skillI = (c.skillI + 1) % o.length, c.direction = "forward")), r.textContent = c.text, r.appendChild(n(c.prefixP < l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d) } /*以下内容自定义修改*/ var l = "这孩子，", o = ["或许可以用来煲汤。", ].map(function (r) { return r + "" }), a = 2, g = 1, s = 5, d = 75, b = ["rgb(110,64,170)", "rgb(150,61,179)", "rgb(191,60,175)", "rgb(228,65,157)", "rgb(254,75,131)", "rgb(255,94,99)", "rgb(255,120,71)", "rgb(251,150,51)", "rgb(226,183,47)", "rgb(198,214,60)", "rgb(175,240,91)", "rgb(127,246,88)", "rgb(82,246,103)", "rgb(48,239,130)", "rgb(29,223,163)", "rgb(26,199,194)", "rgb(35,171,216)", "rgb(54,140,225)", "rgb(76,110,219)", "rgb(96,84,200)"], c = {text: "", prefixP: -s, skillI: 0, skillP: 0, direction: "forward", delay: a, step: g}; i() }; chakhsu(document.getElementById('chakhsu')); </script> <div>


<p>
  <span class='gold'>svg 动图</span>
</p>

<style>
        .container {
            width: 200px;
            margin: 20px auto;
        }

        .yy {
            stroke-width: 1;
            stroke: #ff7700;
            animation: lineMove 3s ease-out infinite;
        }

        @keyframes lineMove {
            0% {
                stroke-dasharray: 0, 378;
            }

            50% {
                stroke-dasharray: 378, 378;
                fill: rgba(0, 0, 0, 0);
                opacity: 1;
            }

            100% {
                stroke-dasharray: 378, 378;
                fill: rgba(255, 119, 0, .5);
                opacity: 0;
            }
        }

    </style>
  <div class="container">
    <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
        width="210" height="200" x="0px" y="0px" viewbox="0 0 100 100">
        <path class="yy" fill-rule="evenodd" clip-rule="evenodd" fill="none" d="M43.4,0.2c1.4,1.5,0.9,4,0.2,5.8c2-0.5,3.3-0.7,4.1-2.4
            c0.1,0.2,0.2,0.3,0.2,0.5c0.8,1.3-0.3,3.5,0.7,3.8c1.6,0.6,3.2,1.1,4.8,1.7c3.8-3.3,15.2-6,20.6-2.4c1.3,4.4,2.1,11.5,0.7,16.8
            c-0.6,1.6-1.3,3.2-1.9,4.8c-0.5,3,3.1,8.9,2.2,13.9c-1.4,7.4-6.1,11.1-8.9,15.8c5.3,1,9.1-3.1,16.3-1.7c10.3,2,18.4,13.5,10.6,24
            c-2.2,2.9-8.2,6.5-13.9,5.5c-3.1-0.5-7.2-1.5-10.6-0.7c-6.5,1.6-10.9,7.3-16.8,9.8c-1.9,0.8-7,1.4-9.1,0.2c-0.8-0.4-0.4-1.4-1.7-1.4
            c-1-0.1-6.3-0.3-7.2,0c-1.9,0.6-3.2,2.7-7.4,1.9c-7.7-1.5-12.8-11.4-12.7-20.9c-1,0.7-2.5,2-4.3,1.2c-0.4-0.2-0.8-0.5-1.2-0.7
            c-0.8-2.6,1.9-11,1.9-11c1.3-2.8,4.5-4.2,6.5-6.5c-0.2-0.2-0.5-0.3-0.7-0.5c-8.1-4-17.5-6.2-15.1-20.4c0.6-3,1.3-5.9,1.9-8.9
            C1.9,24.5-3.1,10.1,2.4,6.7c4.8-4.3,16.8,0.9,19.9,2.9c2.1-0.6,4.2-1.3,6.2-1.9c1.5-0.8,2.7-2.6,4.6-3.4C37.7,2.5,41.6,4.7,43.4,0.2
            z" />
    </svg>
    </div>

<!-- 按钮风格-->
  <p>
  <span class='label'>代码</span>
  </p>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.container</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">20px</span> auto;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.yy</span> &#123;</span></span><br><span class="line"><span class="css">    stroke-<span class="attribute">width</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    stroke: <span class="number">#ff7700</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">animation</span>: lineMove <span class="number">3s</span> ease-out infinite;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> lineMove &#123;</span></span><br><span class="line"><span class="css">    <span class="number">0%</span> &#123;</span></span><br><span class="line"><span class="css">      stroke-dasharray: <span class="number">0</span>, <span class="number">378</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="number">50%</span> &#123;</span></span><br><span class="line"><span class="css">      stroke-dasharray: <span class="number">378</span>, <span class="number">378</span>;</span></span><br><span class="line"><span class="css">      fill: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span></span><br><span class="line"><span class="css">      <span class="attribute">opacity</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="css">      stroke-dasharray: <span class="number">378</span>, <span class="number">378</span>;</span></span><br><span class="line"><span class="css">      fill: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">119</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span></span><br><span class="line"><span class="css">      <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">svg</span></span></span><br><span class="line"><span class="tag">    <span class="attr">version</span>=<span class="string">&quot;1.1&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">&quot;图层_1&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xlink</span>=<span class="string">&quot;http://www.w3.org/1999/xlink&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">width</span>=<span class="string">&quot;210&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">height</span>=<span class="string">&quot;200&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x</span>=<span class="string">&quot;0px&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">y</span>=<span class="string">&quot;0px&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">viewbox</span>=<span class="string">&quot;0 0 100 100&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">path</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;yy&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">fill-rule</span>=<span class="string">&quot;evenodd&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">clip-rule</span>=<span class="string">&quot;evenodd&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">d</span>=<span class="string">&quot;M43.4,0.2c1.4,1.5,0.9,4,0.2,5.8c2-0.5,3.3-0.7,4.1-2.4</span></span></span><br><span class="line"><span class="string"><span class="tag">            c0.1,0.2,0.2,0.3,0.2,0.5c0.8,1.3-0.3,3.5,0.7,3.8c1.6,0.6,3.2,1.1,4.8,1.7c3.8-3.3,15.2-6,20.6-2.4c1.3,4.4,2.1,11.5,0.7,16.8</span></span></span><br><span class="line"><span class="string"><span class="tag">            c-0.6,1.6-1.3,3.2-1.9,4.8c-0.5,3,3.1,8.9,2.2,13.9c-1.4,7.4-6.1,11.1-8.9,15.8c5.3,1,9.1-3.1,16.3-1.7c10.3,2,18.4,13.5,10.6,24</span></span></span><br><span class="line"><span class="string"><span class="tag">            c-2.2,2.9-8.2,6.5-13.9,5.5c-3.1-0.5-7.2-1.5-10.6-0.7c-6.5,1.6-10.9,7.3-16.8,9.8c-1.9,0.8-7,1.4-9.1,0.2c-0.8-0.4-0.4-1.4-1.7-1.4</span></span></span><br><span class="line"><span class="string"><span class="tag">            c-1-0.1-6.3-0.3-7.2,0c-1.9,0.6-3.2,2.7-7.4,1.9c-7.7-1.5-12.8-11.4-12.7-20.9c-1,0.7-2.5,2-4.3,1.2c-0.4-0.2-0.8-0.5-1.2-0.7</span></span></span><br><span class="line"><span class="string"><span class="tag">            c-0.8-2.6,1.9-11,1.9-11c1.3-2.8,4.5-4.2,6.5-6.5c-0.2-0.2-0.5-0.3-0.7-0.5c-8.1-4-17.5-6.2-15.1-20.4c0.6-3,1.3-5.9,1.9-8.9</span></span></span><br><span class="line"><span class="string"><span class="tag">            C1.9,24.5-3.1,10.1,2.4,6.7c4.8-4.3,16.8,0.9,19.9,2.9c2.1-0.6,4.2-1.3,6.2-1.9c1.5-0.8,2.7-2.6,4.6-3.4C37.7,2.5,41.6,4.7,43.4,0.2</span></span></span><br><span class="line"><span class="string"><span class="tag">            z&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>
  <span class='wram'>swiper 插件 </span>
</p>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">swiper 实现轮播图 只需更换图片，基本设置已有</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Swiper demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span></span></span><br><span class="line"><span class="tag">      <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">&quot;https://unpkg.com/swiper/swiper-bundle.min.css&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Demo styles --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-tag">html</span>,</span></span><br><span class="line"><span class="css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-family</span>: Helvetica Neue, Helvetica, Arial, sans-serif;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#000</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.swiper-container</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.swiper-slide</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">text-align</span>: left;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="comment">/* Center slide text vertically */</span></span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: -webkit-box;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: -ms-flexbox;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: -webkit-flex;</span></span><br><span class="line"><span class="css">        <span class="comment">/* display: flex; */</span></span></span><br><span class="line"><span class="css">        -webkit-box-pack: center;</span></span><br><span class="line"><span class="css">        -ms-<span class="attribute">flex</span>-pack: center;</span></span><br><span class="line"><span class="css">        -webkit-<span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">        <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">        -webkit-box-align: center;</span></span><br><span class="line"><span class="css">        -ms-<span class="attribute">flex</span>-align: center;</span></span><br><span class="line"><span class="css">        -webkit-<span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">        <span class="comment">/* align-items: center; */</span></span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.swiper-slide</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.swiper-container</span> &#123;</span></span><br><span class="line"><span class="css">        --swiper-theme-<span class="attribute">color</span>: <span class="number">#ff6600</span>;</span></span><br><span class="line"><span class="css">        <span class="comment">/* 设置Swiper风格 */</span></span></span><br><span class="line"><span class="css">        --swiper-navigation-<span class="attribute">color</span>: <span class="number">#00ff33</span>;</span></span><br><span class="line"><span class="css">        <span class="comment">/* 单独设置按钮颜色 */</span></span></span><br><span class="line"><span class="css">        --swiper-navigation-size: <span class="number">30px</span>;</span></span><br><span class="line"><span class="css">        <span class="comment">/* 设置按钮大小 */</span></span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="comment">/* &lt;!-- 第一个和最后一个slide隐藏按钮 --&gt; */</span></span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.swiper-button-disabled</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Swiper --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-wrapper&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-slide&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./images/nature-1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-slide&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./images/nature-1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-slide&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./images/nature-1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-slide&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./images/nature-1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-slide&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./images/nature-1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-slide&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./images/nature-1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-slide&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./images/nature-1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 左右箭头 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-button-prev&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--左箭头。如果放置在swiper-container外面，需要自定义样式。--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-button-next&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--右箭头。如果放置在swiper-container外面，需要自定义样式。--&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- Add Pagination --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;swiper-pagination&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/swiper/swiper-bundle.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Initialize Swiper --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> swiper = <span class="keyword">new</span> Swiper(<span class="string">&quot;.swiper-container&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">spaceBetween</span>: <span class="number">30</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">autoplay</span>: <span class="literal">true</span>, <span class="comment">//开启定时器</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">autoplay</span>: &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">delay</span>: <span class="number">1000</span>, <span class="comment">//1秒切换一次</span></span></span><br><span class="line"><span class="javascript">          <span class="attr">disableOnInteraction</span>: <span class="literal">false</span> <span class="comment">/* 点击之后继续轮播 */</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">pauseOnMouseEnter</span>: <span class="literal">true</span> <span class="comment">/* 鼠标置于swiper时暂停自动切换，默认关闭此功能。 */</span>,</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 小圆点点击切换</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">pagination</span>: &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">el</span>: <span class="string">&quot;.swiper-pagination&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">clickable</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 左右按钮</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">navigation</span>: &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">nextEl</span>: <span class="string">&quot;.swiper-button-next&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">prevEl</span>: <span class="string">&quot;.swiper-button-prev&quot;</span>,</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 滑到最后一个slide时隐藏前进按钮</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">on</span>: &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">slideChangeTransitionEnd</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (<span class="built_in">this</span>.isEnd) &#123;</span></span><br><span class="line"><span class="javascript">              <span class="built_in">this</span>.navigation.$nextEl.css(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;none&quot;</span>);</span></span><br><span class="line"><span class="javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">              <span class="built_in">this</span>.navigation.$nextEl.css(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;block&quot;</span>);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">          &#125;,</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 键盘控制 开启</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">keyboard</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="comment">//切换效果 翻转</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">effect</span>: <span class="string">&quot;flip&quot;</span>,</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// fade&quot;（淡入）</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// effect : &#x27;fade&#x27;,</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// &quot;cube&quot;（方块）</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// effect: &#x27;cube&#x27;,</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// &quot;coverflow&quot;（3d流）</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// effect: &#x27;coverflow&#x27;,</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// slidesPerView: 3,</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// centeredSlides: true,</span></span></span><br><span class="line"><span class="javascript">      &#125;);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>html</category>
      </categories>
      <tags>
        <tag>html</tag>
      </tags>
  </entry>
  <entry>
    <title>hots</title>
    <url>/archives/1e021099.html</url>
    <content><![CDATA[<p>[hint]你的无畏，来自你的未知[/hint]</p>
<hr>
<ol>
<li>一、Trident内核代表产品Internet Explorer，又称其为IE内核。Trident（又称为MSHTML），是微软开发的一种排版引擎。使用Trident渲染引擎的浏览器包括：IE、傲游、世界之窗浏览器、Avant、腾讯TT、Netscape 8、NetCaptor、Sleipnir、GOSURF、GreenBrowser和KKman等。</li>
<li>二、Gecko内核代表作品Mozilla FirefoxGecko是一套开放源代码的、以C++编写的网页排版引擎。Gecko是最流行的排版引擎之一，仅次于Trident。使用它的最著名浏览器有Firefox、Netscape6至9。</li>
<li>三、WebKit内核代表作品Safari、Chromewebkit 是一个开源项目，包含了来自KDE项目和苹果公司的一些组件，主要用于Mac OS系统，它的特点在于源码结构清晰、渲染速度极快。缺点是对网页代码的兼容性不高，导致一些编写不标准的网页无法正常显示。主要代表作品有Safari和Google的浏览器Chrome。</li>
<li>四、Presto内核代表作品OperaPresto是由Opera Software开发的浏览器排版引擎，供Opera 7.0及以上使用。它取代了旧版Opera 4至6版本使用的Elektra排版引擎，包括加入动态功能，例如网页或其部分可随着DOM及Script语法的事件而重新排版</li>
<li>-moz代表firefox浏览器私有属性-ms代表IE浏览器私有属性</li>
<li>-webkit代表chrome、safari私有属性 IE使用的是Trident内核，Firefox 使用的是Gecko内核。目前使用IE内核的浏览器还有搜狗，遨游，360等等。</li>
<li>表单作用：为了收集用户信息，如登录、注册、搜索。</li>
<li>表单标记有文本框、密码框、单选框、多选框、下拉框、多行文本框、上传按钮、隐藏表单、提交按钮、重置按钮、图片提交按钮、普通按钮。</li>
<li>table是html的表格标签，和表单标记没有关系</li>
<li>拖放<br>拖放是一种常见的特性，即抓取对象以后拖到另一个位置。</li>
</ol>
<p>在 HTML5 中，拖放是标准的一部分，任何元素都能够拖放。<br>首先，为了使元素可拖动，把 draggable 属性设置为 true<br>拖动什么 - ondragstart<br>放到何处 - ondragover<br>ondragover 事件规定在何处放置被拖动的数据。</p>
<p>进行放置 - ondrop<br>当放置被拖数据时，会发生 drop 事件</p>
<hr>
<ol>
<li>参数是scroll时候，必会出现滚动条。<br>参数是auto时候，子元素内容大于父元素时出现滚动条。<br>参数是visible时候，溢出的内容出现在父元素之外。<br>参数是hidden时候，溢出隐藏。<br>1.&lt;!DOCTYPE&gt; 声明位于文档中的最前面，处于 <html> 标签之前。告知浏览器的解析器，用什么文档类型 规范来解析这个文档。<br>2.严格模式的排版和 JS 运作模式是 以该浏览器支持的最高标准运行。在混杂模式中，页面以宽松的向后兼容的方式显示。模拟老式浏览器的行为以防止站点无法工作。<br>3.DOCTYPE不存在或格式不正确会导致文档以混杂模式呈现。</li>
</ol>
<hr>
<p>1.效果<br>border-style:none;//无边框<br>border-width:0;//边框宽度为0px<br>2.区别<br>（1）性能差异<br>border:0;浏览器对border-width、border-color进行渲染，占用内存。<br>border:none;浏览器不进行渲染，不占用内存。<br>Chrome：<br>border:none;&gt;&gt; border:initial none initial;<br>border:0;&gt;&gt; border:0 initial  initial ;<br>Firefox、360：<br>border:none; &gt;&gt;border:medium none;<br>border:0;&gt;&gt; border:0 none;<br>计算出的样式：<br>border:0px none 元素color属性值;<br>（2）浏览器兼容<br>IE7-不支持border:none;<br>W3C提示：请始终把border-style属性声明到border-color属性之前，元素必须在改变颜色之前获得边框。</p>
<hr>
<p>CSS Sprites<br>1.简介<br>CSS Sprites在国内很多人叫css精灵，是一种网页图片应用处理方式。它允许将一个页面涉及到的所有零星图片都包含到一张大图中， 利用CSS的“background-image”，“background- repeat”，“background-position”的组合进行背景定位， 访问页面时避免图片载入缓慢的现象。<br>2.优点<br>（1）CSS Sprites能很好地减少网页的http请求，从而大大的提高页面的性能，这是CSS Sprites最大的优点，也是其被广泛传播和应用的主要原因；<br>（2）CSS Sprites能减少图片的字节；<br>（3）CSS Sprites解决了网页设计师在图片命名上的困扰，只需对一张集合的图片命名，不需要对每一个小图片进行命名，从而提高了网页制作效率。<br>（4）CSS Sprites只需要修改一张或少张图片的颜色或样式来改变整个网页的风格。<br>3.缺点<br>（1）图片合并麻烦：图片合并时，需要把多张图片有序的合理的合并成一张图片，并留好足够的空间防止版块出现不必要的背景。<br>（2）图片适应性差：在高分辨的屏幕下自适应页面，若图片不够宽会出现背景断裂。<br>（3）图片定位繁琐：开发时需要通过工具测量计算每个背景单元的精确位置。<br>（4）可维护性差：页面背景需要少许改动，可能要修改部分或整张已合并的图片，进而要改动css。在避免改动图片的前提下，又只能（最好）往下追加图片，但这样增加了图片字节。</p>
<hr>
<p>alt 就是图片不出来时，显示的文本。即 提供替代图片的信息，使屏幕阅读器能获取到关于图片的信息<br>title是鼠标一上去之后显示的文本</p>
<hr>
<p>在CSS中，html中的标签元素大体被分为三种不同的类型： 块状元素、内联元素(又叫行内元素)和内联块状元素。 </p>
<p>常用的块状元素有：<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">div</span>&gt;</span>、<span class="tag">&lt;<span class="name">p</span>&gt;</span>、<span class="tag">&lt;<span class="name">h1</span>&gt;</span>…<span class="tag">&lt;<span class="name">h6</span>&gt;</span>、<span class="tag">&lt;<span class="name">ol</span>&gt;</span>、<span class="tag">&lt;<span class="name">ul</span>&gt;</span>、<span class="tag">&lt;<span class="name">dl</span>&gt;</span>、<span class="tag">&lt;<span class="name">table</span>&gt;</span>、<span class="tag">&lt;<span class="name">address</span>&gt;</span>、<span class="tag">&lt;<span class="name">blockquote</span>&gt;</span> 、<span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line"> 什么是块级元素？ </span><br><span class="line">在html中<span class="tag">&lt;<span class="name">div</span>&gt;</span>、<span class="tag">&lt;<span class="name">p</span>&gt;</span>、<span class="tag">&lt;<span class="name">h1</span>&gt;</span>、<span class="tag">&lt;<span class="name">form</span>&gt;</span>、<span class="tag">&lt;<span class="name">ul</span>&gt;</span>和<span class="tag">&lt;<span class="name">li</span>&gt;</span>就是块级元素。设置display:block就是将元素显示为块级元素。如下代码就是将内联元素a转换为块状元素，从而使a元素具有块状元素特点。 a&#123;display:block;&#125; </span><br><span class="line">块级元素特点：</span><br><span class="line"> 1、每个块级元素都从新的一行开始，并且其后的元素也另起一行。（真霸道，一个块级元素独占一行）;</span><br><span class="line"> 2、元素的高度、宽度、行高以及顶和底边距都可设置。</span><br><span class="line"> 3、元素宽度在不设置的情况下，是它本身父容器的100%（和父元素的宽度一致），除非设定一个宽度。 </span><br><span class="line"></span><br><span class="line">常用的内联元素有： </span><br><span class="line"><span class="tag">&lt;<span class="name">a</span>&gt;</span>、<span class="tag">&lt;<span class="name">span</span>&gt;</span>、<span class="tag">&lt;<span class="name">br</span>&gt;</span>、<span class="tag">&lt;<span class="name">i</span>&gt;</span>、<span class="tag">&lt;<span class="name">em</span>&gt;</span>、<span class="tag">&lt;<span class="name">strong</span>&gt;</span>、<span class="tag">&lt;<span class="name">label</span>&gt;</span>、<span class="tag">&lt;<span class="name">q</span>&gt;</span>、<span class="tag">&lt;<span class="name">var</span>&gt;</span>、<span class="tag">&lt;<span class="name">cite</span>&gt;</span>、<span class="tag">&lt;<span class="name">code</span>&gt;</span> 在html中，<span class="tag">&lt;<span class="name">span</span>&gt;</span>、<span class="tag">&lt;<span class="name">a</span>&gt;</span>、<span class="tag">&lt;<span class="name">label</span>&gt;</span>、<span class="tag">&lt;<span class="name">strong</span>&gt;</span> 和<span class="tag">&lt;<span class="name">em</span>&gt;</span>就是典型的内联元素（行内元素）（inline）元素。</span><br><span class="line">当然块状元素也可以通过代码display:inline将元素设置为内联元素。如下代码就是将块状元素div转换为内联元素，从而使div 元素具有内联元素特点。</span><br><span class="line"> div&#123; display:inline; &#125; ...... <span class="tag">&lt;<span class="name">div</span>&gt;</span>我要变成内联元素<span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">内联元素特点： </span><br><span class="line">1、和其他元素都在一行上； </span><br><span class="line">2、元素的高度、宽度及顶部和底部边距不可设置； （这是答案^-^）</span><br><span class="line">3、元素的宽度就是它包含的文字或图片的宽度，不可改变。 </span><br><span class="line"></span><br><span class="line">常用的内联块状元素有：</span><br><span class="line"> <span class="tag">&lt;<span class="name">img</span>&gt;</span>、<span class="tag">&lt;<span class="name">input</span>&gt;</span></span><br><span class="line"> 内联块状元素（inline-block）就是同时具备内联元素、块状元素的特点，代码display:inline-block就是将元素设置为内联块状元素。</span><br><span class="line">inline-block 元素特点： </span><br><span class="line">1、和其他元素都在一行上； </span><br><span class="line">2、元素的高度、宽度、行高以及顶和底边距都可设置。</span><br></pre></td></tr></table></figure></p>
<hr>
]]></content>
  </entry>
  <entry>
    <title>less</title>
    <url>/archives/d3b694df.html</url>
    <content><![CDATA[<p>[tag type=”primary” outline]官方介绍[/tag]</p>
<ul>
<li><strong>Less 是一门 CSS 预处理语言，</strong>它扩充了 CSS 语言，增加了诸如变量、混合（mixin）、函数等功能，让 CSS 更易维护、方便制作主题、扩充。Less 可以运行在 Node 或浏览器端。</li>
<li><strong>Less是一门动态CSS语言，使得CSS样式更加灵活地作用于Html标签。</strong>试想如果没有Less，我们要对样式做一些逻辑计算的时候只能依靠Js去实现，有了Less之后，可以方便地动态给Html标签设置样式。比如一个最常见的需求，在当前浏览器的宽度小于500px的时候，给某一个div设置一个样式，使用less+css3就能很简单的解决问题。当然，这只是其中一个场景，less里面还能进行一些常见的条件和逻辑判断。总的来说，Less赋予了CSS逻辑运算的能力。</li>
<li><strong>除此之外，动态CSS语法还有一个重要的作用就是提高样式代码的可维护性。</strong>比如一个最简单的，我们可以定义一个全局的颜色变量@aaa:#222，系统里面所有的默认颜色用的@aaa来写的，这个时候如果需要修改这个全局颜色，我们只需要改下@aaa变量的值就好了，其他地方不用做任何修改，这点，作为编程人员应该很容易理解。</li>
</ul>
<hr>
<p>[tag type=”info” outline]维护css的弊端[/tag]</p>
<ol>
<li>css是一门非程序式语言，没有变量，函数，SCOPE（作用域）等概念。</li>
<li>css需要书写大量看似没有逻辑的代码，css的冗余度是比较高的。</li>
<li>不方便维护及扩展，不利于复用。</li>
<li>css没有很好的计算能力。</li>
<li>非前端工程师来讲，往往会因为缺少css变形经验而很难写出组织良好且易于维护的css代码项目。</li>
</ol>
<p>[tag type=”warn” outline]less变量[/tag]</p>
<ol>
<li>官网：<a href="https://less.bootcss.com/">https://less.bootcss.com/</a></li>
</ol>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// 定义一个粉色的变量</span><br><span class="line"><span class="keyword">@color</span>: pink;</span><br><span class="line">// 错误的变量名  <span class="keyword">@1color</span>   @<span class="attribute">color</span>~@#</span><br><span class="line">// 变量名区分大小写  @<span class="attribute">color</span>  和  @<span class="attribute">Color</span> 是两个不同的变量</span><br><span class="line">// 定义了一个 字体为<span class="number">14</span>像素的变量</span><br><span class="line">// 不能以数字开头，大小写不一致，</span><br><span class="line">@font14: <span class="number">14px</span>;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: @color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: @aq;</span><br><span class="line">    <span class="attribute">font-size</span>: @font14;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: @font14;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>[tag outline]less编译[/tag]</p>
<ol>
<li>EASY less插件用来把less文件编译为css文件</li>
<li>优点：实时编译，css文件也会相应保存。</li>
<li>缺点：暂时没有发现，以后补充。</li>
</ol>
<hr>
<p>[tag type=”primary” outline]less嵌套[/tag]</p>
<ol>
<li>less嵌套 子元素的样式直接写到父元素里面就好了 ==》儿子住在父母家</li>
<li>如果有伪类、交集选择器、 伪元素选择器 我们内层选择器的前面需要加 &amp;</li>
</ol>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"> &lt;<span class="selector-tag">div</span> class=&quot;<span class="selector-tag">header</span>&quot;&gt;</span><br><span class="line">        &lt;<span class="selector-tag">a</span> href=&quot;#&quot;&gt;文字&lt;/<span class="selector-tag">a</span>&gt;</span><br><span class="line">    &lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;<span class="selector-tag">nav</span>&quot;&gt;</span><br><span class="line">        &lt;<span class="selector-tag">div</span> class=&quot;logo&quot;&gt;传智播客&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">    &lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;fa&quot;&gt;</span><br><span class="line">        &lt;<span class="selector-tag">div</span> class=&quot;son&quot;&gt;sd&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">    &lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: pink;</span><br><span class="line">    // <span class="number">1</span>. less嵌套 子元素的样式直接写到父元素里面就好了 ==》儿子住在父母家</span><br><span class="line">    <span class="selector-tag">a</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: red;</span><br><span class="line">// <span class="number">2</span>. 如果有伪类、交集选择器、 伪元素选择器 我们内层选择器的前面需要加 &amp;</span><br><span class="line">        &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">            <span class="attribute">color</span>: blue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav</span> &#123;</span><br><span class="line">    <span class="selector-class">.logo</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: green;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&quot;憨憨&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@aq</span>:aqua;</span><br><span class="line"><span class="selector-class">.fa</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">    <span class="selector-class">.son</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>:@aq;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">30px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">        <span class="attribute">background</span>: gold;</span><br><span class="line">        // 自身，此时hover写在son中</span><br><span class="line">        &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">            <span class="attribute">background</span>: blue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // 此时hover。fa</span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: red;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.header</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.header</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav</span> <span class="selector-class">.logo</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;憨憨&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fa</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fa</span> <span class="selector-class">.son</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: aqua;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">background</span>: gold;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fa</span> <span class="selector-class">.son</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fa</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<span id="more"></span>
<p>[tag type=”info” outline]less运算[/tag]</p>
<ol>
<li>我们运算符的左右两侧必须敲一个空格隔开</li>
<li>两个数参与运算  如果只有一个数有单位，则最后的结果就以这个单位为准</li>
<li>两个数参与运算，如果2个数都有单位，而且不一样的单位 最后的结果以第一个单位为准</li>
<li><strong> 除法运算一定记得加扩号，否则编译后将会是两个变量。</strong></li>
</ol>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@baseFont</span>: <span class="number">50px</span>;</span><br><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: @baseFont;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@border</span>: <span class="number">5px</span> + <span class="number">5</span>;</span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span> - <span class="number">50</span>;</span><br><span class="line">    <span class="attribute">height</span>: (<span class="number">200px</span> + <span class="number">50px</span> ) * <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">border</span>: @border solid red;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#666</span> - <span class="number">#222</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">82rem</span> / @baseFont;</span><br><span class="line">    // 编译后结果： <span class="attribute">width</span>: <span class="number">82rem</span> / <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">height</span>:( <span class="number">82rem</span> / @baseFont);</span><br><span class="line">    // 编译后结果： <span class="attribute">height</span>: <span class="number">1.64rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">ul</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">30px</span> + <span class="number">30</span>;</span><br><span class="line">    <span class="attribute">border</span>: @border - <span class="number">3</span> solid rebeccapurple;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">height</span>: (<span class="number">30px</span> - <span class="number">10</span>) * <span class="number">3</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="selector-tag">li</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: @baseFont + <span class="number">2px</span>;</span><br><span class="line">        <span class="attribute">height</span>: (<span class="number">100px</span> / @baseFont);</span><br><span class="line">        <span class="attribute">background-color</span>: gold;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>[tag type=”warn” outline]less参数[/tag]</p>
<ul>
<li>当传递参数有默认值，形参没有默认值，会覆盖</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// 居中<span class="number">2</span>  </span><br><span class="line"><span class="selector-class">.df</span>(<span class="keyword">@wi</span>, @hi) &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">width</span>: @wi;</span><br><span class="line">    <span class="attribute">height</span>: @hi;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 当传递参数有默认值，形参没有默认值，会覆盖</span><br><span class="line"><span class="selector-class">.dfs</span>(<span class="keyword">@wis</span>: <span class="number">300px</span>, @<span class="attribute">his</span>: <span class="number">300px</span>) &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">width</span>: @wis;</span><br><span class="line">    <span class="attribute">height</span>: @his;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">    <span class="selector-class">.center</span>;</span><br><span class="line">    // 此参数会作为最终参数</span><br><span class="line">    <span class="selector-class">.df</span>(<span class="keyword">@wi</span>: <span class="number">366px</span>, @<span class="attribute">hi</span>: <span class="number">300px</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">color</span>: @aq;</span><br><span class="line">    <span class="attribute">display</span>: table;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.son</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">10</span>, <span class="number">134</span>, <span class="number">192</span>);</span><br><span class="line">        <span class="attribute">color</span>: @re;</span><br><span class="line">        <span class="attribute">text-align</span>: center;</span><br><span class="line">        // <span class="attribute">line-height</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">display</span>: table-cell;</span><br><span class="line">        <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">        // <span class="selector-class">.center</span>;</span><br><span class="line">        <span class="selector-class">.animate</span>(all, <span class="number">4s</span>);</span><br><span class="line"></span><br><span class="line">        &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">            <span class="attribute">color</span>: @aq;</span><br><span class="line">            <span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">85</span>, <span class="number">6</span>, <span class="number">61</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>[tag type=”danger” outline]less插值[/tag]</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// 插值 --&gt; css属性</span><br><span class="line"><span class="keyword">@w</span>: <span class="attribute">width</span>;</span><br><span class="line"><span class="keyword">@h</span>: <span class="attribute">height</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">ul</span> &#123;</span><br><span class="line">    @&#123;w&#125;: (<span class="number">100px</span> / <span class="number">2</span>) + <span class="number">10</span>;</span><br><span class="line">    @&#123;h&#125;: <span class="number">100px</span> + <span class="number">20</span>;</span><br><span class="line">    <span class="attribute">background</span>: gold;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">100px</span> auto;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: @aq;</span><br><span class="line">        <span class="attribute">color</span>: goldenrod;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&#x27;show&#x27;</span>;</span><br><span class="line">        <span class="attribute">color</span>: @re;</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">100px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">li</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: red;</span><br><span class="line">        <span class="keyword">@ws</span>: <span class="number">30px</span>;</span><br><span class="line">        <span class="keyword">@hs</span>: <span class="number">30px</span>;</span><br><span class="line">        @&#123;w&#125;: @ws;</span><br><span class="line">        @&#123;h&#125;: @hs;</span><br><span class="line">        // 实现居中</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">margin-top</span>: <span class="built_in">-</span>(@ws / <span class="number">2</span>);</span><br><span class="line">        <span class="attribute">margin-left</span>: <span class="built_in">-</span>(@hs / <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></h2><p>[tag type=”success” outline=”1”]可变参数[/tag]<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// 可变参数</span><br><span class="line">// <span class="selector-class">.animate</span> (<span class="keyword">@name</span>, @time, @mode, @delay) &#123;</span><br><span class="line">//     <span class="attribute">transition</span>: @arguments;</span><br><span class="line">// &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// <span class="selector-class">.animate</span> (...) &#123;</span><br><span class="line">//     <span class="attribute">transition</span>: @arguments;</span><br><span class="line">// &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 规定必须需要<span class="number">2</span>个 参数</span><br><span class="line"><span class="selector-class">.animate</span> (<span class="keyword">@name</span>, @time, ...) &#123;</span><br><span class="line">    <span class="attribute">transition</span>: @arguments;</span><br><span class="line">    // <span class="keyword">@arguments</span> 接受所有参数</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">实列： .animate(all, <span class="number">3s</span>, );</span><br></pre></td></tr></table></figure></p>
<!--more-->
<p>[tag type=”info”]匹配模式[/tag]</p>
<ul>
<li>@-通用匹配模式</li>
<li>@- 表示匹配所有，只要调用了triangle,就会调用有@-的样式</li>
<li>无论哪一个混合被匹配了，都会执行通用匹配模式的代码</li>
<li>执行顺序：先执行通用匹配，在执行匹配模式</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.triangle</span> (@-, @<span class="attribute">width</span>, @colors) &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-style</span>: solid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 匹配模式</span><br><span class="line">// 三角形</span><br><span class="line">// up</span><br><span class="line"><span class="selector-class">.triangle</span> (&#x27;up&#x27;, <span class="keyword">@width</span>, @colors) &#123;</span><br><span class="line">    // <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    // <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    // <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="attribute">border-width</span>: @width;</span><br><span class="line">    <span class="attribute">border-color</span>: @colors transparent transparent transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// <span class="attribute">bottom</span></span><br><span class="line"><span class="selector-class">.triangle</span> (&#x27;<span class="attribute">bottom</span>&#x27;, <span class="keyword">@width</span>, @colors) &#123;</span><br><span class="line">    // <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    // <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    // <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="attribute">border-width</span>: @width;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent transparent @colors transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// <span class="attribute">left</span></span><br><span class="line"><span class="selector-class">.triangle</span> (&#x27;<span class="attribute">left</span>&#x27;, <span class="keyword">@width</span>, @colors) &#123;</span><br><span class="line">    // <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    // <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    // <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="attribute">border-width</span>: @width;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent transparent transparent @colors;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// <span class="attribute">right</span></span><br><span class="line"><span class="selector-class">.triangle</span> (&#x27;<span class="attribute">right</span>&#x27;, <span class="keyword">@width</span>, @colors) &#123;</span><br><span class="line">    // <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    // <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    // <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="attribute">border-width</span>: @width;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent @colors transparent transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.delta</span> &#123;</span><br><span class="line">    // <span class="selector-class">.triangle</span>(&#x27;up&#x27;, <span class="number">40px</span>, gold);</span><br><span class="line">    // <span class="selector-class">.triangle</span>(&#x27;<span class="attribute">left</span>&#x27;, <span class="number">40px</span>, gold);</span><br><span class="line">    // <span class="selector-class">.triangle</span>(&#x27;<span class="attribute">right</span>&#x27;, <span class="number">40px</span>, gold);</span><br><span class="line">    <span class="selector-class">.triangle</span>(&#x27;<span class="attribute">bottom</span>&#x27;, <span class="number">40px</span>, gold);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>[tag type=”warn”]less继承[/tag]</p>
<ul>
<li><strong>版权声明：less继承为CSDN博主「Liekkas_BX」的原创文章。</strong></li>
<li>原文链接：<a href="https://blog.csdn.net/qq_19865749/article/details/52523178">https://blog.csdn.net/qq_19865749/article/details/52523178</a></li>
<li>一、Extend Syntax（语法）</li>
<li>说明：The extend is either attached to a selector or placed into a ruleset. It looks like a pseudoclass with selector parameter optionally followed by the keyword。</li>
<li>继承被附在选择器后面或放置在规则集（即具体定于样式处），它看起来就像是一个在关键字extend后具有可选参数的伪类（pseudoclass）。</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.parentClass</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.subClassOne</span>&#123;</span><br><span class="line">	&amp;:<span class="built_in">extend</span>(.parentClass);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.subClassTwo</span>:<span class="built_in">extend</span>(.parentClass)&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line">编译为：</span><br><span class="line"><span class="selector-class">.parentClass</span>,</span><br><span class="line"><span class="selector-class">.subClassOne</span>,</span><br><span class="line"><span class="selector-class">.subClassTwo</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>二、深入了解</li>
<li>除了上面的基本语法外，less继承也支持CSS 的选择器分组等更多用法。</li>
<li><p>1、继承嵌套（nested）选择器</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">parentClass&#123;</span><br><span class="line">	<span class="selector-tag">span</span>&#123;</span><br><span class="line">		<span class="attribute">color</span>:red</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.subClassOne</span>&#123;</span><br><span class="line">	&amp;:<span class="built_in">extend</span>(.parentClass span);</span><br><span class="line">&#125;</span><br><span class="line">编译为：</span><br><span class="line"><span class="selector-class">.parentClass</span> <span class="selector-tag">span</span>,</span><br><span class="line"><span class="selector-class">.subClassOne</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>2、精确匹配（exactly matching）</p>
</li>
<li>Less中，关键字extend里面的选择器必须与已定义的样式选择器严格一致，</li>
<li><p>如div .a{}样式只能通过extend（div .a）继承，而不能是extend（.a），尽管这两者在CSS中并没太多区别。例：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.a</span><span class="selector-class">.class</span>,</span><br><span class="line"><span class="selector-class">.class</span><span class="selector-class">.a</span>,</span><br><span class="line"><span class="selector-class">.class</span> &gt; <span class="selector-class">.a</span> &#123;</span><br><span class="line"> 	<span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.test</span>:<span class="built_in">extend</span>(.class) &#123;&#125; // this will NOT match the any selectors above</span><br><span class="line">编译将提示：extend &#x27;<span class="selector-class">.class</span>&#x27; has no matches错误。此外，通配符也不能用于此情况。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>3、extend的选择器替代问题</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@myClass</span>:.redColor;</span><br><span class="line"></span><br><span class="line">@&#123;myClass&#125;&#123;</span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.class</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.subClass</span>:<span class="built_in">extend</span>(.redColor)&#123;&#125;	//extend参考的选择器名在参考处为变量，错误</span><br><span class="line"><span class="selector-class">.subClass</span>:<span class="built_in">extend</span>(@&#123;myClass&#125;)&#123;&#125;	//extend内选择器名为变量，错误。</span><br><span class="line"><span class="keyword">@myClass</span>:extend(.class)&#123;&#125;		//不是上面两种情况，无错。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>4、媒体查询@media内的继承范围（scope）问题</p>
</li>
<li>同一个媒体查询（@media）内可被继承，<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> print &#123;</span><br><span class="line"> 	<span class="selector-class">.screenClass</span>:<span class="built_in">extend</span>(.selector) &#123;&#125; // extend inside media</span><br><span class="line">  	<span class="selector-class">.selector</span> &#123; // this will be matched - it is in the same media</span><br><span class="line">    	<span class="attribute">color</span>: black;</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.selector</span> &#123; // ruleset on <span class="attribute">top</span> of style sheet - extend ignores it</span><br><span class="line">  	<span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen &#123;</span><br><span class="line">  	<span class="selector-class">.selector</span> &#123;  // ruleset inside another media - extend ignores it</span><br><span class="line">    	<span class="attribute">color</span>: blue;</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br><span class="line">编译为：</span><br><span class="line"><span class="keyword">@media</span> print &#123;</span><br><span class="line">  <span class="selector-class">.selector</span>,</span><br><span class="line">  <span class="selector-class">.screenClass</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: black;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.selector</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen &#123;</span><br><span class="line">  <span class="selector-class">.selector</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: blue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">说明：并非内外部优先级问题，实际编译可知，若将媒体查询print内部的<span class="selector-class">.selector</span>去掉，仍然无法继承外部的<span class="selector-class">.selector</span>。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>5、Duplication（重复）问题<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.class1</span>,<span class="selector-class">.class2</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.class3</span>:<span class="built_in">extend</span>(.class1,.class2)&#123;&#125;</span><br><span class="line">注意：class1与class2是用逗号隔开，属于分组查询，所有不会有上面的第<span class="number">2</span>条。编译为：</span><br><span class="line"><span class="selector-class">.class1</span>,</span><br><span class="line"><span class="selector-class">.class2</span>,</span><br><span class="line"><span class="selector-class">.class3</span>,</span><br><span class="line"><span class="selector-class">.class3</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line">可见继承于分组选择器将是每个都单独继承。对于此处class1与class2完全一样的情况，extend内只写一个即可，不存在匹配问题。</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<ul>
<li>继承实际上是将当前的选择器名以分组形式添加到被继承的选择器处，</li>
<li>所以当既有继承又有自身样式时，应注意被继承的选择器的位置。</li>
<li>情况一：被继承的选择器在前面<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.parentClass</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.subClass</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:blue;</span><br><span class="line">	&amp;:<span class="built_in">extend</span>(.parentClass);</span><br><span class="line">	<span class="attribute">border</span>:<span class="number">1px</span> solid blue;</span><br><span class="line">&#125;</span><br><span class="line">编译结果，与预期一致，使用了自身的特殊<span class="attribute">color</span>：</span><br><span class="line"><span class="selector-class">.parentClass</span>,</span><br><span class="line"><span class="selector-class">.subClass</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.subClass</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>情况二：被继承的选择器在后面<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.subClass</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:blue;</span><br><span class="line">	&amp;:<span class="built_in">extend</span>(.parentClass);</span><br><span class="line">	<span class="attribute">border</span>:<span class="number">1px</span> solid blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.parentClass</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line">编译结果，因为位置原因，与预期不一致，此时此例中继承没达到目的：</span><br><span class="line"><span class="selector-class">.subClass</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.parentClass</span>,</span><br><span class="line"><span class="selector-class">.subClass</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/lessa1.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/lessa2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/lessa3.png" alt="请输入图片描述"></li>
</ul>
<hr>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>layout_painting</title>
    <url>/archives/78ca6597.html</url>
    <content><![CDATA[<h1 id="面试官：怎么理解回流跟重绘？什么场景下会触发？"><a href="#面试官：怎么理解回流跟重绘？什么场景下会触发？" class="headerlink" title="面试官：怎么理解回流跟重绘？什么场景下会触发？"></a>面试官：怎么理解回流跟重绘？什么场景下会触发？</h1><p> <img src="https://static.vue-js.com/1ed5d340-9cdc-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>在<code>HTML</code>中，每个元素都可以理解成一个盒子，在浏览器解析过程中，会涉及到回流与重绘：</p>
<ul>
<li><p>回流：布局引擎会根据各种样式计算每个盒子在页面上的大小与位置</p>
</li>
<li><p>重绘：当计算好盒模型的位置、大小及其他属性后，浏览器根据每个盒子特性进行绘制</p>
</li>
</ul>
<p>具体的浏览器解析渲染机制如下所示：</p>
<p> <img src="https://static.vue-js.com/2b56a950-9cdc-11eb-ab90-d9ae814b240d.png" alt=""></p>
<ul>
<li><p>解析HTML，生成DOM树，解析CSS，生成CSSOM树</p>
</li>
<li><p>将DOM树和CSSOM树结合，生成渲染树(Render Tree)</p>
</li>
<li>Layout(回流):根据生成的渲染树，进行回流(Layout)，得到节点的几何信息（位置，大小）</li>
<li>Painting(重绘):根据渲染树以及回流得到的几何信息，得到节点的绝对像素</li>
<li>Display:将像素发送给GPU，展示在页面上</li>
</ul>
<p>在页面初始渲染阶段，回流不可避免的触发，可以理解成页面一开始是空白的元素，后面添加了新的元素使页面布局发生改变</p>
<p>当我们对 <code>DOM</code> 的修改引发了 <code>DOM</code>几何尺寸的变化（比如修改元素的宽、高或隐藏元素等）时，浏览器需要重新计算元素的几何属性，然后再将计算的结果绘制出来</p>
<p>当我们对 <code>DOM</code>的修改导致了样式的变化（<code>color</code>或<code>background-color</code>），却并未影响其几何属性时，浏览器不需重新计算元素的几何属性、直接为该元素绘制新的样式，这里就仅仅触发了重绘</p>
<h2 id="二、如何触发"><a href="#二、如何触发" class="headerlink" title="二、如何触发"></a>二、如何触发</h2><p>要想减少回流和重绘的次数，首先要了解回流和重绘是如何触发的</p>
<h3 id="回流触发时机"><a href="#回流触发时机" class="headerlink" title="回流触发时机"></a>回流触发时机</h3><p>回流这一阶段主要是计算节点的位置和几何信息，那么当页面布局和几何信息发生变化的时候，就需要回流，如下面情况：</p>
<ul>
<li>添加或删除可见的DOM元素</li>
<li>元素的位置发生变化</li>
<li>元素的尺寸发生变化（包括外边距、内边框、边框大小、高度和宽度等）</li>
<li>内容发生变化，比如文本变化或图片被另一个不同尺寸的图片所替代</li>
<li>页面一开始渲染的时候（这避免不了）</li>
<li>浏览器的窗口尺寸变化（因为回流是根据视口的大小来计算元素的位置和大小的）</li>
</ul>
<p>还有一些容易被忽略的操作：获取一些特定属性的值</p>
<blockquote>
<p>offsetTop、offsetLeft、 offsetWidth、offsetHeight、scrollTop、scrollLeft、scrollWidth、scrollHeight、clientTop、clientLeft、clientWidth、clientHeight</p>
</blockquote>
<p>这些属性有一个共性，就是需要通过即时计算得到。因此浏览器为了获取这些值，也会进行回流</p>
<p>除此还包括<code>getComputedStyle</code>方法，原理是一样的</p>
<h3 id="重绘触发时机"><a href="#重绘触发时机" class="headerlink" title="重绘触发时机"></a>重绘触发时机</h3><p>触发回流一定会触发重绘</p>
<p>可以把页面理解为一个黑板，黑板上有一朵画好的小花。现在我们要把这朵从左边移到了右边，那我们要先确定好右边的具体位置，画好形状（回流），再画上它原有的颜色（重绘）</p>
<p>除此之外还有一些其他引起重绘行为：</p>
<ul>
<li><p>颜色的修改</p>
</li>
<li><p>文本方向的修改</p>
</li>
<li>阴影的修改</li>
</ul>
<h3 id="浏览器优化机制"><a href="#浏览器优化机制" class="headerlink" title="浏览器优化机制"></a>浏览器优化机制</h3><p>由于每次重排都会造成额外的计算消耗，因此大多数浏览器都会通过队列化修改并批量执行来优化重排过程。浏览器会将修改操作放入到队列里，直到过了一段时间或者操作达到了一个阈值，才清空队列</p>
<p>当你获取布局信息的操作的时候，会强制队列刷新，包括前面讲到的<code>offsetTop</code>等方法都会返回最新的数据</p>
<p>因此浏览器不得不清空队列，触发回流重绘来返回正确的值</p>
<h2 id="三、如何减少"><a href="#三、如何减少" class="headerlink" title="三、如何减少"></a>三、如何减少</h2><p>我们了解了如何触发回流和重绘的场景，下面给出避免回流的经验：</p>
<ul>
<li>如果想设定元素的样式，通过改变元素的 <code>class</code> 类名 (尽可能在 DOM 树的最里层)</li>
<li>避免设置多项内联样式</li>
<li>应用元素的动画，使用 <code>position</code> 属性的 <code>fixed</code> 值或 <code>absolute</code> 值(如前文示例所提)</li>
<li>避免使用 <code>table</code> 布局，<code>table</code> 中每个元素的大小以及内容的改动，都会导致整个 <code>table</code> 的重新计算</li>
<li>对于那些复杂的动画，对其设置 <code>position: fixed/absolute</code>，尽可能地使元素脱离文档流，从而减少对其他元素的影响</li>
<li>使用css3硬件加速，可以让<code>transform</code>、<code>opacity</code>、<code>filters</code>这些动画不会引起回流重绘</li>
<li>避免使用 CSS 的 <code>JavaScript</code> 表达式</li>
</ul>
<p>在使用 <code>JavaScript</code> 动态插入多个节点时, 可以使用<code>DocumentFragment</code>. 创建后一次插入. 就能避免多次的渲染性能</p>
<p>但有时候，我们会无可避免地进行回流或者重绘，我们可以更好使用它们</p>
<p>例如，多次修改一个把元素布局的时候，我们很可能会如下操作</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> el = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;el&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++) &#123;</span><br><span class="line">    el.style.top  = el.offsetTop  + <span class="number">10</span> + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">    el.style.left = el.offsetLeft + <span class="number">10</span> + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>每次循环都需要获取多次<code>offset</code>属性，比较糟糕，可以使用变量的形式缓存起来，待计算完毕再提交给浏览器发出重计算请求</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 缓存offsetLeft与offsetTop的值</span></span><br><span class="line"><span class="keyword">const</span> el = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;el&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> offLeft = el.offsetLeft, offTop = el.offsetTop</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在JS层面进行计算</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++) &#123;</span><br><span class="line">  offLeft += <span class="number">10</span></span><br><span class="line">  offTop  += <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 一次性将计算结果应用到DOM上</span></span><br><span class="line">el.style.left = offLeft + <span class="string">&quot;px&quot;</span></span><br><span class="line">el.style.top = offTop  + <span class="string">&quot;px&quot;</span></span><br></pre></td></tr></table></figure>
<p>我们还可避免改变样式，使用类名去合并样式</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> container = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;container&#x27;</span>)</span><br><span class="line">container.style.width = <span class="string">&#x27;100px&#x27;</span></span><br><span class="line">container.style.height = <span class="string">&#x27;200px&#x27;</span></span><br><span class="line">container.style.border = <span class="string">&#x27;10px solid red&#x27;</span></span><br><span class="line">container.style.color = <span class="string">&#x27;red&#x27;</span></span><br></pre></td></tr></table></figure>
<p>使用类名去合并样式</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.basic_style</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">border</span>: <span class="number">10px</span> solid red;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> container = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;container&#x27;</span>)</span></span><br><span class="line"><span class="javascript">    container.classList.add(<span class="string">&#x27;basic_style&#x27;</span>)</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>前者每次单独操作，都去触发一次渲染树更改（新浏览器不会），</p>
<p>都去触发一次渲染树更改，从而导致相应的回流与重绘过程</p>
<p>合并之后，等于我们将所有的更改一次性发出</p>
<p>我们还可以通过通过设置元素属性<code>display: none</code>，将其从页面上去掉，然后再进行后续操作，这些后续操作也不会触发回流与重绘，这个过程称为离线操作</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> container = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;container&#x27;</span>)</span><br><span class="line">container.style.width = <span class="string">&#x27;100px&#x27;</span></span><br><span class="line">container.style.height = <span class="string">&#x27;200px&#x27;</span></span><br><span class="line">container.style.border = <span class="string">&#x27;10px solid red&#x27;</span></span><br><span class="line">container.style.color = <span class="string">&#x27;red&#x27;</span></span><br></pre></td></tr></table></figure>
<p>离线操作后</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> container = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;container&#x27;</span>)</span><br><span class="line">container.style.display = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">container.style.width = <span class="string">&#x27;100px&#x27;</span></span><br><span class="line">container.style.height = <span class="string">&#x27;200px&#x27;</span></span><br><span class="line">container.style.border = <span class="string">&#x27;10px solid red&#x27;</span></span><br><span class="line">container.style.color = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">...（省略了许多类似的后续操作）</span><br><span class="line">container.style.display = <span class="string">&#x27;block&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><p><a href="https://juejin.cn/post/6844903942137053192">https://juejin.cn/post/6844903942137053192</a></p>
</li>
<li><p><a href="https://segmentfault.com/a/1190000017329980">https://segmentfault.com/a/1190000017329980</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>layout_painting</tag>
      </tags>
  </entry>
  <entry>
    <title>js_data_structure</title>
    <url>/archives/958c57b5.html</url>
    <content><![CDATA[<h1 id="面试官：说说你了解的js数据结构？"><a href="#面试官：说说你了解的js数据结构？" class="headerlink" title="面试官：说说你了解的js数据结构？"></a>面试官：说说你了解的js数据结构？</h1><h2 id="什么是数据结构？"><a href="#什么是数据结构？" class="headerlink" title="什么是数据结构？"></a>什么是数据结构？</h2><p>数据结构是计算机存储、组织数据的方式。<br>数据结构意味着接口或封装：一个数据结构可被视为两个函数之间的接口，或者是由数据类型联合组成的存储内容的访问方法封装。</p>
<p>我们每天的编码中都会用到数据结构<br>数组是最简单的内存数据结构<br>下面是常见的数据结构：</p>
<ol>
<li>数组（Array）</li>
<li>栈（Stack）</li>
<li>队列（Queue）</li>
<li>链表（Linked List）</li>
<li>字典</li>
<li>散列表（Hash table）</li>
<li>树（Tree）</li>
<li>图（Graph）</li>
<li>堆（Heap）</li>
</ol>
<h2 id="数组（Array）"><a href="#数组（Array）" class="headerlink" title="数组（Array）"></a>数组（Array）</h2><p>数组是最最基本的数据结构，很多语言都内置支持数组。<br>数组是使用一块连续的内存空间保存数据，保存的数据的个数在分配内存的时候就是确定的。</p>
<p>在日常生活中，人们经常使用列表：待办事项列表、购物清单等。</p>
<p>而计算机程序也在使用列表，在下面的条件下，选择列表作为数据结构就显得尤为有用：<br>数据结构较为简单<br>不需要在一个长序列中查找元素，或者对其进行排序<br>反之，如果数据结构非常复杂，列表的作用就没有那么大了。</p>
<h2 id="栈（Stack）"><a href="#栈（Stack）" class="headerlink" title="栈（Stack）"></a>栈（Stack）</h2><p>栈是一种遵循后进先出（LIFO）原则的有序集合<br>在栈里，新元素都接近栈顶，旧元素都接近栈底。<br>每次加入新的元素和拿走元素都在顶部操作<br><img src="https://upload-images.jianshu.io/upload_images/13253432-ddcb884374470d2c?imageMogr2/auto-orient/strip|imageView2/2/format/webp" alt=""></p>
<h2 id="队列（Queue）"><a href="#队列（Queue）" class="headerlink" title="队列（Queue）"></a>队列（Queue）</h2><p>队列是遵循先进先出（FIFO，也称为先来先服务）原则的一组有序的项<br>队列在尾部添加新元素，并从顶部移除元素<br>最新添加的元素必须排在队列的末尾<br><img src="https://upload-images.jianshu.io/upload_images/13253432-55ad7c7db40d3796?imageMogr2/auto-orient/strip|imageView2/2/format/webp" alt=""></p>
<h2 id="链表（Linked-List）"><a href="#链表（Linked-List）" class="headerlink" title="链表（Linked List）"></a>链表（Linked List）</h2><p>链表也是一种列表，已经设计了数组，为什么还需要链表呢？<br>JavaScript中数组的主要问题时，它们被实现成了对象，<br>与其他语言（比如C++和Java）的数组相对，效率很低。<br>如果你发现数组在实际使用时很慢，就可以考虑使用链表来代替它。</p>
<p>使用条件：<br>链表几乎可以用在任何可以使用一维数组的情况中。<br>如果需要随机访问，数组仍然是更好的选择。<br><img src="https://raw.githubusercontent.com/zoro-web/blog/master/img/lian.jpg" alt=""></p>
<h2 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h2><p>字典是一种以键-值对存储数据的数据结构，js中的Object类就是以字典的形式设计的。JavaScript可以通过实现字典类，让这种字典类型的对象使用起来更加简单，字典可以实现对象拥有的常见功能，并相应拓展自己想要的功能，而对象在JavaScript编写中随处可见，所以字典的作用也异常明显了。</p>
<h2 id="散列表"><a href="#散列表" class="headerlink" title="散列表"></a>散列表</h2><p>也称为哈希表，特点是在散列表上插入、删除和取用数据都非常快。<br>为什么要设计这种数据结构呢？<br>用数组或链表存储数据，如果想要找到其中一个数据，需要从头进行遍历，因为不知道这个数据存储到了数组的哪个位置。</p>
<p>散列表在JavaScript中可以基础数组去进行设计。<br>数组的长度是预先设定的，所有元素根据和该元素对应的键，保存在数组的特定位置，这里的键和对象的键是类型的概念。<br>使用散列表存储数组时，通过一个散列函数将键映射为一个数字，这个数字的范围是0到散列表的长度。</p>
<p>即使使用一个高效的散列函数，依然存在将两个键映射为同一个值得可能，这种现象叫做碰撞。常见碰撞的处理方法有：开链法和线性探测法（具体概念有兴趣的可以网上自信了解）<br>使用条件：<br>可以用于数据的插入、删除和取用，不适用于查找数据<br><img src="https://raw.githubusercontent.com/zoro-web/blog/master/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170820211406.png" alt=""></p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>js_data_structure</tag>
      </tags>
  </entry>
  <entry>
    <title>inherit</title>
    <url>/archives/a0245a2a.html</url>
    <content><![CDATA[<h1 id="面试官：Javascript如何实现继承？"><a href="#面试官：Javascript如何实现继承？" class="headerlink" title="面试官：Javascript如何实现继承？"></a>面试官：Javascript如何实现继承？</h1><p><img src="https://static.vue-js.com/5d9c4450-72a3-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>继承（inheritance）是面向对象软件技术当中的一个概念。</p>
<p>如果一个类别B“继承自”另一个类别A，就把这个B称为“A的子类”，而把A称为“B的父类别”也可以称“A是B的超类”</p>
<ul>
<li>继承的优点</li>
</ul>
<p>继承可以使得子类具有父类别的各种属性和方法，而不需要再次编写相同的代码</p>
<p>在子类别继承父类别的同时，可以重新定义某些属性，并重写某些方法，即覆盖父类别的原有属性和方法，使其获得与父类别不同的功能</p>
<p>虽然<code>JavaScript</code>并不是真正的面向对象语言，但它天生的灵活性，使应用场景更加丰富</p>
<p>关于继承，我们举个形象的例子：</p>
<p>定义一个类（Class）叫汽车，汽车的属性包括颜色、轮胎、品牌、速度、排气量等</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">color,speed</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.color = color</span><br><span class="line">        <span class="built_in">this</span>.speed = speed</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由汽车这个类可以派生出“轿车”和“货车”两个类，在汽车的基础属性上，为轿车添加一个后备厢、给货车添加一个大货箱</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 货车</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Truck</span> <span class="keyword">extends</span> <span class="title">Car</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">color,speed</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>(color,speed)</span><br><span class="line">        <span class="built_in">this</span>.Container = <span class="literal">true</span> <span class="comment">// 货箱</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样轿车和货车就是不一样的，但是二者都属于汽车这个类，汽车、轿车继承了汽车的属性，而不需要再次在“轿车”中定义汽车已经有的属性</p>
<p>在“轿车”继承“汽车”的同时，也可以重新定义汽车的某些属性，并重写或覆盖某些属性和方法，使其获得与“汽车”这个父类不同的属性和方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Truck</span> <span class="keyword">extends</span> <span class="title">Car</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">color,speed</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>(color,speed)</span><br><span class="line">        <span class="built_in">this</span>.color = <span class="string">&quot;black&quot;</span> <span class="comment">//覆盖</span></span><br><span class="line">        <span class="built_in">this</span>.Container = <span class="literal">true</span> <span class="comment">// 货箱</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从这个例子中就能详细说明汽车、轿车以及卡车之间的继承关系</p>
<h2 id="二、实现方式"><a href="#二、实现方式" class="headerlink" title="二、实现方式"></a>二、实现方式</h2><p>下面给出<code>JavaScripy</code>常见的继承方式：</p>
<ul>
<li><p>原型链继承</p>
</li>
<li><p>构造函数继承（借助 call）</p>
</li>
<li>组合继承</li>
<li>原型式继承</li>
<li>寄生式继承</li>
<li>寄生组合式继承</li>
</ul>
<h3 id="原型链继承"><a href="#原型链继承" class="headerlink" title="原型链继承"></a>原型链继承</h3><p>原型链继承是比较常见的继承方式之一，其中涉及的构造函数、原型和实例，三者之间存在着一定的关系，即每一个构造函数都有一个原型对象，原型对象又包含一个指向构造函数的指针，而实例则包含一个原型对象的指针</p>
<p>举个例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="built_in">this</span>.name = <span class="string">&#x27;parent1&#x27;</span>;</span><br><span class="line">   <span class="built_in">this</span>.play = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="built_in">this</span>.type = <span class="string">&#x27;child2&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> Child1.prototype = <span class="keyword">new</span> Parent();</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="keyword">new</span> Child())</span><br></pre></td></tr></table></figure>
<p>上面代码看似没问题，实际存在潜在问题</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 = <span class="keyword">new</span> Child2();</span><br><span class="line"><span class="keyword">var</span> s2 = <span class="keyword">new</span> Child2();</span><br><span class="line">s1.play.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(s1.play, s2.play); <span class="comment">// [1,2,3,4]</span></span><br></pre></td></tr></table></figure>
<p>改变<code>s1</code>的<code>play</code>属性，会发现<code>s2</code>也跟着发生变化了，这是因为两个实例使用的是同一个原型对象，内存空间是共享的</p>
<h3 id="构造函数继承"><a href="#构造函数继承" class="headerlink" title="构造函数继承"></a>构造函数继承</h3><p>借助 <code>call</code>调用<code>Parent</code>函数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;parent1&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Parent.prototype.getName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    Parent1.call(<span class="built_in">this</span>);</span><br><span class="line">    <span class="built_in">this</span>.type = <span class="string">&#x27;child&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> child = <span class="keyword">new</span> Child();</span><br><span class="line"><span class="built_in">console</span>.log(child);  <span class="comment">// 没问题</span></span><br><span class="line"><span class="built_in">console</span>.log(child.getName());  <span class="comment">// 会报错</span></span><br></pre></td></tr></table></figure>
<p>可以看到，父类原型对象中一旦存在父类之前自己定义的方法，那么子类将无法继承这些方法</p>
<p>相比第一种原型链继承方式，父类的引用属性不会被共享，优化了第一种继承方式的弊端，但是只能继承父类的实例属性和方法，不能继承原型属性或者方法</p>
<h3 id="组合继承"><a href="#组合继承" class="headerlink" title="组合继承"></a>组合继承</h3><p>前面我们讲到两种继承方式，各有优缺点。组合继承则将前两种方式继承起来</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent3</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;parent3&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.play = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Parent3.prototype.getName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 第二次调用 Parent3()</span></span><br><span class="line">    Parent3.call(<span class="built_in">this</span>);</span><br><span class="line">    <span class="built_in">this</span>.type = <span class="string">&#x27;child3&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第一次调用 Parent3()</span></span><br><span class="line">Child3.prototype = <span class="keyword">new</span> Parent3();</span><br><span class="line"><span class="comment">// 手动挂上构造器，指向自己的构造函数</span></span><br><span class="line">Child3.prototype.constructor = Child3;</span><br><span class="line"><span class="keyword">var</span> s3 = <span class="keyword">new</span> Child3();</span><br><span class="line"><span class="keyword">var</span> s4 = <span class="keyword">new</span> Child3();</span><br><span class="line">s3.play.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(s3.play, s4.play);  <span class="comment">// 不互相影响</span></span><br><span class="line"><span class="built_in">console</span>.log(s3.getName()); <span class="comment">// 正常输出&#x27;parent3&#x27;</span></span><br><span class="line"><span class="built_in">console</span>.log(s4.getName()); <span class="comment">// 正常输出&#x27;parent3&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这种方式看起来就没什么问题，方式一和方式二的问题都解决了，但是从上面代码我们也可以看到<code>Parent3</code> 执行了两次，造成了多构造一次的性能开销</p>
<h3 id="原型式继承"><a href="#原型式继承" class="headerlink" title="原型式继承"></a>原型式继承</h3><p>这里主要借助<code>Object.create</code>方法实现普通对象的继承</p>
<p>同样举个例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> parent4 = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;parent4&quot;</span>,</span><br><span class="line">    <span class="attr">friends</span>: [<span class="string">&quot;p1&quot;</span>, <span class="string">&quot;p2&quot;</span>, <span class="string">&quot;p3&quot;</span>],</span><br><span class="line">    <span class="attr">getName</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> person4 = <span class="built_in">Object</span>.create(parent4);</span><br><span class="line">  person4.name = <span class="string">&quot;tom&quot;</span>;</span><br><span class="line">  person4.friends.push(<span class="string">&quot;jerry&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> person5 = <span class="built_in">Object</span>.create(parent4);</span><br><span class="line">  person5.friends.push(<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(person4.name); <span class="comment">// tom</span></span><br><span class="line">  <span class="built_in">console</span>.log(person4.name === person4.getName()); <span class="comment">// true</span></span><br><span class="line">  <span class="built_in">console</span>.log(person5.name); <span class="comment">// parent4</span></span><br><span class="line">  <span class="built_in">console</span>.log(person4.friends); <span class="comment">// [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;,&quot;jerry&quot;,&quot;lucy&quot;]</span></span><br><span class="line">  <span class="built_in">console</span>.log(person5.friends); <span class="comment">// [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;,&quot;jerry&quot;,&quot;lucy&quot;]</span></span><br></pre></td></tr></table></figure>
<p>这种继承方式的缺点也很明显，因为<code>Object.create</code>方法实现的是浅拷贝，多个实例的引用类型属性指向相同的内存，存在篡改的可能</p>
<h3 id="寄生式继承"><a href="#寄生式继承" class="headerlink" title="寄生式继承"></a>寄生式继承</h3><p>寄生式继承在上面继承基础上进行优化，利用这个浅拷贝的能力再进行增强，添加一些方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> parent5 = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;parent5&quot;</span>,</span><br><span class="line">    <span class="attr">friends</span>: [<span class="string">&quot;p1&quot;</span>, <span class="string">&quot;p2&quot;</span>, <span class="string">&quot;p3&quot;</span>],</span><br><span class="line">    <span class="attr">getName</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clone</span>(<span class="params">original</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> clone = <span class="built_in">Object</span>.create(original);</span><br><span class="line">    clone.getFriends = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.friends;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> clone;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person5 = clone(parent5);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(person5.getName()); <span class="comment">// parent5</span></span><br><span class="line"><span class="built_in">console</span>.log(person5.getFriends()); <span class="comment">// [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;]</span></span><br></pre></td></tr></table></figure>
<p>其优缺点也很明显，跟上面讲的原型式继承一样</p>
<h3 id="寄生组合式继承"><a href="#寄生组合式继承" class="headerlink" title="寄生组合式继承"></a>寄生组合式继承</h3><p>寄生组合式继承，借助解决普通对象的继承问题的<code>Object.create</code> 方法，在前面几种继承方式的优缺点基础上进行改造，这也是所有继承方式里面相对最优的继承方式</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clone</span> (<span class="params">parent, child</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 这里改用 Object.create 就可以减少组合继承中多进行一次构造的过程</span></span><br><span class="line">    child.prototype = <span class="built_in">Object</span>.create(parent.prototype);</span><br><span class="line">    child.prototype.constructor = child;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent6</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;parent6&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.play = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line">Parent6.prototype.getName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child6</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    Parent6.call(<span class="built_in">this</span>);</span><br><span class="line">    <span class="built_in">this</span>.friends = <span class="string">&#x27;child5&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">clone(Parent6, Child6);</span><br><span class="line"></span><br><span class="line">Child6.prototype.getFriends = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.friends;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person6 = <span class="keyword">new</span> Child6();</span><br><span class="line"><span class="built_in">console</span>.log(person6); <span class="comment">//&#123;friends:&quot;child5&quot;,name:&quot;child5&quot;,play:[1,2,3],__proto__:Parent6&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(person6.getName()); <span class="comment">// parent6</span></span><br><span class="line"><span class="built_in">console</span>.log(person6.getFriends()); <span class="comment">// child5</span></span><br></pre></td></tr></table></figure>
<p>可以看到 person6 打印出来的结果，属性都得到了继承，方法也没问题</p>
<p>文章一开头，我们是使用<code>ES6</code> 中的<code>extends</code>关键字直接实现 <code>JavaScript</code>的继承</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 原型方法</span></span><br><span class="line">  <span class="comment">// 即 Person.prototype.getName = function() &#123; &#125;</span></span><br><span class="line">  <span class="comment">// 下面可以简写为 getName() &#123;...&#125;</span></span><br><span class="line">  getName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Person:&#x27;</span>, <span class="built_in">this</span>.name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Gamer</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name, age</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 子类中存在构造函数，则需要在使用“this”之前首先调用 super()。</span></span><br><span class="line">    <span class="built_in">super</span>(name)</span><br><span class="line">    <span class="built_in">this</span>.age = age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> asuna = <span class="keyword">new</span> Gamer(<span class="string">&#x27;Asuna&#x27;</span>, <span class="number">20</span>)</span><br><span class="line">asuna.getName() <span class="comment">// 成功访问到父类的方法</span></span><br></pre></td></tr></table></figure>
<p>利用<code>babel</code>工具进行转换，我们会发现<code>extends</code>实际采用的也是寄生组合继承方式，因此也证明了这种方式是较优的解决继承的方式</p>
<h2 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h2><p>下面以一张图作为总结：</p>
<p> <img src="https://static.vue-js.com/0df74700-731c-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>通过<code>Object.create</code> 来划分不同的继承方式，最后的寄生式组合继承方式是通过组合继承改造之后的最优继承方式，而 <code>extends</code> 的语法糖和寄生组合继承的方式基本类似</p>
<h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><p><a href="https://zh.wikipedia.org/wiki/%E7%BB%A7%E6%89%BF">https://zh.wikipedia.org/wiki/%E7%BB%A7%E6%89%BF</a></p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>inherit</tag>
      </tags>
  </entry>
  <entry>
    <title>loss_accuracy</title>
    <url>/archives/e0c98e7a.html</url>
    <content><![CDATA[<h1 id="面试官：说说-Javascript-数字精度丢失的问题，如何解决？"><a href="#面试官：说说-Javascript-数字精度丢失的问题，如何解决？" class="headerlink" title="面试官：说说 Javascript 数字精度丢失的问题，如何解决？"></a>面试官：说说 Javascript 数字精度丢失的问题，如何解决？</h1><p> <img src="https://static.vue-js.com/09646a10-86f4-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、场景复现"><a href="#一、场景复现" class="headerlink" title="一、场景复现"></a>一、场景复现</h2><p>一个经典的面试题</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">0.1</span> + <span class="number">0.2</span> === <span class="number">0.3</span> <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>为什么是<code>false</code>呢?</p>
<p>先看下面这个比喻</p>
<p>比如一个数 1÷3=0.33333333…… </p>
<p>3会一直无限循环，数学可以表示，但是计算机要存储，方便下次取出来再使用，但0.333333…… 这个数无限循环，再大的内存它也存不下，所以不能存储一个相对于数学来说的值，只能存储一个近似值，当计算机存储后再取出时就会出现精度丢失问题</p>
<h2 id="二、浮点数"><a href="#二、浮点数" class="headerlink" title="二、浮点数"></a>二、浮点数</h2><p>“浮点数”是一种表示数字的标准，整数也可以用浮点数的格式来存储</p>
<p>我们也可以理解成，浮点数就是小数</p>
<p>在<code>JavaScript</code>中，现在主流的数值类型是<code>Number</code>，而<code>Number</code>采用的是<code>IEEE754</code>规范中64位双精度浮点数编码</p>
<p>这样的存储结构优点是可以归一化处理整数和小数，节省存储空间</p>
<p>对于一个整数，可以很轻易转化成十进制或者二进制。但是对于一个浮点数来说，因为小数点的存在，小数点的位置不是固定的。解决思路就是使用科学计数法，这样小数点位置就固定了</p>
<p>而计算机只能用二进制（0或1）表示，二进制转换为科学记数法的公式如下：</p>
<p> <img src="https://static.vue-js.com/1b4b1620-86f4-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>其中，<code>a</code>的值为0或者1，e为小数点移动的位置</p>
<p>举个例子：</p>
<p>27.0转化成二进制为11011.0 ，科学计数法表示为：</p>
<p> <img src="https://static.vue-js.com/37007090-86f4-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>前面讲到，<code>javaScript</code>存储方式是双精度浮点数，其长度为8个字节，即64位比特</p>
<p>64位比特又可分为三个部分：</p>
<ul>
<li>符号位S：第 1 位是正负数符号位（sign），0代表正数，1代表负数</li>
<li>指数位E：中间的 11 位存储指数（exponent），用来表示次方数，可以为正负数。在双精度浮点数中，指数的固定偏移量为1023</li>
<li>尾数位M：最后的 52 位是尾数（mantissa），超出的部分自动进一舍零</li>
</ul>
<p>如下图所示：</p>
<p> <img src="https://static.vue-js.com/430d0100-86f4-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>举个例子：</p>
<p>27.5 转换为二进制11011.1</p>
<p>11011.1转换为科学记数法 <img src="https://www.zhihu.com/equation?tex=1.10111%2A2%5E4" alt="[公式]"></p>
<p>符号位为1(正数)，指数位为4+，1023+4，即1027</p>
<p>因为它是十进制的需要转换为二进制，即 <code>10000000011</code>，小数部分为<code>10111</code>，补够52位即： 1011 1000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000`</p>
<p>所以27.5存储为计算机的二进制标准形式（符号位+指数位+小数部分 (阶数)），既下面所示</p>
<p>0+10000000011+011 1000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000`</p>
<h2 id="二、问题分析"><a href="#二、问题分析" class="headerlink" title="二、问题分析"></a>二、问题分析</h2><p>再回到问题上</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">0.1</span> + <span class="number">0.2</span> === <span class="number">0.3</span> <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>通过上面的学习，我们知道，在<code>javascript</code>语言中，0.1 和 0.2 都转化成二进制后再进行运算</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 0.1 和 0.2 都转化成二进制后再进行运算</span></span><br><span class="line"><span class="number">0.00011001100110011001100110011001100110011001100110011010</span> +</span><br><span class="line"><span class="number">0.0011001100110011001100110011001100110011001100110011010</span> =</span><br><span class="line"><span class="number">0.0100110011001100110011001100110011001100110011001100111</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转成十进制正好是 0.30000000000000004</span></span><br></pre></td></tr></table></figure>
<p>所以输出<code>false</code></p>
<p>再来一个问题，那么为什么<code>x=0.1</code>得到<code>0.1</code>？</p>
<p>主要是存储二进制时小数点的偏移量最大为52位，最多可以表达的位数是<code>2^53=9007199254740992</code>，对应科学计数尾数是 <code>9.007199254740992</code>，这也是 JS 最多能表示的精度</p>
<p>它的长度是 16，所以可以使用 <code>toPrecision(16)</code> 来做精度运算，超过的精度会自动做凑整处理</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">.10000000000000000555</span>.toPrecision(<span class="number">16</span>)</span><br><span class="line"><span class="comment">// 返回 0.1000000000000000，去掉末尾的零后正好为 0.1</span></span><br></pre></td></tr></table></figure>
<p>但看到的 <code>0.1</code> 实际上并不是 <code>0.1</code>。不信你可用更高的精度试试：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">0.1</span>.toPrecision(<span class="number">21</span>) = <span class="number">0.100000000000000005551</span></span><br></pre></td></tr></table></figure>
<p>如果整数大于 <code>9007199254740992</code> 会出现什么情况呢？</p>
<p>由于指数位最大值是1023，所以最大可以表示的整数是 <code>2^1024 - 1</code>，这就是能表示的最大整数。但你并不能这样计算这个数字，因为从 <code>2^1024</code> 开始就变成了 <code>Infinity</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; Math.pow(2, 1023)</span><br><span class="line">8.98846567431158e+307</span><br><span class="line"></span><br><span class="line">&gt; Math.pow(2, 1024)</span><br><span class="line">Infinity</span><br></pre></td></tr></table></figure>
<p>那么对于 <code>(2^53, 2^63)</code> 之间的数会出现什么情况呢？</p>
<ul>
<li><code>(2^53, 2^54)</code> 之间的数会两个选一个，只能精确表示偶数</li>
<li><code>(2^54, 2^55)</code> 之间的数会四个选一个，只能精确表示4个倍数</li>
<li>… 依次跳过更多2的倍数</li>
</ul>
<p>要想解决大数的问题你可以引用第三方库 <code>bignumber.js</code>，原理是把所有数字当作字符串，重新实现了计算逻辑，缺点是性能比原生差很多</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>计算机存储双精度浮点数需要先把十进制数转换为二进制的科学记数法的形式，然后计算机以自己的规则{符号位+(指数位+指数偏移量的二进制)+小数部分}存储二进制的科学记数法</p>
<p>因为存储时有位数限制（64位），并且某些十进制的浮点数在转换为二进制数时会出现无限循环，会造成二进制的舍入操作(0舍1入)，当再转换为十进制时就造成了计算误差</p>
<h2 id="三、解决方案"><a href="#三、解决方案" class="headerlink" title="三、解决方案"></a>三、解决方案</h2><p>理论上用有限的空间来存储无限的小数是不可能保证精确的，但我们可以处理一下得到我们期望的结果</p>
<p>当你拿到 <code>1.4000000000000001</code> 这样的数据要展示时，建议使用 <code>toPrecision</code> 凑整并 <code>parseFloat</code> 转成数字后再显示，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">parseFloat(1.4000000000000001.toPrecision(12)) === 1.4  // True</span><br></pre></td></tr></table></figure>
<p>封装成方法就是：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strip</span>(<span class="params">num, precision = <span class="number">12</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> +<span class="built_in">parseFloat</span>(num.toPrecision(precision));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于运算类操作，如 <code>+-*/</code>，就不能使用 <code>toPrecision</code> 了。正确的做法是把小数转成整数后再运算。以加法为例：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 精确加法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> num1Digits = (num1.toString().split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>] || <span class="string">&#x27;&#x27;</span>).length;</span><br><span class="line">  <span class="keyword">const</span> num2Digits = (num2.toString().split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>] || <span class="string">&#x27;&#x27;</span>).length;</span><br><span class="line">  <span class="keyword">const</span> baseNum = <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="built_in">Math</span>.max(num1Digits, num2Digits));</span><br><span class="line">  <span class="keyword">return</span> (num1 * baseNum + num2 * baseNum) / baseNum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后还可以使用第三方库，如<code>Math.js</code>、<code>BigDecimal.js</code></p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://zhuanlan.zhihu.com/p/100353781">https://zhuanlan.zhihu.com/p/100353781</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/BigInt">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/BigInt</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>loss_accuracy</tag>
      </tags>
  </entry>
  <entry>
    <title>memory_leak</title>
    <url>/archives/171d1754.html</url>
    <content><![CDATA[<h1 id="面试官：说说-JavaScript-中内存泄漏的几种情况？"><a href="#面试官：说说-JavaScript-中内存泄漏的几种情况？" class="headerlink" title="面试官：说说 JavaScript 中内存泄漏的几种情况？"></a>面试官：说说 JavaScript 中内存泄漏的几种情况？</h1><p>  <img src="https://static.vue-js.com/19f76b30-824d-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>内存泄漏（Memory leak）是在计算机科学中，由于疏忽或错误造成程序未能释放已经不再使用的内存</p>
<p>并非指内存在物理上的消失，而是应用程序分配某段内存后，由于设计错误，导致在释放该段内存之前就失去了对该段内存的控制，从而造成了内存的浪费</p>
<p>程序的运行需要内存。只要程序提出要求，操作系统或者运行时就必须供给内存</p>
<p>对于持续运行的服务进程，必须及时释放不再用到的内存。否则，内存占用越来越高，轻则影响系统性能，重则导致进程崩溃</p>
<p> <img src="https://static.vue-js.com/56d4bd90-821c-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>在<code>C</code>语言中，因为是手动管理内存，内存泄露是经常出现的事情。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">char * buffer;</span><br><span class="line">buffer = (char*) malloc(42);</span><br><span class="line"></span><br><span class="line">// Do something with buffer</span><br><span class="line"></span><br><span class="line">free(buffer);</span><br></pre></td></tr></table></figure>
<p>上面是 C 语言代码，<code>malloc</code>方法用来申请内存，使用完毕之后，必须自己用<code>free</code>方法释放内存。</p>
<p>这很麻烦，所以大多数语言提供自动内存管理，减轻程序员的负担，这被称为”垃圾回收机制”</p>
<h2 id="二、垃圾回收机制"><a href="#二、垃圾回收机制" class="headerlink" title="二、垃圾回收机制"></a>二、垃圾回收机制</h2><p>Javascript 具有自动垃圾回收机制（GC：Garbage Collecation），也就是说，执行环境会负责管理代码执行过程中使用的内存</p>
<p>原理：垃圾收集器会定期（周期性）找出那些不在继续使用的变量，然后释放其内存</p>
<p>通常情况下有两种实现方式：</p>
<ul>
<li>标记清除</li>
<li>引用计数</li>
</ul>
<h3 id="标记清除"><a href="#标记清除" class="headerlink" title="标记清除"></a>标记清除</h3><p><code>JavaScript</code>最常用的垃圾收回机制</p>
<p>当变量进入执行环境是，就标记这个变量为“进入环境“。进入环境的变量所占用的内存就不能释放，当变量离开环境时，则将其标记为“离开环境“</p>
<p>垃圾回收程序运行的时候，会标记内存中存储的所有变量。然后，它会将所有在上下文中的变量，以及被在上下文中的变量引用的变量的标记去掉</p>
<p>在此之后再被加上标记的变量就是待删除的了，原因是任何在上下文中的变量都访问不到它们了</p>
<p>随后垃圾回收程序做一次内存清理，销毁带标记的所有值并收回它们的内存</p>
<p>举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> m = <span class="number">0</span>,n = <span class="number">19</span> <span class="comment">// 把 m,n,add() 标记为进入环境。</span></span><br><span class="line">add(m, n) <span class="comment">// 把 a, b, c标记为进入环境。</span></span><br><span class="line"><span class="built_in">console</span>.log(n) <span class="comment">// a,b,c标记为离开环境，等待垃圾回收。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  a++</span><br><span class="line">  <span class="keyword">var</span> c = a + b</span><br><span class="line">  <span class="keyword">return</span> c</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="引用计数"><a href="#引用计数" class="headerlink" title="引用计数"></a>引用计数</h3><p>语言引擎有一张”引用表”，保存了内存里面所有的资源（通常是各种值）的引用次数。如果一个值的引用次数是<code>0</code>，就表示这个值不再用到了，因此可以将这块内存释放</p>
<p>如果一个值不再需要了，引用数却不为<code>0</code>，垃圾回收机制无法释放这块内存，从而导致内存泄漏</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello world&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>面代码中，数组<code>[1, 2, 3, 4]</code>是一个值，会占用内存。变量<code>arr</code>是仅有的对这个值的引用，因此引用次数为<code>1</code>。尽管后面的代码没有用到<code>arr</code>，它还是会持续占用内存</p>
<p>如果需要这块内存被垃圾回收机制释放，只需要设置如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">arr = <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>通过设置<code>arr</code>为<code>null</code>，就解除了对数组<code>[1,2,3,4]</code>的引用，引用次数变为 0，就被垃圾回收了</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>有了垃圾回收机制，不代表不用关注内存泄露。那些很占空间的值，一旦不再用到，需要检查是否还存在对它们的引用。如果是的话，就必须手动解除引用</p>
<h2 id="三、常见内存泄露情况"><a href="#三、常见内存泄露情况" class="headerlink" title="三、常见内存泄露情况"></a>三、常见内存泄露情况</h2><p>意外的全局变量</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">    bar = <span class="string">&quot;this is a hidden global variable&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另一种意外的全局变量可能由 <code>this</code> 创建：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.variable = <span class="string">&quot;potential accidental global&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// foo 调用自己，this 指向了全局对象（window）</span></span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>
<p>上述使用严格模式，可以避免意外的全局变量</p>
<p>定时器也常会造成内存泄露</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> someResource = getData();</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;Node&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(node) &#123;</span><br><span class="line">        <span class="comment">// 处理 node 和 someResource</span></span><br><span class="line">        node.innerHTML = <span class="built_in">JSON</span>.stringify(someResource));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
<p>如果<code>id</code>为Node的元素从<code>DOM</code>中移除，该定时器仍会存在，同时，因为回调函数中包含对<code>someResource</code>的引用，定时器外面的<code>someResource</code>也不会被释放</p>
<p>包括我们之前所说的闭包，维持函数内局部变量，使其得不到释放</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindEvent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> obj = <span class="built_in">document</span>.createElement(<span class="string">&#x27;XXX&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> unused = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(obj, <span class="string">&#x27;闭包内引用obj obj不会被释放&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  obj = <span class="literal">null</span>; <span class="comment">// 解决方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>没有清理对<code>DOM</code>元素的引用同样造成内存泄露</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> refA = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;refA&#x27;</span>);</span><br><span class="line"><span class="built_in">document</span>.body.removeChild(refA); <span class="comment">// dom删除了</span></span><br><span class="line"><span class="built_in">console</span>.log(refA, <span class="string">&#x27;refA&#x27;</span>); <span class="comment">// 但是还存在引用能console出整个div 没有被回收</span></span><br><span class="line">refA = <span class="literal">null</span>;</span><br><span class="line"><span class="built_in">console</span>.log(refA, <span class="string">&#x27;refA&#x27;</span>); <span class="comment">// 解除引用</span></span><br></pre></td></tr></table></figure>
<p>包括使用事件监听<code>addEventListener</code>监听的时候，在不监听的情况下使用<code>removeEventListener</code>取消对事件监听</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="http://www.ruanyifeng.com/blog/2017/04/memory-leak.html">http://www.ruanyifeng.com/blog/2017/04/memory-leak.html</a></li>
<li><a href="https://zh.wikipedia.org/wiki">https://zh.wikipedia.org/wiki</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>memory_leak</tag>
      </tags>
  </entry>
  <entry>
    <title>less_12px</title>
    <url>/archives/30b90bc0.html</url>
    <content><![CDATA[<h1 id="面试官：让Chrome支持小于12px-的文字方式有哪些？区别？"><a href="#面试官：让Chrome支持小于12px-的文字方式有哪些？区别？" class="headerlink" title="面试官：让Chrome支持小于12px 的文字方式有哪些？区别？"></a>面试官：让Chrome支持小于12px 的文字方式有哪些？区别？</h1><p><img src="https://static.vue-js.com/62945fd0-a334-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h2><p>Chrome 中文版浏览器会默认设定页面的最小字号是12px，英文版没有限制</p>
<p>原由 Chrome 团队认为汉字小于12px就会增加识别难度</p>
<ul>
<li>中文版浏览器</li>
</ul>
<p>与网页语言无关，取决于用户在Chrome的设置里（chrome://settings/languages）把哪种语言设置为默认显示语言</p>
<ul>
<li>系统级最小字号</li>
</ul>
<p>浏览器默认设定页面的最小字号，用户可以前往 chrome://settings/fonts 根据需求更改</p>
<p>而我们在实际项目中，不能奢求用户更改浏览器设置</p>
<p>对于文本需要以更小的字号来显示，就需要用到一些小技巧</p>
<h2 id="二、解决方案"><a href="#二、解决方案" class="headerlink" title="二、解决方案"></a>二、解决方案</h2><p>常见的解决方案有：</p>
<ul>
<li>zoom</li>
<li>-webkit-transform:scale()</li>
<li>-webkit-text-size-adjust:none</li>
</ul>
<h3 id="Zoom"><a href="#Zoom" class="headerlink" title="Zoom"></a>Zoom</h3><p><code>zoom</code> 的字面意思是“变焦”，可以改变页面上元素的尺寸，属于真实尺寸</p>
<p>其支持的值类型有：</p>
<ul>
<li>zoom:50%，表示缩小到原来的一半</li>
<li>zoom:0.5，表示缩小到原来的一半</li>
</ul>
<p>使用 <code>zoom</code> 来”支持“ 12px 以下的字体</p>
<p>代码如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.span1</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="css">        zoom: <span class="number">0.8</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.span2</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;span1&quot;</span>&gt;</span>测试10px<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;span2&quot;</span>&gt;</span>测试12px<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p> <img src="https://static.vue-js.com/d5243980-a334-11eb-ab90-d9ae814b240d.png" alt=""></p>
<blockquote>
<p>需要注意的是，<code>Zoom</code> 并不是标准属性，需要考虑其兼容性</p>
</blockquote>
<p> <img src="https://static.vue-js.com/3defe3c0-a343-11eb-85f6-6fac77c0c9b3.png" alt="image.png"></p>
<h3 id="webkit-transform-scale"><a href="#webkit-transform-scale" class="headerlink" title="-webkit-transform:scale()"></a>-webkit-transform:scale()</h3><p>针对<code>chrome</code>浏览器,加<code>webkit</code>前缀，用<code>transform:scale()</code>这个属性进行放缩</p>
<p>注意的是，使用<code>scale</code>属性只对可以定义宽高的元素生效，所以，下面代码中将<code>span</code>元素转为行内块元素</p>
<p>实现代码如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.span1</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="css">        -webkit-<span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">0.8</span>);</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.span2</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;span1&quot;</span>&gt;</span>测试10px<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;span2&quot;</span>&gt;</span>测试12px<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p> <img src="https://static.vue-js.com/d5243980-a334-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="webkit-text-size-adjust-none"><a href="#webkit-text-size-adjust-none" class="headerlink" title="-webkit-text-size-adjust:none"></a>-webkit-text-size-adjust:none</h3><p>该属性用来设定文字大小是否根据设备(浏览器)来自动调整显示大小</p>
<p>属性值：</p>
<ul>
<li>percentage：字体显示的大小；</li>
<li>auto：默认，字体大小会根据设备/浏览器来自动调整；</li>
<li>none:字体大小不会自动调整</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123; -webkit-text-size-adjust: none; &#125;</span><br></pre></td></tr></table></figure>
<p>这样设置之后会有一个问题，就是当你放大网页时，一般情况下字体也会随着变大，而设置了以上代码后，字体只会显示你当前设置的字体大小，不会随着网页放大而变大了</p>
<p>所以，我们不建议全局应用该属性，而是单独对某一属性使用</p>
<blockquote>
<p>需要注意的是，自从<code>chrome 27</code>之后，就取消了对这个属性的支持。同时，该属性只对英文、数字生效，对中文不生效</p>
</blockquote>
<h2 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h2><p><code>Zoom</code> 非标属性，有兼容问题，缩放会改变了元素占据的空间大小，触发重排</p>
<p><code>-webkit-transform:scale()</code> 大部分现代浏览器支持，并且对英文、数字、中文也能够生效，缩放不会改变了元素占据的空间大小，页面布局不会发生变化</p>
<p><code>-webkit-text-size-adjust</code>对谷歌浏览器有版本要求，在27之后，就取消了该属性的支持，并且只对英文、数字生效</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/text-size-adjust">https://developer.mozilla.org/zh-CN/docs/Web/CSS/text-size-adjust</a></li>
<li><a href="https://vue3js.cn/interview">https://vue3js.cn/interview</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>less_12px</tag>
      </tags>
  </entry>
  <entry>
    <title>my-carousel</title>
    <url>/archives/f1d0391c.html</url>
    <content><![CDATA[<div class="tip ban faa-flash animated-hover"><p>my -carousel</p>
</div>
<ol>
<li><psw>啊哈，我是不会告诉你切换黑夜模式有惊喜的，你咬我呀</psw>
</li>
</ol>
<div id='[mycarouselr] ' class='carousel'><div id="[mycarouselr] -drag-container" class="drag-container"><div id="[mycarouselr] -spin-container" class="spin-container"><img src="/img/12.png" alt=""><br><img src="/img/17.png" alt=""><br><img src="/img/18.png" alt=""><br><img src="/img/10.png" alt=""><br><img src="/img/30.png" alt=""><br><img src="/img/35.png" alt=""><br><img src="/img/36.png" alt=""><br><img src="/img/42.png" alt=""><br><img src="/img/54.png" alt=""><br><img src="/img/449.png" alt=""><p> [别动我，我可是有脾气的]</p></div><div id="[mycarouselr] -carousel-ground" class="carousel-ground"></div></div></div><script type="text/javascript">carouselinit('[mycarouselr] ');</script>]]></content>
      <categories>
        <category>fine</category>
      </categories>
      <tags>
        <tag>fine</tag>
        <tag>my-carousel</tag>
      </tags>
  </entry>
  <entry>
    <title>modal_component</title>
    <url>/archives/7331f3bb.html</url>
    <content><![CDATA[<h1 id="面试官：用Vue3-0-写过组件吗？如果想实现一个-Modal你会怎么设计？"><a href="#面试官：用Vue3-0-写过组件吗？如果想实现一个-Modal你会怎么设计？" class="headerlink" title="面试官：用Vue3.0 写过组件吗？如果想实现一个 Modal你会怎么设计？"></a>面试官：用Vue3.0 写过组件吗？如果想实现一个 Modal你会怎么设计？</h1><p> <img src="https://static.vue-js.com/e294c660-6370-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、组件设计"><a href="#一、组件设计" class="headerlink" title="一、组件设计"></a>一、组件设计</h2><p>组件就是把图形、非图形的各种逻辑均抽象为一个统一的概念（组件）来实现开发的模式</p>
<p>现在有一个场景，点击新增与编辑都弹框出来进行填写，功能上大同小异，可能只是标题内容或者是显示的主体内容稍微不同</p>
<p>这时候就没必要写两个组件，只需要根据传入的参数不同，组件显示不同内容即可</p>
<p>这样，下次开发相同界面程序时就可以写更少的代码，意义着更高的开发效率，更少的 <code>Bug</code>和更少的程序体积</p>
<h2 id="二、需求分析"><a href="#二、需求分析" class="headerlink" title="二、需求分析"></a>二、需求分析</h2><p>实现一个<code>Modal</code>组件，首先确定需要完成的内容：</p>
<ul>
<li><p>遮罩层</p>
</li>
<li><p>标题内容</p>
</li>
<li>主体内容</li>
<li>确定和取消按钮</li>
</ul>
<p>主体内容需要灵活，所以可以是字符串，也可以是一段 <code>html</code> 代码</p>
<p>特点是它们在当前<code>vue</code>实例之外独立存在，通常挂载于<code>body</code>之上</p>
<p>除了通过引入<code>import</code>的形式，我们还可通过<code>API</code>的形式进行组件的调用</p>
<p>还可以包括配置全局样式、国际化、与<code>typeScript</code>结合</p>
<h2 id="三、实现流程"><a href="#三、实现流程" class="headerlink" title="三、实现流程"></a>三、实现流程</h2><p>首先看看大致流程：</p>
<ul>
<li>目录结构</li>
<li>组件内容</li>
<li>实现 API 形式</li>
<li><p>事件处理</p>
</li>
<li><p>其他完善</p>
</li>
</ul>
<h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><p><code>Modal</code>组件相关的目录结构</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">├── plugins</span><br><span class="line">│   └── modal</span><br><span class="line">│       ├── Content.tsx // 维护 Modal 的内容，用于 h 函数和 jsx 语法</span><br><span class="line">│       ├── Modal.vue // 基础组件</span><br><span class="line">│       ├── config.ts // 全局默认配置</span><br><span class="line">│       ├── index.ts // 入口</span><br><span class="line">│       ├── locale // 国际化相关</span><br><span class="line">│       │   ├── index.ts</span><br><span class="line">│       │   └── lang</span><br><span class="line">│       │       ├── en-US.ts</span><br><span class="line">│       │       ├── zh-CN.ts</span><br><span class="line">│       │       └── zh-TW.ts</span><br><span class="line">│       └── modal.type.ts // ts类型声明相关</span><br></pre></td></tr></table></figure>
<p>因为 Modal 会被 <code>app.use(Modal)</code> 调用作为一个插件，所以都放在<code>plugins</code>目录下</p>
<h3 id="组件内容"><a href="#组件内容" class="headerlink" title="组件内容"></a>组件内容</h3><p>首先实现<code>modal.vue</code>的主体显示内容大致如下</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Teleport</span> <span class="attr">to</span>=<span class="string">&quot;body&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;!isTeleport&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;modelValue&quot;</span> <span class="attr">class</span>=<span class="string">&quot;modal&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">&quot;mask&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">:style</span>=<span class="string">&quot;style&quot;</span></span></span><br><span class="line"><span class="tag">             @<span class="attr">click</span>=<span class="string">&quot;maskClose &amp;&amp; !loading &amp;&amp; handleCancel()&quot;</span></span></span><br><span class="line"><span class="tag">             &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal__main&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal__title line line--b&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; title || t(&quot;r.title&quot;) &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">v-if</span>=<span class="string">&quot;close&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">:title</span>=<span class="string">&quot;t(&#x27;r.close&#x27;)&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;close&quot;</span></span></span><br><span class="line"><span class="tag">                      @<span class="attr">click</span>=<span class="string">&quot;!loading &amp;&amp; handleCancel()&quot;</span></span></span><br><span class="line"><span class="tag">                      &gt;</span>✕&lt;/span</span><br><span class="line">                    &gt;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal__content&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Content</span> <span class="attr">v-if</span>=<span class="string">&quot;typeof content === &#x27;function&#x27;&quot;</span> <span class="attr">:render</span>=<span class="string">&quot;content&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">slot</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">                    &#123;&#123; content &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal__btns line line--t&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">:disabled</span>=<span class="string">&quot;loading&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleConfirm&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;loading&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;loading&quot;</span>&gt;</span> ❍ <span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#123;&#123; t(&quot;r.confirm&quot;) &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;!loading &amp;&amp; handleCancel()&quot;</span>&gt;</span></span><br><span class="line">                    &#123;&#123; t(&quot;r.cancel&quot;) &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Teleport</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>最外层上通过Vue3 <code>Teleport</code> 内置组件进行包裹，其相当于传送门，将里面的内容传送至<code>body</code>之上</p>
<p>并且从<code>DOM</code>结构上来看，把<code>modal</code>该有的内容（遮罩层、标题、内容、底部按钮）都实现了</p>
<p>关于主体内容</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal__content&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Content</span> <span class="attr">v-if</span>=<span class="string">&quot;typeof content===&#x27;function&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">:render</span>=<span class="string">&quot;content&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">        &#123;&#123;content&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以看到根据传入<code>content</code>的类型不同，对应显示不同得到内容</p>
<p>最常见的则是通过调用字符串和默认插槽的形式</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">// 默认插槽</span><br><span class="line"><span class="tag">&lt;<span class="name">Modal</span> <span class="attr">v-model</span>=<span class="string">&quot;show&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">title</span>=<span class="string">&quot;演示 slot&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>hello world~<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Modal</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 字符串</span><br><span class="line"><span class="tag">&lt;<span class="name">Modal</span> <span class="attr">v-model</span>=<span class="string">&quot;show&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">title</span>=<span class="string">&quot;演示 content&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">content</span>=<span class="string">&quot;hello world~&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>通过 API 形式调用<code>Modal</code>组件的时候，<code>content</code>可以使用下面两种</p>
<ul>
<li>h 函数</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$modal.show(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;演示 h 函数&#x27;</span>,</span><br><span class="line">  <span class="function"><span class="title">content</span>(<span class="params">h</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> h(</span><br><span class="line">      <span class="string">&#x27;div&#x27;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">style</span>: <span class="string">&#x27;color:red;&#x27;</span>,</span><br><span class="line">        <span class="attr">onClick</span>: <span class="function">(<span class="params">$event: Event</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;clicked&#x27;</span>, $event.target)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&#x27;hello world ~&#x27;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>JSX</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$modal.show(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;演示 jsx 语法&#x27;</span>,</span><br><span class="line">  <span class="function"><span class="title">content</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">        <span class="attr">onClick</span>=<span class="string">&#123;($event:</span> <span class="attr">Event</span>) =&gt;</span> console.log(&#x27;clicked&#x27;, $event.target)&#125;</span></span><br><span class="line"><span class="xml">      &gt;</span></span><br><span class="line"><span class="xml">        hello world ~</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="实现-API-形式"><a href="#实现-API-形式" class="headerlink" title="实现 API 形式"></a>实现 API 形式</h3><p>那么组件如何实现<code>API</code>形式调用<code>Modal</code>组件呢？</p>
<p>在<code>Vue2</code>中，我们可以借助<code>Vue</code>实例以及<code>Vue.extend</code>的方式获得组件实例，然后挂载到<code>body</code>上</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Modal <span class="keyword">from</span> <span class="string">&#x27;./Modal.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> ComponentClass = Vue.extend(Modal);</span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> ComponentClass(&#123; <span class="attr">el</span>: <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>) &#125;);</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(instance.$el);</span><br></pre></td></tr></table></figure>
<p>虽然<code>Vue3</code>移除了<code>Vue.extend</code>方法，但可以通过<code>createVNode</code>实现</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Modal <span class="keyword">from</span> <span class="string">&#x27;./Modal.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> container = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> vnode = createVNode(Modal);</span><br><span class="line">render(vnode, container);</span><br><span class="line"><span class="keyword">const</span> instance = vnode.component;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(container);</span><br></pre></td></tr></table></figure>
<p>在<code>Vue2</code>中，可以通过<code>this</code>的形式调用全局 API</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="function"><span class="title">install</span>(<span class="params">vue</span>)</span> &#123;</span><br><span class="line">       vue.prototype.$create = create</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>而在 Vue3 的 <code>setup</code> 中已经没有 <code>this</code>概念了，需要调用<code>app.config.globalProperties</code>挂载到全局</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="function"><span class="title">install</span>(<span class="params">app</span>)</span> &#123;</span><br><span class="line">        app.config.globalProperties.$create = create</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h3><p>下面再看看看<code>Modal</code>组件内部是如何处理「确定」「取消」事件的，既然是<code>Vue3</code>，当然采用<code>Compositon API</code> 形式</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Modal.vue</span></span><br><span class="line"><span class="function"><span class="title">setup</span>(<span class="params">props, ctx</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> instance = getCurrentInstance(); <span class="comment">// 获得当前组件实例</span></span><br><span class="line">  onBeforeMount(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    instance._hub = &#123;</span><br><span class="line">      <span class="string">&#x27;on-cancel&#x27;</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">      <span class="string">&#x27;on-confirm&#x27;</span>: <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> handleConfirm = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    ctx.emit(<span class="string">&#x27;on-confirm&#x27;</span>);</span><br><span class="line">    instance._hub[<span class="string">&#x27;on-confirm&#x27;</span>]();</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> handleCancel = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    ctx.emit(<span class="string">&#x27;on-cancel&#x27;</span>);</span><br><span class="line">    ctx.emit(<span class="string">&#x27;update:modelValue&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line">    instance._hub[<span class="string">&#x27;on-cancel&#x27;</span>]();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    handleConfirm,</span><br><span class="line">    handleCancel</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在上面代码中，可以看得到除了使用传统<code>emit</code>的形式使父组件监听，还可通过<code>_hub</code>属性中添加 <code>on-cancel</code>，<code>on-confirm</code>方法实现在<code>API</code>中进行监听</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">app.config.globalProperties.$modal = &#123;</span><br><span class="line">   <span class="function"><span class="title">show</span>(<span class="params">&#123;&#125;</span>)</span> &#123;</span><br><span class="line">     <span class="comment">/* 监听 确定、取消 事件 */</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面再来目睹下<code>_hub</code>是如何实现</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line">app.config.globalProperties.$modal = &#123;</span><br><span class="line">    <span class="function"><span class="title">show</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="regexp">/* 其他选项 */</span></span></span></span><br><span class="line"><span class="params"><span class="function">        onConfirm,</span></span></span><br><span class="line"><span class="params"><span class="function">        onCancel</span></span></span><br><span class="line"><span class="params"><span class="function">    &#125;</span>)</span> &#123;</span><br><span class="line">        <span class="comment">/* ... */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> &#123; props, _hub &#125; = instance;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> _closeModal = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            props.modelValue = <span class="literal">false</span>;</span><br><span class="line">            container.parentNode!.removeChild(container);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 往 _hub 新增事件的具体实现</span></span><br><span class="line">        <span class="built_in">Object</span>.assign(_hub, &#123;</span><br><span class="line">            <span class="keyword">async</span> <span class="string">&#x27;on-confirm&#x27;</span>() &#123;</span><br><span class="line">            <span class="keyword">if</span> (onConfirm) &#123;</span><br><span class="line">                <span class="keyword">const</span> fn = onConfirm();</span><br><span class="line">                <span class="comment">// 当方法返回为 Promise</span></span><br><span class="line">                <span class="keyword">if</span> (fn &amp;&amp; fn.then) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        props.loading = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">await</span> fn;</span><br><span class="line">                        props.loading = <span class="literal">false</span>;</span><br><span class="line">                        _closeModal();</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                        <span class="comment">// 发生错误时，不关闭弹框</span></span><br><span class="line">                        <span class="built_in">console</span>.error(err);</span><br><span class="line">                        props.loading = <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    _closeModal();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                _closeModal();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">            <span class="string">&#x27;on-cancel&#x27;</span>() &#123;</span><br><span class="line">                onCancel &amp;&amp; onCancel();</span><br><span class="line">                _closeModal();</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue3</category>
      </categories>
      <tags>
        <tag>vue3</tag>
        <tag>modal_component</tag>
      </tags>
  </entry>
  <entry>
    <title>me</title>
    <url>/archives/ac5292c2.html</url>
    <content><![CDATA[<p>
  <span class='green'>me -</span>
</p>


<ul>
<li>·叫 freelaeder，不胖不宅。</li>
<li>·性别男，喜欢喝椰子，(感觉不喝椰子的人，长不高，真的！)</li>
<li>·身高在蜘蛛侠和绿巨人之间</li>
<li>·平时喜欢哒哒bug，这大概就是一种莫名的快乐</li>
</ul>
<p>
  <span class='purp'>her -</span>
</p>

<ul>
<li>・很漂亮，爱喝奶茶</li>
<li>・古灵精怪，总能让人感到意外</li>
<li>・一定要爱着什么，恰似草木对光阴的钟情</li>
</ul>
<p>
  <span class='purps'>his -</span>
</p>

<ul>
<li>有傻狍子，有快乐，有 bug</li>
<li>有掉不完的头发，有 困顿</li>
<li>有空多联系~</li>
</ul>
<p>
  <span class='wram'>写在最后 -</span>
</p>

<ul>
<li>暂不添加留言板，哎，我就是玩</li>
<li>qq：2590131280</li>
<li>人生是如此简单，而又是这般辉煌</li>
</ul>
]]></content>
      <tags>
        <tag>me</tag>
      </tags>
  </entry>
  <entry>
    <title>module</title>
    <url>/archives/c242628.html</url>
    <content><![CDATA[<h1 id="面试官：你是怎么理解ES6中Module的？使用场景？"><a href="#面试官：你是怎么理解ES6中Module的？使用场景？" class="headerlink" title="面试官：你是怎么理解ES6中Module的？使用场景？"></a>面试官：你是怎么理解ES6中Module的？使用场景？</h1><p> <img src="https://static.vue-js.com/b6d19be0-5adb-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h2><p>模块，（Module），是能够单独命名并独立地完成一定功能的程序语句的<strong>集合（即程序代码和数据结构的集合体）</strong>。</p>
<p>两个基本的特征：外部特征和内部特征</p>
<ul>
<li><p>外部特征是指模块跟外部环境联系的接口（即其他模块或程序调用该模块的方式，包括有输入输出参数、引用的全局变量）和模块的功能</p>
</li>
<li><p>内部特征是指模块的内部环境具有的特点（即该模块的局部数据和程序代码）</p>
</li>
</ul>
<h3 id="为什么需要模块化"><a href="#为什么需要模块化" class="headerlink" title="为什么需要模块化"></a>为什么需要模块化</h3><ul>
<li>代码抽象</li>
<li>代码封装</li>
<li>代码复用</li>
<li>依赖管理</li>
</ul>
<p>如果没有模块化，我们代码会怎样？</p>
<ul>
<li>变量和方法不容易维护，容易污染全局作用域</li>
<li>加载资源的方式通过script标签从上到下。</li>
<li>依赖的环境主观逻辑偏重，代码较多就会比较复杂。</li>
<li>大型项目资源难以维护，特别是多人合作的情况下，资源的引入会让人奔溃</li>
</ul>
<p>因此，需要一种将<code>JavaScript</code>程序模块化的机制，如</p>
<ul>
<li>CommonJs (典型代表：node.js早期)</li>
<li>AMD (典型代表：require.js)</li>
<li>CMD (典型代表：sea.js)</li>
</ul>
<h3 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h3><p><code>Asynchronous ModuleDefinition</code>（AMD），异步模块定义，采用异步方式加载模块。所有依赖模块的语句，都定义在一个回调函数中，等到模块加载完成之后，这个回调函数才会运行</p>
<p>代表库为<code>require.js</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** main.js 入口文件/主模块 **/</span></span><br><span class="line"><span class="comment">// 首先用config()指定各模块路径和引用名</span></span><br><span class="line"><span class="built_in">require</span>.config(&#123;</span><br><span class="line">  <span class="attr">baseUrl</span>: <span class="string">&quot;js/lib&quot;</span>,</span><br><span class="line">  <span class="attr">paths</span>: &#123;</span><br><span class="line">    <span class="string">&quot;jquery&quot;</span>: <span class="string">&quot;jquery.min&quot;</span>,  <span class="comment">//实际路径为js/lib/jquery.min.js</span></span><br><span class="line">    <span class="string">&quot;underscore&quot;</span>: <span class="string">&quot;underscore.min&quot;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 执行基本操作</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">&quot;jquery&quot;</span>,<span class="string">&quot;underscore&quot;</span>],<span class="function"><span class="keyword">function</span>(<span class="params">$,_</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// some code here</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="CommonJs"><a href="#CommonJs" class="headerlink" title="CommonJs"></a>CommonJs</h3><p><code>CommonJS</code> 是一套 <code>Javascript</code> 模块规范，用于服务端</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// a.js</span></span><br><span class="line"><span class="built_in">module</span>.exports=&#123; foo , bar&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// b.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; foo,bar &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./a.js&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>其有如下特点：</p>
<ul>
<li>所有代码都运行在模块作用域，不会污染全局作用域</li>
<li>模块是同步加载的，即只有加载完成，才能执行后面的操作</li>
<li>模块在首次执行后就会缓存，再次加载只返回缓存结果，如果想要再次执行，可清除缓存</li>
<li><code>require</code>返回的值是被输出的值的拷贝，模块内部的变化也不会影响这个值</li>
</ul>
<p>既然存在了<code>AMD</code>以及<code>CommonJs</code>机制，<code>ES6</code>的<code>Module</code>又有什么不一样？</p>
<p>ES6 在语言标准的层面上，实现了<code>Module</code>，即模块功能，完全可以取代 <code>CommonJS</code>和 <code>AMD</code>规范，成为浏览器和服务器通用的模块解决方案</p>
<p><code>CommonJS</code> 和<code>AMD</code> 模块，都只能在运行时确定这些东西。比如，<code>CommonJS</code>模块就是对象，输入时必须查找对象属性</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// CommonJS模块</span></span><br><span class="line"><span class="keyword">let</span> &#123; stat, exists, readfile &#125; = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">let</span> _fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> stat = _fs.stat;</span><br><span class="line"><span class="keyword">let</span> exists = _fs.exists;</span><br><span class="line"><span class="keyword">let</span> readfile = _fs.readfile;</span><br></pre></td></tr></table></figure>
<p><code>ES6</code>设计思想是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ES6模块</span></span><br><span class="line"><span class="keyword">import</span> &#123; stat, exists, readFile &#125; <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>上述代码，只加载3个方法，其他方法不加载，即 <code>ES6</code> 可以在编译时就完成模块加载</p>
<p>由于编译加载，使得静态分析成为可能。包括现在流行的<code>typeScript</code>也是依靠静态分析实现功能</p>
<h2 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h2><p><code>ES6</code>模块内部自动采用了严格模式，这里就不展开严格模式的限制，毕竟这是<code>ES5</code>之前就已经规定好</p>
<p>模块功能主要由两个命令构成：</p>
<ul>
<li><code>export</code>：用于规定模块的对外接口</li>
<li><code>import</code>：用于输入其他模块提供的功能</li>
</ul>
<h3 id="export"><a href="#export" class="headerlink" title="export"></a>export</h3><p>一个模块就是一个独立的文件，该文件内部的所有变量，外部无法获取。如果你希望外部能够读取模块内部的某个变量，就必须使用<code>export</code>关键字输出该变量</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// profile.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> firstName = <span class="string">&#x27;Michael&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> lastName = <span class="string">&#x27;Jackson&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> year = <span class="number">1958</span>;</span><br><span class="line"></span><br><span class="line">或 </span><br><span class="line"><span class="comment">// 建议使用下面写法，这样能瞬间确定输出了哪些变量</span></span><br><span class="line"><span class="keyword">var</span> firstName = <span class="string">&#x27;Michael&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> lastName = <span class="string">&#x27;Jackson&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> year = <span class="number">1958</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; firstName, lastName, year &#125;;</span><br></pre></td></tr></table></figure>
<p>输出函数或类</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">multiply</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>通过<code>as</code>可以进行输出变量的重命名</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">v1</span>(<span class="params"></span>) </span>&#123; ... &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">v2</span>(<span class="params"></span>) </span>&#123; ... &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  v1 <span class="keyword">as</span> streamV1,</span><br><span class="line">  v2 <span class="keyword">as</span> streamV2,</span><br><span class="line">  v2 <span class="keyword">as</span> streamLatestVersion</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><p>使用<code>export</code>命令定义了模块的对外接口以后，其他 JS 文件就可以通过<code>import</code>命令加载这个模块</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; firstName, lastName, year &#125; <span class="keyword">from</span> <span class="string">&#x27;./profile.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setName</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">  element.textContent = firstName + <span class="string">&#x27; &#x27;</span> + lastName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同样如果想要输入变量起别名，通过<code>as</code>关键字</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; lastName <span class="keyword">as</span> surname &#125; <span class="keyword">from</span> <span class="string">&#x27;./profile.js&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>当加载整个模块的时候，需要用到星号<code>*</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// circle.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">area</span>(<span class="params">radius</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.PI * radius * radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">circumference</span>(<span class="params">radius</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">2</span> * <span class="built_in">Math</span>.PI * radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> circle <span class="keyword">from</span> <span class="string">&#x27;./circle&#x27;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(circle)   <span class="comment">// &#123;area:area,circumference:circumference&#125;</span></span><br></pre></td></tr></table></figure>
<p>输入的变量都是只读的，不允许修改，但是如果是对象，允许修改属性</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;a&#125; <span class="keyword">from</span> <span class="string">&#x27;./xxx.js&#x27;</span></span><br><span class="line"></span><br><span class="line">a.foo = <span class="string">&#x27;hello&#x27;</span>; <span class="comment">// 合法操作</span></span><br><span class="line">a = &#123;&#125;; <span class="comment">// Syntax Error : &#x27;a&#x27; is read-only;</span></span><br></pre></td></tr></table></figure>
<p>不过建议即使能修改，但我们不建议。因为修改之后，我们很难差错</p>
<p><code>import</code>后面我们常接着<code>from</code>关键字，<code>from</code>指定模块文件的位置，可以是相对路径，也可以是绝对路径</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; a &#125; <span class="keyword">from</span> <span class="string">&#x27;./a&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>如果只有一个模块名，需要有配置文件，告诉引擎模块的位置</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; myMethod &#125; <span class="keyword">from</span> <span class="string">&#x27;util&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>在编译阶段，<code>import</code>会提升到整个模块的头部，首先执行</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">foo();</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>多次重复执行同样的导入，只会执行一次</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;lodash&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;lodash&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>上面的情况，大家都能看到用户在导入模块的时候，需要知道加载的变量名和函数，否则无法加载</p>
<p>如果不需要知道变量名或函数就完成加载，就要用到<code>export default</code>命令，为模块指定默认输出</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// export-default.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>加载该模块的时候，<code>import</code>命令可以为该函数指定任意名字</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// import-default.js</span></span><br><span class="line"><span class="keyword">import</span> customName <span class="keyword">from</span> <span class="string">&#x27;./export-default&#x27;</span>;</span><br><span class="line">customName(); <span class="comment">// &#x27;foo&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="动态加载"><a href="#动态加载" class="headerlink" title="动态加载"></a>动态加载</h3><p>允许您仅在需要时动态加载模块，而不必预先加载所有模块，这存在明显的性能优势</p>
<p>这个新功能允许您将<code>import()</code>作为函数调用，将其作为参数传递给模块的路径。 它返回一个 <code>promise</code>，它用一个模块对象来实现，让你可以访问该对象的导出</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">&#x27;/modules/myModule.mjs&#x27;</span>)</span><br><span class="line">  .then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Do something with the module.</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="复合写法"><a href="#复合写法" class="headerlink" title="复合写法"></a>复合写法</h3><p>如果在一个模块之中，先输入后输出同一个模块，<code>import</code>语句可以与<code>export</code>语句写在一起</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; foo, bar &#125; <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以简单理解为</span></span><br><span class="line"><span class="keyword">import</span> &#123; foo, bar &#125; <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; foo, bar &#125;;</span><br></pre></td></tr></table></figure>
<p>同理能够搭配<code>as</code>、<code>*</code>搭配使用</p>
<h2 id="三、使用场景"><a href="#三、使用场景" class="headerlink" title="三、使用场景"></a>三、使用场景</h2><p>如今，<code>ES6</code>模块化已经深入我们日常项目开发中，像<code>vue</code>、<code>react</code>项目搭建项目，组件化开发处处可见，其也是依赖模块化实现</p>
<p><code>vue</code>组件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      组件化开发 ---- 模块化</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="attr">name</span>: <span class="string">&#x27;HelloWorld&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="attr">props</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">msg</span>: <span class="built_in">String</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p><code>react</code>组件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">		组件化开发 ---- 模块化</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure>
<p>包括完成一些复杂应用的时候，我们也可以拆分成各个模块</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://macsalvation.net/the-history-of-js-module/">https://macsalvation.net/the-history-of-js-module/</a></li>
<li><a href="https://es6.ruanyifeng.com/#docs/module">https://es6.ruanyifeng.com/#docs/module</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>es6</tag>
        <tag>module</tag>
      </tags>
  </entry>
  <entry>
    <title>new</title>
    <url>/archives/6be34445.html</url>
    <content><![CDATA[<h1 id="面试官：说说new操作符具体干了什么？"><a href="#面试官：说说new操作符具体干了什么？" class="headerlink" title="面试官：说说new操作符具体干了什么？"></a>面试官：说说new操作符具体干了什么？</h1><p><img src="https://static.vue-js.com/880d0010-7a39-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>在<code>JavaScript</code>中，<code>new</code>操作符用于创建一个给定构造函数的实例对象</p>
<p>例子<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> person1 = <span class="keyword">new</span> Person(<span class="string">&#x27;Tom&#x27;</span>, <span class="number">20</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person1)  <span class="comment">// Person &#123;name: &quot;Tom&quot;, age: 20&#125;</span></span><br><span class="line">t.sayName() <span class="comment">// &#x27;Tom&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p>从上面可以看到：</p>
<ul>
<li><code>new</code> 通过构造函数 <code>Person</code> 创建出来的实例可以访问到构造函数中的属性</li>
<li><code>new</code> 通过构造函数 <code>Person</code> 创建出来的实例可以访问到构造函数原型链中的属性（即实例与构造函数通过原型链连接了起来）</li>
</ul>
<p>现在在构建函数中显式加上返回值，并且这个返回值是一个原始类型</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> t = <span class="keyword">new</span> Test(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(t.name) <span class="comment">// &#x27;xxx&#x27;</span></span><br></pre></td></tr></table></figure>
<p>可以发现，构造函数中返回一个原始值，然而这个返回值并没有作用</p>
<p>下面在构造函数中返回一个对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>) <span class="comment">// Test &#123; name: &#x27;xxx&#x27; &#125;</span></span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">age</span>: <span class="number">26</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> t = <span class="keyword">new</span> Test(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(t) <span class="comment">// &#123; age: 26 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(t.name) <span class="comment">// &#x27;undefined&#x27;</span></span><br></pre></td></tr></table></figure>
<p>从上面可以发现，构造函数如果返回值为一个对象，那么这个返回值会被正常使用</p>
<h2 id="二、流程"><a href="#二、流程" class="headerlink" title="二、流程"></a>二、流程</h2><p>从上面介绍中，我们可以看到<code>new</code>关键字主要做了以下的工作：</p>
<ul>
<li>创建一个新的对象<code>obj</code></li>
<li>将对象与构建函数通过原型链连接起来</li>
<li><p>将构建函数中的<code>this</code>绑定到新建的对象<code>obj</code>上</p>
</li>
<li><p>根据构建函数返回类型作判断，如果是原始值则被忽略，如果是返回对象，需要正常处理</p>
</li>
</ul>
<p>举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> person1 = <span class="keyword">new</span> Person(<span class="string">&#x27;Tom&#x27;</span>, <span class="number">20</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person1)  <span class="comment">// Person &#123;name: &quot;Tom&quot;, age: 20&#125;</span></span><br><span class="line">t.sayName() <span class="comment">// &#x27;Tom&#x27;</span></span><br></pre></td></tr></table></figure>
<p>流程图如下：</p>
<p> <img src="https://static.vue-js.com/b429b990-7a39-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="三、手写new操作符"><a href="#三、手写new操作符" class="headerlink" title="三、手写new操作符"></a>三、手写new操作符</h2><p>现在我们已经清楚地掌握了<code>new</code>的执行过程</p>
<p>那么我们就动手来实现一下<code>new</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mynew</span>(<span class="params">Func, ...args</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 1.创建一个新对象</span></span><br><span class="line">    <span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line">    <span class="comment">// 2.新对象原型指向构造函数原型对象</span></span><br><span class="line">    obj.__proto__ = Func.prototype</span><br><span class="line">    <span class="comment">// 3.将构建函数的this指向新对象</span></span><br><span class="line">    <span class="keyword">let</span> result = Func.apply(obj, args)</span><br><span class="line">    <span class="comment">// 4.根据返回值判断</span></span><br><span class="line">    <span class="keyword">return</span> result <span class="keyword">instanceof</span> <span class="built_in">Object</span> ? result : obj</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试一下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mynew</span>(<span class="params">func, ...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line">    obj.__proto__ = func.prototype</span><br><span class="line">    <span class="keyword">let</span> result = func.apply(obj, args)</span><br><span class="line">    <span class="keyword">return</span> result <span class="keyword">instanceof</span> <span class="built_in">Object</span> ? result : obj</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.say = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p = mynew(Person, <span class="string">&quot;huihui&quot;</span>, <span class="number">123</span>)</span><br><span class="line"><span class="built_in">console</span>.log(p) <span class="comment">// Person &#123;name: &quot;huihui&quot;, age: 123&#125;</span></span><br><span class="line">p.say() <span class="comment">// huihui</span></span><br></pre></td></tr></table></figure>
<p>可以发现，代码虽然很短，但是能够模拟实现<code>new</code></p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>new</tag>
      </tags>
  </entry>
  <entry>
    <title>node</title>
    <url>/archives/857fe845.html</url>
    <content><![CDATA[<p>你好</p>
<p> node.js是什么？</p>
<ul>
<li>node.js不是一门语言，不是库，不是框架，node.js是一个运行javaScript运行时的环境。</li>
<li>node.js没有Bom，Dom；</li>
<li>作用：文件读写，网络服务的构建，网络通信，HTTP服务器等</li>
<li><p>特性：event.driven事件驱动，ligtweight and efficient 轻量和高效，non-blocking I/o非阻塞io模型</p>
<p>浏览器中的JavaScript组成</p>
</li>
<li>Chrome 浏览器 =&gt; V8 </li>
<li>Firefox 浏览器=&gt; OdinMonkey(奥丁猴)</li>
<li>Safri 浏览器=&gt; JSCore</li>
<li>IE 浏览器=&gt; Chakra(查克拉) </li>
<li><p>etc… 其中，Chrome 浏览器的 V8 解析引擎性能最好! </p>
<p>注意</p>
</li>
<li>运行环境，指 代码能够正常执行，所必须的条件浏览器，就是 JS 代码的 运行环境。（包括解析引擎、窗口显示结果……）脱离运行环境，JS 代码将会失去作用。</li>
<li>浏览器运行环境中，能够执行的 JS 代码包括（ECMAScript、WebAPI）ECMAScript 肯定能够运行，因为它是核心语法<br>WebAPI 是浏览器环境特有的，只能在浏览器环境中才能使用。</li>
</ul>
<hr>
<ul>
<li><em>交互模式(了解)</em> </li>
<li>REPL(Read-Eval -Print-Loop)交互模式指的是在终端窗口中，执行简单的JavaScript代码</li>
<li>操作步骤：打开任意终端，直接输入 node 命令并回车执行你的JS代码，按回车表示执行按两次“Ctrl+C”退出</li>
<li>只适合少量js代码<br>[tag type=”success” outline=”1”]脚本模式(重要哦)[/tag]</li>
<li>如果有大段的JS代码需要在Node环境中运行，可以把JS代码写到JS文件中终端中，使用 node xxx.js 命令即可运行文件中的代码</li>
<li><strong>注意哟：两种模式不能混用，如果使用第一种模式，必须先退出，然后才能用第二种</strong><br>[tag type=”primary” outline]node中的模块化[/tag]</li>
<li>Node中的模块化，就是把一个大的JS文件拆分成若干个小文件，还能按照一定的语法组装到一起。</li>
<li>规定，用户创建的每个JS文件，就是一个小模块，叫做自定义模块</li>
<li>我们可以按照一定的语法将这些小模块组合到一起，形成一个完整的项目<br>[tag type=”success” outline=”1”]Node中的模块分类[/tag]</li>
<li>内置模块（核心模块）：Node安装后，即可使用的模块，Node环境自带。</li>
<li>自定义模块：用户自己创建的每个JS文件，都是自定义模块</li>
<li>第三方模块：其他人或公司、组织开发的模块，发布到 npm 网站，我们需要下载使用的模块<br>[tag type=”primary” outline]加载模块的语法[/tag]<br><em>1.1加载自定义模块</em></li>
<li>a 文件，必须通过 module.exports 共享（导出、暴露）当前模块中的变量</li>
<li>b 文件，需要通过 require() 加载（导入）。（a 文件导出什么，b 文件就得到什么）</li>
<li>加载自定义模块时，必须要带路径 （相对路径、绝对路径都可以；但必须带路径，哪怕是 ./ 也不能省略）</li>
<li>加载自定义模块时，可以省略后缀<br><em>1.2加载内置模块</em></li>
<li>直接使用 require() 加载即可。</li>
<li>加载模块时，无需带路径，比如 require(‘fs’)</li>
<li>加载内置模块，得到对象类型，对象中内置了很多API方法<br><em>1.3加载第三方模块</em></li>
<li>// npm （node package manager）,npm包管理器</li>
<li>第三方模块，发布在https：//www.npm.js.com</li>
<li>1,npm init 初始化package.json  || npm  init  -y</li>
<li>2,安装npm install 包名   || npm i 模块名</li>
<li>3,卸载npm uninstall 包名   || npm un  模块名</li>
<li>可以在文件package.json中的dependencied查看安装的模块</li>
</ul>
<hr>
<p>数组排序模块化</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 数组第一个转大写，其余小写</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.slice(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() + str.slice(<span class="number">1</span>).toLowerCase()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;asdfaknfsakfnaksd&#x27;</span></span><br><span class="line">change(str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组排序</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sortBy</span>(<span class="params">pro</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">item1, item2</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> item1[pro] - item2[pro]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 对外暴露</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="attr">change</span>: change,</span><br><span class="line">    <span class="attr">sortBy</span>: sortBy</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  接受数据</span></span><br><span class="line"><span class="keyword">var</span> &#123; change, sortBy &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./lib.js&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> r = change(<span class="string">&#x27;adfna&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(r);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(change(<span class="string">&#x27;asdkfksfn&#x27;</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;AS&#x27;</span>, <span class="attr">age</span>: <span class="number">12</span>, <span class="attr">score</span>: <span class="number">90</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;DS&#x27;</span>, <span class="attr">age</span>: <span class="number">13</span>, <span class="attr">score</span>: <span class="number">10</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;AE&#x27;</span>, <span class="attr">age</span>: <span class="number">11</span>, <span class="attr">score</span>: <span class="number">9</span> &#125;,</span><br><span class="line">]</span><br><span class="line"><span class="keyword">var</span> res = arr.sort(sortBy(<span class="string">&#x27;score&#x27;</span>))</span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>[tag type=”primary” outline]文件操作[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// fs 是file-system 的简写，文件系统的意思</span></span><br><span class="line"><span class="comment">// 在node 中如果想进行文件操作，就必须引入 fs 这个核心模块</span></span><br><span class="line"><span class="comment">// fs.readFine 用来读取文件</span></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="comment">// 读取文件 第一个参数要读取的文件路径，第二个是回调函数</span></span><br><span class="line"><span class="comment">// 成功 data 数据  error null</span></span><br><span class="line"><span class="comment">// 失败 data null  error  错误对象</span></span><br><span class="line">fs.readFile(<span class="string">&#x27;./1.html&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123; &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写文件第一个参数，路径 ；第二个参数，文件的内容；第三个参数，回调函数</span></span><br><span class="line"></span><br><span class="line">fs.writeFile(<span class="string">&#x27;./data.md&#x27;</span>,<span class="string">&#x27;大家好&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">[/collapse]</span><br></pre></td></tr></table></figure></p>
<hr>
<p>Path 模块<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// path 模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&#x27;a/b/c/index.js&#x27;</span></span><br><span class="line"><span class="comment">// 获取路径文件后缀名</span></span><br><span class="line"><span class="comment">// console.log(path.extname(url));</span></span><br><span class="line"><span class="comment">// 拼接给出的路径</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;a/b/c&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="string">&#x27;d/e/index.html&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(path.join(a,b));</span></span><br><span class="line"><span class="comment">// 全局变量，表示当前的js的绝对路径</span></span><br><span class="line"><span class="built_in">console</span>.log(__dirname);</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<hr>
<p>querystring 模块<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// querystring 模块</span></span><br><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">&#x27;querystring&#x27;</span>);</span><br><span class="line"><span class="comment">// 定义变量，查询字符串</span></span><br><span class="line"><span class="keyword">let</span> urls = <span class="string">&#x27;uname= zhangsan&amp;age=20&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> obj = querystring.parse(urls);</span><br><span class="line"><span class="built_in">console</span>.log(obj);</span><br><span class="line"><span class="comment">// 将对象转化成字符串</span></span><br><span class="line"><span class="keyword">let</span> os = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;grils&#x27;</span>,</span><br><span class="line">    <span class="attr">lova</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">moeny</span>: <span class="number">12202</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> str = querystring.stringify(os);</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br></pre></td></tr></table></figure></p>
<hr>
<p>http<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 服务器要干嘛  提供服务：对，数据服务发请求  接受请求  处理请求给个反馈（发送相应） 注册request 请求事件*/</span></span><br><span class="line"><span class="comment">// 1 http 加载http 模块</span></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2创建web服务器</span></span><br><span class="line"><span class="comment">// 使用http.createServer()创建web服务器 返回Server实列</span></span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3监听request请求事件        /* req请求，res响应 */</span></span><br><span class="line">server.on(<span class="string">&#x27;request&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 设置响应头                   /* 文本数据 */</span></span><br><span class="line">    res.setHeader(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/pain;charest=utf-8&#x27;</span>)</span><br><span class="line">    <span class="comment">// 向客户响应数据</span></span><br><span class="line">    res.end(<span class="string">&#x27;你好啊,陌生人&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 4,监听端口号.</span></span><br><span class="line">server.listen(<span class="number">5555</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;端口5555已启动&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 简化2 3 步骤</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> server = http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 设置响应头                   /* 文本数据 */</span></span><br><span class="line">    res.setHeader(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/pain;charest=utf-8&#x27;</span>)</span><br><span class="line">    <span class="comment">// 向客户响应数据</span></span><br><span class="line">    res.end(<span class="string">&#x27;你好啊,陌生人&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4,监听端口号.</span></span><br><span class="line">server.listen(<span class="number">5555</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;端口5555已启动&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>node</category>
      </categories>
      <tags>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>performance</title>
    <url>/archives/82d79681.html</url>
    <content><![CDATA[<h1 id="面试官：Vue3-0性能提升主要是通过哪几方面体现的？"><a href="#面试官：Vue3-0性能提升主要是通过哪几方面体现的？" class="headerlink" title="面试官：Vue3.0性能提升主要是通过哪几方面体现的？"></a>面试官：Vue3.0性能提升主要是通过哪几方面体现的？</h1><p> <img src="https://static.vue-js.com/2aac1020-5ed0-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、编译阶段"><a href="#一、编译阶段" class="headerlink" title="一、编译阶段"></a>一、编译阶段</h2><p>回顾<code>Vue2</code>，我们知道每个组件实例都对应一个 <code>watcher</code> 实例，它会在组件渲染的过程中把用到的数据<code>property</code>记录为依赖，当依赖发生改变，触发<code>setter</code>，则会通知<code>watcher</code>，从而使关联的组件重新渲染</p>
<p> <img src="https://static.vue-js.com/39066120-5ed0-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>试想一下，一个组件结构如下图</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>静态文本<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>静态文本<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>静态文本<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>静态文本<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以看到，组件内部只有一个动态节点，剩余一堆都是静态节点，所以这里很多 <code>diff</code> 和遍历其实都是不需要的，造成性能浪费</p>
<p>因此，<code>Vue3</code>在编译阶段，做了进一步优化。主要有如下：</p>
<ul>
<li>diff算法优化</li>
<li>静态提升</li>
<li>事件监听缓存</li>
<li>SSR优化</li>
</ul>
<h4 id="diff算法优化"><a href="#diff算法优化" class="headerlink" title="diff算法优化"></a>diff算法优化</h4><p><code>vue3</code>在<code>diff</code>算法中相比<code>vue2</code>增加了静态标记</p>
<p>关于这个静态标记，其作用是为了会发生变化的地方添加一个<code>flag</code>标记，下次发生变化的时候直接找该地方进行比较</p>
<p>下图这里，已经标记静态节点的<code>p</code>标签在<code>diff</code>过程中则不会比较，把性能进一步提高</p>
<p> <img src="https://static.vue-js.com/c732e150-5c58-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>关于静态类型枚举如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> enum PatchFlags &#123;</span><br><span class="line">  TEXT = <span class="number">1</span>,<span class="comment">// 动态的文本节点</span></span><br><span class="line">  CLASS = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,  <span class="comment">// 2 动态的 class</span></span><br><span class="line">  STYLE = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,  <span class="comment">// 4 动态的 style</span></span><br><span class="line">  PROPS = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,  <span class="comment">// 8 动态属性，不包括类名和样式</span></span><br><span class="line">  FULL_PROPS = <span class="number">1</span> &lt;&lt; <span class="number">4</span>,  <span class="comment">// 16 动态 key，当 key 变化时需要完整的 diff 算法做比较</span></span><br><span class="line">  HYDRATE_EVENTS = <span class="number">1</span> &lt;&lt; <span class="number">5</span>,  <span class="comment">// 32 表示带有事件监听器的节点</span></span><br><span class="line">  STABLE_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">6</span>,   <span class="comment">// 64 一个不会改变子节点顺序的 Fragment</span></span><br><span class="line">  KEYED_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">7</span>, <span class="comment">// 128 带有 key 属性的 Fragment</span></span><br><span class="line">  UNKEYED_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">8</span>, <span class="comment">// 256 子节点没有 key 的 Fragment</span></span><br><span class="line">  NEED_PATCH = <span class="number">1</span> &lt;&lt; <span class="number">9</span>,   <span class="comment">// 512</span></span><br><span class="line">  DYNAMIC_SLOTS = <span class="number">1</span> &lt;&lt; <span class="number">10</span>,  <span class="comment">// 动态 solt</span></span><br><span class="line">  HOISTED = -<span class="number">1</span>,  <span class="comment">// 特殊标志是负整数表示永远不会用作 diff</span></span><br><span class="line">  BAIL = -<span class="number">2</span> <span class="comment">// 一个特殊的标志，指代差异算法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="静态提升"><a href="#静态提升" class="headerlink" title="静态提升"></a>静态提升</h4><p><code>Vue3</code>中对不参与更新的元素，会做静态提升，只会被创建一次，在渲染时直接复用</p>
<p>这样就免去了重复的创建节点，大型应用会受益于这个改动，免去了重复的创建操作，优化了运行时候的内存占用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;span&gt;你好&lt;/span&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>没有做静态提升之前</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(_Fragment, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;span&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;你好&quot;</span>),</span><br><span class="line">    _createVNode(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.message), <span class="number">1</span> <span class="comment">/* TEXT */</span>)</span><br><span class="line">  ], <span class="number">64</span> <span class="comment">/* STABLE_FRAGMENT */</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>做了静态提升之后</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> _hoisted_1 = <span class="comment">/*#__PURE__*/</span>_createVNode(<span class="string">&quot;span&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;你好&quot;</span>, -<span class="number">1</span> <span class="comment">/* HOISTED */</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(_Fragment, <span class="literal">null</span>, [</span><br><span class="line">    _hoisted_1,</span><br><span class="line">    _createVNode(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.message), <span class="number">1</span> <span class="comment">/* TEXT */</span>)</span><br><span class="line">  ], <span class="number">64</span> <span class="comment">/* STABLE_FRAGMENT */</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check the console for the AST</span></span><br></pre></td></tr></table></figure>
<p>静态内容<code>_hoisted_1</code>被放置在<code>render</code> 函数外，每次渲染的时候只要取 <code>_hoisted_1</code> 即可</p>
<p>同时 <code>_hoisted_1</code> 被打上了 <code>PatchFlag</code> ，静态标记值为 -1 ，特殊标志是负整数表示永远不会用于 Diff</p>
<h4 id="事件监听缓存"><a href="#事件监听缓存" class="headerlink" title="事件监听缓存"></a>事件监听缓存</h4><p>默认情况下绑定事件行为会被视为动态绑定，所以每次都会去追踪它的变化</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;button @click = &#x27;onClick&#x27;&gt;点我&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>没开启事件监听器缓存</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> render = <span class="comment">/*#__PURE__*/</span>_withId(<span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;button&quot;</span>, &#123; <span class="attr">onClick</span>: _ctx.onClick &#125;, <span class="string">&quot;点我&quot;</span>, <span class="number">8</span> <span class="comment">/* PROPS */</span>, [<span class="string">&quot;onClick&quot;</span>])</span><br><span class="line">                                             <span class="comment">// PROPS=1&lt;&lt;3,// 8 //动态属性，但不包含类名和样式</span></span><br><span class="line">  ]))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>开启事件侦听器缓存后</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;button&quot;</span>, &#123;</span><br><span class="line">      <span class="attr">onClick</span>: _cache[<span class="number">1</span>] || (_cache[<span class="number">1</span>] = <span class="function">(<span class="params">...args</span>) =&gt;</span> (_ctx.onClick(...args)))</span><br><span class="line">    &#125;, <span class="string">&quot;点我&quot;</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述发现开启了缓存后，没有了静态标记。也就是说下次<code>diff</code>算法的时候直接使用</p>
<h4 id="SSR优化"><a href="#SSR优化" class="headerlink" title="SSR优化"></a>SSR优化</h4><p>当静态内容大到一定量级时候，会用<code>createStaticVNode</code>方法在客户端去生成一个static node，这些静态<code>node</code>，会被直接<code>innerHtml</code>，就不需要创建对象，然后根据对象渲染</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">div&gt;</span><br><span class="line">	<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">span</span>&gt;</span>你好<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">	...  <span class="comment">// 很多个静态属性</span></span><br><span class="line">	&lt;div&gt;</span><br><span class="line">		<span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>编译后</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mergeProps <span class="keyword">as</span> _mergeProps &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ssrRenderAttrs <span class="keyword">as</span> _ssrRenderAttrs, ssrInterpolate <span class="keyword">as</span> _ssrInterpolate &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/server-renderer&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">ssrRender</span>(<span class="params">_ctx, _push, _parent, _attrs, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> _cssVars = &#123; <span class="attr">style</span>: &#123; <span class="attr">color</span>: _ctx.color &#125;&#125;</span><br><span class="line">  _push(<span class="string">`&lt;div<span class="subst">$&#123;</span></span></span><br><span class="line"><span class="subst"><span class="string">    _ssrRenderAttrs(_mergeProps(_attrs, _cssVars))</span></span></span><br><span class="line"><span class="subst"><span class="string">  &#125;</span>&gt;&lt;div&gt;&lt;span&gt;你好&lt;/span&gt;...&lt;div&gt;&lt;span&gt;你好&lt;/span&gt;&lt;div&gt;&lt;span&gt;<span class="subst">$&#123;</span></span></span><br><span class="line"><span class="subst"><span class="string">    _ssrInterpolate(_ctx.message)</span></span></span><br><span class="line"><span class="subst"><span class="string">  &#125;</span>&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二、源码体积"><a href="#二、源码体积" class="headerlink" title="二、源码体积"></a>二、源码体积</h2><p>相比<code>Vue2</code>，<code>Vue3</code>整体体积变小了，除了移出一些不常用的API，再重要的是<code>Tree shanking</code></p>
<p>任何一个函数，如<code>ref</code>、<code>reavtived</code>、<code>computed</code>等，仅仅在用到的时候才打包，没用到的模块都被摇掉，打包的整体体积变小</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; computed, defineComponent, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineComponent(&#123;</span><br><span class="line">    <span class="function"><span class="title">setup</span>(<span class="params">props, context</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> age = ref(<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> state = reactive(&#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;test&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> readOnlyAge = computed(<span class="function">() =&gt;</span> age.value++) <span class="comment">// 19</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            age,</span><br><span class="line">            state,</span><br><span class="line">            readOnlyAge</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="三、响应式系统"><a href="#三、响应式系统" class="headerlink" title="三、响应式系统"></a>三、响应式系统</h2><p><code>vue2</code>中采用 <code>defineProperty</code>来劫持整个对象，然后进行深度遍历所有属性，给每个属性添加<code>getter</code>和<code>setter</code>，实现响应式</p>
<p><code>vue3</code>采用<code>proxy</code>重写了响应式系统，因为<code>proxy</code>可以对整个对象进行监听，所以不需要深度遍历</p>
<ul>
<li>可以监听动态属性的添加</li>
<li>可以监听到数组的索引和数组<code>length</code>属性</li>
<li>可以监听删除属性</li>
</ul>
<p>关于这两个 API 具体的不同，我们下篇文章会进行一个更加详细的介绍</p>
]]></content>
      <categories>
        <category>vue3</category>
      </categories>
      <tags>
        <tag>vue3</tag>
        <tag>performance</tag>
      </tags>
  </entry>
  <entry>
    <title>promise</title>
    <url>/archives/9b0c2390.html</url>
    <content><![CDATA[<h1 id="面试官：你是怎么理解ES6中-Promise的？使用场景？"><a href="#面试官：你是怎么理解ES6中-Promise的？使用场景？" class="headerlink" title="面试官：你是怎么理解ES6中 Promise的？使用场景？"></a>面试官：你是怎么理解ES6中 Promise的？使用场景？</h1><p><img src="https://static.vue-js.com/f033b160-5811-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h2><p><code>Promise</code>，译为承诺，是异步编程的一种解决方案，比传统的解决方案（回调函数）更加合理和更加强大</p>
<p>在以往我们如果处理多层异步操作，我们往往会像下面那样编写我们的代码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">doSomething(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">  doSomethingElse(result, <span class="function"><span class="keyword">function</span>(<span class="params">newResult</span>) </span>&#123;</span><br><span class="line">    doThirdThing(newResult, <span class="function"><span class="keyword">function</span>(<span class="params">finalResult</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;得到最终结果: &#x27;</span> + finalResult);</span><br><span class="line">    &#125;, failureCallback);</span><br><span class="line">  &#125;, failureCallback);</span><br><span class="line">&#125;, failureCallback);</span><br></pre></td></tr></table></figure>
<p>阅读上面代码，是不是很难受，上述形成了经典的回调地狱</p>
<p>现在通过<code>Promise</code>的改写上面的代码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">doSomething().then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> doSomethingElse(result);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">newResult</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> doThirdThing(newResult);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">finalResult</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;得到最终结果: &#x27;</span> + finalResult);</span><br><span class="line">&#125;)</span><br><span class="line">.catch(failureCallback);</span><br></pre></td></tr></table></figure>
<p>瞬间感受到<code>promise</code>解决异步操作的优点：</p>
<ul>
<li>链式操作减低了编码难度</li>
<li>代码可读性明显增强</li>
</ul>
<p>下面我们正式来认识<code>promise</code>：</p>
<h3 id="状态"><a href="#状态" class="headerlink" title="状态"></a>状态</h3><p><code>promise</code>对象仅有三种状态</p>
<ul>
<li><code>pending</code>（进行中）</li>
<li><code>fulfilled</code>（已成功）</li>
<li><code>rejected</code>（已失败）</li>
</ul>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li>对象的状态不受外界影响，只有异步操作的结果，可以决定当前是哪一种状态</li>
<li>一旦状态改变（从<code>pending</code>变为<code>fulfilled</code>和从<code>pending</code>变为<code>rejected</code>），就不会再变，任何时候都可以得到这个结果</li>
</ul>
<h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><p>认真阅读下图，我们能够轻松了解<code>promise</code>整个流程</p>
<p> <img src="https://static.vue-js.com/1b02ae90-58a9-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="二、用法"><a href="#二、用法" class="headerlink" title="二、用法"></a>二、用法</h2><p><code>Promise</code>对象是一个构造函数，用来生成<code>Promise</code>实例</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;&#125;);</span><br></pre></td></tr></table></figure>
<p><code>Promise</code>构造函数接受一个函数作为参数，该函数的两个参数分别是<code>resolve</code>和<code>reject</code></p>
<ul>
<li><code>resolve</code>函数的作用是，将<code>Promise</code>对象的状态从“未完成”变为“成功”</li>
<li><code>reject</code>函数的作用是，将<code>Promise</code>对象的状态从“未完成”变为“失败”</li>
</ul>
<h3 id="实例方法"><a href="#实例方法" class="headerlink" title="实例方法"></a>实例方法</h3><p><code>Promise</code>构建出来的实例存在以下方法：</p>
<ul>
<li>then()</li>
<li>catch()</li>
<li>finally()</li>
</ul>
<h4 id="then"><a href="#then" class="headerlink" title="then()"></a>then()</h4><p><code>then</code>是实例状态发生改变时的回调函数，第一个参数是<code>resolved</code>状态的回调函数，第二个参数是<code>rejected</code>状态的回调函数</p>
<p><code>then</code>方法返回的是一个新的<code>Promise</code>实例，也就是<code>promise</code>能链式书写的原因</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">getJSON(<span class="string">&quot;/posts.json&quot;</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">json</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> json.post;</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">post</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="catch"><a href="#catch" class="headerlink" title="catch"></a>catch</h4><p><code>catch()</code>方法是<code>.then(null, rejection)</code>或<code>.then(undefined, rejection)</code>的别名，用于指定发生错误时的回调函数</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">getJSON(<span class="string">&#x27;/posts.json&#x27;</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">posts</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 处理 getJSON 和 前一个回调函数运行时发生的错误</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;发生错误！&#x27;</span>, error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><code>Promise</code>对象的错误具有“冒泡”性质，会一直向后传递，直到被捕获为止</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">getJSON(<span class="string">&#x27;/post/1.json&#x27;</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">post</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> getJSON(post.commentURL);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">comments</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// some code</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 处理前面三个Promise产生的错误</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>一般来说，使用<code>catch</code>方法代替<code>then()</code>第二个参数</p>
<p><code>Promise</code>对象抛出的错误不会传递到外层代码，即不会有任何反应</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> someAsyncThing = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 下面一行会报错，因为x没有声明</span></span><br><span class="line">    resolve(x + <span class="number">2</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>浏览器运行到这一行，会打印出错误提示<code>ReferenceError: x is not defined</code>，但是不会退出进程</p>
<p><code>catch()</code>方法之中，还能再抛出错误，通过后面<code>catch</code>方法捕获到</p>
<h4 id="finally"><a href="#finally" class="headerlink" title="finally()"></a>finally()</h4><p><code>finally()</code>方法用于指定不管 Promise 对象最后状态如何，都会执行的操作</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">promise</span><br><span class="line">.then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;···&#125;)</span><br><span class="line">.catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;···&#125;)</span><br><span class="line">.finally(<span class="function">() =&gt;</span> &#123;···&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="构造函数方法"><a href="#构造函数方法" class="headerlink" title="构造函数方法"></a>构造函数方法</h3><p><code>Promise</code>构造函数存在以下方法：</p>
<ul>
<li>all()</li>
<li>race()</li>
<li>allSettled()</li>
<li>resolve()</li>
<li>reject()</li>
<li>try()</li>
</ul>
<h3 id="all"><a href="#all" class="headerlink" title="all()"></a>all()</h3><p><code>Promise.all()</code>方法用于将多个 <code>Promise</code>实例，包装成一个新的 <code>Promise</code>实例</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="built_in">Promise</span>.all([p1, p2, p3]);</span><br></pre></td></tr></table></figure>
<p>接受一个数组（迭代对象）作为参数，数组成员都应为<code>Promise</code>实例</p>
<p>实例<code>p</code>的状态由<code>p1</code>、<code>p2</code>、<code>p3</code>决定，分为两种：</p>
<ul>
<li>只有<code>p1</code>、<code>p2</code>、<code>p3</code>的状态都变成<code>fulfilled</code>，<code>p</code>的状态才会变成<code>fulfilled</code>，此时<code>p1</code>、<code>p2</code>、<code>p3</code>的返回值组成一个数组，传递给<code>p</code>的回调函数</li>
<li>只要<code>p1</code>、<code>p2</code>、<code>p3</code>之中有一个被<code>rejected</code>，<code>p</code>的状态就变成<code>rejected</code>，此时第一个被<code>reject</code>的实例的返回值，会传递给<code>p</code>的回调函数</li>
</ul>
<p>注意，如果作为参数的 <code>Promise</code> 实例，自己定义了<code>catch</code>方法，那么它一旦被<code>rejected</code>，并不会触发<code>Promise.all()</code>的<code>catch</code>方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  resolve(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">result</span> =&gt;</span> result)</span><br><span class="line">.catch(<span class="function"><span class="params">e</span> =&gt;</span> e);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;报错了&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">result</span> =&gt;</span> result)</span><br><span class="line">.catch(<span class="function"><span class="params">e</span> =&gt;</span> e);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all([p1, p2])</span><br><span class="line">.then(<span class="function"><span class="params">result</span> =&gt;</span> <span class="built_in">console</span>.log(result))</span><br><span class="line">.catch(<span class="function"><span class="params">e</span> =&gt;</span> <span class="built_in">console</span>.log(e));</span><br><span class="line"><span class="comment">// [&quot;hello&quot;, Error: 报错了]</span></span><br></pre></td></tr></table></figure>
<p>如果<code>p2</code>没有自己的<code>catch</code>方法，就会调用<code>Promise.all()</code>的<code>catch</code>方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  resolve(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">result</span> =&gt;</span> result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;报错了&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">result</span> =&gt;</span> result);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all([p1, p2])</span><br><span class="line">.then(<span class="function"><span class="params">result</span> =&gt;</span> <span class="built_in">console</span>.log(result))</span><br><span class="line">.catch(<span class="function"><span class="params">e</span> =&gt;</span> <span class="built_in">console</span>.log(e));</span><br><span class="line"><span class="comment">// Error: 报错了</span></span><br></pre></td></tr></table></figure>
<h3 id="race"><a href="#race" class="headerlink" title="race()"></a>race()</h3><p><code>Promise.race()</code>方法同样是将多个 Promise 实例，包装成一个新的 Promise 实例</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="built_in">Promise</span>.race([p1, p2, p3]);</span><br></pre></td></tr></table></figure>
<p>只要<code>p1</code>、<code>p2</code>、<code>p3</code>之中有一个实例率先改变状态，<code>p</code>的状态就跟着改变</p>
<p>率先改变的 Promise 实例的返回值则传递给<code>p</code>的回调函数</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="built_in">Promise</span>.race([</span><br><span class="line">  fetch(<span class="string">&#x27;/resource-that-may-take-a-while&#x27;</span>),</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;request timeout&#x27;</span>)), <span class="number">5000</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line">p</span><br><span class="line">.then(<span class="built_in">console</span>.log)</span><br><span class="line">.catch(<span class="built_in">console</span>.error);</span><br></pre></td></tr></table></figure>
<h3 id="allSettled"><a href="#allSettled" class="headerlink" title="allSettled()"></a>allSettled()</h3><p><code>Promise.allSettled()</code>方法接受一组 Promise 实例作为参数，包装成一个新的 Promise 实例</p>
<p>只有等到所有这些参数实例都返回结果，不管是<code>fulfilled</code>还是<code>rejected</code>，包装实例才会结束</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> promises = [</span><br><span class="line">  fetch(<span class="string">&#x27;/api-1&#x27;</span>),</span><br><span class="line">  fetch(<span class="string">&#x27;/api-2&#x27;</span>),</span><br><span class="line">  fetch(<span class="string">&#x27;/api-3&#x27;</span>),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> <span class="built_in">Promise</span>.allSettled(promises);</span><br><span class="line">removeLoadingIndicator();</span><br></pre></td></tr></table></figure>
<h4 id="resolve"><a href="#resolve" class="headerlink" title="resolve()"></a>resolve()</h4><p>将现有对象转为 <code>Promise</code>对象</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> resolve(<span class="string">&#x27;foo&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>参数可以分成四种情况，分别如下：</p>
<ul>
<li>参数是一个 Promise 实例，<code>promise.resolve</code>将不做任何修改、原封不动地返回这个实例</li>
<li>参数是一个<code>thenable</code>对象，<code>promise.resolve</code>会将这个对象转为 <code>Promise</code>对象，然后就立即执行<code>thenable</code>对象的<code>then()</code>方法</li>
<li>参数不是具有<code>then()</code>方法的对象，或根本就不是对象，<code>Promise.resolve()</code>会返回一个新的 Promise 对象，状态为<code>resolved</code></li>
<li>没有参数时，直接返回一个<code>resolved</code>状态的 Promise 对象</li>
</ul>
<h4 id="reject"><a href="#reject" class="headerlink" title="reject()"></a>reject()</h4><p><code>Promise.reject(reason)</code>方法也会返回一个新的 Promise 实例，该实例的状态为<code>rejected</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="built_in">Promise</span>.reject(<span class="string">&#x27;出错了&#x27;</span>);</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> reject(<span class="string">&#x27;出错了&#x27;</span>))</span><br><span class="line"></span><br><span class="line">p.then(<span class="literal">null</span>, <span class="function"><span class="keyword">function</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(s)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 出错了</span></span><br></pre></td></tr></table></figure>
<p><code>Promise.reject()</code>方法的参数，会原封不动地变成后续方法的参数</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.reject(<span class="string">&#x27;出错了&#x27;</span>)</span><br><span class="line">.catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(e === <span class="string">&#x27;出错了&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="三、使用场景"><a href="#三、使用场景" class="headerlink" title="三、使用场景"></a>三、使用场景</h2><p>将图片的加载写成一个<code>Promise</code>，一旦加载完成，<code>Promise</code>的状态就发生变化</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> preloadImage = <span class="function"><span class="keyword">function</span> (<span class="params">path</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> image = <span class="keyword">new</span> Image();</span><br><span class="line">    image.onload  = resolve;</span><br><span class="line">    image.onerror = reject;</span><br><span class="line">    image.src = path;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>通过链式操作，将多个渲染数据分别给个<code>then</code>，让其各司其职。或当下个异步请求依赖上个请求结果的时候，我们也能够通过链式操作友好解决问题</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 各司其职</span></span><br><span class="line">getInfo().then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; bannerList &#125; = res</span><br><span class="line">    <span class="comment">//渲染轮播图</span></span><br><span class="line">    <span class="built_in">console</span>.log(bannerList)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> &#123; storeList &#125; = res</span><br><span class="line">    <span class="comment">//渲染店铺列表</span></span><br><span class="line">    <span class="built_in">console</span>.log(storeList)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; categoryList &#125; = res</span><br><span class="line">    <span class="built_in">console</span>.log(categoryList)</span><br><span class="line">    <span class="comment">//渲染分类列表</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>通过<code>all()</code>实现多个请求合并在一起，汇总所有请求结果，只需设置一个<code>loading</code>即可</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initLoad</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// loading.show() //加载loading</span></span><br><span class="line">    <span class="built_in">Promise</span>.all([getBannerList(),getStoreList(),getCategoryList()]).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res)</span><br><span class="line">        loading.hide() <span class="comment">//关闭loading</span></span><br><span class="line">    &#125;).catch(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err)</span><br><span class="line">        loading.hide()<span class="comment">//关闭loading</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//数据初始化    </span></span><br><span class="line">initLoad()</span><br></pre></td></tr></table></figure>
<p>通过<code>race</code>可以设置图片请求超时</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//请求某个图片资源</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">requestImg</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">        img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">           resolve(img);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//img.src = &quot;https://b-gold-cdn.xitu.io/v3/static/img/logo.a7995ad.svg&quot;; 正确的</span></span><br><span class="line">        img.src = <span class="string">&quot;https://b-gold-cdn.xitu.io/v3/static/img/logo.a7995ad.svg1&quot;</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//延时函数，用于给请求计时</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            reject(<span class="string">&#x27;图片请求超时&#x27;</span>);</span><br><span class="line">        &#125;, <span class="number">5000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span></span><br><span class="line">.race([requestImg(), timeout()])</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">results</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(results);</span><br><span class="line">&#125;)</span><br><span class="line">.catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(reason);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://es6.ruanyifeng.com/#docs/promise">https://es6.ruanyifeng.com/#docs/promise</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>es6</tag>
        <tag>promise</tag>
      </tags>
  </entry>
  <entry>
    <title>object</title>
    <url>/archives/a8adabec.html</url>
    <content><![CDATA[<h1 id="面试官：对象新增了哪些扩展？"><a href="#面试官：对象新增了哪些扩展？" class="headerlink" title="面试官：对象新增了哪些扩展？"></a>面试官：对象新增了哪些扩展？</h1><p><img src="https://static.vue-js.com/4da4dd40-5427-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、属性的简写"><a href="#一、属性的简写" class="headerlink" title="一、属性的简写"></a>一、属性的简写</h2><p>ES6中，当对象键名与对应值名相等的时候，可以进行简写</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> baz = &#123;<span class="attr">foo</span>:foo&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">const</span> baz = &#123;foo&#125;</span><br></pre></td></tr></table></figure>
<p>方法也能够进行简写</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> o = &#123;</span><br><span class="line">  <span class="function"><span class="title">method</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> o = &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在函数内作为返回值，也会变得方便很多</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPoint</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> x = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">const</span> y = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123;x, y&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getPoint()</span><br><span class="line"><span class="comment">// &#123;x:1, y:10&#125;</span></span><br></pre></td></tr></table></figure>
<p>注意：简写的对象方法不能用作构造函数，否则会报错</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="function"><span class="title">f</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.foo = <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> obj.f() <span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
<h2 id="二、属性名表达式"><a href="#二、属性名表达式" class="headerlink" title="二、属性名表达式"></a>二、属性名表达式</h2><p>ES6 允许字面量定义对象时，将表达式放在括号内</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> lastWord = <span class="string">&#x27;last word&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = &#123;</span><br><span class="line">  <span class="string">&#x27;first word&#x27;</span>: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">  [lastWord]: <span class="string">&#x27;world&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">a[<span class="string">&#x27;first word&#x27;</span>] <span class="comment">// &quot;hello&quot;</span></span><br><span class="line">a[lastWord] <span class="comment">// &quot;world&quot;</span></span><br><span class="line">a[<span class="string">&#x27;last word&#x27;</span>] <span class="comment">// &quot;world&quot;</span></span><br></pre></td></tr></table></figure>
<p>表达式还可以用于定义方法名</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  [<span class="string">&#x27;h&#x27;</span> + <span class="string">&#x27;ello&#x27;</span>]() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;hi&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.hello() <span class="comment">// hi</span></span><br></pre></td></tr></table></figure>
<p>注意，属性名表达式与简洁表示法，不能同时使用，会报错</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">const</span> foo = <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> bar = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> baz = &#123; [foo] &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line"><span class="keyword">const</span> foo = <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> baz = &#123; [foo]: <span class="string">&#x27;abc&#x27;</span>&#125;;</span><br></pre></td></tr></table></figure>
<p>注意，属性名表达式如果是一个对象，默认情况下会自动将对象转为字符串<code>[object Object]</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> keyA = &#123;<span class="attr">a</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> keyB = &#123;<span class="attr">b</span>: <span class="number">2</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myObject = &#123;</span><br><span class="line">  [keyA]: <span class="string">&#x27;valueA&#x27;</span>,</span><br><span class="line">  [keyB]: <span class="string">&#x27;valueB&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">myObject <span class="comment">// Object &#123;[object Object]: &quot;valueB&quot;&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="三、super关键字"><a href="#三、super关键字" class="headerlink" title="三、super关键字"></a>三、super关键字</h2><p><code>this</code>关键字总是指向函数所在的当前对象，ES6 又新增了另一个类似的关键字<code>super</code>，指向当前对象的原型对象</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> proto = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="string">&#x27;world&#x27;</span>,</span><br><span class="line">  <span class="function"><span class="title">find</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">super</span>.foo;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.setPrototypeOf(obj, proto); <span class="comment">// 为obj设置原型对象</span></span><br><span class="line">obj.find() <span class="comment">// &quot;hello&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="四、扩展运算符的应用"><a href="#四、扩展运算符的应用" class="headerlink" title="四、扩展运算符的应用"></a>四、扩展运算符的应用</h2><p>在解构赋值中，未被读取的可遍历的属性，分配到指定的对象上面</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span> &#125;;</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 2</span></span><br><span class="line">z <span class="comment">// &#123; a: 3, b: 4 &#125;</span></span><br></pre></td></tr></table></figure>
<p>注意：解构赋值必须是最后一个参数，否则会报错</p>
<p>解构赋值是浅拷贝</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: <span class="number">1</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; ...x &#125; = obj;</span><br><span class="line">obj.a.b = <span class="number">2</span>; <span class="comment">// 修改obj里面a属性中键值</span></span><br><span class="line">x.a.b <span class="comment">// 2，影响到了结构出来x的值</span></span><br></pre></td></tr></table></figure>
<p>对象的扩展运算符等同于使用<code>Object.assign()</code>方法</p>
<h2 id="五、属性的遍历"><a href="#五、属性的遍历" class="headerlink" title="五、属性的遍历"></a>五、属性的遍历</h2><p>ES6 一共有 5 种方法可以遍历对象的属性。</p>
<ul>
<li><p>for…in：循环遍历对象自身的和继承的可枚举属性（不含 Symbol 属性）</p>
</li>
<li><p>Object.keys(obj)：返回一个数组，包括对象自身的（不含继承的）所有可枚举属性（不含 Symbol 属性）的键名</p>
</li>
<li><p>Object.getOwnPropertyNames(obj)：回一个数组，包含对象自身的所有属性（不含 Symbol 属性，但是包括不可枚举属性）的键名</p>
</li>
<li><p>Object.getOwnPropertySymbols(obj)：返回一个数组，包含对象自身的所有 Symbol 属性的键名</p>
</li>
<li><p>Reflect.ownKeys(obj)：返回一个数组，包含对象自身的（不含继承的）所有键名，不管键名是 Symbol 或字符串，也不管是否可枚举</p>
</li>
</ul>
<p>上述遍历，都遵守同样的属性遍历的次序规则：</p>
<ul>
<li>首先遍历所有数值键，按照数值升序排列</li>
<li>其次遍历所有字符串键，按照加入时间升序排列</li>
<li>最后遍历所有 Symbol 键，按照加入时间升序排</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Reflect</span>.ownKeys(&#123; [<span class="built_in">Symbol</span>()]:<span class="number">0</span>, <span class="attr">b</span>:<span class="number">0</span>, <span class="number">10</span>:<span class="number">0</span>, <span class="number">2</span>:<span class="number">0</span>, <span class="attr">a</span>:<span class="number">0</span> &#125;)</span><br><span class="line"><span class="comment">// [&#x27;2&#x27;, &#x27;10&#x27;, &#x27;b&#x27;, &#x27;a&#x27;, Symbol()]</span></span><br></pre></td></tr></table></figure>
<h2 id="六、对象新增的方法"><a href="#六、对象新增的方法" class="headerlink" title="六、对象新增的方法"></a>六、对象新增的方法</h2><p>关于对象新增的方法，分别有以下：</p>
<ul>
<li>Object.is()</li>
<li>Object.assign()</li>
<li>Object.getOwnPropertyDescriptors()</li>
<li>Object.setPrototypeOf()，Object.getPrototypeOf()</li>
<li>Object.keys()，Object.values()，Object.entries()</li>
<li>Object.fromEntries()</li>
</ul>
<h3 id="Object-is"><a href="#Object-is" class="headerlink" title="Object.is()"></a>Object.is()</h3><p>严格判断两个值是否相等，与严格比较运算符（===）的行为基本一致，不同之处只有两个：一是<code>+0</code>不等于<code>-0</code>，二是<code>NaN</code>等于自身</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">+<span class="number">0</span> === -<span class="number">0</span> <span class="comment">//true</span></span><br><span class="line"><span class="literal">NaN</span> === <span class="literal">NaN</span> <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.is(+<span class="number">0</span>, -<span class="number">0</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Object</span>.is(<span class="literal">NaN</span>, <span class="literal">NaN</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign()"></a>Object.assign()</h3><p><code>Object.assign()</code>方法用于对象的合并，将源对象<code>source</code>的所有可枚举属性，复制到目标对象<code>target</code></p>
<p><code>Object.assign()</code>方法的第一个参数是目标对象，后面的参数都是源对象</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">1</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> source1 = &#123; <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> source2 = &#123; <span class="attr">c</span>: <span class="number">3</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.assign(target, source1, source2);</span><br><span class="line">target <span class="comment">// &#123;a:1, b:2, c:3&#125;</span></span><br></pre></td></tr></table></figure>
<p>注意：<code>Object.assign()</code>方法是浅拷贝，遇到同名属性会进行替换</p>
<h3 id="Object-getOwnPropertyDescriptors"><a href="#Object-getOwnPropertyDescriptors" class="headerlink" title="Object.getOwnPropertyDescriptors()"></a>Object.getOwnPropertyDescriptors()</h3><p>返回指定对象所有自身属性（非继承属性）的描述对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">123</span>,</span><br><span class="line">  <span class="keyword">get</span> <span class="title">bar</span>() &#123; <span class="keyword">return</span> <span class="string">&#x27;abc&#x27;</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptors(obj)</span><br><span class="line"><span class="comment">// &#123; foo:</span></span><br><span class="line"><span class="comment">//    &#123; value: 123,</span></span><br><span class="line"><span class="comment">//      writable: true,</span></span><br><span class="line"><span class="comment">//      enumerable: true,</span></span><br><span class="line"><span class="comment">//      configurable: true &#125;,</span></span><br><span class="line"><span class="comment">//   bar:</span></span><br><span class="line"><span class="comment">//    &#123; get: [Function: get bar],</span></span><br><span class="line"><span class="comment">//      set: undefined,</span></span><br><span class="line"><span class="comment">//      enumerable: true,</span></span><br><span class="line"><span class="comment">//      configurable: true &#125; &#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Object-setPrototypeOf"><a href="#Object-setPrototypeOf" class="headerlink" title="Object.setPrototypeOf()"></a>Object.setPrototypeOf()</h3><p><code>Object.setPrototypeOf</code>方法用来设置一个对象的原型对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.setPrototypeOf(object, prototype)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用法</span></span><br><span class="line"><span class="keyword">const</span> o = <span class="built_in">Object</span>.setPrototypeOf(&#123;&#125;, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Object-getPrototypeOf"><a href="#Object-getPrototypeOf" class="headerlink" title="Object.getPrototypeOf()"></a>Object.getPrototypeOf()</h3><p>用于读取一个对象的原型对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.getPrototypeOf(obj);</span><br></pre></td></tr></table></figure>
<h3 id="Object-keys"><a href="#Object-keys" class="headerlink" title="Object.keys()"></a>Object.keys()</h3><p>返回自身的（不含继承的）所有可遍历（enumerable）属性的键名的数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.keys(obj)</span><br><span class="line"><span class="comment">// [&quot;foo&quot;, &quot;baz&quot;]</span></span><br></pre></td></tr></table></figure>
<h3 id="Object-values"><a href="#Object-values" class="headerlink" title="Object.values()"></a>Object.values()</h3><p>返回自身的（不含继承的）所有可遍历（enumerable）属性的键对应值的数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.values(obj)</span><br><span class="line"><span class="comment">// [&quot;bar&quot;, 42]</span></span><br></pre></td></tr></table></figure>
<h3 id="Object-entries"><a href="#Object-entries" class="headerlink" title="Object.entries()"></a>Object.entries()</h3><p>返回一个对象自身的（不含继承的）所有可遍历（enumerable）属性的键值对的数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.entries(obj)</span><br><span class="line"><span class="comment">// [ [&quot;foo&quot;, &quot;bar&quot;], [&quot;baz&quot;, 42] ]</span></span><br></pre></td></tr></table></figure>
<h3 id="Object-fromEntries"><a href="#Object-fromEntries" class="headerlink" title="Object.fromEntries()"></a>Object.fromEntries()</h3><p>用于将一个键值对数组转为对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.fromEntries([</span><br><span class="line">  [<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>],</span><br><span class="line">  [<span class="string">&#x27;baz&#x27;</span>, <span class="number">42</span>]</span><br><span class="line">])</span><br><span class="line"><span class="comment">// &#123; foo: &quot;bar&quot;, baz: 42 &#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://es6.ruanyifeng.com/#docs/object">https://es6.ruanyifeng.com/#docs/object</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>es6</tag>
        <tag>object</tag>
      </tags>
  </entry>
  <entry>
    <title>prototype</title>
    <url>/archives/a36a5ae4.html</url>
    <content><![CDATA[<h1 id="面试官：JavaScript原型，原型链-有什么特点？"><a href="#面试官：JavaScript原型，原型链-有什么特点？" class="headerlink" title="面试官：JavaScript原型，原型链 ? 有什么特点？"></a>面试官：JavaScript原型，原型链 ? 有什么特点？</h1><p> <img src="https://static.vue-js.com/4500e170-725e-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、原型"><a href="#一、原型" class="headerlink" title="一、原型"></a>一、原型</h2><p><code>JavaScript</code> 常被描述为一种基于原型的语言——每个对象拥有一个原型对象</p>
<p>当试图访问一个对象的属性时，它不仅仅在该对象上搜寻，还会搜寻该对象的原型，以及该对象的原型的原型，依次层层向上搜索，直到找到一个名字匹配的属性或到达原型链的末尾</p>
<p>准确地说，这些属性和方法定义在Object的构造器函数（constructor functions）之上的<code>prototype</code>属性上，而非实例对象本身</p>
<p>下面举个例子：</p>
<p>函数可以有属性。 每个函数都有一个特殊的属性叫作原型<code>prototype</code> </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log( doSomething.prototype );</span><br></pre></td></tr></table></figure>
<p>控制台输出</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">constructor</span>: ƒ doSomething(),</span><br><span class="line">    <span class="attr">__proto__</span>: &#123;</span><br><span class="line">        <span class="attr">constructor</span>: ƒ <span class="built_in">Object</span>(),</span><br><span class="line">        <span class="attr">hasOwnProperty</span>: ƒ hasOwnProperty(),</span><br><span class="line">        <span class="attr">isPrototypeOf</span>: ƒ isPrototypeOf(),</span><br><span class="line">        <span class="attr">propertyIsEnumerable</span>: ƒ propertyIsEnumerable(),</span><br><span class="line">        <span class="attr">toLocaleString</span>: ƒ toLocaleString(),</span><br><span class="line">        <span class="attr">toString</span>: ƒ toString(),</span><br><span class="line">        <span class="attr">valueOf</span>: ƒ valueOf()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面这个对象，就是大家常说的原型对象</p>
<p>可以看到，原型对象有一个自有属性<code>constructor</code>，这个属性指向该函数，如下图关系展示</p>
<p> <img src="https://static.vue-js.com/56d87250-725e-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="二、原型链"><a href="#二、原型链" class="headerlink" title="二、原型链"></a>二、原型链</h2><p>原型对象也可能拥有原型，并从中继承方法和属性，一层一层、以此类推。这种关系常被称为原型链 (prototype chain)，它解释了为何一个对象会拥有定义在其他对象中的属性和方法</p>
<p>在对象实例和它的构造器之间建立一个链接（它是<code>__proto__</code>属性，是从构造函数的<code>prototype</code>属性派生的），之后通过上溯原型链，在构造器中找到这些属性和方法</p>
<p>下面举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.age = <span class="number">18</span>;</span><br><span class="line">    <span class="built_in">this</span>.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 第二步 创建实例</span></span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">&#x27;person&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>根据代码，我们可以得到下图</p>
<p> <img src="https://static.vue-js.com/60825aa0-725e-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>下面分析一下：</p>
<ul>
<li>构造函数<code>Person</code>存在原型对象<code>Person.prototype</code></li>
<li>构造函数生成实例对象<code>person</code>，<code>person</code>的<code>__proto__</code>指向构造函数<code>Person</code>原型对象</li>
<li><p><code>Person.prototype.__proto__</code> 指向内置对象，因为 <code>Person.prototype</code> 是个对象，默认是由 <code>Object</code>函数作为类创建的，而 <code>Object.prototype</code> 为内置对象</p>
</li>
<li><p><code>Person.__proto__</code> 指向内置匿名函数 <code>anonymous</code>，因为 Person 是个函数对象，默认由 Function 作为类创建</p>
</li>
<li><p><code>Function.prototype</code> 和 <code>Function.__proto__</code>同时指向内置匿名函数 <code>anonymous</code>，这样原型链的终点就是 <code>null</code></p>
</li>
</ul>
<h2 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h2><p>下面首先要看几个概念：</p>
<p><code>__proto__</code>作为不同对象之间的桥梁，用来指向创建它的构造函数的原型对象的</p>
<p> <img src="https://static.vue-js.com/6a742160-725e-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>每个对象的<code>__proto__</code>都是指向它的构造函数的原型对象<code>prototype</code>的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">person1.__proto__ === Person.prototype</span><br></pre></td></tr></table></figure>
<p>构造函数是一个函数对象，是通过 <code>Function</code>构造器产生的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Person.__proto__ === <span class="built_in">Function</span>.prototype</span><br></pre></td></tr></table></figure>
<p>原型对象本身是一个普通对象，而普通对象的构造函数都是<code>Object</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Person.prototype.__proto__ === <span class="built_in">Object</span>.prototype</span><br></pre></td></tr></table></figure>
<p>刚刚上面说了，所有的构造器都是函数对象，函数对象都是 <code>Function</code>构造产生的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.__proto__ === <span class="built_in">Function</span>.prototype</span><br></pre></td></tr></table></figure>
<p><code>Object</code>的原型对象也有<code>__proto__</code>属性指向<code>null</code>，<code>null</code>是原型链的顶端</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.__proto__ === <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>下面作出总结：</p>
<ul>
<li><p>一切对象都是继承自<code>Object</code>对象，<code>Object</code> 对象直接继承根源对象<code>null</code></p>
</li>
<li><p>一切的函数对象（包括 <code>Object</code> 对象），都是继承自 <code>Function</code> 对象</p>
</li>
<li><p><code>Object</code> 对象直接继承自 <code>Function</code> 对象</p>
</li>
<li><p><code>Function</code>对象的<code>__proto__</code>会指向自己的原型对象，最终还是继承自<code>Object</code>对象</p>
</li>
</ul>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://juejin.cn/post/6870732239556640775#heading-7">https://juejin.cn/post/6870732239556640775#heading-7</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>prototype</tag>
      </tags>
  </entry>
  <entry>
    <title>文章分页按钮功能实现</title>
    <url>/archives/75b2f6c6.html</url>
    <content><![CDATA[<h2 id="文章管理-文章列表分页"><a href="#文章管理-文章列表分页" class="headerlink" title="文章管理-文章列表分页"></a>文章管理-文章列表分页</h2><blockquote>
<p>目标：实现文章列表分页功能<br><img src="https://files.catbox.moe/5tq1rj.png" alt=""></p>
</blockquote>
<div class="note info flat"><h3 id="①-根据分页数据构建分页组件"><a href="#①-根据分页数据构建分页组件" class="headerlink" title="① 根据分页数据构建分页组件"></a>① 根据分页数据构建分页组件</h3></div>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install classnames@2.3.2</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/pages/articlePage/pagination/index.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import styles from &quot;./index.module.css&quot;;</span><br><span class="line">import classNames from &quot;classnames&quot;;</span><br><span class="line">import &#123; articlesRequestParams &#125; from &quot;article&quot;;</span><br><span class="line"></span><br><span class="line">interface Props &#123;</span><br><span class="line">  // 当前页</span><br><span class="line">  page: number;</span><br><span class="line">  // 总数据条数</span><br><span class="line">  total_count: number;</span><br><span class="line">  // 每页显示的数据条数</span><br><span class="line">  per_page: number;</span><br><span class="line">  // 页面中能够同时显示的页面数量</span><br><span class="line">  maxPageNum: number;</span><br><span class="line">  // 更新分页状态</span><br><span class="line">  updateReqParams: (reqParams: articlesRequestParams) =&gt; void;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class Pagination extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  // 构造函数</span><br><span class="line">  constructor(props: Props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    // 使以下方法中的 this 关键字指向当前类的实例对象</span><br><span class="line">    this.buildPage = this.buildPage.bind(this);</span><br><span class="line">  &#125;</span><br><span class="line">  // 构建分页</span><br><span class="line">  buildPage() &#123;</span><br><span class="line">    // 获取分页信息</span><br><span class="line">    const &#123; page, per_page, total_count, maxPageNum, updateReqParams &#125; =</span><br><span class="line">      this.props;</span><br><span class="line">    // 计算页码偏移量</span><br><span class="line">    const pageOffset = Math.floor(maxPageNum / 2);</span><br><span class="line">    // 计算显示着的开始页面</span><br><span class="line">    let start = page - pageOffset;</span><br><span class="line">    // 计算显示着的结束页码</span><br><span class="line">    let end = start + maxPageNum - 1;</span><br><span class="line">    // 计算总页数</span><br><span class="line">    const totalPage = Math.ceil(total_count / per_page);</span><br><span class="line">    // 显示着的开始页面范围限制</span><br><span class="line">    if (start &lt; 1) &#123;</span><br><span class="line">      // 终止开始页码</span><br><span class="line">      start = 1;</span><br><span class="line">      // 根据重置的显示着的开始页码重置显示着的结束页码</span><br><span class="line">      let tmp = start + maxPageNum - 1;</span><br><span class="line">      // 限制显示着的结束页码并为 end 赋值</span><br><span class="line">      end = tmp &gt; totalPage ? totalPage : tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    // 显示着的结束页码范围限制</span><br><span class="line">    if (end &gt; totalPage) &#123;</span><br><span class="line">      // 重置显示着的结束页码</span><br><span class="line">      end = totalPage;</span><br><span class="line">      // 根据重置的显示着的结束页码重置显示着的开始页码</span><br><span class="line">      let tmp = end - maxPageNum + 1;</span><br><span class="line">      // 限制显示着的开始页码并为 start 赋值</span><br><span class="line">      start = tmp &lt; 1 ? 1 : tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    // 用于存储页码数组</span><br><span class="line">    let pageArray = [];</span><br><span class="line">    // 生成页码</span><br><span class="line">    for (let i = start; i &lt;= end; i++) &#123;</span><br><span class="line">      pageArray.push(i);</span><br><span class="line">    &#125;</span><br><span class="line">    return (</span><br><span class="line">      &lt;nav className=&quot;pagination&quot;&gt;</span><br><span class="line">        &lt;ul className=&quot;pagination-list&quot;&gt;</span><br><span class="line">          &lt;li&gt;</span><br><span class="line">            &lt;button</span><br><span class="line">              onClick=&#123;() =&gt; updateReqParams(&#123; page: page - 1 &#125;)&#125;</span><br><span class="line">              className=&quot;pagination-link&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              上一页</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">          &#123;pageArray.map((item) =&gt; (</span><br><span class="line">            &lt;li key=&#123;item&#125;&gt;</span><br><span class="line">              &lt;button</span><br><span class="line">                onClick=&#123;() =&gt; updateReqParams(&#123; page: item &#125;)&#125;</span><br><span class="line">                className=&#123;classNames(&quot;pagination-link&quot;, &#123;</span><br><span class="line">                  &quot;is-current&quot;: item === page,</span><br><span class="line">                &#125;)&#125;</span><br><span class="line">              &gt;</span><br><span class="line">                &#123;item&#125;</span><br><span class="line">              &lt;/button&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">          ))&#125;</span><br><span class="line"></span><br><span class="line">          &lt;li&gt;</span><br><span class="line">            &lt;button</span><br><span class="line">              onClick=&#123;() =&gt; updateReqParams(&#123; page: page + 1 &#125;)&#125;</span><br><span class="line">              className=&quot;pagination-link&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              下一页</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">          &lt;li&gt;</span><br><span class="line">            &lt;div className=&quot;select&quot;&gt;</span><br><span class="line">              &lt;select</span><br><span class="line">                value=&#123;per_page&#125;</span><br><span class="line">                onChange=&#123;(event) =&gt;</span><br><span class="line">                  updateReqParams(&#123; per_page: Number(event.target.value) &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">              &gt;</span><br><span class="line">                &lt;option value=&#123;10&#125;&gt;10条/页&lt;/option&gt;</span><br><span class="line">                &lt;option value=&#123;15&#125;&gt;15条/页&lt;/option&gt;</span><br><span class="line">                &lt;option value=&#123;20&#125;&gt;20条/页&lt;/option&gt;</span><br><span class="line">              &lt;/select&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/nav&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  // 渲染视图</span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;div className=&#123;styles.pagination&#125;&gt;&#123;this.buildPage()&#125;&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="note info flat"><h3 id="②-调用分页组件时传递必要参数并在页码信息发生变化时重新获取文章列表"><a href="#②-调用分页组件时传递必要参数并在页码信息发生变化时重新获取文章列表" class="headerlink" title="② 调用分页组件时传递必要参数并在页码信息发生变化时重新获取文章列表"></a>② 调用分页组件时传递必要参数并在页码信息发生变化时重新获取文章列表</h3></div>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/pages/articlePage/index.tsx</span><br><span class="line">import &#123;</span><br><span class="line">  connect,</span><br><span class="line">  MapDispatchToPropsParam,</span><br><span class="line">  MapStateToPropsParam,</span><br><span class="line">&#125; from &quot;react-redux&quot;;</span><br><span class="line">import &#123; articlesRequestParams &#125; from &quot;article&quot;;</span><br><span class="line">import &#123; ArticlesState &#125; from &quot;@reducers/articlesReducer&quot;;</span><br><span class="line">import &#123; AppState, AppThunkDispatch &#125; from &quot;@src/store&quot;;</span><br><span class="line">import &#123; ArticleActions &#125; from &quot;@actions/articleActions&quot;;</span><br><span class="line">import &#123; ArticleCreators &#125; from &quot;@store/creators/articleCreators&quot;;</span><br><span class="line"></span><br><span class="line">interface StateProps &#123;</span><br><span class="line">  articleReducer: ArticlesState;</span><br><span class="line">&#125;</span><br><span class="line">interface DispatchProps &#123;</span><br><span class="line">  // 获取文章列表</span><br><span class="line">  requestArticles(</span><br><span class="line">    reqParams: articlesRequestParams</span><br><span class="line">  ): Promise&lt;ArticleActions.Actions&gt;;</span><br><span class="line">&#125;</span><br><span class="line">interface OwnProps &#123;&#125;</span><br><span class="line"></span><br><span class="line">type Props = OwnProps &amp; StateProps &amp; DispatchProps;</span><br><span class="line"></span><br><span class="line">class ArticlePage extends React.Component&lt;Props, States&gt; &#123;</span><br><span class="line">  // 组件更新后执行</span><br><span class="line">  async componentDidUpdate(</span><br><span class="line">    prevProps: Readonly&lt;Props&gt;,</span><br><span class="line">    prevState: Readonly&lt;States&gt;</span><br><span class="line">  ) &#123;</span><br><span class="line">    // 监听 page和 per_page 是否发生变化</span><br><span class="line">    if (</span><br><span class="line">      prevState.reqParams.page !== this.state.reqParams.page ||</span><br><span class="line">      prevState.reqParams.per_page !== this.state.reqParams.per_page</span><br><span class="line">    ) &#123;</span><br><span class="line">      // 请求文章列表</span><br><span class="line">      await this.props.requestArticles(this.state.reqParams);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 渲染视图</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; reqParams &#125; = this.state;</span><br><span class="line">    const &#123; articleReducer &#125; = this.props;</span><br><span class="line">    return (</span><br><span class="line">      &lt;Pagination</span><br><span class="line">        page=&#123;reqParams.page || 1&#125;</span><br><span class="line">        per_page=&#123;reqParams.per_page || 10&#125;</span><br><span class="line">        total_count=&#123;articleReducer.articles.result.total_count || 0&#125;</span><br><span class="line">        maxPageNum=&#123;5&#125;</span><br><span class="line">        updateReqParams=&#123;this.updateReqParams&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const mapStateToProps: MapStateToPropsParam&lt;StateProps, OwnProps, AppState&gt; = (</span><br><span class="line">  state</span><br><span class="line">) =&gt; (&#123;</span><br><span class="line">  // 获取文章状态</span><br><span class="line">  articleReducer: state.articlesReducer,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const mapDispatchToProps: MapDispatchToPropsParam&lt;DispatchProps, OwnProps&gt; = (</span><br><span class="line">  dispatch: AppThunkDispatch</span><br><span class="line">) =&gt; (&#123;</span><br><span class="line">  // 获取文章列表</span><br><span class="line">  requestArticles: (reqParams) =&gt;</span><br><span class="line">    dispatch(ArticleCreators.requestArticles(reqParams)),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(ArticlePage);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>react</category>
        <category>ts</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>分页</tag>
      </tags>
  </entry>
  <entry>
    <title>proxy</title>
    <url>/archives/82d79681.html</url>
    <content><![CDATA[<h1 id="面试官：Vue3-0里为什么要用-Proxy-API-替代-defineProperty-API-？"><a href="#面试官：Vue3-0里为什么要用-Proxy-API-替代-defineProperty-API-？" class="headerlink" title="面试官：Vue3.0里为什么要用 Proxy API 替代 defineProperty API ？"></a>面试官：Vue3.0里为什么要用 Proxy API 替代 defineProperty API ？</h1><p> <img src="https://static.vue-js.com/57aa5c80-5f7f-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、Object-defineProperty"><a href="#一、Object-defineProperty" class="headerlink" title="一、Object.defineProperty"></a>一、Object.defineProperty</h2><p>定义：<code>Object.defineProperty()</code> 方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回此对象</p>
<h5 id="为什么能实现响应式"><a href="#为什么能实现响应式" class="headerlink" title="为什么能实现响应式"></a>为什么能实现响应式</h5><p>通过<code>defineProperty</code> 两个属性，<code>get</code>及<code>set</code></p>
<ul>
<li>get </li>
</ul>
<p>属性的 getter 函数，当访问该属性时，会调用此函数。执行时不传入任何参数，但是会传入 this 对象（由于继承关系，这里的this并不一定是定义该属性的对象）。该函数的返回值会被用作属性的值</p>
<ul>
<li>set </li>
</ul>
<p>属性的 setter 函数，当属性值被修改时，会调用此函数。该方法接受一个参数（也就是被赋予的新值），会传入赋值时的 this 对象。默认为 undefined</p>
<p>下面通过代码展示：</p>
<p>定义一个响应式函数<code>defineReactive</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    app.innerText = obj.foo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span>(<span class="params">obj, key, val</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`get <span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;val&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> val</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (newVal !== val) &#123;</span><br><span class="line">                val = newVal</span><br><span class="line">                update()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用<code>defineReactive</code>，数据发生变化触发<code>update</code>方法，实现数据响应式</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line">defineReactive(obj, <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    obj.foo = <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString()</span><br><span class="line">&#125;,<span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<p>在对象存在多个<code>key</code>情况下，需要进行遍历</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observe</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&#x27;object&#x27;</span> || obj == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Object</span>.keys(obj).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        defineReactive(obj, key, obj[key])</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果存在嵌套对象的情况，还需要在<code>defineReactive</code>中进行递归</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span>(<span class="params">obj, key, val</span>) </span>&#123;</span><br><span class="line">    observe(val)</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`get <span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;val&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> val</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (newVal !== val) &#123;</span><br><span class="line">                val = newVal</span><br><span class="line">                update()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当给<code>key</code>赋值为对象的时候，还需要在<code>set</code>属性中进行递归</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">set</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (newVal !== val) &#123;</span><br><span class="line">        observe(newVal) <span class="comment">// 新值是对象的情况</span></span><br><span class="line">        notifyUpdate()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述例子能够实现对一个对象的基本响应式，但仍然存在诸多问题</p>
<p>现在对一个对象进行删除与添加属性操作，无法劫持到</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">foo</span>: <span class="string">&quot;foo&quot;</span>,</span><br><span class="line">    <span class="attr">bar</span>: <span class="string">&quot;bar&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">observe(obj)</span><br><span class="line"><span class="keyword">delete</span> obj.foo <span class="comment">// no ok</span></span><br><span class="line">obj.jar = <span class="string">&#x27;xxx&#x27;</span> <span class="comment">// no ok</span></span><br></pre></td></tr></table></figure>
<p>当我们对一个数组进行监听的时候，并不那么好使了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arrData = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line">arrData.forEach(<span class="function">(<span class="params">val,index</span>)=&gt;</span>&#123;</span><br><span class="line">    defineProperty(arrData,index,val)</span><br><span class="line">&#125;)</span><br><span class="line">arrData.push() <span class="comment">// no ok</span></span><br><span class="line">arrData.pop()  <span class="comment">// no ok</span></span><br><span class="line">arrDate[<span class="number">0</span>] = <span class="number">99</span> <span class="comment">// ok</span></span><br></pre></td></tr></table></figure>
<p>可以看到数据的<code>api</code>无法劫持到，从而无法实现数据响应式，</p>
<p>所以在<code>Vue2</code>中，增加了<code>set</code>、<code>delete</code> API，并且对数组<code>api</code>方法进行一个重写</p>
<p>还有一个问题则是，如果存在深层的嵌套对象关系，需要深层的进行监听，造成了性能的极大问题</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li>检测不到对象属性的添加和删除</li>
<li>数组<code>API</code>方法无法监听到</li>
<li>需要对每个属性进行遍历监听，如果嵌套对象，需要深层监听，造成性能问题</li>
</ul>
<h2 id="二、proxy"><a href="#二、proxy" class="headerlink" title="二、proxy"></a>二、proxy</h2><p><code>Proxy</code>的监听是针对一个对象的，那么对这个对象的所有操作会进入监听操作，这就完全可以代理所有属性了</p>
<p>在<code>ES6</code>系列中，我们详细讲解过<code>Proxy</code>的使用，就不再述说了</p>
<p>下面通过代码进行展示：</p>
<p>定义一个响应式方法<code>reactive</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reactive</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&#x27;object&#x27;</span> &amp;&amp; obj != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Proxy相当于在对象外层加拦截</span></span><br><span class="line">    <span class="keyword">const</span> observed = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params">target, key, receiver</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`获取<span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;res&#125;</span>`</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params">target, key, value, receiver</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`设置<span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;value&#125;</span>`</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">deleteProperty</span>(<span class="params">target, key</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.deleteProperty(target, key)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`删除<span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;res&#125;</span>`</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> observed</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试一下简单数据的操作，发现都能劫持</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> state = reactive(&#123;</span><br><span class="line">    <span class="attr">foo</span>: <span class="string">&#x27;foo&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 1.获取</span></span><br><span class="line">state.foo <span class="comment">// ok</span></span><br><span class="line"><span class="comment">// 2.设置已存在属性</span></span><br><span class="line">state.foo = <span class="string">&#x27;fooooooo&#x27;</span> <span class="comment">// ok</span></span><br><span class="line"><span class="comment">// 3.设置不存在属性</span></span><br><span class="line">state.dong = <span class="string">&#x27;dong&#x27;</span> <span class="comment">// ok</span></span><br><span class="line"><span class="comment">// 4.删除属性</span></span><br><span class="line"><span class="keyword">delete</span> state.dong <span class="comment">// ok</span></span><br></pre></td></tr></table></figure>
<p>再测试嵌套对象情况，这时候发现就不那么 OK 了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> state = reactive(&#123;</span><br><span class="line">    <span class="attr">bar</span>: &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置嵌套对象属性</span></span><br><span class="line">state.bar.a = <span class="number">10</span> <span class="comment">// no ok</span></span><br></pre></td></tr></table></figure>
<p>如果要解决，需要在<code>get</code>之上再进行一层代理</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reactive</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&#x27;object&#x27;</span> &amp;&amp; obj != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Proxy相当于在对象外层加拦截</span></span><br><span class="line">    <span class="keyword">const</span> observed = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params">target, key, receiver</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`获取<span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;res&#125;</span>`</span>)</span><br><span class="line">            <span class="keyword">return</span> isObject(res) ? reactive(res) : res</span><br><span class="line">        &#125;,</span><br><span class="line">    <span class="keyword">return</span> observed</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h2><p><code>Object.defineProperty</code>只能遍历对象属性进行劫持</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observe</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&#x27;object&#x27;</span> || obj == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Object</span>.keys(obj).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        defineReactive(obj, key, obj[key])</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Proxy</code>直接可以劫持整个对象，并返回一个新对象，我们可以只操作新的对象达到响应式目的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reactive</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&#x27;object&#x27;</span> &amp;&amp; obj != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Proxy相当于在对象外层加拦截</span></span><br><span class="line">    <span class="keyword">const</span> observed = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params">target, key, receiver</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`获取<span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;res&#125;</span>`</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params">target, key, value, receiver</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`设置<span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;value&#125;</span>`</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">deleteProperty</span>(<span class="params">target, key</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.deleteProperty(target, key)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`删除<span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;res&#125;</span>`</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> observed</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Proxy</code>可以直接监听数组的变化（<code>push</code>、<code>shift</code>、<code>splice</code>）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">const</span> proxtObj = reactive(obj)</span><br><span class="line">obj.psuh(<span class="number">4</span>) <span class="comment">// ok</span></span><br></pre></td></tr></table></figure>
<p><code>Proxy</code>有多达13种拦截方法,不限于<code>apply</code>、<code>ownKeys</code>、<code>deleteProperty</code>、<code>has</code>等等，这是<code>Object.defineProperty</code>不具备的</p>
<p>正因为<code>defineProperty</code>自身的缺陷，导致<code>Vue2</code>在实现响应式过程需要实现其他的方法辅助（如重写数组方法、增加额外<code>set</code>、<code>delete</code>方法）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 数组重写</span></span><br><span class="line"><span class="keyword">const</span> originalProto = <span class="built_in">Array</span>.prototype</span><br><span class="line"><span class="keyword">const</span> arrayProto = <span class="built_in">Object</span>.create(originalProto)</span><br><span class="line">[<span class="string">&#x27;push&#x27;</span>, <span class="string">&#x27;pop&#x27;</span>, <span class="string">&#x27;shift&#x27;</span>, <span class="string">&#x27;unshift&#x27;</span>, <span class="string">&#x27;splice&#x27;</span>, <span class="string">&#x27;reverse&#x27;</span>, <span class="string">&#x27;sort&#x27;</span>].forEach(<span class="function"><span class="params">method</span> =&gt;</span> &#123;</span><br><span class="line">  arrayProto[method] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    originalProto[method].apply(<span class="built_in">this</span>.arguments)</span><br><span class="line">    dep.notice()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// set、delete</span></span><br><span class="line">Vue.set(obj,<span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;newbar&#x27;</span>)</span><br><span class="line">Vue.delete(obj),<span class="string">&#x27;bar&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><code>Proxy</code> 不兼容IE，也没有 <code>polyfill</code>, <code>defineProperty</code> 能支持到IE9</p>
]]></content>
      <categories>
        <category>vue3</category>
      </categories>
      <tags>
        <tag>vue3</tag>
        <tag>proxy</tag>
      </tags>
  </entry>
  <entry>
    <title>下拉刷新</title>
    <url>/archives/97b76847.html</url>
    <content><![CDATA[<h1 id="面试官：如何实现上拉加载，下拉刷新？"><a href="#面试官：如何实现上拉加载，下拉刷新？" class="headerlink" title="面试官：如何实现上拉加载，下拉刷新？"></a>面试官：如何实现上拉加载，下拉刷新？</h1><p> <img src="https://static.vue-js.com/89cd1850-8adc-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>下拉刷新和上拉加载这两种交互方式通常出现在移动端中</p>
<p>本质上等同于PC网页中的分页，只是交互形式不同</p>
<p>开源社区也有很多优秀的解决方案，如<code>iscroll</code>、<code>better-scroll</code>、<code>pulltorefresh.js</code>库等等</p>
<p>这些第三方库使用起来非常便捷</p>
<p>我们通过原生的方式实现一次上拉加载，下拉刷新，有助于对第三方库有更好的理解与使用</p>
<h2 id="二、实现原理"><a href="#二、实现原理" class="headerlink" title="二、实现原理"></a>二、实现原理</h2><p>上拉加载及下拉刷新都依赖于用户交互</p>
<p>最重要的是要理解在什么场景，什么时机下触发交互动作</p>
<h3 id="上拉加载"><a href="#上拉加载" class="headerlink" title="上拉加载"></a>上拉加载</h3><p>首先可以看一张图</p>
<p> <img src="https://static.vue-js.com/df498a00-8ae3-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>上拉加载的本质是页面触底，或者快要触底时的动作</p>
<p>判断页面触底我们需要先了解一下下面几个属性</p>
<ul>
<li><p><code>scrollTop</code>：滚动视窗的高度距离<code>window</code>顶部的距离，它会随着往上滚动而不断增加，初始值是0，它是一个变化的值</p>
</li>
<li><p><code>clientHeight</code>:它是一个定值，表示屏幕可视区域的高度；</p>
</li>
<li><code>scrollHeight</code>：页面不能滚动时也是存在的,此时scrollHeight等于clientHeight。scrollHeight表示<code>body</code>所有元素的总长度(包括body元素自身的padding)</li>
</ul>
<p>综上我们得出一个触底公式：<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">scrollTop + clientHeight &gt;= scrollHeight</span><br></pre></td></tr></table></figure></p>
<p>简单实现<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> clientHeight  = <span class="built_in">document</span>.documentElement.clientHeight; <span class="comment">//浏览器高度</span></span><br><span class="line"><span class="keyword">let</span> scrollHeight = <span class="built_in">document</span>.body.scrollHeight;</span><br><span class="line"><span class="keyword">let</span> scrollTop = <span class="built_in">document</span>.documentElement.scrollTop;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> distance = <span class="number">50</span>;  <span class="comment">//距离视窗还用50的时候，开始触发；</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((scrollTop + clientHeight) &gt;= (scrollHeight - distance)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;开始加载数据&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="下拉刷新"><a href="#下拉刷新" class="headerlink" title="下拉刷新"></a>下拉刷新</h3><p>下拉刷新的本质是页面本身置于顶部时，用户下拉时需要触发的动作</p>
<p>关于下拉刷新的原生实现，主要分成三步：</p>
<ul>
<li>监听原生<code>touchstart</code>事件，记录其初始位置的值，<code>e.touches[0].pageY</code>；</li>
<li>监听原生<code>touchmove</code>事件，记录并计算当前滑动的位置值与初始位置值的差值，大于<code>0</code>表示向下拉动，并借助CSS3的<code>translateY</code>属性使元素跟随手势向下滑动对应的差值，同时也应设置一个允许滑动的最大值；</li>
<li>监听原生<code>touchend</code>事件，若此时元素滑动达到最大值，则触发<code>callback</code>，同时将<code>translateY</code>重设为<code>0</code>，元素回到初始位置</li>
</ul>
<p>举个例子：</p>
<p><code>Html</code>结构如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;main&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;refreshText&quot;</span>&gt;</span>&lt;/p &gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;refreshContainer&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>111<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>222<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>333<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>444<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>555<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        ...</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">main</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>监听<code>touchstart</code>事件，记录初始的值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> _element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;refreshContainer&#x27;</span>),</span><br><span class="line">    _refreshText = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;.refreshText&#x27;</span>),</span><br><span class="line">    _startPos = <span class="number">0</span>,  <span class="comment">// 初始的值</span></span><br><span class="line">    _transitionHeight = <span class="number">0</span>; <span class="comment">// 移动的距离</span></span><br><span class="line"></span><br><span class="line">_element.addEventListener(<span class="string">&#x27;touchstart&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    _startPos = e.touches[<span class="number">0</span>].pageY; <span class="comment">// 记录初始位置</span></span><br><span class="line">    _element.style.position = <span class="string">&#x27;relative&#x27;</span>;</span><br><span class="line">    _element.style.transition = <span class="string">&#x27;transform 0s&#x27;</span>;</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>监听<code>touchmove</code>移动事件，记录滑动差值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">_element.addEventListener(<span class="string">&#x27;touchmove&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// e.touches[0].pageY 当前位置</span></span><br><span class="line">    _transitionHeight = e.touches[<span class="number">0</span>].pageY - _startPos; <span class="comment">// 记录差值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_transitionHeight &gt; <span class="number">0</span> &amp;&amp; _transitionHeight &lt; <span class="number">60</span>) &#123; </span><br><span class="line">        _refreshText.innerText = <span class="string">&#x27;下拉刷新&#x27;</span>; </span><br><span class="line">        _element.style.transform = <span class="string">&#x27;translateY(&#x27;</span>+_transitionHeight+<span class="string">&#x27;px)&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (_transitionHeight &gt; <span class="number">55</span>) &#123;</span><br><span class="line">            _refreshText.innerText = <span class="string">&#x27;释放更新&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;                </span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>最后，就是监听<code>touchend</code>离开的事件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">_element.addEventListener(<span class="string">&#x27;touchend&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    _element.style.transition = <span class="string">&#x27;transform 0.5s ease 1s&#x27;</span>;</span><br><span class="line">    _element.style.transform = <span class="string">&#x27;translateY(0px)&#x27;</span>;</span><br><span class="line">    _refreshText.innerText = <span class="string">&#x27;更新中...&#x27;</span>;</span><br><span class="line">    <span class="comment">// todo...</span></span><br><span class="line"></span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>从上面可以看到，在下拉到松手的过程中，经历了三个阶段：</p>
<ul>
<li>当前手势滑动位置与初始位置差值大于零时，提示正在进行下拉刷新操作</li>
<li>下拉到一定值时，显示松手释放后的操作提示</li>
<li>下拉到达设定最大值松手时，执行回调，提示正在进行更新操作</li>
</ul>
<h2 id="三、案例"><a href="#三、案例" class="headerlink" title="三、案例"></a>三、案例</h2><p>在实际开发中，我们更多的是使用第三方库，下面以<code>better-scroll</code>进行举例：</p>
<p>HTML结构</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;position-wrapper&quot;</span>&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;refresh&quot;</span>&gt;</span>下拉刷新&lt;/p &gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;position-list&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">   <span class="comment">&lt;!--列表内容--&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;more&quot;</span>&gt;</span>查看更多&lt;/p &gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>实例化上拉下拉插件，通过<code>use</code>来注册插件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> BScroll <span class="keyword">from</span> <span class="string">&quot;@better-scroll/core&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> PullDown <span class="keyword">from</span> <span class="string">&quot;@better-scroll/pull-down&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> PullUp <span class="keyword">from</span> <span class="string">&#x27;@better-scroll/pull-up&#x27;</span>;</span><br><span class="line">BScroll.use(PullDown);</span><br><span class="line">BScroll.use(PullUp);</span><br></pre></td></tr></table></figure>
<p>实例化<code>BetterScroll</code>，并传入相关的参数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> pageNo = <span class="number">1</span>,pageSize = <span class="number">10</span>,dataList = [],isMore = <span class="literal">true</span>;  </span><br><span class="line"><span class="keyword">var</span> scroll= <span class="keyword">new</span> BScroll(<span class="string">&quot;#position-wrapper&quot;</span>,&#123;</span><br><span class="line">    <span class="attr">scrollY</span>:<span class="literal">true</span>,<span class="comment">//垂直方向滚动</span></span><br><span class="line">    <span class="attr">click</span>:<span class="literal">true</span>,<span class="comment">//默认会阻止浏览器的原生click事件，如果需要点击，这里要设为true</span></span><br><span class="line">    <span class="attr">pullUpLoad</span>:<span class="literal">true</span>,<span class="comment">//上拉加载更多</span></span><br><span class="line">    <span class="attr">pullDownRefresh</span>:&#123;</span><br><span class="line">        <span class="attr">threshold</span>:<span class="number">50</span>,<span class="comment">//触发pullingDown事件的位置</span></span><br><span class="line">        <span class="attr">stop</span>:<span class="number">0</span><span class="comment">//下拉回弹后停留的位置</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//监听下拉刷新</span></span><br><span class="line">scroll.on(<span class="string">&quot;pullingDown&quot;</span>,pullingDownHandler);</span><br><span class="line"><span class="comment">//监测实时滚动</span></span><br><span class="line">scroll.on(<span class="string">&quot;scroll&quot;</span>,scrollHandler);</span><br><span class="line"><span class="comment">//上拉加载更多</span></span><br><span class="line">scroll.on(<span class="string">&quot;pullingUp&quot;</span>,pullingUpHandler);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">pullingDownHandler</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    dataList=[];</span><br><span class="line">    pageNo=<span class="number">1</span>;</span><br><span class="line">    isMore=<span class="literal">true</span>;</span><br><span class="line">    $(<span class="string">&quot;.more&quot;</span>).text(<span class="string">&quot;查看更多&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> getlist();<span class="comment">//请求数据</span></span><br><span class="line">    scroll.finishPullDown();<span class="comment">//每次下拉结束后，需要执行这个操作</span></span><br><span class="line">    scroll.refresh();<span class="comment">//当滚动区域的dom结构有变化时，需要执行这个操作</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">pullingUpHandler</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!isMore)&#123;</span><br><span class="line">        $(<span class="string">&quot;.more&quot;</span>).text(<span class="string">&quot;没有更多数据了&quot;</span>);</span><br><span class="line">        scroll.finishPullUp();<span class="comment">//每次上拉结束后，需要执行这个操作</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pageNo++;</span><br><span class="line">    <span class="keyword">await</span> <span class="built_in">this</span>.getlist();<span class="comment">//请求数据</span></span><br><span class="line">    scroll.finishPullUp();<span class="comment">//每次上拉结束后，需要执行这个操作</span></span><br><span class="line">    scroll.refresh();<span class="comment">//当滚动区域的dom结构有变化时，需要执行这个操作    </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scrollHandler</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">this</span>.y&gt;<span class="number">50</span>) $(<span class="string">&#x27;.refresh&#x27;</span>).text(<span class="string">&quot;松手开始加载&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> $(<span class="string">&#x27;.refresh&#x27;</span>).text(<span class="string">&quot;下拉刷新&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getlist</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//返回的数据</span></span><br><span class="line">    <span class="keyword">let</span> result=....;</span><br><span class="line">    dataList=dataList.concat(result);</span><br><span class="line">    <span class="comment">//判断是否已加载完</span></span><br><span class="line">    <span class="keyword">if</span>(result.length&lt;pageSize) isMore=<span class="literal">false</span>;</span><br><span class="line">    <span class="comment">//将dataList渲染到html内容中</span></span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure>
<p>注意点：</p>
<p>使用<code>better-scroll</code>实现下拉刷新、上拉加载时要注意以下几点：</p>
<ul>
<li><code>wrapper</code>里必须只有一个子元素</li>
<li>子元素的高度要比<code>wrapper</code>要高</li>
<li>使用的时候，要确定<code>DOM</code>元素是否已经生成，必须要等到<code>DOM</code>渲染完成后，再<code>new BScroll()</code></li>
<li>滚动区域的<code>DOM</code>元素结构有变化后，需要执行刷新 <code>refresh()</code></li>
<li>上拉或者下拉，结束后，需要执行<code>finishPullUp()</code>或者<code>finishPullDown()</code>，否则将不会执行下次操作</li>
<li><code>better-scroll</code>，默认会阻止浏览器的原生<code>click</code>事件，如果滚动内容区要添加点击事件，需要在实例化属性里设置<code>click:true</code></li>
</ul>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>下拉刷新、上拉加载原理本身都很简单，真正复杂的是封装过程中，要考虑的兼容性、易用性、性能等诸多细节</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://segmentfault.com/a/1190000014423308">https://segmentfault.com/a/1190000014423308</a></li>
<li><a href="https://github.com/ustbhuangyi/better-scroll">https://github.com/ustbhuangyi/better-scroll</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>下拉刷新</tag>
      </tags>
  </entry>
  <entry>
    <title>proxyEs6</title>
    <url>/archives/294b86eb.html</url>
    <content><![CDATA[<h1 id="面试官：你是怎么理解ES6中Proxy的？使用场景"><a href="#面试官：你是怎么理解ES6中Proxy的？使用场景" class="headerlink" title="面试官：你是怎么理解ES6中Proxy的？使用场景?"></a>面试官：你是怎么理解ES6中Proxy的？使用场景?</h1><p> <img src="https://static.vue-js.com/6f656e30-59f5-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h2><p><strong>定义：</strong> 用于定义基本操作的自定义行为</p>
<p><strong>本质：</strong> 修改的是程序默认形为，就形同于在编程语言层面上做修改，属于元编程<code>(meta programming)</code></p>
<p>元编程（Metaprogramming，又译超编程，是指某类计算机程序的编写，这类计算机程序编写或者操纵其它程序（或者自身）作为它们的数据，或者在运行时完成部分本应在编译时完成的工作</p>
<p>一段代码来理解<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># metaprogram</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;#!/bin/bash&#x27;</span> &gt;program</span><br><span class="line"><span class="keyword">for</span> ((I=1; I&lt;=1024; I++)) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;echo <span class="variable">$I</span>&quot;</span> &gt;&gt;program</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">chmod +x program</span><br></pre></td></tr></table></figure><br>这段程序每执行一次能帮我们生成一个名为<code>program</code>的文件，文件内容为1024行<code>echo</code>，如果我们手动来写1024行代码，效率显然低效</p>
<ul>
<li>元编程优点：与手工编写全部代码相比，程序员可以获得更高的工作效率，或者给与程序更大的灵活度去处理新的情形而无需重新编译</li>
</ul>
<p><code>Proxy</code> 亦是如此，用于创建一个对象的代理，从而实现基本操作的拦截和自定义（如属性查找、赋值、枚举、函数调用等）</p>
<h2 id="二、用法"><a href="#二、用法" class="headerlink" title="二、用法"></a>二、用法</h2><p><code>Proxy</code>为 构造函数，用来生成 <code>Proxy</code>实例</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler)</span><br></pre></td></tr></table></figure>
<h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><p><code>target</code>表示所要拦截的目标对象（任何类型的对象，包括原生数组，函数，甚至另一个代理））</p>
<p><code>handler</code>通常以函数作为属性的对象，各属性中的函数分别定义了在执行各种操作时代理 <code>p</code> 的行为</p>
<h3 id="handler解析"><a href="#handler解析" class="headerlink" title="handler解析"></a>handler解析</h3><p>关于<code>handler</code>拦截属性，有如下：</p>
<ul>
<li>get(target,propKey,receiver)：拦截对象属性的读取</li>
<li>set(target,propKey,value,receiver)：拦截对象属性的设置</li>
<li>has(target,propKey)：拦截<code>propKey in proxy</code>的操作，返回一个布尔值</li>
<li>deleteProperty(target,propKey)：拦截<code>delete proxy[propKey]</code>的操作，返回一个布尔值</li>
<li>ownKeys(target)：拦截<code>Object.keys(proxy)</code>、<code>for...in</code>等循环，返回一个数组</li>
<li>getOwnPropertyDescriptor(target, propKey)：拦截<code>Object.getOwnPropertyDescriptor(proxy, propKey)</code>，返回属性的描述对象</li>
<li>defineProperty(target, propKey, propDesc)：拦截<code>Object.defineProperty(proxy, propKey, propDesc）</code>，返回一个布尔值</li>
<li>preventExtensions(target)：拦截<code>Object.preventExtensions(proxy)</code>，返回一个布尔值</li>
<li>getPrototypeOf(target)：拦截<code>Object.getPrototypeOf(proxy)</code>，返回一个对象</li>
<li>isExtensible(target)：拦截<code>Object.isExtensible(proxy)</code>，返回一个布尔值</li>
<li>setPrototypeOf(target, proto)：拦截<code>Object.setPrototypeOf(proxy, proto)</code>，返回一个布尔值</li>
<li>apply(target, object, args)：拦截 Proxy 实例作为函数调用的操作</li>
<li>construct(target, args)：拦截 Proxy 实例作为构造函数调用的操作</li>
</ul>
<h3 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h3><p>若需要在<code>Proxy</code>内部调用对象的默认行为，建议使用<code>Reflect</code>，其是<code>ES6</code>中操作对象而提供的新 <code>API</code></p>
<p>基本特点：</p>
<ul>
<li>只要<code>Proxy</code>对象具有的代理方法，<code>Reflect</code>对象全部具有，以静态方法的形式存在</li>
<li>修改某些<code>Object</code>方法的返回结果，让其变得更合理（定义不存在属性行为的时候不报错而是返回<code>false</code>）</li>
<li>让<code>Object</code>操作都变成函数行为      </li>
</ul>
<p>下面我们介绍<code>proxy</code>几种用法：</p>
<h3 id="get"><a href="#get" class="headerlink" title="get()"></a>get()</h3><p><code>get</code>接受三个参数，依次为目标对象、属性名和 <code>proxy</code> 实例本身，最后一个参数可选</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(person, &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, propKey</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target,propKey)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">proxy.name <span class="comment">// &quot;张三&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>get</code>能够对数组增删改查进行拦截，下面是试下你数组读取负数的索引</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createArray</span>(<span class="params">...elements</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> handler = &#123;</span><br><span class="line">    <span class="function"><span class="title">get</span>(<span class="params">target, propKey, receiver</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> index = <span class="built_in">Number</span>(propKey);</span><br><span class="line">      <span class="keyword">if</span> (index &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        propKey = <span class="built_in">String</span>(target.length + index);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, propKey, receiver);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> target = [];</span><br><span class="line">  target.push(...elements);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = createArray(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">arr[-<span class="number">1</span>] <span class="comment">// c</span></span><br></pre></td></tr></table></figure>
<p>注意：如果一个属性不可配置（configurable）且不可写（writable），则 Proxy 不能修改该属性，否则会报错</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> target = <span class="built_in">Object</span>.defineProperties(&#123;&#125;, &#123;</span><br><span class="line">  <span class="attr">foo</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="number">123</span>,</span><br><span class="line">    <span class="attr">writable</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params">target, propKey</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line"></span><br><span class="line">proxy.foo</span><br><span class="line"><span class="comment">// TypeError: Invariant check failed</span></span><br></pre></td></tr></table></figure>
<h3 id="set"><a href="#set" class="headerlink" title="set()"></a>set()</h3><p><code>set</code>方法用来拦截某个属性的赋值操作，可以接受四个参数，依次为目标对象、属性名、属性值和 <code>Proxy</code> 实例本身</p>
<p>假定<code>Person</code>对象有一个<code>age</code>属性，该属性应该是一个不大于 200 的整数，那么可以使用<code>Proxy</code>保证<code>age</code>的属性值符合要求</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> validator = &#123;</span><br><span class="line">  <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params">obj, prop, value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (prop === <span class="string">&#x27;age&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="built_in">Number</span>.isInteger(value)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&#x27;The age is not an integer&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (value &gt; <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RangeError</span>(<span class="string">&#x27;The age seems invalid&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对于满足条件的 age 属性以及其他属性，直接保存</span></span><br><span class="line">    obj[prop] = value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, validator);</span><br><span class="line"></span><br><span class="line">person.age = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">person.age <span class="comment">// 100</span></span><br><span class="line">person.age = <span class="string">&#x27;young&#x27;</span> <span class="comment">// 报错</span></span><br><span class="line">person.age = <span class="number">300</span> <span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
<p>如果目标对象自身的某个属性，不可写且不可配置，那么<code>set</code>方法将不起作用</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">&#x27;foo&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;bar&#x27;</span>,</span><br><span class="line">  <span class="attr">writable</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">  <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params">obj, prop, value, receiver</span>) </span>&#123;</span><br><span class="line">    obj[prop] = <span class="string">&#x27;baz&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, handler);</span><br><span class="line">proxy.foo = <span class="string">&#x27;baz&#x27;</span>;</span><br><span class="line">proxy.foo <span class="comment">// &quot;bar&quot;</span></span><br></pre></td></tr></table></figure>
<p>注意，严格模式下，<code>set</code>代理如果没有返回<code>true</code>，就会报错</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">  <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params">obj, prop, value, receiver</span>) </span>&#123;</span><br><span class="line">    obj[prop] = receiver;</span><br><span class="line">    <span class="comment">// 无论有没有下面这一行，都会报错</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, handler);</span><br><span class="line">proxy.foo = <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line"><span class="comment">// TypeError: &#x27;set&#x27; on proxy: trap returned falsish for property &#x27;foo&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="deleteProperty"><a href="#deleteProperty" class="headerlink" title="deleteProperty()"></a>deleteProperty()</h3><p><code>deleteProperty</code>方法用于拦截<code>delete</code>操作，如果这个方法抛出错误或者返回<code>false</code>，当前属性就无法被<code>delete</code>命令删除</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> handler = &#123;</span><br><span class="line">  deleteProperty (target, key) &#123;</span><br><span class="line">    invariant(key, <span class="string">&#x27;delete&#x27;</span>);</span><br><span class="line">    <span class="built_in">Reflect</span>.deleteProperty(target,key)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">invariant</span> (<span class="params">key, action</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (key[<span class="number">0</span>] === <span class="string">&#x27;_&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`无法删除私有属性`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> target = &#123; <span class="attr">_prop</span>: <span class="string">&#x27;foo&#x27;</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line"><span class="keyword">delete</span> proxy._prop</span><br><span class="line"><span class="comment">// Error: 无法删除私有属性</span></span><br></pre></td></tr></table></figure>
<p>注意，目标对象自身的不可配置（configurable）的属性，不能被<code>deleteProperty</code>方法删除，否则报错</p>
<h3 id="取消代理"><a href="#取消代理" class="headerlink" title="取消代理"></a>取消代理</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Proxy.revocable(target, handler);</span><br></pre></td></tr></table></figure>
<h2 id="三、使用场景"><a href="#三、使用场景" class="headerlink" title="三、使用场景"></a>三、使用场景</h2><p><code>Proxy</code>其功能非常类似于设计模式中的代理模式，常用功能如下：</p>
<ul>
<li>拦截和监视外部对对象的访问</li>
<li>降低函数或类的复杂度</li>
<li>在复杂操作前对操作进行校验或对所需资源进行管理</li>
</ul>
<p>使用 <code>Proxy</code> 保障数据类型的准确性</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numericDataStore = &#123; <span class="attr">count</span>: <span class="number">0</span>, <span class="attr">amount</span>: <span class="number">1234</span>, <span class="attr">total</span>: <span class="number">14</span> &#125;;</span><br><span class="line">numericDataStore = <span class="keyword">new</span> <span class="built_in">Proxy</span>(numericDataStore, &#123;</span><br><span class="line">    <span class="function"><span class="title">set</span>(<span class="params">target, key, value, proxy</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> value !== <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">&quot;属性只能是number类型&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Reflect</span>.set(target, key, value, proxy);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">numericDataStore.count = <span class="string">&quot;foo&quot;</span></span><br><span class="line"><span class="comment">// Error: 属性只能是number类型</span></span><br><span class="line"></span><br><span class="line">numericDataStore.count = <span class="number">333</span></span><br><span class="line"><span class="comment">// 赋值成功</span></span><br></pre></td></tr></table></figure>
<p>声明了一个私有的 <code>apiKey</code>，便于 <code>api</code> 这个对象内部的方法调用，但不希望从外部也能够访问 <code>api._apiKey</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> api = &#123;</span><br><span class="line">    <span class="attr">_apiKey</span>: <span class="string">&#x27;123abc456def&#x27;</span>,</span><br><span class="line">    <span class="attr">getUsers</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; &#125;,</span><br><span class="line">    <span class="attr">getUser</span>: <span class="function"><span class="keyword">function</span>(<span class="params">userId</span>)</span>&#123; &#125;,</span><br><span class="line">    <span class="attr">setUser</span>: <span class="function"><span class="keyword">function</span>(<span class="params">userId, config</span>)</span>&#123; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> RESTRICTED = [<span class="string">&#x27;_apiKey&#x27;</span>];</span><br><span class="line">api = <span class="keyword">new</span> <span class="built_in">Proxy</span>(api, &#123;</span><br><span class="line">    <span class="function"><span class="title">get</span>(<span class="params">target, key, proxy</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(RESTRICTED.indexOf(key) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">`<span class="subst">$&#123;key&#125;</span> 不可访问.`</span>);</span><br><span class="line">        &#125; <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, key, proxy);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">set</span>(<span class="params">target, key, value, proxy</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(RESTRICTED.indexOf(key) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">`<span class="subst">$&#123;key&#125;</span> 不可修改`</span>);</span><br><span class="line">        &#125; <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, key, value, proxy);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(api._apiKey)</span><br><span class="line">api._apiKey = <span class="string">&#x27;987654321&#x27;</span></span><br><span class="line"><span class="comment">// 上述都抛出错误</span></span><br></pre></td></tr></table></figure>
<p>还能通过使用<code>Proxy</code>实现观察者模式</p>
<p>观察者模式（Observer mode）指的是函数自动观察数据对象，一旦对象有变化，函数就会自动执行</p>
<p><code>observable</code>函数返回一个原始对象的 <code>Proxy</code> 代理，拦截赋值操作，触发充当观察者的各个函数</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> queuedObservers = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> observe = <span class="function"><span class="params">fn</span> =&gt;</span> queuedObservers.add(fn);</span><br><span class="line"><span class="keyword">const</span> observable = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;set&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set</span>(<span class="params">target, key, value, receiver</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.set(target, key, value, receiver);</span><br><span class="line">  queuedObservers.forEach(<span class="function"><span class="params">observer</span> =&gt;</span> observer());</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>观察者函数都放进<code>Set</code>集合，当修改<code>obj</code>的值，在会<code>set</code>函数中拦截，自动执行<code>Set</code>所有的观察者</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://es6.ruanyifeng.com/#docs/proxy">https://es6.ruanyifeng.com/#docs/proxy</a></li>
<li><a href="https://vue3js.cn/es6">https://vue3js.cn/es6</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>es6</tag>
        <tag>proxyEs6</tag>
      </tags>
  </entry>
  <entry>
    <title>regexp</title>
    <url>/archives/f9f4b1e7.html</url>
    <content><![CDATA[<h1 id="面试官：说说你对正则表达式的理解？应用场景？"><a href="#面试官：说说你对正则表达式的理解？应用场景？" class="headerlink" title="面试官：说说你对正则表达式的理解？应用场景？"></a>面试官：说说你对正则表达式的理解？应用场景？</h1><p><img src="https://static.vue-js.com/55388a40-7f1d-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>正则表达式是一种用来匹配字符串的强有力的武器</p>
<p>它的设计思想是用一种描述性的语言定义一个规则，凡是符合规则的字符串，我们就认为它“匹配”了，否则，该字符串就是不合法的</p>
<p>在 <code>JavaScript</code>中，正则表达式也是对象，构建正则表达式有两种方式：</p>
<ol>
<li>字面量创建，其由包含在斜杠之间的模式组成</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> re = <span class="regexp">/\d+/g</span>;</span><br></pre></td></tr></table></figure>
<ol>
<li>调用<code>RegExp</code>对象的构造函数</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> re = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;\\d+&quot;</span>,<span class="string">&quot;g&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rul = <span class="string">&quot;\\d+&quot;</span></span><br><span class="line"><span class="keyword">const</span> re1 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(rul,<span class="string">&quot;g&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>使用构建函数创建，第一个参数可以是一个变量，遇到特殊字符<code>\</code>需要使用<code>\\</code>进行转义</p>
<h2 id="二、匹配规则"><a href="#二、匹配规则" class="headerlink" title="二、匹配规则"></a>二、匹配规则</h2><p>常见的校验规则如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>规则</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>\</td>
<td>转义</td>
</tr>
<tr>
<td>^</td>
<td>匹配输入的开始</td>
</tr>
<tr>
<td>$</td>
<td>匹配输入的结束</td>
</tr>
<tr>
<td>*</td>
<td>匹配前一个表达式 0 次或多次</td>
</tr>
<tr>
<td>+</td>
<td>匹配前面一个表达式 1 次或者多次。等价于 <code>&#123;1,&#125;</code></td>
</tr>
<tr>
<td>?</td>
<td>匹配前面一个表达式 0 次或者 1 次。等价于<code>&#123;0,1&#125;</code></td>
</tr>
<tr>
<td>.</td>
<td>默认匹配除换行符之外的任何单个字符</td>
</tr>
<tr>
<td>x(?=y)</td>
<td>匹配’x’仅仅当’x’后面跟着’y’。这种叫做先行断言</td>
</tr>
<tr>
<td>(?&lt;=y)x</td>
<td>匹配’x’仅当’x’前面是’y’.这种叫做后行断言</td>
</tr>
<tr>
<td>x(?!y)</td>
<td>仅仅当’x’后面不跟着’y’时匹配’x’，这被称为正向否定查找</td>
</tr>
<tr>
<td>(?&lt;!<em>y</em>)<em>x</em></td>
<td>仅仅当’x’前面不是’y’时匹配’x’，这被称为反向否定查找</td>
</tr>
<tr>
<td>x\</td>
<td>y</td>
<td>匹配‘x’或者‘y’</td>
</tr>
<tr>
<td>{n}</td>
<td>n 是一个正整数，匹配了前面一个字符刚好出现了 n 次</td>
</tr>
<tr>
<td>{n,}</td>
<td>n是一个正整数，匹配前一个字符至少出现了n次</td>
</tr>
<tr>
<td>{n,m}</td>
<td>n 和 m 都是整数。匹配前面的字符至少n次，最多m次</td>
</tr>
<tr>
<td>[xyz]</td>
<td>一个字符集合。匹配方括号中的任意字符</td>
</tr>
<tr>
<td><sup><a href="#fn_xyz\" id="reffn_xyz\">xyz\</a></sup></td>
<td>匹配任何没有包含在方括号中的字符</td>
</tr>
<tr>
<td>\b</td>
<td>匹配一个词的边界，例如在字母和空格之间</td>
</tr>
<tr>
<td>\B</td>
<td>匹配一个非单词边界</td>
</tr>
<tr>
<td>\d</td>
<td>匹配一个数字</td>
</tr>
<tr>
<td>\D</td>
<td>匹配一个非数字字符</td>
</tr>
<tr>
<td>\f</td>
<td>匹配一个换页符</td>
</tr>
<tr>
<td>\n</td>
<td>匹配一个换行符</td>
</tr>
<tr>
<td>\r</td>
<td>匹配一个回车符</td>
</tr>
<tr>
<td>\s</td>
<td>匹配一个空白字符，包括空格、制表符、换页符和换行符</td>
</tr>
<tr>
<td>\S</td>
<td>匹配一个非空白字符</td>
</tr>
<tr>
<td>\w</td>
<td>匹配一个单字字符（字母、数字或者下划线）</td>
</tr>
<tr>
<td>\W</td>
<td>匹配一个非单字字符</td>
</tr>
</tbody>
</table>
</div>
<h3 id="正则表达式标记"><a href="#正则表达式标记" class="headerlink" title="正则表达式标记"></a>正则表达式标记</h3><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">标志</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>g</code></td>
<td style="text-align:left">全局搜索。</td>
</tr>
<tr>
<td style="text-align:left"><code>i</code></td>
<td style="text-align:left">不区分大小写搜索。</td>
</tr>
<tr>
<td style="text-align:left"><code>m</code></td>
<td style="text-align:left">多行搜索。</td>
</tr>
<tr>
<td style="text-align:left"><code>s</code></td>
<td style="text-align:left">允许 <code>.</code> 匹配换行符。</td>
</tr>
<tr>
<td style="text-align:left"><code>u</code></td>
<td style="text-align:left">使用<code>unicode</code>码的模式进行匹配。</td>
</tr>
<tr>
<td style="text-align:left"><code>y</code></td>
<td style="text-align:left">执行“粘性(<code>sticky</code>)”搜索,匹配从目标字符串的当前位置开始。</td>
</tr>
</tbody>
</table>
</div>
<p>使用方法如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/pattern/</span>flags;</span><br><span class="line"><span class="keyword">var</span> re = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;pattern&quot;</span>, <span class="string">&quot;flags&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>在了解下正则表达式基本的之外，还可以掌握几个正则表达式的特性：</p>
<h3 id="贪婪模式"><a href="#贪婪模式" class="headerlink" title="贪婪模式"></a>贪婪模式</h3><p>在了解贪婪模式前，首先举个例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> reg = <span class="regexp">/ab&#123;1,3&#125;c/</span></span><br></pre></td></tr></table></figure>
<p>在匹配过程中，尝试可能的顺序是从多往少的方向去尝试。首先会尝试<code>bbb</code>，然后再看整个正则是否能匹配。不能匹配时，吐出一个<code>b</code>，即在<code>bb</code>的基础上，再继续尝试，以此重复</p>
<p>如果多个贪婪量词挨着，则深度优先搜索</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> string = <span class="string">&quot;12345&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> regx = <span class="regexp">/(\d&#123;1,3&#125;)(\d&#123;1,3&#125;)/</span>;</span><br><span class="line"><span class="built_in">console</span>.log( string.match(reg) );</span><br><span class="line"><span class="comment">// =&gt; [&quot;12345&quot;, &quot;123&quot;, &quot;45&quot;, index: 0, input: &quot;12345&quot;]</span></span><br></pre></td></tr></table></figure>
<p>其中，前面的<code>\d&#123;1,3&#125;</code>匹配的是”123”，后面的<code>\d&#123;1,3&#125;</code>匹配的是”45”</p>
<h3 id="懒惰模式"><a href="#懒惰模式" class="headerlink" title="懒惰模式"></a>懒惰模式</h3><p>惰性量词就是在贪婪量词后面加个问号。表示尽可能少的匹配</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> string = <span class="string">&quot;12345&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> regex = <span class="regexp">/(\d&#123;1,3&#125;?)(\d&#123;1,3&#125;)/</span>;</span><br><span class="line"><span class="built_in">console</span>.log( string.match(regex) );</span><br><span class="line"><span class="comment">// =&gt; [&quot;1234&quot;, &quot;1&quot;, &quot;234&quot;, index: 0, input: &quot;12345&quot;]</span></span><br></pre></td></tr></table></figure>
<p>其中<code>\d&#123;1,3&#125;?</code>只匹配到一个字符”1”，而后面的<code>\d&#123;1,3&#125;</code>匹配了”234”</p>
<h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><p>分组主要是用过<code>()</code>进行实现，比如<code>beyond&#123;3&#125;</code>，是匹配<code>d</code>字母3次。而<code>(beyond)&#123;3&#125;</code>是匹配<code>beyond</code>三次</p>
<p>在<code>()</code>内使用<code>|</code>达到或的效果，如<code>(abc | xxx)</code>可以匹配<code>abc</code>或者<code>xxx</code></p>
<p>反向引用，巧用<code>$</code>分组捕获</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;John Smith&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 交换名字和姓氏</span></span><br><span class="line"><span class="built_in">console</span>.log(str.replace(<span class="regexp">/(john) (smith)/i</span>, <span class="string">&#x27;$2, $1&#x27;</span>)) <span class="comment">// Smith, John</span></span><br></pre></td></tr></table></figure>
<h2 id="三、匹配方法"><a href="#三、匹配方法" class="headerlink" title="三、匹配方法"></a>三、匹配方法</h2><p>正则表达式常被用于某些方法，我们可以分成两类：</p>
<ul>
<li>字符串（str）方法：<code>match</code>、<code>matchAll</code>、<code>search</code>、<code>replace</code>、<code>split</code></li>
<li>正则对象下（regexp）的方法：<code>test</code>、<code>exec</code></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">方法</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">exec</td>
<td style="text-align:left">一个在字符串中执行查找匹配的RegExp方法，它返回一个数组（未匹配到则返回 null）。</td>
</tr>
<tr>
<td style="text-align:left">test</td>
<td style="text-align:left">一个在字符串中测试是否匹配的RegExp方法，它返回 true 或 false。</td>
</tr>
<tr>
<td style="text-align:left">match</td>
<td style="text-align:left">一个在字符串中执行查找匹配的String方法，它返回一个数组，在未匹配到时会返回 null。</td>
</tr>
<tr>
<td style="text-align:left">matchAll</td>
<td style="text-align:left">一个在字符串中执行查找所有匹配的String方法，它返回一个迭代器（iterator）。</td>
</tr>
<tr>
<td style="text-align:left">search</td>
<td style="text-align:left">一个在字符串中测试匹配的String方法，它返回匹配到的位置索引，或者在失败时返回-1。</td>
</tr>
<tr>
<td style="text-align:left">replace</td>
<td style="text-align:left">一个在字符串中执行查找匹配的String方法，并且使用替换字符串替换掉匹配到的子字符串。</td>
</tr>
<tr>
<td style="text-align:left">split</td>
<td style="text-align:left">一个使用正则表达式或者一个固定字符串分隔一个字符串，并将分隔后的子字符串存储到数组中的 <code>String</code> 方法。</td>
</tr>
</tbody>
</table>
</div>
<h3 id="str-match-regexp"><a href="#str-match-regexp" class="headerlink" title="str.match(regexp)"></a>str.match(regexp)</h3><p><code>str.match(regexp)</code> 方法在字符串 <code>str</code> 中找到匹配 <code>regexp</code> 的字符</p>
<p>如果 <code>regexp</code> 不带有 <code>g</code> 标记，则它以数组的形式返回第一个匹配项，其中包含分组和属性 <code>index</code>（匹配项的位置）、<code>input</code>（输入字符串，等于 <code>str</code>）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;I love JavaScript&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result = str.match(<span class="regexp">/Java(Script)/</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log( result[<span class="number">0</span>] );     <span class="comment">// JavaScript（完全匹配）</span></span><br><span class="line"><span class="built_in">console</span>.log( result[<span class="number">1</span>] );     <span class="comment">// Script（第一个分组）</span></span><br><span class="line"><span class="built_in">console</span>.log( result.length ); <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他信息：</span></span><br><span class="line"><span class="built_in">console</span>.log( result.index );  <span class="comment">// 7（匹配位置）</span></span><br><span class="line"><span class="built_in">console</span>.log( result.input );  <span class="comment">// I love JavaScript（源字符串）</span></span><br></pre></td></tr></table></figure>
<p>如果 <code>regexp</code> 带有 <code>g</code> 标记，则它将所有匹配项的数组作为字符串返回，而不包含分组和其他详细信息</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;I love JavaScript&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result = str.match(<span class="regexp">/Java(Script)/g</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log( result[<span class="number">0</span>] ); <span class="comment">// JavaScript</span></span><br><span class="line"><span class="built_in">console</span>.log( result.length ); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>如果没有匹配项，则无论是否带有标记 <code>g</code> ，都将返回 <code>null</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;I love JavaScript&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result = str.match(<span class="regexp">/HTML/</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(result); <span class="comment">// null</span></span><br></pre></td></tr></table></figure>
<h3 id="str-matchAll-regexp"><a href="#str-matchAll-regexp" class="headerlink" title="str.matchAll(regexp)"></a>str.matchAll(regexp)</h3><p>返回一个包含所有匹配正则表达式的结果及分组捕获组的迭代器</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> regexp = <span class="regexp">/t(e)(st(\d?))/g</span>;</span><br><span class="line"><span class="keyword">const</span> str = <span class="string">&#x27;test1test2&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> array = [...str.matchAll(regexp)];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(array[<span class="number">0</span>]);</span><br><span class="line"><span class="comment">// expected output: Array [&quot;test1&quot;, &quot;e&quot;, &quot;st1&quot;, &quot;1&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(array[<span class="number">1</span>]);</span><br><span class="line"><span class="comment">// expected output: Array [&quot;test2&quot;, &quot;e&quot;, &quot;st2&quot;, &quot;2&quot;]</span></span><br></pre></td></tr></table></figure>
<h3 id="str-search-regexp"><a href="#str-search-regexp" class="headerlink" title="str.search(regexp)"></a>str.search(regexp)</h3><p>返回第一个匹配项的位置，如果未找到，则返回 <code>-1</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;A drop of ink may make a million think&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log( str.search( <span class="regexp">/ink/i</span> ) ); <span class="comment">// 10（第一个匹配位置）</span></span><br></pre></td></tr></table></figure>
<p>这里需要注意的是，<code>search</code> 仅查找第一个匹配项</p>
<h2 id="str-replace-regexp"><a href="#str-replace-regexp" class="headerlink" title="str.replace(regexp)"></a>str.replace(regexp)</h2><p>替换与正则表达式匹配的子串，并返回替换后的字符串。在不设置全局匹配<code>g</code>的时候，只替换第一个匹配成功的字符串片段</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> reg1=<span class="regexp">/javascript/i</span>;</span><br><span class="line"><span class="keyword">const</span> reg2=<span class="regexp">/javascript/ig</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello Javascript Javascript Javascript&#x27;</span>.replace(reg1,<span class="string">&#x27;js&#x27;</span>));</span><br><span class="line"><span class="comment">//hello js Javascript Javascript</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello Javascript Javascript Javascript&#x27;</span>.replace(reg2,<span class="string">&#x27;js&#x27;</span>));</span><br><span class="line"><span class="comment">//hello js js js</span></span><br></pre></td></tr></table></figure>
<h3 id="str-split-regexp"><a href="#str-split-regexp" class="headerlink" title="str.split(regexp)"></a>str.split(regexp)</h3><p>使用正则表达式（或子字符串）作为分隔符来分割字符串</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;12, 34, 56&#x27;</span>.split(<span class="regexp">/,\s*/</span>)) <span class="comment">// 数组 [&#x27;12&#x27;, &#x27;34&#x27;, &#x27;56&#x27;]</span></span><br></pre></td></tr></table></figure>
<h3 id="regexp-exec-str"><a href="#regexp-exec-str" class="headerlink" title="regexp.exec(str)"></a>regexp.exec(str)</h3><p><code>regexp.exec(str)</code> 方法返回字符串 <code>str</code> 中的 <code>regexp</code> 匹配项，与以前的方法不同，它是在正则表达式而不是字符串上调用的</p>
<p>根据正则表达式是否带有标志 <code>g</code>，它的行为有所不同</p>
<p>如果没有 <code>g</code>，那么 <code>regexp.exec(str)</code> 返回的第一个匹配与 <code>str.match(regexp)</code> 完全相同</p>
<p>如果有标记 <code>g</code>，调用 <code>regexp.exec(str)</code> 会返回第一个匹配项，并将紧随其后的位置保存在属性<code>regexp.lastIndex</code> 中。 下一次同样的调用会从位置 <code>regexp.lastIndex</code> 开始搜索，返回下一个匹配项，并将其后的位置保存在 <code>regexp.lastIndex</code> 中</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&#x27;More about JavaScript at https://javascript.info&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> regexp = <span class="regexp">/javascript/ig</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (result = regexp.exec(str)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">`Found <span class="subst">$&#123;result[<span class="number">0</span>]&#125;</span> at position <span class="subst">$&#123;result.index&#125;</span>`</span> );</span><br><span class="line">  <span class="comment">// Found JavaScript at position 11</span></span><br><span class="line">  <span class="comment">// Found javascript at position 33</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="regexp-test-str"><a href="#regexp-test-str" class="headerlink" title="regexp.test(str)"></a>regexp.test(str)</h3><p>查找匹配项，然后返回 <code>true/false</code> 表示是否存在</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;I love JavaScript&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这两个测试相同</span></span><br><span class="line"><span class="built_in">console</span>.log( <span class="regexp">/love/i</span>.test(str) ); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="四、应用场景"><a href="#四、应用场景" class="headerlink" title="四、应用场景"></a>四、应用场景</h2><p>通过上面的学习，我们对正则表达式有了一定的了解</p>
<p>下面再来看看正则表达式一些案例场景：</p>
<p>验证QQ合法性（5~15位、全是数字、不以0开头）：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> reg = <span class="regexp">/^[1-9][0-9]&#123;4,14&#125;$/</span></span><br><span class="line"><span class="keyword">const</span> isvalid = patrn.exec(s)</span><br></pre></td></tr></table></figure>
<p>校验用户账号合法性（只能输入5-20个以字母开头、可带数字、“_”、“.”的字串）：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> patrn=<span class="regexp">/^[a-zA-Z]&#123;1&#125;([a-zA-Z0-9]|[._])&#123;4,19&#125;$/</span>;</span><br><span class="line"><span class="keyword">const</span> isvalid = patrn.exec(s)</span><br></pre></td></tr></table></figure>
<p>将<code>url</code>参数解析为对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> protocol = <span class="string">&#x27;(?&lt;protocol&gt;https?:)&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> host = <span class="string">&#x27;(?&lt;host&gt;(?&lt;hostname&gt;[^/#?:]+)(?::(?&lt;port&gt;\\d+))?)&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> path = <span class="string">&#x27;(?&lt;pathname&gt;(?:\\/[^/#?]+)*\\/?)&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> search = <span class="string">&#x27;(?&lt;search&gt;(?:\\?[^#]*)?)&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> hash = <span class="string">&#x27;(?&lt;hash&gt;(?:#.*)?)&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`^<span class="subst">$&#123;protocol&#125;</span>\/\/<span class="subst">$&#123;host&#125;</span><span class="subst">$&#123;path&#125;</span><span class="subst">$&#123;search&#125;</span><span class="subst">$&#123;hash&#125;</span>$`</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execURL</span>(<span class="params">url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> result = reg.exec(url);</span><br><span class="line">    <span class="keyword">if</span>(result)&#123;</span><br><span class="line">        result.groups.port = result.groups.port || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> result.groups;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">protocol</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">host</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">hostname</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">port</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">pathname</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">search</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">hash</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(execURL(<span class="string">&#x27;https://localhost:8080/?a=b#xxxx&#x27;</span>));</span><br><span class="line">protocol: <span class="string">&quot;https:&quot;</span></span><br><span class="line"><span class="attr">host</span>: <span class="string">&quot;localhost:8080&quot;</span></span><br><span class="line"><span class="attr">hostname</span>: <span class="string">&quot;localhost&quot;</span></span><br><span class="line"><span class="attr">port</span>: <span class="string">&quot;8080&quot;</span></span><br><span class="line"><span class="attr">pathname</span>: <span class="string">&quot;/&quot;</span></span><br><span class="line"><span class="attr">search</span>: <span class="string">&quot;?a=b&quot;</span></span><br><span class="line"><span class="attr">hash</span>: <span class="string">&quot;#xxxx&quot;</span></span><br></pre></td></tr></table></figure>
<p>再将上面的<code>search</code>和<code>hash</code>进行解析</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execUrlParams</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    str = str.replace(<span class="regexp">/^[#?&amp;]/</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> result = &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span>(!str)&#123; <span class="comment">//如果正则可能配到空字符串，极有可能造成死循环，判断很重要</span></span><br><span class="line">        <span class="keyword">return</span> result; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> reg = <span class="regexp">/(?:^|&amp;)([^&amp;=]*)=?([^&amp;]*?)(?=&amp;|$)/y</span></span><br><span class="line">    <span class="keyword">let</span> exec = reg.exec(str);</span><br><span class="line">    <span class="keyword">while</span>(exec)&#123;</span><br><span class="line">        result[exec[<span class="number">1</span>]] = exec[<span class="number">2</span>];</span><br><span class="line">        exec = reg.exec(str);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(execUrlParams(<span class="string">&#x27;#&#x27;</span>));<span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(execUrlParams(<span class="string">&#x27;##&#x27;</span>));<span class="comment">//&#123;&#x27;#&#x27;:&#x27;&#x27;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(execUrlParams(<span class="string">&#x27;?q=3606&amp;src=srp&#x27;</span>)); <span class="comment">//&#123;q: &quot;3606&quot;, src: &quot;srp&quot;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(execUrlParams(<span class="string">&#x27;test=a=b=c&amp;&amp;==&amp;a=&#x27;</span>));<span class="comment">//&#123;test: &quot;a=b=c&quot;, &quot;&quot;: &quot;=&quot;, a: &quot;&quot;&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>regexp</tag>
      </tags>
  </entry>
  <entry>
    <title>responsive_layout</title>
    <url>/archives/203410a2.html</url>
    <content><![CDATA[<h3 id="1-什么是响应式设计"><a href="#1-什么是响应式设计" class="headerlink" title="1.什么是响应式设计"></a>1.什么是响应式设计</h3><p>响应式网站设计（Responsive Web design）是一种网络页面设计布局，页面的设计与开发应当根据用户行为以及设备环境(系统平台、屏幕尺寸、屏幕定向等)进行相应的响应和调整</p>
<p>描述响应式界面最著名的一句话就是“Content is like water”</p>
<p>大白话便是“如果将屏幕看作容器，那么内容就像水一样”</p>
<p>响应式网站常见特点：</p>
<ul>
<li><p>同时适配PC + 平板 + 手机等</p>
</li>
<li><p>标签导航在接近手持终端设备时改变为经典的抽屉式导航</p>
</li>
<li><p>网站的布局会根据视口来调整模块的大小和位置</p>
<p><img src="https://static.vue-js.com/ae68be30-9dba-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
</li>
</ul>
<h3 id="2-响应式基本原理"><a href="#2-响应式基本原理" class="headerlink" title="2.响应式基本原理"></a>2.响应式基本原理</h3><p>响应式设计的基本原理是通过媒体查询检测不同的设备屏幕尺寸做处理，为了处理移动端，页面头部必须有<code>meta</code>声明<code>viewport</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no”&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>属性对应如下：</p>
<ul>
<li><p>width=device-width: 是自适应手机屏幕的尺寸宽度</p>
</li>
<li><p>maximum-scale:是缩放比例的最大值</p>
</li>
<li><p>inital-scale:是缩放的初始化</p>
</li>
<li><p>user-scalable:是用户的可以缩放的操作</p>
</li>
</ul>
<p>实现响应式布局的方式有如下：</p>
<ul>
<li>媒体查询</li>
<li>百分比</li>
<li>vw/vh</li>
<li>rem</li>
</ul>
<h3 id="3-媒体查询"><a href="#3-媒体查询" class="headerlink" title="3.媒体查询"></a>3.媒体查询</h3><p><code>CSS3</code>中的增加了更多的媒体查询，就像<code>if</code>条件表达式一样，我们可以设置不同类型的媒体条件，并根据对应的条件，给相应符合条件的媒体调用相对应的样式表</p>
<p>使用<code>@Media</code>查询，可以针对不同的媒体类型定义不同的样式，如：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1920px</span>) &#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>当视口在375px - 600px之间，设置特定字体大小18px</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen (<span class="attribute">min-width</span>: <span class="number">375px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">600px</span>) &#123;</span><br><span class="line">  <span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过媒体查询，可以通过给不同分辨率的设备编写不同的样式来实现响应式的布局，比如我们为不同分辨率的屏幕，设置不同的背景图片</p>
<p>比如给小屏幕手机设置@2x图，为大屏幕手机设置@3x图，通过媒体查询就能很方便的实现</p>
<h3 id="4-百分比"><a href="#4-百分比" class="headerlink" title="4.百分比"></a>4.百分比</h3><p>通过百分比单位 “ % “ 来实现响应式的效果</p>
<p> 比如当浏览器的宽度或者高度发生变化时，通过百分比单位，可以使得浏览器中的组件的宽和高随着浏览器的变化而变化，从而实现响应式的效果</p>
<p><code>height</code>、<code>width</code>属性的百分比依托于父标签的宽高，但是其他盒子属性则不完全依赖父元素：</p>
<ul>
<li><p>子元素的top/left和bottom/right如果设置百分比，则相对于直接非static定位(默认定位)的父元素的高度/宽度</p>
</li>
<li><p>子元素的padding如果设置百分比，不论是垂直方向或者是水平方向，都相对于直接父亲元素的width，而与父元素的height无关。</p>
</li>
<li><p>子元素的margin如果设置成百分比，不论是垂直方向还是水平方向，都相对于直接父元素的width</p>
</li>
<li><p>border-radius不一样，如果设置border-radius为百分比，则是相对于自身的宽度</p>
</li>
</ul>
<p>可以看到每个属性都使用百分比，会照成布局的复杂度，所以不建议使用百分比来实现响应式</p>
<h3 id="5-vw-vh"><a href="#5-vw-vh" class="headerlink" title="5.vw/vh"></a>5.vw/vh</h3><p><code>vw</code>表示相对于视图窗口的宽度，<code>vh</code>表示相对于视图窗口高度。 任意层级元素，在使用<code>vw</code>单位的情况下，<code>1vw</code>都等于视图宽度的百分之一</p>
<p>与百分比布局很相似，在以前文章提过与<code>%</code>的区别，这里就不再展开述说</p>
<h3 id="6-rem"><a href="#6-rem" class="headerlink" title="6.rem"></a>6.rem</h3><p>在以前也讲到，<code>rem</code>是相对于根元素<code>html</code>的<code>font-size</code>属性，默认情况下浏览器字体大小为<code>16px</code>，此时<code>1rem = 16px</code></p>
<p>可以利用前面提到的媒体查询，针对不同设备分辨率改变<code>font-size</code>的值，如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">414px</span>) &#123;</span><br><span class="line">  <span class="selector-tag">html</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">375px</span>) &#123;</span><br><span class="line">  <span class="selector-tag">html</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">320px</span>) &#123;</span><br><span class="line">  <span class="selector-tag">html</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为了更准确监听设备可视窗口变化，我们可以在<code>css</code>之前插入<code>script</code>标签，内容如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//动态为根元素设置字体大小</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 获取屏幕宽度</span></span><br><span class="line">    <span class="keyword">var</span> width = <span class="built_in">document</span>.documentElement.clientWidth</span><br><span class="line">    <span class="comment">// 设置根元素字体大小。此时为宽的10等分</span></span><br><span class="line">    <span class="built_in">document</span>.documentElement.style.fontSize = width / <span class="number">10</span> + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//首次加载应用，设置一次</span></span><br><span class="line">init()</span><br><span class="line"><span class="comment">// 监听手机旋转的事件的时机，重新设置</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;orientationchange&#x27;</span>, init)</span><br><span class="line"><span class="comment">// 监听手机窗口变化，重新设置</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;resize&#x27;</span>, init)</span><br></pre></td></tr></table></figure>
<p>无论设备可视窗口如何变化，始终设置<code>rem</code>为<code>width</code>的1/10，实现了百分比布局</p>
<p>除此之外，我们还可以利用主流<code>UI</code>框架，如：<code>element ui</code>、<code>antd</code>提供的栅格布局实现响应式</p>
<h3 id="7-小结"><a href="#7-小结" class="headerlink" title="7.小结"></a>7.小结</h3><p>响应式设计实现通常会从以下几方面思考：</p>
<ul>
<li>弹性盒子（包括图片、表格、视频）和媒体查询等技术</li>
<li>使用百分比布局创建流式布局的弹性UI，同时使用媒体查询限制元素的尺寸和内容变更范围</li>
<li>使用相对单位使得内容自适应调节</li>
<li>选择断点，针对不同断点实现不同布局和内容展示</li>
</ul>
<h3 id="8-响应式优缺点"><a href="#8-响应式优缺点" class="headerlink" title="8.响应式优缺点"></a>8.响应式优缺点</h3><p>响应式布局优点可以看到：</p>
<ul>
<li>面对不同分辨率设备灵活性强</li>
<li>能够快捷解决多设备显示适应问题</li>
</ul>
<p>缺点：</p>
<ul>
<li>仅适用布局、信息、框架并不复杂的部门类型网站</li>
<li>兼容各种设备工作量大，效率低下</li>
<li>代码累赘，会出现隐藏无用的元素，加载时间加长</li>
<li>其实这是一种折中性质的设计解决方案，多方面因素影响而达不到最佳效果</li>
<li>一定程度上改变了网站原有的布局结构，会出现用户混淆的情况</li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>responsive_layout</tag>
      </tags>
  </entry>
  <entry>
    <title>React + TypeScript - 类组件</title>
    <url>/archives/12529ae2.html</url>
    <content><![CDATA[<h1 id="React-TypeScript-类组件"><a href="#React-TypeScript-类组件" class="headerlink" title="React + TypeScript - 类组件"></a>React + TypeScript - 类组件</h1><h2 id="01-创建应用"><a href="#01-创建应用" class="headerlink" title="01. 创建应用"></a>01. 创建应用</h2><blockquote>
<p>目标：掌握如何使用 create-react-app 创建支持 TypeScript 的 React 应用的方式</p>
</blockquote>
<p>使用 React 官方提供的 create-react-app 脚手架工具即可创建支持 TypeScript 的 React 应用。</p>
<p>我们只需要在命令中添加 —template typescript 选项即可创建 TypeScript 项目。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npx create-react-app react-ts-tutorial --template typescript</span><br></pre></td></tr></table></figure>
<p>在 TypeScript 项目中包含 JSX 代码的文件后缀名称为 tsx，其他不包含 JSX 代码的文件后缀名称为 ts。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;div&gt;App&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="02-Component-泛型类"><a href="#02-Component-泛型类" class="headerlink" title="02. Component 泛型类"></a>02. Component 泛型类</h2><blockquote>
<p>目标：掌握如何通过 Component 泛型类标注组件 Props 对象和 State 对象的类型</p>
</blockquote>
<p>Component 是一个泛型类，通过它的第一个泛型参数可以标注组件 Props 对象的类型，第二个参数可以标注组件 State 对象的类型。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">// Props 对象的类型</span><br><span class="line">interface Props &#123;</span><br><span class="line">  greetings: string;</span><br><span class="line">  sayHello: () =&gt; void;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// State 对象的类型</span><br><span class="line">interface States &#123;</span><br><span class="line">  count: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component&lt;Props, States&gt; &#123;</span><br><span class="line">  constructor(props: Readonly&lt;Props&gt;) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      count: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; greetings, sayHello &#125; = this.props;</span><br><span class="line">    return (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;div onClick=&#123;sayHello&#125;&gt;&#123;greetings&#125;&lt;/div&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          onClick=&#123;() =&gt; this.setState((state) =&gt; (&#123; count: state.count + 1 &#125;))&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;this.state.count&#125;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/index.tsx</span><br><span class="line">&lt;App</span><br><span class="line">  greetings=&#123;&quot;Hello&quot;&#125;</span><br><span class="line">  sayHello=&#123;() =&gt; alert(&quot;Hello React with TypeScript&quot;)&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<h2 id="03-标注-React-元素的类型"><a href="#03-标注-React-元素的类型" class="headerlink" title="03. 标注 React 元素的类型"></a>03. 标注 React 元素的类型</h2><p>(1) 什么是 React 元素</p>
<p>通过 React.createElement 方法创建的元素、通过 JSX 语法创建的元素都被叫做 React 元素。(虚拟 DOM 对象)</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> title = React.createElement(<span class="string">&quot;h1&quot;</span>, &#123; <span class="attr">className</span>: <span class="string">&quot;foo&quot;</span> &#125;, <span class="string">&quot;Hello, world!&quot;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const title = &lt;h1 className=&quot;foo&quot;&gt;Hello, world!&lt;/h1&gt;;</span><br></pre></td></tr></table></figure>
<p>(2) 如何标注 React 元素的类型</p>
<p>使用 ReactElement 和 JSX.Element 都可以标注 React 元素的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在使用 ReactElement 类型时需要显式导入它</span></span><br><span class="line"><span class="keyword">import</span> &#123; ReactElement &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="comment">// JSX.Element 类型可以直接使用不需要导入</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const title_1: ReactElement = React.createElement(</span><br><span class="line">  &quot;h1&quot;,</span><br><span class="line">  &#123; className: &quot;foo&quot; &#125;,</span><br><span class="line">  &quot;Hello, world!&quot;</span><br><span class="line">);</span><br><span class="line">const title_2: ReactElement = &lt;h1 className=&quot;foo&quot;&gt;Hello, world!&lt;/h1&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const title_3: JSX.Element = React.createElement(</span><br><span class="line">  &quot;h1&quot;,</span><br><span class="line">  &#123; className: &quot;foo&quot; &#125;,</span><br><span class="line">  &quot;Hello, world!&quot;</span><br><span class="line">);</span><br><span class="line">const title_4: JSX.Element = &lt;h1 className=&quot;foo&quot;&gt;Hello, world!&lt;/h1&gt;;</span><br></pre></td></tr></table></figure>
<p>ReactElement 主要用于描述虚拟 DOM 对象的类型。</p>
<p>JSX.Element 主要用于描述通过 JSX 语法创建的元素的类型。</p>
<p>JSX 被编译之之后其实就是虚拟 DOM 对象，而且在编译之后 JSX 类型被自动映射为 ReactElement 类型，所以两个类型几乎通用。</p>
<h2 id="04-ReactPortal-了解"><a href="#04-ReactPortal-了解" class="headerlink" title="04. ReactPortal (了解)"></a>04. ReactPortal (了解)</h2><p>ReactPortal 表示 ReactDOM.createPortal 方法的返回值的类型。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; createPortal &#125; from &quot;react-dom&quot;;</span><br><span class="line">import &#123; ReactPortal &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">  render(): ReactPortal &#123;</span><br><span class="line">    return createPortal(</span><br><span class="line">      &lt;div&gt;portal&lt;/div&gt;,</span><br><span class="line">      document.getElementById(&quot;portal-root&quot;)!</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="05-ReactNode"><a href="#05-ReactNode" class="headerlink" title="05. ReactNode"></a>05. ReactNode</h2><blockquote>
<p>目标：掌握 React.ReactNode 类型的使用方式</p>
</blockquote>
<p>ReactNode 表示一个可以渲染的任意值，包括布尔值、数字、字符串、元素和数组等，它是 React 中最泛化的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// node_modules/@types/react/index.d.ts</span></span><br><span class="line"><span class="keyword">type</span> ReactNode =</span><br><span class="line">  | ReactElement</span><br><span class="line">  | <span class="built_in">string</span></span><br><span class="line">  | <span class="built_in">number</span></span><br><span class="line">  | ReactFragment</span><br><span class="line">  | ReactPortal</span><br><span class="line">  | <span class="built_in">boolean</span></span><br><span class="line">  | <span class="literal">null</span></span><br><span class="line">  | <span class="literal">undefined</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;App&gt;&#123;&quot;hello&quot;&#125;&lt;/App&gt;</span><br><span class="line">&lt;App&gt;&#123;100&#125;&lt;/App&gt;</span><br><span class="line">&lt;App&gt;&#123;true&#125;&lt;/App&gt;</span><br><span class="line">&lt;App&gt;&#123;undefined&#125;&lt;/App&gt;</span><br><span class="line">&lt;App&gt;&#123;null&#125;&lt;/App&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;App&gt;</span><br><span class="line">  &lt;p&gt;Hello World&lt;/p&gt;</span><br><span class="line">&lt;/App&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;App&gt;</span><br><span class="line">  &lt;p&gt;Hello World&lt;/p&gt;</span><br><span class="line">  &lt;p&gt;Hello World&lt;/p&gt;</span><br><span class="line">  &lt;p&gt;Hello World&lt;/p&gt;</span><br><span class="line">&lt;/App&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;App&gt;</span><br><span class="line">  &#123;createPortal(</span><br><span class="line">    &lt;div&gt;Portal&lt;/div&gt;,</span><br><span class="line">    document.getElementById(&quot;portal-root&quot;) as HTMLElement</span><br><span class="line">  )&#125;</span><br><span class="line">&lt;/App&gt;</span><br></pre></td></tr></table></figure>
<h2 id="06-ReactFragment"><a href="#06-ReactFragment" class="headerlink" title="06. ReactFragment"></a>06. ReactFragment</h2><p>ReactFragment 表示一组可以被遍历渲染的任意值，它只被用于标注组件 children 属性的类型。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> ReactFragment = Iterable&lt;ReactNode&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">interface Props &#123;</span><br><span class="line">  children: ReactFragment;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;App&gt;</span><br><span class="line">  &#123;/* 不能只有一个, 只能多个 */&#125;</span><br><span class="line">  &lt;p&gt;&lt;/p&gt;</span><br><span class="line">  &lt;p&gt;&lt;/p&gt;</span><br><span class="line">&lt;/App&gt;;</span><br></pre></td></tr></table></figure>
<h2 id="07-CSSProperties"><a href="#07-CSSProperties" class="headerlink" title="07. CSSProperties"></a>07. CSSProperties</h2><blockquote>
<p>目标：掌握 CSSProperties 类型的使用方式</p>
</blockquote>
<p>CSSProperties 类型用于标注 styles 属性值的类型，它对样式对象中的属性及属性值的类型进行约束。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">interface Props &#123;</span><br><span class="line">  style?: React.CSSProperties;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;div style=&#123;this.props.style&#125;&gt;&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;App</span><br><span class="line">  style=&#123;&#123; width: 100, height: 200, backgroundColor: &quot;red&quot;, display: &quot;block&quot; &#125;&#125;</span><br><span class="line">&gt;&lt;/App&gt;</span><br></pre></td></tr></table></figure>
<h2 id="08-ChangeEvent"><a href="#08-ChangeEvent" class="headerlink" title="08. ChangeEvent"></a>08. ChangeEvent</h2><blockquote>
<p>目标：掌握 ChangeEvent 类型的使用方式</p>
</blockquote>
<p>ChangeEvent 用于标注表单项 change 事件的事件对象的类型。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// React.ChangeEvent 的泛型参数表示触发事件的元素的类型, 即 event.currentTarget 的类型</span><br><span class="line">function onChangeHandler(event: React.ChangeEvent&lt;HTMLInputElement&gt;) &#123;&#125;</span><br><span class="line">&lt;input type=&quot;text&quot; onChange=&#123;onChangeHandler&#125; /&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 等价写法</span></span><br><span class="line"><span class="keyword">const</span> onKeyUpHandler: React.ChangeEventHandler&lt;HTMLInputElement&gt; = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  event</span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="09-MouseEvent"><a href="#09-MouseEvent" class="headerlink" title="09. MouseEvent"></a>09. MouseEvent</h2><blockquote>
<p>目标：掌握 React.MouseEvent 类型的使用方式</p>
</blockquote>
<p>MouseEvent 用于标注鼠标事件对应的事件对象的类型。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function onClickHandler(event: React.MouseEvent&lt;HTMLButtonElement&gt;) &#123;&#125;</span><br><span class="line">&lt;button onClick=&#123;onClickHandler&#125;&gt;按钮&lt;/button&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 等价写法</span></span><br><span class="line"><span class="keyword">const</span> onClickHandler: React.MouseEventHandler&lt;HTMLButtonElement&gt; = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  event</span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="10-KeyboardEvent"><a href="#10-KeyboardEvent" class="headerlink" title="10. KeyboardEvent"></a>10. KeyboardEvent</h2><p>KeyboardEvent 用于标注键盘事件对应的事件对象的类型。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function onKeyUpHandler(event: React.KeyboardEvent&lt;HTMLInputElement&gt;) &#123;&#125;</span><br><span class="line">&lt;input type=&quot;text&quot; onKeyUp=&#123;onKeyUpHandler&#125; /&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 等价写法</span></span><br><span class="line"><span class="keyword">const</span> onKeyUpHandler: React.KeyboardEventHandler&lt;HTMLInputElement&gt; = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  event</span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="11-FormEvent"><a href="#11-FormEvent" class="headerlink" title="11. FormEvent"></a>11. FormEvent</h2><p>FormEvent 用于标注表单提交事件对应的事件对象的类型。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function onSubmitHandler(event: React.FormEvent&lt;HTMLFormElement&gt;) &#123;&#125;</span><br><span class="line">&lt;form onSubmit=&#123;onSubmitHandler&#125;&gt;&lt;/form&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 等价写法</span></span><br><span class="line"><span class="keyword">const</span> onSubmitHandler: React.FormEventHandler = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="12-UIEvent"><a href="#12-UIEvent" class="headerlink" title="12. UIEvent"></a>12. UIEvent</h2><p>UIEvent 是一个通用的和用户界面相关的事件的事件对象的类型，MouseEvent、KeyboardEvent 等都是它的子类。</p>
<p>开发者在标注事件对象的类型时有子类优先使用子类。</p>
<p>一般我们使用 UIEvent 标注滚动事件的事件对象类型、加载事件的事件对象类型等。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function onScrollHandler(event: React.UIEvent&lt;HTMLDivElement&gt;) &#123;&#125;</span><br><span class="line">&lt;div onScroll=&#123;onScrollHandler&#125;&gt;&lt;/div&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 等价写法</span><br><span class="line">const onScrollHandler: React.UIEventHandler&lt;HTMLDivElement&gt; = (event) =&gt; &#123;&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="13-defaultProps"><a href="#13-defaultProps" class="headerlink" title="13. defaultProps"></a>13. defaultProps</h2><blockquote>
<p>目标：掌握标注组件 Props 对象默认的方式</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">// 当我们在组件中的 defaultProps 中添加了 greetings 之后</span><br><span class="line">// greetings 属性就变成了可选的, 在调用当前组件时即使不传递 greetings 属性也可以通过 ts 的编译</span><br><span class="line">interface Props &#123;</span><br><span class="line">  greetings: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  static defaultProps: Partial&lt;Props&gt; = &#123;</span><br><span class="line">    greetings: &quot;默认值&quot;,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;div&gt;&#123;this.props.greetings&#125;&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;App /&gt;</span><br><span class="line">&lt;App greetings=&#123;&quot;Hello world&quot;&#125; /&gt;</span><br></pre></td></tr></table></figure>
<h2 id="14-createContext"><a href="#14-createContext" class="headerlink" title="14. createContext"></a>14. createContext</h2><blockquote>
<p>目标：掌握标注上下文对象中存储的状态的类型的方式</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/index.tsx</span><br><span class="line">import &#123; createContext &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">interface AppContextState &#123;</span><br><span class="line">  name: string;</span><br><span class="line">  url: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const initialState: AppContextState = &#123; name: &quot;&quot;, url: &quot;&quot; &#125;;</span><br><span class="line"></span><br><span class="line">export const AppCtx = createContext&lt;AppContextState&gt;(initialState);</span><br><span class="line"></span><br><span class="line">root.render(</span><br><span class="line">  &lt;AppCtx.Provider</span><br><span class="line">    value=&#123;&#123; name: &quot;React and TypeScript&quot;, url: &quot;api.example.com&quot; &#125;&#125;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;App /&gt;</span><br><span class="line">  &lt;/AppCtx.Provider&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import &#123; AppCtx &#125; from &quot;./index&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;AppCtx.Consumer&gt;</span><br><span class="line">        &#123;(value) =&gt; &lt;div&gt;&#123;value.name&#125; &#123;value.url&#125;&lt;/div&gt;&#125;</span><br><span class="line">      &lt;/AppCtx.Consumer&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="15-createRef"><a href="#15-createRef" class="headerlink" title="15. createRef"></a>15. createRef</h2><blockquote>
<p>目标：掌握 React.RefObject 类型的使用方式</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import React, &#123; createRef &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  // 指定 divRef 属性的类型为 React.RefObject 并指定内部的 current 属性存储的数据类型为 HTMLDivElement</span><br><span class="line">  divRef: React.RefObject&lt;HTMLDivElement&gt; = createRef&lt;HTMLDivElement&gt;();</span><br><span class="line"></span><br><span class="line">  onClicked() &#123;</span><br><span class="line">    console.log(this.divRef.current);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div onClick=&#123;() =&gt; this.onClicked()&#125; ref=&#123;this.divRef&#125;&gt;</span><br><span class="line">        App works</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="16-Redux"><a href="#16-Redux" class="headerlink" title="16. Redux"></a>16. Redux</h2><blockquote>
<p>目标：掌握 Redux + TypeScript 的使用方式并完成计数器功能</p>
</blockquote>
<p>① 下载 redux、react-redux、redux-thunk、axios</p>
<p>注意：以上库全部自带 TypeScript 类型声明文件不需要单独下载。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install redux@4.2.0 react-redux@8.0.4 redux-thunk@2.4.2 axios@1.3.4</span><br></pre></td></tr></table></figure>
<p>② 创建用于实现计数器功能的 action type</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/types/counterTypes.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="built_in">enum</span> CounterTypes &#123;</span><br><span class="line">  INCREMENT = <span class="string">&quot;计数器/增加&quot;</span>,</span><br><span class="line">  DECREMENT = <span class="string">&quot;计数器/减少&quot;</span>,</span><br><span class="line">  INCREMENT_BY_COUNT = <span class="string">&quot;计数器/增加/指定数值&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③ 创建用于实现计数器功能的 action 对象的类型</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/actions/counterActions.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; CounterTypes &#125; <span class="keyword">from</span> <span class="string">&quot;../types/counterTypes&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">namespace</span> CounterActions &#123;</span><br><span class="line">  <span class="comment">// 计数器/数值增加</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> Increment &#123;</span><br><span class="line">    <span class="attr">type</span>: CounterTypes.INCREMENT;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计数器/数值减少</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> Decrement &#123;</span><br><span class="line">    <span class="attr">type</span>: CounterTypes.DECREMENT;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计数器/数值增加/指定数值</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> IncrementByCount &#123;</span><br><span class="line">    <span class="attr">type</span>: CounterTypes.INCREMENT_BY_COUNT;</span><br><span class="line">    payload: &#123; <span class="attr">count</span>: <span class="built_in">number</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">type</span> Actions = Increment | Decrement | IncrementByCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>④ 创建用于实现计数器功能的 reducer 函数</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/，，</span></span><br><span class="line"><span class="keyword">import</span> &#123; CounterActions &#125; <span class="keyword">from</span> <span class="string">&quot;../actions/counterActions&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CounterTypes &#125; <span class="keyword">from</span> <span class="string">&quot;../types/counterTypes&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// reducer 函数返回的状态的类型</span></span><br><span class="line"><span class="keyword">interface</span> CounterState &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 状态的初始值</span></span><br><span class="line"><span class="keyword">const</span> initialState: CounterState = &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">counterReducer</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  state: CounterState = initialState,</span></span></span><br><span class="line"><span class="params"><span class="function">  action: CounterActions.Actions</span></span></span><br><span class="line"><span class="params"><span class="function"></span>): <span class="title">CounterState</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> CounterTypes.INCREMENT:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.count + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> CounterTypes.DECREMENT:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.count - <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> CounterTypes.INCREMENT_BY_COUNT:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.count + action.payload.count &#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/store/reducers/rootReducer.ts</span><br><span class="line">import &#123; combineReducers &#125; from &quot;redux&quot;;</span><br><span class="line">import counterReducer from &quot;./counterReducer&quot;;</span><br><span class="line"></span><br><span class="line">const rootReducer = combineReducers(&#123;</span><br><span class="line">  counterReducer,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default rootReducer;</span><br></pre></td></tr></table></figure>
<p>⑤ 创建用于实现计数器功能的 action creator 函数</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/creators/counterCreators.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; CounterActions &#125; <span class="keyword">from</span> <span class="string">&quot;../actions/counterActions&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CounterTypes &#125; <span class="keyword">from</span> <span class="string">&quot;../types/counterTypes&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">namespace</span> CounterCreators &#123;</span><br><span class="line">  <span class="comment">// 计数器/数值增加</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">const</span> increment = (): CounterActions.Increment =&gt; (&#123;</span><br><span class="line">    <span class="attr">type</span>: CounterTypes.INCREMENT,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计数器/数值减少</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">const</span> decrement = (): CounterActions.Decrement =&gt; (&#123;</span><br><span class="line">    <span class="attr">type</span>: CounterTypes.DECREMENT,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计数器/数值增加/增加指定数值</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">const</span> incrementByCount = (</span><br><span class="line">    count: <span class="built_in">number</span></span><br><span class="line">  ): CounterActions.IncrementByCount =&gt; (&#123;</span><br><span class="line">    <span class="attr">type</span>: CounterTypes.INCREMENT_BY_COUNT,</span><br><span class="line">    <span class="attr">payload</span>: &#123; count &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>⑥ 创建 Redux Store 对象</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/store/index.ts</span><br><span class="line">import &#123; createStore &#125; from &quot;redux&quot;;</span><br><span class="line">import rootReducer from &quot;./reducers/rootReducer&quot;;</span><br><span class="line"></span><br><span class="line">// 创建 store 对象</span><br><span class="line">const store = createStore(rootReducer);</span><br><span class="line"></span><br><span class="line">// Redux 状态对象的类型</span><br><span class="line">export type AppState = ReturnType&lt;typeof store.getState&gt;;</span><br><span class="line">// 用于接收 Action 对象的 dispatch 方法的类型</span><br><span class="line">export type AppDispatch = typeof store.dispatch;</span><br><span class="line"></span><br><span class="line">// 导出 store 对象</span><br><span class="line">export default store;</span><br></pre></td></tr></table></figure>
<p>⑥ 在 App 组件中配置 Provider 组件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import &#123; Provider &#125; from &quot;react-redux&quot;;</span><br><span class="line">import store from &quot;./store&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">        &lt;div&gt;App works&lt;/div&gt;</span><br><span class="line">      &lt;/Provider&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>⑦ 创建用于实现计数器功能的 Counter 组件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/Counter.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default class Counter extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;button&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;span&gt;0&lt;/span&gt;</span><br><span class="line">        &lt;button&gt;-1&lt;/button&gt;</span><br><span class="line">      &lt;/&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import Counter from &quot;./components/Counter&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">        &lt;Counter /&gt;</span><br><span class="line">      &lt;/Provider&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>⑧ 在计数器组件中实现计数器功能</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/Counter.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import &#123; connect &#125; from &quot;react-redux&quot;;</span><br><span class="line">import &#123; AppDispatch, AppState &#125; from &quot;../store&quot;;</span><br><span class="line">import &#123; CounterActions &#125; from &quot;../store/actions/counterActions&quot;;</span><br><span class="line">import &#123; CounterCreators &#125; from &quot;../store/creators/counterCreators&quot;;</span><br><span class="line"></span><br><span class="line">// 从 Redux Store 映射的状态的类型</span><br><span class="line">interface StateProps &#123;</span><br><span class="line">  count: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 从 Redux Store 映射的用于发射 action 的方法的类型</span><br><span class="line">interface DispatchProps &#123;</span><br><span class="line">  increment(): CounterActions.Increment;</span><br><span class="line">  decrement(): CounterActions.Decrement;</span><br><span class="line">  incrementByCount(count: number): CounterActions.IncrementByCount;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 调用组件时传递的属性的类型</span><br><span class="line">interface OwnProps &#123;&#125;</span><br><span class="line"></span><br><span class="line">// 组件 Props 对象的最终类型</span><br><span class="line">type Props = OwnProps &amp; StateProps &amp; DispatchProps;</span><br><span class="line"></span><br><span class="line">class Counter extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; count, increment, decrement, incrementByCount &#125; = this.props;</span><br><span class="line">    return (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;button onClick=&#123;increment&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;span&gt;&#123;count&#125;&lt;/span&gt;</span><br><span class="line">        &lt;button onClick=&#123;decrement&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; incrementByCount(10)&#125;&gt;+10&lt;/button&gt;</span><br><span class="line">      &lt;/&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 1) 用于指定 mapStateToProps 方法的返回值类型</span><br><span class="line">// 2) 用于指定 mapDispatchToProps 方法的返回值类型</span><br><span class="line">// 3) 用于指定 mapStateToProps、mapDispatchToProps 方法的第二个参数的类型</span><br><span class="line">// 4) 用于指定 mapStateToProps 方法的第一个参数的类型</span><br><span class="line">export default connect&lt;StateProps, DispatchProps, OwnProps, AppState&gt;(</span><br><span class="line">  (state) =&gt; (&#123;</span><br><span class="line">    count: state.counterReducer.count,</span><br><span class="line">  &#125;),</span><br><span class="line">  (dispatch: AppDispatch) =&gt; (&#123;</span><br><span class="line">    increment: () =&gt; dispatch(CounterCreators.increment()),</span><br><span class="line">    decrement: () =&gt; dispatch(CounterCreators.decrement()),</span><br><span class="line">    incrementByCount: (count) =&gt;</span><br><span class="line">      dispatch(CounterCreators.incrementByCount(count)),</span><br><span class="line">  &#125;)</span><br><span class="line">)(Counter);</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1) 用于指定 mapStateToProps 方法的返回值类型</span></span><br><span class="line"><span class="comment">// 2) 用于指定 mapStateToProps 方法的第二个参数的类型</span></span><br><span class="line"><span class="comment">// 3) 用于指定 mapStateToProps 方法的第一个参数的类型</span></span><br><span class="line"><span class="keyword">const</span> mapStateToProps: MapStateToPropsParam&lt;StateProps, OwnProps, AppState&gt; = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  state</span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">count</span>: state.counterReducer.count,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1) 用于指定 mapDispatchToProps 方法的返回值的类型</span></span><br><span class="line"><span class="comment">// 2) 用于指定 mapDispatchToProps 方法的第二个参数的类型</span></span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps: MapDispatchToPropsParam&lt;DispatchProps, OwnProps&gt; = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  dispatch: AppDispatch</span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">increment</span>: <span class="function">() =&gt;</span> dispatch(CounterCreators.increment()),</span><br><span class="line">  <span class="attr">decrement</span>: <span class="function">() =&gt;</span> dispatch(CounterCreators.decrement()),</span><br><span class="line">  <span class="attr">incrementByCount</span>: <span class="function">(<span class="params">count</span>) =&gt;</span></span><br><span class="line">    dispatch(CounterCreators.incrementByCount(count)),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps, mapDispatchToProps)(Counter);</span><br></pre></td></tr></table></figure>
<h2 id="17-Redux-Thunk"><a href="#17-Redux-Thunk" class="headerlink" title="17. Redux Thunk"></a>17. Redux Thunk</h2><blockquote>
<p>目标：掌握 Redux + Redux Thunk + TypeScript 的使用方式并完成从 npm 存储库中搜索 package 的功能</p>
</blockquote>
<p>① 下载 redux-thunk、axios</p>
<p>注意：以上库全部自带 TypeScript 类型声明文件不需要单独下载。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install redux-thunk@2.4.1 axios@1.1.3</span><br></pre></td></tr></table></figure>
<p>② 创建用于实现搜索存储库功能的 action types</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/types/PackageTypes.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="built_in">enum</span> PackageTypes &#123;</span><br><span class="line">  SEARCH_PACKAGES = <span class="string">&quot;存储库/搜索&quot;</span>,</span><br><span class="line">  SEARCH_PACKAGES_SUCCESS = <span class="string">&quot;存储库/搜索成功&quot;</span>,</span><br><span class="line">  SEARCH_PACKAGES_ERROR = <span class="string">&quot;存储库/搜索失败&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③ 创建用于实现搜索存储库功能的 action 对象的类型</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/actions/PackageActions.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; PackageTypes &#125; <span class="keyword">from</span> <span class="string">&quot;../types/PackageTypes&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">namespace</span> PackageActions &#123;</span><br><span class="line">  <span class="comment">// 发送搜索请求</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> Search &#123;</span><br><span class="line">    <span class="attr">type</span>: PackageTypes.SEARCH_PACKAGES;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 搜索成功</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> SearchSuccess &#123;</span><br><span class="line">    <span class="attr">type</span>: PackageTypes.SEARCH_PACKAGES_SUCCESS;</span><br><span class="line">    payload: &#123;</span><br><span class="line">      <span class="attr">data</span>: <span class="built_in">string</span>[];</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 搜索失败</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> SearchError &#123;</span><br><span class="line">    <span class="attr">type</span>: PackageTypes.SEARCH_PACKAGES_ERROR;</span><br><span class="line">    error: <span class="built_in">string</span> | <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">type</span> Actions = Search | SearchSuccess | SearchError;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>④ 创建用于实现搜索存储库功能的 reducer 函数</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/reducers/packageReducer.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; PackageTypes &#125; <span class="keyword">from</span> <span class="string">&quot;../types/PackageTypes&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PackageActions &#125; <span class="keyword">from</span> <span class="string">&quot;../actions/PackageActions&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> PackageState &#123;</span><br><span class="line">  <span class="attr">data</span>: <span class="built_in">string</span>[];</span><br><span class="line">  status: <span class="string">&quot;idle&quot;</span> | <span class="string">&quot;loading&quot;</span> | <span class="string">&quot;success&quot;</span> | <span class="string">&quot;error&quot;</span>;</span><br><span class="line">  error: <span class="built_in">string</span> | <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState: PackageState = &#123;</span><br><span class="line">  <span class="attr">data</span>: [],</span><br><span class="line">  <span class="attr">status</span>: <span class="string">&quot;idle&quot;</span>,</span><br><span class="line">  <span class="attr">error</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">packageReducer</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  state: PackageState = initialState,</span></span></span><br><span class="line"><span class="params"><span class="function">  action: PackageActions.Actions</span></span></span><br><span class="line"><span class="params"><span class="function"></span>): <span class="title">PackageState</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> PackageTypes.SEARCH_PACKAGES:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">data</span>: [], <span class="attr">status</span>: <span class="string">&quot;loading&quot;</span>, <span class="attr">error</span>: <span class="literal">null</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> PackageTypes.SEARCH_PACKAGES_SUCCESS:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">data</span>: action.payload.data, <span class="attr">error</span>: <span class="literal">null</span>, <span class="attr">status</span>: <span class="string">&quot;success&quot;</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> PackageTypes.SEARCH_PACKAGES_ERROR:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">data</span>: [], <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">error</span>: action.error &#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/reducers/rootReducer.ts</span></span><br><span class="line"><span class="keyword">import</span> packageReducer <span class="keyword">from</span> <span class="string">&quot;./packageReducer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootReducer = combineReducers(&#123;</span><br><span class="line">  packageReducer,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>⑤ 创建用于实现搜索存储库功能的 action creator 函数</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/creators/packageCreators.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; PackageTypes &#125; <span class="keyword">from</span> <span class="string">&quot;../types/PackageTypes&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppState &#125; <span class="keyword">from</span> <span class="string">&quot;../index&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ThunkAction &#125; <span class="keyword">from</span> <span class="string">&quot;redux-thunk&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PackageActions &#125; <span class="keyword">from</span> <span class="string">&quot;../actions/PackageActions&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Response &#123;</span><br><span class="line">  <span class="attr">objects</span>: &#123; <span class="attr">package</span>: &#123; <span class="attr">name</span>: <span class="built_in">string</span> &#125; &#125;[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ThunkAction 的第一个泛型参数用于指定 Action creator 函数的返回值的类型</span></span><br><span class="line"><span class="comment">// ThunkAction 的第二个泛型参数用于指定状态的类型. 即 getState 方法的返回值类型</span></span><br><span class="line"><span class="comment">// ThunkAction 的第三个泛型参数用于指定函数的第三个参数的类型, 即 extraArgument 参数的类型</span></span><br><span class="line"><span class="comment">// ThunkAction 的第四个泛型参数用于指定函数的第一个参数 dispatch 方法能够接收的 action 对象的类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">namespace</span> PackageCreators &#123;</span><br><span class="line">  <span class="comment">// 在存储库中进行搜索</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">const</span> searchPackagesCreator =</span><br><span class="line">    (</span><br><span class="line">      text: <span class="built_in">string</span></span><br><span class="line">    ): ThunkAction&lt;</span><br><span class="line">      <span class="built_in">Promise</span>&lt;PackageActions.Actions&gt;,</span><br><span class="line">      AppState,</span><br><span class="line">      <span class="literal">undefined</span>,</span><br><span class="line">      PackageActions.Actions</span><br><span class="line">    &gt; =&gt;</span><br><span class="line">    <span class="keyword">async</span> (dispatch) =&gt; &#123;</span><br><span class="line">      <span class="comment">// 更新请求状态</span></span><br><span class="line">      dispatch(&#123; <span class="attr">type</span>: PackageTypes.SEARCH_PACKAGES &#125;);</span><br><span class="line">      <span class="comment">// 捕获错误</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> axios.get&lt;Response&gt;(</span><br><span class="line">          <span class="string">&quot;https://registry.npmjs.org/-/v1/search&quot;</span>,</span><br><span class="line">          &#123; <span class="attr">params</span>: &#123; text &#125; &#125;</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">// 更新请求状态 保存搜索结果</span></span><br><span class="line">        <span class="keyword">return</span> dispatch(&#123;</span><br><span class="line">          <span class="attr">type</span>: PackageTypes.SEARCH_PACKAGES_SUCCESS,</span><br><span class="line">          <span class="attr">payload</span>: &#123;</span><br><span class="line">            <span class="attr">data</span>: response.data.objects.map(<span class="function">(<span class="params">item</span>) =&gt;</span> item.package.name),</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="comment">// 更新请求状态 保存错误信息</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(&#123;</span><br><span class="line">          <span class="attr">type</span>: PackageTypes.SEARCH_PACKAGES_ERROR,</span><br><span class="line">          <span class="attr">error</span>: (error <span class="keyword">as</span> <span class="built_in">Error</span>).message,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; applyMiddleware &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">&quot;redux-thunk&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(rootReducer, applyMiddleware(thunk));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用于接收 Action 函数的 dispatch 方法的类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> AppThunkDispatch = ThunkDispatch&lt;</span><br><span class="line">  AppState,</span><br><span class="line">  <span class="built_in">any</span>,</span><br><span class="line">  Parameters&lt;AppDispatch&gt;[<span class="number">0</span>]</span><br><span class="line">&gt;;</span><br></pre></td></tr></table></figure>
<p>⑥ 创建 SearchPackage 组件用于实现功能</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/Package.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default class Package extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;form&gt;</span><br><span class="line">          &lt;input type=&quot;text&quot; /&gt;</span><br><span class="line">          &lt;button type=&quot;submit&quot;&gt;搜索&lt;/button&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &lt;li&gt;react&lt;/li&gt;</span><br><span class="line">          &lt;li&gt;react redux&lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import Package from &quot;./components/Package&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;Package /&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>⑦ 在 SearchPackage <code>组件中实现搜索功能并渲染搜索结果</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/Package.tsx</span><br><span class="line">import React, &#123; createRef, FormEvent, RefObject &#125; from &quot;react&quot;;</span><br><span class="line">import &#123;</span><br><span class="line">  connect,</span><br><span class="line">  MapDispatchToPropsParam,</span><br><span class="line">  MapStateToPropsParam,</span><br><span class="line">&#125; from &quot;react-redux&quot;;</span><br><span class="line">import &#123; PackageState &#125; from &quot;../store/reducers/packageReducer&quot;;</span><br><span class="line">import &#123; AppState, AppThunkDispatch &#125; from &quot;../store&quot;;</span><br><span class="line">import &#123; PackageActions &#125; from &quot;../store/actions/PackageActions&quot;;</span><br><span class="line">import &#123; PackageCreators &#125; from &quot;../store/creators/packageCreators&quot;;</span><br><span class="line"></span><br><span class="line">interface StateProps &#123;</span><br><span class="line">  package: PackageState;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface DispatchProps &#123;</span><br><span class="line">  searchPackage: (text: string) =&gt; Promise&lt;PackageActions.Actions&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface OwnProps &#123;&#125;</span><br><span class="line"></span><br><span class="line">type Props = StateProps &amp; DispatchProps &amp; OwnProps;</span><br><span class="line"></span><br><span class="line">class Package extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  // 用于获取 input 元素</span><br><span class="line">  inputRef: RefObject&lt;HTMLInputElement&gt; = createRef();</span><br><span class="line">  // 表单提交</span><br><span class="line">  async onSubmit(event: FormEvent&lt;HTMLFormElement&gt;) &#123;</span><br><span class="line">    // 阻止表单提交跳转的默认行为</span><br><span class="line">    event.preventDefault();</span><br><span class="line">    // 发送请求从存储库中进行搜索</span><br><span class="line">    await this.props.searchPackage(this.inputRef.current?.value!);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;form onSubmit=&#123;(event) =&gt; this.onSubmit(event)&#125;&gt;</span><br><span class="line">          &lt;input type=&quot;text&quot; ref=&#123;this.inputRef&#125; /&gt;</span><br><span class="line">          &lt;button type=&quot;submit&quot;&gt;搜索&lt;/button&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &#123;this.props.package.status === &quot;loading&quot; &amp;&amp; &lt;div&gt;loading...&lt;/div&gt;&#125;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &#123;this.props.package.data.map((name) =&gt; (</span><br><span class="line">            &lt;li key=&#123;name&#125;&gt;&#123;name&#125;&lt;/li&gt;</span><br><span class="line">          ))&#125;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const mapStateToProps: MapStateToPropsParam&lt;StateProps, OwnProps, AppState&gt; = (</span><br><span class="line">  state</span><br><span class="line">) =&gt; (&#123;</span><br><span class="line">  package: state.packageReducer,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const mapDispatchToProps: MapDispatchToPropsParam&lt;DispatchProps, OwnProps&gt; = (</span><br><span class="line">  dispatch: AppThunkDispatch</span><br><span class="line">) =&gt; (&#123;</span><br><span class="line">  searchPackage: (text) =&gt;</span><br><span class="line">    dispatch(PackageCreators.searchPackagesCreator(text)),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(Package);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>ts</tag>
      </tags>
  </entry>
  <entry>
    <title>React + TypeScript - 函数组件</title>
    <url>/archives/8ad35e55.html</url>
    <content><![CDATA[<h1 id="React-TypeScript-函数组件"><a href="#React-TypeScript-函数组件" class="headerlink" title="React + TypeScript - 函数组件"></a>React + TypeScript - 函数组件</h1><h2 id="01-创建应用"><a href="#01-创建应用" class="headerlink" title="01. 创建应用"></a>01. 创建应用</h2><blockquote>
<p>目标：掌握创建 React 应用的方式 (支持 TypeScript)</p>
</blockquote>
<p>使用 React 官方提供的 create-react-app 脚手架工具即可创建支持 TypeScript 的 React 应用。</p>
<p>我们只需要在命令中添加 —template typescript 选项即可创建 TypeScript 项目。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir react-ts-tutorial &amp;&amp; <span class="built_in">cd</span> react-ts-tutorial &amp;&amp; code .</span><br><span class="line">create-react-app ./ --template typescript</span><br></pre></td></tr></table></figure>
<p>在 TypeScript 项目中包含 JSX 代码的文件后缀名称为 tsx，其他不包含 JSX 代码的文件后缀名称为 ts。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">export default function App() &#123;</span><br><span class="line">  return &lt;div&gt;App&lt;/div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="02-为函数组件标注类型"><a href="#02-为函数组件标注类型" class="headerlink" title="02. 为函数组件标注类型"></a>02. 为函数组件标注类型</h2><blockquote>
<p>目标：掌握为函数组件标注类型的方式</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">export default function App(): JSX.Element &#123;</span><br><span class="line">  return &lt;div&gt;App works&lt;/div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import &#123; FC &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">const App: FC = () =&gt; &#123;</span><br><span class="line">  return &lt;div&gt;App works&lt;/div&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
<h2 id="03-标注-Props-对象的类型"><a href="#03-标注-Props-对象的类型" class="headerlink" title="03. 标注 Props 对象的类型"></a>03. 标注 Props 对象的类型</h2><blockquote>
<p>目标：掌握标注函数组件 Props 对象的类型</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">interface Props &#123;</span><br><span class="line">  name: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default function App(props: Props): JSX.Element &#123;</span><br><span class="line">  return &lt;div&gt;&#123;props.name&#125;&lt;/div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/index.tsx</span><br><span class="line">root.render(&lt;App name=&quot;张三&quot; /&gt;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import &#123; FC &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">interface Props &#123;</span><br><span class="line">  name: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const App: FC&lt;Props&gt; = (props) =&gt; &#123;</span><br><span class="line">  return &lt;div&gt;&#123;props.name&#125;&lt;/div&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
<h2 id="04-标注-useState-状态类型"><a href="#04-标注-useState-状态类型" class="headerlink" title="04. 标注 useState 状态类型"></a>04. 标注 useState 状态类型</h2><blockquote>
<p>目标：掌握标注状态类型的方式 (通过 useState 方法创建)</p>
</blockquote>
<p>① 在声明状态时如果状态有初始值不需要显式标注状态类型使用 TypeScript 中的类型推断即可</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default function App(): JSX.Element &#123;</span><br><span class="line">  // const state: number</span><br><span class="line">  const [state, setState] = useState(0);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setState(state + 1)&#125;&gt;&#123;state&#125;&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setState((prev) =&gt; prev + 1)&#125;&gt;&#123;state&#125;&lt;/button&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>② 对于不能使用类型推断的场景可以使用泛型参数标注状态的类型</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default function App(): JSX.Element &#123;</span><br><span class="line">  // const state: number[]</span><br><span class="line">  const [state, setState] = useState&lt;number[]&gt;([]);</span><br><span class="line">  return (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setState((prev) =&gt; [...prev, Math.random()])&#125;&gt;</span><br><span class="line">        add</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &#123;state.map((item) =&gt; (</span><br><span class="line">          &lt;li key=&#123;item&#125;&gt;&#123;item&#125;&lt;/li&gt;</span><br><span class="line">        ))&#125;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="05-标注-useReducer-状态类型"><a href="#05-标注-useReducer-状态类型" class="headerlink" title="05. 标注 useReducer 状态类型"></a>05. 标注 useReducer 状态类型</h2><blockquote>
<p>目标：掌握标注状态类型的方式 (通过 useReducer 方法创建)</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; useReducer &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">const initialState: CounterState = &#123;</span><br><span class="line">  count: 0,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">interface CounterState &#123;</span><br><span class="line">  count: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type CounterActions =</span><br><span class="line">  | &#123; type: &quot;counter/increment&quot; &#125;</span><br><span class="line">  | &#123; type: &quot;counter/decrement&quot; &#125;</span><br><span class="line">  | &#123; type: &quot;counter/incrementByCount&quot;; payload: &#123; count: number &#125; &#125;;</span><br><span class="line"></span><br><span class="line">function counterReducer(state: CounterState, action: CounterActions): CounterState &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case &quot;counter/increment&quot;:</span><br><span class="line">      return &#123; count: state.count + 1 &#125;;</span><br><span class="line">    case &quot;counter/decrement&quot;:</span><br><span class="line">      return &#123; count: state.count - 1 &#125;;</span><br><span class="line">    case &quot;counter/incrementByCount&quot;:</span><br><span class="line">      return &#123; count: state.count + action.payload.count &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default function App(): JSX.Element &#123;</span><br><span class="line">  const [state, dispatch] = useReducer(counterReducer, initialState);</span><br><span class="line">  return (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &#123;state.count&#125;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: &quot;counter/increment&quot; &#125;)&#125;&gt; +1 &lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: &quot;counter/decrement&quot; &#125;)&#125;&gt; -1 &lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: &quot;counter/incrementByCount&quot;, payload: &#123; count: 10 &#125;&#125;)&#125;&gt; +10 &lt;/button&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="06-标注-useRef-状态类型"><a href="#06-标注-useRef-状态类型" class="headerlink" title="06. 标注 useRef 状态类型"></a>06. 标注 useRef 状态类型</h2><blockquote>
<p>目标：掌握标注状态类型的方式 (通过 useRef 方法创建)</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; useEffect, useRef &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default function App(): JSX.Element &#123;</span><br><span class="line">  // 注意: 默认值必须是 null</span><br><span class="line">  // 因为在 JavaScript 中, 获取元素的方法的返回值在没有获取到元素时返回值都是 null</span><br><span class="line">  const buttonRef = useRef&lt;HTMLButtonElement&gt;(null);</span><br><span class="line">  // 组件初次渲染完成后</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    // 检测是否获取到 button 元素</span><br><span class="line">    if (!buttonRef.current) return;</span><br><span class="line">    // 测试输出 button 元素</span><br><span class="line">    console.log(buttonRef.current);</span><br><span class="line">  &#125;, []);</span><br><span class="line">  // 渲染视图 获取 button 元素</span><br><span class="line">  return &lt;button ref=&#123;buttonRef&#125;&gt;button&lt;/button&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="07-标注-forwardRef-方法类型"><a href="#07-标注-forwardRef-方法类型" class="headerlink" title="07. 标注 forwardRef 方法类型"></a>07. 标注 forwardRef 方法类型</h2><blockquote>
<p>目标：掌握在调用 forwardRef 方法时为其传递泛型参数的方式</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/Message.tsx</span><br><span class="line">import &#123; forwardRef, useImperativeHandle &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export interface MsgRef &#123;</span><br><span class="line">  msg: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface MsgProps &#123;</span><br><span class="line">  test: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 1) 定义 forwardRef 方法返回组件调用时接收的 ref 属性值的类型</span><br><span class="line">// 2) 定义 forwardRef 方法返回组件调用时接收的 props 对象的类型</span><br><span class="line">// forwardRef 会将接收到的 ref 和 props 传递给我们定义的组件</span><br><span class="line">const Message = forwardRef&lt;MsgRef, MsgProps&gt;((props, ref) =&gt; &#123;</span><br><span class="line">  // 为 ref 对象赋值, 值必须符合 MsgRef 类型</span><br><span class="line">  useImperativeHandle(ref, () =&gt; (&#123; msg: &quot;hello&quot; &#125;));</span><br><span class="line">  return &lt;div&gt;&#123;props.test&#125;&lt;/div&gt;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default Message;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import &#123; useEffect, useRef &#125; from &quot;react&quot;;</span><br><span class="line">import Message, &#123; MsgRef &#125; from &quot;./Message&quot;;</span><br><span class="line"></span><br><span class="line">export default function App() &#123;</span><br><span class="line">  const ref = useRef&lt;MsgRef&gt;(null);</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    console.log(ref.current?.msg);</span><br><span class="line">  &#125;, []);</span><br><span class="line">  return &lt;Message ref=&#123;ref&#125; test=&quot;test&quot; /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="08-配置-Redux-Toolkit"><a href="#08-配置-Redux-Toolkit" class="headerlink" title="08. 配置 Redux Toolkit"></a>08. 配置 Redux Toolkit</h2><blockquote>
<p>目标：在支持 TypeScript 的 React 应用中配置 Redux Toolkit</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 该包自带类型声明文件 不需要单独下载</span></span><br><span class="line">npm i @reduxjs/toolkit@1.9.0 react-redux@8.0.5</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="comment">// 创建 store 对象</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  <span class="attr">devTools</span>: process.env.NODE_ENV !== <span class="string">&quot;production&quot;</span>,</span><br><span class="line">  <span class="attr">reducer</span>: &#123;&#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/index.tsx</span><br><span class="line">import &#123; Provider &#125; from &quot;react-redux&quot;;</span><br><span class="line">import &#123; store &#125; from &quot;./store&quot;;</span><br><span class="line"></span><br><span class="line">// 配置 Provider 组件</span><br><span class="line">root.render(</span><br><span class="line">  &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">    &lt;App /&gt;</span><br><span class="line">  &lt;/Provider&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="09-createAction"><a href="#09-createAction" class="headerlink" title="09. createAction"></a>09. createAction</h2><blockquote>
<p>目标：掌握在创建 action creator 函数时标注 action payload 参数的类型</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/creators/counterCreators.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createAction &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> increment = createAction(<span class="string">&quot;counter/increment&quot;</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> incrementByCount = createAction&lt;&#123; <span class="attr">count</span>: <span class="built_in">number</span> &#125;&gt;(</span><br><span class="line">  <span class="string">&quot;counter/incrementByCount&quot;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// incrementByCount(&#123;count: 10&#125;);</span></span><br></pre></td></tr></table></figure>
<h2 id="10-createReducer"><a href="#10-createReducer" class="headerlink" title="10. createReducer"></a>10. createReducer</h2><blockquote>
<p>目标：掌握在创建 reducer 函数时标注状态的方式</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/reducers/counterReducer.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createReducer &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; increment, incrementByCount &#125; <span class="keyword">from</span> <span class="string">&quot;../creators/counterCreators&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// reducer 函数操作的状态的类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> CounterState &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始状态</span></span><br><span class="line"><span class="keyword">const</span> initialState: CounterState = &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 reducer 函数</span></span><br><span class="line"><span class="keyword">const</span> counterReducer = createReducer&lt;CounterState&gt;(initialState, <span class="function">(<span class="params">builder</span>) =&gt;</span> &#123;</span><br><span class="line">  builder</span><br><span class="line">    .addCase(increment, <span class="function">(<span class="params">state</span>) =&gt;</span> (&#123; <span class="attr">count</span>: state.count + <span class="number">1</span> &#125;))</span><br><span class="line">    .addCase(incrementByCount, <span class="function">(<span class="params">state, action</span>) =&gt;</span> (&#123;</span><br><span class="line">      <span class="attr">count</span>: state.count + action.payload.count,</span><br><span class="line">    &#125;))</span><br><span class="line">    .addDefaultCase(<span class="function">(<span class="params">state</span>) =&gt;</span> state);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> counterReducer;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">import</span> counterReducer <span class="keyword">from</span> <span class="string">&quot;./reducers/counterReducer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    counterReducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="11-useSelector"><a href="#11-useSelector" class="headerlink" title="11. useSelector"></a>11. useSelector</h2><blockquote>
<p>目标：掌握在组件中通过 useSelector 获取状态时标注 Redux Store 状态对象的类型和要获取的状态的类型</p>
</blockquote>
<p>① 为 useSelector 方法设置类型的方式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/Counter.tsx</span><br><span class="line">import &#123; useSelector &#125; from &quot;react-redux&quot;;</span><br><span class="line">import &#123; AppState &#125; from &quot;../store&quot;;</span><br><span class="line">import &#123; CounterState &#125; from &quot;../store/reducers/counterReducer&quot;;</span><br><span class="line"></span><br><span class="line">export default function Counter() &#123;</span><br><span class="line">  const counterReducer = useSelector&lt;AppState, CounterState&gt;(</span><br><span class="line">    (state) =&gt; state.counterReducer</span><br><span class="line">  );</span><br><span class="line">  return &lt;div&gt;&#123;counterReducer.count&#125;&lt;/div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="comment">// 声明 Redux Store 中状态对象的类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> AppState = ReturnType&lt;<span class="keyword">typeof</span> store.getState&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import Counter from &quot;./components/Counter&quot;;</span><br><span class="line"></span><br><span class="line">export default function App() &#123;</span><br><span class="line">  return &lt;Counter /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>② 对 useSelector 方法的类型进行包装，避免在任何组件中调用该方法时都传递 AppState</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/store/index.ts</span><br><span class="line">import &#123; TypedUseSelectorHook, useSelector &#125; from &quot;react-redux&quot;;</span><br><span class="line"></span><br><span class="line">export const useTypedSelector: TypedUseSelectorHook&lt;AppState&gt; = useSelector;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/Counter.tsx</span><br><span class="line">import &#123; useTypedSelector &#125; from &quot;../store&quot;;</span><br><span class="line"></span><br><span class="line">export default function Counter() &#123;</span><br><span class="line">  const counterReducer = useTypedSelector&lt;CounterState&gt;(</span><br><span class="line">    (state) =&gt; state.counterReducer</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="12-useDispatch"><a href="#12-useDispatch" class="headerlink" title="12. useDispatch"></a>12. useDispatch</h2><blockquote>
<p>目标：掌握 useDispatch 方法返回值默认类型的含义</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/Counter.tsx</span><br><span class="line">import &#123; useDispatch &#125; from &quot;react-redux&quot;;</span><br><span class="line">import &#123; increment, incrementByCount &#125; from &quot;../store/creators/counterCreators&quot;;</span><br><span class="line"></span><br><span class="line">export default function Counter() &#123;</span><br><span class="line">  // const dispatch: Dispatch&lt;AnyAction&gt;</span><br><span class="line">  // 在不为 dispatch 方法标注类型的情况下, 它的默认类型就是一个可以接受任何 action 对象作为参数的函数</span><br><span class="line">  // 也就是说给 dispatch 方法传递的参数必须是对象类型, 对象中必须有 type 属性</span><br><span class="line">  // 对象中可以有任意名称的附加属性及任意类型的附加属性值, 也可以没有</span><br><span class="line">  const dispatch = useDispatch();</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(increment())&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(incrementByCount(&#123; count: 10 &#125;))&#125;&gt;</span><br><span class="line">        &#123;&quot; &quot;&#125;</span><br><span class="line">        +1&#123;&quot; &quot;&#125;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="13-createAsyncThunk"><a href="#13-createAsyncThunk" class="headerlink" title="13. createAsyncThunk"></a>13. createAsyncThunk</h2><blockquote>
<p>目标：掌握异步 Action Creator 与 TypeScript 结合使用的方式</p>
</blockquote>
<hr>
<ul>
<li>[ ] 创建用于加载待办事项列表状态的 action creator 函数</li>
<li>[ ] 创建用于存储待办事项列表状态的 reducer 函数</li>
<li>[ ] 创建 Todos 组件、获取待办事项列表</li>
<li>[ ] 对 useDispatch 方法的泛型参数进行包装避免在每个组件中调用 useDispatch 方法时都传递 AppDispatch 参数</li>
</ul>
<hr>
<p>① 创建用于加载待办事项列表状态的 action creator 函数</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/creators/todoCreators.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createAsyncThunk &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Todo &#125; <span class="keyword">from</span> <span class="string">&quot;../reducers/todoReducer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1) 异步操作执行成功后 action.payload 属性的值的类型</span></span><br><span class="line"><span class="comment">// 2) action creator 函数在调用时传递的参数的类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> loadTodos = createAsyncThunk&lt;&#123; <span class="attr">todos</span>: Todo[] &#125;, <span class="built_in">string</span>&gt;(</span><br><span class="line">  <span class="string">&quot;todo/requestTodo&quot;</span>,</span><br><span class="line">  <span class="keyword">async</span> (url) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.get&lt;Todo[]&gt;(url);</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">todos</span>: response.data &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>② 创建用于存储待办事项列表状态的 reducer 函数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/store/reducers/todoReducer.ts</span><br><span class="line">import &#123; createReducer &#125; from &quot;@reduxjs/toolkit&quot;;</span><br><span class="line">import &#123; loadTodos &#125; from &quot;../creators/todoCreators&quot;;</span><br><span class="line"></span><br><span class="line">// Todo 对象的类型</span><br><span class="line">export interface Todo &#123;</span><br><span class="line">  userId: number;</span><br><span class="line">  id: number;</span><br><span class="line">  title: string;</span><br><span class="line">  completed: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// reducer 函数操作的状态的类型</span><br><span class="line">export interface TodoState &#123;</span><br><span class="line">  todos: &#123;</span><br><span class="line">    status: &quot;idle&quot; | &quot;loading&quot; | &quot;success&quot; | &quot;error&quot;;</span><br><span class="line">    error: string | null;</span><br><span class="line">    result: Todo[];</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 初始状态</span><br><span class="line">const initialState: TodoState = &#123;</span><br><span class="line">  todos: &#123;</span><br><span class="line">    status: &quot;idle&quot;,</span><br><span class="line">    error: null,</span><br><span class="line">    result: [],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const todoReducer = createReducer&lt;TodoState&gt;(initialState, (builder) =&gt; &#123;</span><br><span class="line">  builder.addCase(loadTodos.pending, (state) =&gt; &#123;</span><br><span class="line">    state.todos = &#123;</span><br><span class="line">      result: [],</span><br><span class="line">      error: null,</span><br><span class="line">      status: &quot;loading&quot;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">  builder</span><br><span class="line">    .addCase(loadTodos.fulfilled, (state, action) =&gt; &#123;</span><br><span class="line">      state.todos = &#123;</span><br><span class="line">        result: action.payload.todos,</span><br><span class="line">        error: null,</span><br><span class="line">        status: &quot;success&quot;,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">    .addCase(loadTodos.rejected, (state, action) =&gt; &#123;</span><br><span class="line">      state.todos = &#123;</span><br><span class="line">        result: [],</span><br><span class="line">        status: &quot;error&quot;,</span><br><span class="line">        error: action.error.message!,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default todoReducer;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/store/index.ts</span><br><span class="line">import todoReducer from &quot;./reducers/todoReducer&quot;;</span><br><span class="line"></span><br><span class="line">export const store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    todoReducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>③ 创建 Todos 组件、获取待办事项列表</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/Todos.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import &#123; useDispatch &#125; from &quot;react-redux&quot;;</span><br><span class="line">import &#123; AppDispatch &#125; from &quot;../store&quot;;</span><br><span class="line">import &#123; loadTodos &#125; from &quot;../store/creators/todoCreators&quot;;</span><br><span class="line"></span><br><span class="line">export default function Todos() &#123;</span><br><span class="line">  const dispatch = useDispatch&lt;AppDispatch&gt;();</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(loadTodos(&quot;https://jsonplaceholder.typicode.com/todos&quot;))&#125;&gt;</span><br><span class="line">        loadTodos</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> AppDispatch = <span class="keyword">typeof</span> store.dispatch;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import Todos from &quot;./components/Todos&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return &lt;Todos /&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
<p>④ 对 useDispatch 方法的泛型参数进行包装避免在每个组件中调用 useDispatch 方法时都传递 AppDispatch 参数</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTypedDispatch = <span class="function">() =&gt;</span> useDispatch&lt;AppDispatch&gt;();</span><br></pre></td></tr></table></figure>
<h2 id="14-createSlice"><a href="#14-createSlice" class="headerlink" title="14. createSlice"></a>14. createSlice</h2><blockquote>
<p>目标：掌握状态切片和 TypeScript 结合使用的方式</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/components/quantity/slice.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice, PayloadAction, Draft &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> QuantityState &#123;</span><br><span class="line">  <span class="attr">quantity</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState: QuantityState = &#123;</span><br><span class="line">  <span class="attr">quantity</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// createSlice 泛型参数</span></span><br><span class="line"><span class="comment">// 1) 状态类型</span></span><br><span class="line"><span class="comment">// 2) reducers 配置项的类型</span></span><br><span class="line"><span class="comment">// 3) name 选项的类型</span></span><br><span class="line"><span class="keyword">const</span> &#123; actions, <span class="attr">reducer</span>: quantityReducer &#125; = createSlice&lt;</span><br><span class="line">  QuantityState,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">increase</span>: <span class="function">(<span class="params">state: Draft&lt;QuantityState&gt;</span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">    increaseByQuantity: <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">      state: Draft&lt;QuantityState&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">      action: PayloadAction&lt;&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        quantity: <span class="built_in">number</span>;</span></span></span><br><span class="line"><span class="params"><span class="function">      &#125;&gt;</span></span></span><br><span class="line"><span class="params"><span class="function">    </span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;quantity&quot;</span></span><br><span class="line">&gt;(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;quantity&quot;</span>,</span><br><span class="line">  initialState,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="attr">increase</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.quantity += <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">increaseByQuantity</span>: <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">      state.quantity += action.payload.quantity;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; increase, increaseByQuantity &#125; = actions;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> quantityReducer;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/store.ts</span><br><span class="line">import quantityReducer from &quot;../components/quantity/slice&quot;;</span><br><span class="line"></span><br><span class="line">export const store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    quantityReducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; useTypedDispatch, useTypedSelector &#125; from &quot;../../store&quot;;</span><br><span class="line">import &#123; increase, increaseByQuantity, QuantityState &#125; from &quot;./slice&quot;;</span><br><span class="line"></span><br><span class="line">export default function Quantity() &#123;</span><br><span class="line">  const quantityReducer = useTypedSelector&lt;QuantityState&gt;(</span><br><span class="line">    (state) =&gt; state.quantityReducer</span><br><span class="line">  );</span><br><span class="line">  const dispatch = useTypedDispatch();</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;quantityReducer.quantity&#125;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(increase())&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(increaseByQuantity(&#123; quantity: 10 &#125;))&#125;&gt;</span><br><span class="line">        &#123;&quot; &quot;&#125;</span><br><span class="line">        +10&#123;&quot; &quot;&#125;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import Quantity from &quot;./components/quantity&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return &lt;Quantity /&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
<h2 id="15-createSelector"><a href="#15-createSelector" class="headerlink" title="15. createSelector"></a>15. createSelector</h2><blockquote>
<p>目标：掌握状态选择器和 TypeScript 结合使用的方式</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/quantity/slice.ts</span><br><span class="line">import &#123; AppState &#125; from &quot;../../store&quot;;</span><br><span class="line">import &#123; CounterState &#125; from &quot;../../store/reducers/counterReducer&quot;;</span><br><span class="line"></span><br><span class="line">// 1) 指定输入选择器函数的类型, 数组, 内部放置输入选择器函数类型</span><br><span class="line">// 2) 输出选择器函数的返回值类型</span><br><span class="line">export const selectTotal = createSelector&lt;</span><br><span class="line">  [(state: AppState) =&gt; QuantityState, (state: AppState) =&gt; CounterState],</span><br><span class="line">  number</span><br><span class="line">&gt;(</span><br><span class="line">  (state) =&gt; state.quantityReducer,</span><br><span class="line">  (state) =&gt; state.counterReducer,</span><br><span class="line">  (quantityReducer, counterReducer) =&gt;</span><br><span class="line">    quantityReducer.quantity + counterReducer.count</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/quantity/index.tsx</span><br><span class="line">import &#123; useTypedSelector &#125; from &quot;../../store&quot;;</span><br><span class="line">import &#123; selectTotal &#125; from &quot;./slice&quot;;</span><br><span class="line"></span><br><span class="line">export default function Quantity() &#123;</span><br><span class="line">  const total = useTypedSelector(selectTotal);</span><br><span class="line">  return &lt;div&gt;&#123;total&#125;&lt;/div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="16-createEntityAdapter"><a href="#16-createEntityAdapter" class="headerlink" title="16. createEntityAdapter"></a>16. createEntityAdapter</h2><blockquote>
<p>目标：掌握实体适配器和 TypeScript 结合使用的方式</p>
</blockquote>
<hr>
<ul>
<li>[ ] 创建用于存储待办事项列表状态切片(使用实体适配器存储)、创建用于获取待办事项列表的状态选择器</li>
<li>[ ] 创建 TodoList 组件、测试状态切片是否生效</li>
</ul>
<hr>
<p>① 创建用于存储待办事项列表状态切片(使用实体适配器存储)、创建用于获取待办事项列表的状态选择器</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/components/todoList/slice.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createEntityAdapter,</span><br><span class="line">  createSelector,</span><br><span class="line">  createSlice,</span><br><span class="line">  Draft,</span><br><span class="line">  EntityState,</span><br><span class="line">  nanoid,</span><br><span class="line">  PayloadAction,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppState &#125; <span class="keyword">from</span> <span class="string">&quot;../../store&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> TodoItem &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">  title: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todoListAdapter = createEntityAdapter&lt;TodoItem&gt;();</span><br><span class="line"><span class="keyword">const</span> todoListSelectors = todoListAdapter.getSelectors();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; actions, <span class="attr">reducer</span>: todoListReducer &#125; = createSlice&lt;</span><br><span class="line">  EntityState&lt;TodoItem&gt;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">addItem</span>: &#123;</span><br><span class="line">      <span class="attr">reducer</span>: <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">        state: Draft&lt;EntityState&lt;TodoItem&gt;&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">        action: PayloadAction&lt;&#123; todo: TodoItem &#125;&gt;</span></span></span><br><span class="line"><span class="params"><span class="function">      </span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">      prepare: <span class="function">(<span class="params">title: <span class="built_in">string</span></span>) =&gt;</span> &#123; <span class="attr">payload</span>: &#123; <span class="attr">todo</span>: TodoItem &#125; &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;todoList&quot;</span></span><br><span class="line">&gt;(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;todoList&quot;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: todoListAdapter.getInitialState(),</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="attr">addItem</span>: &#123;</span><br><span class="line">      <span class="attr">reducer</span>: <span class="function">(<span class="params">state, action: PayloadAction&lt;&#123; todo: TodoItem &#125;&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">        todoListAdapter.addOne(state, action.payload.todo);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">prepare</span>: <span class="function">(<span class="params">title: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">payload</span>: &#123; <span class="attr">todo</span>: &#123; title, <span class="attr">id</span>: nanoid() &#125; &#125;,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> selectTodos = createSelector&lt;</span><br><span class="line">  [<span class="function">(<span class="params">state: AppState</span>) =&gt;</span> EntityState&lt;TodoItem&gt;],</span><br><span class="line">  TodoItem[]</span><br><span class="line">&gt;(<span class="function">(<span class="params">state: AppState</span>) =&gt;</span> state.todoListReducer, todoListSelectors.selectAll);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; addItem &#125; = actions;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> todoListReducer;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">import</span> todoListReducer <span class="keyword">from</span> <span class="string">&quot;../components/todoList/slice&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    todoListReducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>② 创建 TodoList 组件、测试状态切片是否生效</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/todoList/index.tsx</span><br><span class="line">import &#123; useTypedDispatch, useTypedSelector &#125; from &quot;../../store&quot;;</span><br><span class="line">import &#123; addItem, selectTodos &#125; from &quot;./slice&quot;;</span><br><span class="line"></span><br><span class="line">export default function TodoList() &#123;</span><br><span class="line">  const todos = useTypedSelector(selectTodos);</span><br><span class="line">  const dispatch = useTypedDispatch();</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type=&quot;text&quot;</span><br><span class="line">        onKeyUp=&#123;(event) =&gt; &#123;</span><br><span class="line">          if (event.key === &quot;Enter&quot;) &#123;</span><br><span class="line">            dispatch(addItem(event.currentTarget.value));</span><br><span class="line">            event.currentTarget.value = &quot;&quot;;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">      &#123;todos.map((item) =&gt; (</span><br><span class="line">        &lt;li key=&#123;item.id&#125;&gt;&#123;item.title&#125;&lt;/li&gt;</span><br><span class="line">      ))&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import TodoList from &quot;./components/todoList&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return &lt;TodoList /&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
<h2 id="17-RTK-Query-查询"><a href="#17-RTK-Query-查询" class="headerlink" title="17. RTK Query (查询)"></a>17. RTK Query (查询)</h2><blockquote>
<p>目标：掌握 RTK Query 和 TypeScript 结合使用的方式</p>
</blockquote>
<hr>
<ul>
<li>[ ] 使用 json-server 启动测试服务器准备接收客户端请求</li>
<li>[ ] 在应用中加入 RTK Query 的基本配置</li>
<li>[ ] 创建用于获取用户列表的 API 端点</li>
<li>[ ] 创建 User 组件测试用户列表是否可以获取成功</li>
</ul>
<hr>
<p>① 使用 json-server 启动测试服务器准备接收客户端请求</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install json-server@0.17.1</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;users&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;张三&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="number">2</span>,</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;李四&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;server&quot;</span>: <span class="string">&quot;json-server -w ./db.json -p 3001&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run server</span><br></pre></td></tr></table></figure>
<p>② 在应用中加入 RTK Query 的基本配置</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/apiService.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit/query/react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> apiService = createApi(&#123;</span><br><span class="line">  <span class="attr">reducerPath</span>: <span class="string">&quot;apiReducer&quot;</span>,</span><br><span class="line">  <span class="attr">baseQuery</span>: fetchBaseQuery(&#123; <span class="attr">baseUrl</span>: <span class="string">&quot;http://localhost:3001&quot;</span> &#125;),</span><br><span class="line">  <span class="attr">endpoints</span>: <span class="function">(<span class="params">builder</span>) =&gt;</span> (&#123;&#125;),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> apiService;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">import</span> apiService <span class="keyword">from</span> <span class="string">&quot;../apiService&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    [apiService.reducerPath]: apiService.reducer,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">middleware</span>: <span class="function">(<span class="params">getDefaultMiddle</span>) =&gt;</span></span><br><span class="line">    getDefaultMiddle().concat([apiService.middleware]),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>③ 创建用于获取用户列表的 API 端点</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/components/user/userService.ts</span></span><br><span class="line"><span class="keyword">import</span> apiService <span class="keyword">from</span> <span class="string">&quot;../../apiService&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> User &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userEndpoints = apiService.injectEndpoints(&#123;</span><br><span class="line">  <span class="attr">endpoints</span>: <span class="function">(<span class="params">builder</span>) =&gt;</span> (&#123;</span><br><span class="line">    <span class="comment">// 获取用户列表</span></span><br><span class="line">    <span class="comment">// 1) 服务端响应数据的类型</span></span><br><span class="line">    <span class="comment">// 2) 参数类型</span></span><br><span class="line">    <span class="attr">requestUsers</span>: builder.query&lt;User[], <span class="literal">undefined</span>&gt;(&#123;</span><br><span class="line">      <span class="attr">query</span>: <span class="function">() =&gt;</span> (&#123; <span class="attr">url</span>: <span class="string">&quot;/users&quot;</span> &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> userEndpoints;</span><br></pre></td></tr></table></figure>
<p>④ 创建 User 组件测试用户列表是否可以获取成功</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/components/user/User.tsx</span><br><span class="line">import &#123; useRequestUsersQuery &#125; from &quot;./userService&quot;;</span><br><span class="line"></span><br><span class="line">export default function User() &#123;</span><br><span class="line">  // 发送请求获取用户列表</span><br><span class="line">  const &#123; data, isLoading, isFetching, isError &#125; =</span><br><span class="line">    useRequestUsersQuery(undefined);</span><br><span class="line">  // 监听请求状态</span><br><span class="line">  if (isLoading) return &lt;div&gt;加载中...&lt;/div&gt;;</span><br><span class="line">  if (isFetching) return &lt;div&gt;正在重新加载...&lt;/div&gt;;</span><br><span class="line">  if (isError) return &lt;div&gt;发生了错误&lt;/div&gt;;</span><br><span class="line">  if (typeof data == &quot;undefined&quot;) return &lt;div&gt;暂无数据&lt;/div&gt;;</span><br><span class="line">  // 渲染用户列表</span><br><span class="line">  return (</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &#123;data.map((user) =&gt; (</span><br><span class="line">        &lt;li key=&#123;user.id&#125;&gt;&#123;user.name&#125;&lt;/li&gt;</span><br><span class="line">      ))&#125;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import User from &quot;./components/user/User&quot;;</span><br><span class="line"></span><br><span class="line">export default function App() &#123;</span><br><span class="line">  return &lt;User /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>ts</tag>
      </tags>
  </entry>
  <entry>
    <title>sass_less_stylus</title>
    <url>/archives/2039e3ed.html</url>
    <content><![CDATA[<h1 id="面试官：说说对Css预编语言的理解？有哪些区别"><a href="#面试官：说说对Css预编语言的理解？有哪些区别" class="headerlink" title="面试官：说说对Css预编语言的理解？有哪些区别?"></a>面试官：说说对Css预编语言的理解？有哪些区别?</h1><p> <img src="https://static.vue-js.com/81cca1c0-a42c-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p><code>Css</code> 作为一门标记性语言，语法相对简单，对使用者的要求较低，但同时也带来一些问题</p>
<p>需要书写大量看似没有逻辑的代码，不方便维护及扩展，不利于复用，尤其对于非前端开发工程师来讲，往往会因为缺少 <code>Css</code> 编写经验而很难写出组织良好且易于维护的 <code>Css</code> 代码</p>
<p><code>Css</code>预处理器便是针对上述问题的解决方案</p>
<h4 id="预处理语言"><a href="#预处理语言" class="headerlink" title="预处理语言"></a>预处理语言</h4><p>扩充了 <code>Css</code> 语言，增加了诸如变量、混合（mixin）、函数等功能，让 <code>Css</code> 更易维护、方便</p>
<p>本质上，预处理是<code>Css</code>的超集</p>
<p>包含一套自定义的语法及一个解析器，根据这些语法定义自己的样式规则，这些规则最终会通过解析器，编译生成对应的 <code>Css</code> 文件</p>
<h2 id="二、有哪些"><a href="#二、有哪些" class="headerlink" title="二、有哪些"></a>二、有哪些</h2><p><code>Css</code>预编译语言在前端里面有三大优秀的预编处理器，分别是：</p>
<ul>
<li>sass</li>
<li>less</li>
<li>stylus</li>
</ul>
<h3 id="sass"><a href="#sass" class="headerlink" title="sass"></a>sass</h3><p>2007 年诞生，最早也是最成熟的 <code>Css</code>预处理器，拥有 Ruby 社区的支持和 <code>Compass</code> 这一最强大的 <code>Css</code>框架，目前受 <code>LESS</code> 影响，已经进化到了全面兼容 <code>Css</code> 的 <code>Scss</code></p>
<p>文件后缀名为<code>.sass</code>与<code>scss</code>，可以严格按照 sass 的缩进方式省去大括号和分号</p>
<h3 id="less"><a href="#less" class="headerlink" title="less"></a>less</h3><p>2009年出现，受<code>SASS</code>的影响较大，但又使用 <code>Css</code> 的语法，让大部分开发者和设计师更容易上手，在 <code>Ruby</code>社区之外支持者远超过 <code>SASS</code></p>
<p>其缺点是比起 <code>SASS</code>来，可编程功能不够，不过优点是简单和兼容 <code>Css</code>，反过来也影响了 <code>SASS</code>演变到了<code>Scss</code> 的时代</p>
<h3 id="stylus"><a href="#stylus" class="headerlink" title="stylus"></a>stylus</h3><p><code>Stylus</code>是一个<code>Css</code>的预处理框架，2010 年产生，来自 <code>Node.js</code>社区，主要用来给 <code>Node</code> 项目进行 <code>Css</code> 预处理支持</p>
<p>所以<code>Stylus</code> 是一种新型语言，可以创建健壮的、动态的、富有表现力的<code>Css</code>。比较年轻，其本质上做的事情与<code>SASS/LESS</code>等类似</p>
<h2 id="三、区别"><a href="#三、区别" class="headerlink" title="三、区别"></a>三、区别</h2><p>虽然各种预处理器功能强大，但使用最多的，还是以下特性：</p>
<ul>
<li>变量（variables）</li>
<li>作用域（scope）</li>
<li>代码混合（ mixins）</li>
<li>嵌套（nested rules）</li>
<li>代码模块化（Modules）</li>
</ul>
<p>因此，下面就展开这些方面的区别</p>
<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>less和scss</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>sass</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box</span></span><br><span class="line">  <span class="attribute">display</span>: block</span><br></pre></td></tr></table></figure>
<p>stylus</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box</span></span><br><span class="line">  <span class="attribute">display</span>: block</span><br></pre></td></tr></table></figure>
<h3 id="嵌套"><a href="#嵌套" class="headerlink" title="嵌套"></a>嵌套</h3><p>三者的嵌套语法都是一致的，甚至连引用父级选择器的标记 &amp; 也相同</p>
<p>区别只是 Sass 和 Stylus 可以用没有大括号的方式书写</p>
<p>less</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.a</span> &#123;</span><br><span class="line">  &amp;<span class="selector-class">.b</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>变量无疑为 Css 增加了一种有效的复用方式，减少了原来在 Css 中无法避免的重复「硬编码」</p>
<p><code>less</code>声明的变量必须以<code>@</code>开头，后面紧跟变量名和变量值，而且变量名和变量值需要使用冒号<code>:</code>分隔开</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@red</span>: #c00;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">strong</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: @red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>sass</code>声明的变量跟<code>less</code>十分的相似，只是变量名前面使用<code>@</code>开头</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">$red: <span class="number">#c00</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">strong</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: $red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>stylus</code>声明的变量没有任何的限定，可以使用<code>$</code>开头，结尾的分号<code>;</code>可有可无，但变量与变量值之间需要使用<code>=</code></p>
<p>在<code>stylus</code>中我们不建议使用<code>@</code>符号开头声明变量</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">red = <span class="selector-id">#c00</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">strong</span></span><br><span class="line">  <span class="attribute">color</span>: red</span><br></pre></td></tr></table></figure>
<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><p><code>Css</code> 预编译器把变量赋予作用域，也就是存在生命周期。就像 <code>js</code>一样，它会先从局部作用域查找变量，依次向上级作用域查找</p>
<p><code>sass</code>中不存在全局变量</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">$<span class="attribute">color</span>: black;</span><br><span class="line"><span class="selector-class">.scoped</span> &#123;</span><br><span class="line">  $bg: blue;</span><br><span class="line">  $<span class="attribute">color</span>: white;</span><br><span class="line">  <span class="attribute">color</span>: $color;</span><br><span class="line">  <span class="attribute">background-color</span>:$bg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.unscoped</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>:$color;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>编译后</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.scoped</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>:white;<span class="comment">/*是白色*/</span></span><br><span class="line">  <span class="attribute">background-color</span>:blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.unscoped</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>:white;<span class="comment">/*白色（无全局变量概念）*/</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>所以，在<code>sass</code>中最好不要定义相同的变量名</p>
<p><code>less</code>与<code>stylus</code>的作用域跟<code>javascript</code>十分的相似，首先会查找局部定义的变量，如果没有找到，会像冒泡一样，一级一级往下查找，直到根为止</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@color</span>: black;</span><br><span class="line"><span class="selector-class">.scoped</span> &#123;</span><br><span class="line">  <span class="keyword">@bg</span>: blue;</span><br><span class="line">  <span class="keyword">@color</span>: white;</span><br><span class="line">  <span class="attribute">color</span>: @color;</span><br><span class="line">  <span class="attribute">background-color</span>:@bg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.unscoped</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>:@color;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>编译后：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.scoped</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>:white;<span class="comment">/*白色（调用了局部变量）*/</span></span><br><span class="line">  <span class="attribute">background-color</span>:blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.unscoped</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>:black;<span class="comment">/*黑色（调用了全局变量）*/</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="混入"><a href="#混入" class="headerlink" title="混入"></a>混入</h3><p>混入（mixin）应该说是预处理器最精髓的功能之一了，简单点来说，<code>Mixins</code>可以将一部分样式抽出，作为单独定义的模块，被很多选择器重复使用</p>
<p>可以在<code>Mixins</code>中定义变量或者默认参数</p>
<p>在<code>less</code>中，混合的用法是指将定义好的<code>ClassA</code>中引入另一个已经定义的<code>Class</code>，也能使用够传递参数，参数变量为<code>@</code>声明</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.alert</span> &#123;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.highlight</span>(<span class="keyword">@color</span>: red) &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.2em</span>;</span><br><span class="line">  <span class="attribute">color</span>: @color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.heads-up</span> &#123;</span><br><span class="line">  <span class="selector-class">.alert</span>;</span><br><span class="line">  <span class="selector-class">.highlight</span>(red);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译后</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.alert</span> &#123;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.heads-up</span> &#123;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.2em</span>;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Sass</code>声明<code>mixins</code>时需要使用<code>@mixinn</code>，后面紧跟<code>mixin</code>的名，也可以设置参数，参数名为变量<code>$</code>声明的形式</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> large-text &#123;</span><br><span class="line">  <span class="attribute">font</span>: &#123;</span><br><span class="line">    family: Arial;</span><br><span class="line">    size: <span class="number">20px</span>;</span><br><span class="line">    weight: bold;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ff0000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.page-title</span> &#123;</span><br><span class="line">  <span class="keyword">@include</span> large-text;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>stylus</code>中的混合和前两款<code>Css</code>预处理器语言的混合略有不同，他可以不使用任何符号，就是直接声明<code>Mixins</code>名，然后在定义参数和默认值之间用等号（=）来连接</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">error(borderWidth= <span class="number">2px</span>) &#123;</span><br><span class="line">  <span class="attribute">border</span>: borderWidth solid <span class="number">#F00</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#F00</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.generic-error</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">4px</span>;</span><br><span class="line">  error(); <span class="comment">/* 调用error mixins */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.login-error</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  error(<span class="number">5px</span>); <span class="comment">/* 调用error mixins，并将参数$borderWidth的值指定为5px */</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="代码模块化"><a href="#代码模块化" class="headerlink" title="代码模块化"></a>代码模块化</h3><p>模块化就是将<code>Css</code>代码分成一个个模块</p>
<p><code>scss</code>、<code>less</code>、<code>stylus</code>三者的使用方法都如下所示</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;./common&#x27;</span>;</span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;./github-markdown&#x27;</span>;</span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;./mixin&#x27;</span>;</span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;./variables&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://jelly.jd.com/article/5dcb9c73641a030153732a89">https://jelly.jd.com/article/5dcb9c73641a030153732a89</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/23382462">https://zhuanlan.zhihu.com/p/23382462</a></li>
<li><a href="https://baike.baidu.com/item/Less/17570158">https://baike.baidu.com/item/Less/17570158</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>sass_less_stylus</tag>
      </tags>
  </entry>
  <entry>
    <title>scope</title>
    <url>/archives/af55d3.html</url>
    <content><![CDATA[<h1 id="面试官：说说你对作用域链的理解"><a href="#面试官：说说你对作用域链的理解" class="headerlink" title="面试官：说说你对作用域链的理解"></a>面试官：说说你对作用域链的理解</h1><p> <img src="https://static.vue-js.com/16f614a0-718f-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、作用域"><a href="#一、作用域" class="headerlink" title="一、作用域"></a>一、作用域</h2><p>作用域，即变量（变量作用域又称上下文）和函数生效（能被访问）的区域或集合</p>
<p>换句话说，作用域决定了代码区块中变量和其他资源的可见性</p>
<p>举个例子</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> inVariable = <span class="string">&quot;函数内部变量&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">myFunction();<span class="comment">//要先执行这个函数，否则根本不知道里面是啥</span></span><br><span class="line"><span class="built_in">console</span>.log(inVariable); <span class="comment">// Uncaught ReferenceError: inVariable is not defined</span></span><br></pre></td></tr></table></figure>
<p>上述例子中，函数<code>myFunction</code>内部创建一个<code>inVariable</code>变量，当我们在全局访问这个变量的时候，系统会报错</p>
<p>这就说明我们在全局是无法获取到（闭包除外）函数内部的变量</p>
<p>我们一般将作用域分成：</p>
<ul>
<li>全局作用域</li>
<li><p>函数作用域</p>
</li>
<li><p>块级作用域</p>
</li>
</ul>
<h3 id="全局作用域"><a href="#全局作用域" class="headerlink" title="全局作用域"></a>全局作用域</h3><p>任何不在函数中或是大括号中声明的变量，都是在全局作用域下，全局作用域下声明的变量可以在程序的任意位置访问</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 全局变量</span></span><br><span class="line"><span class="keyword">var</span> greeting = <span class="string">&#x27;Hello World!&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(greeting);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 打印 &#x27;Hello World!&#x27;</span></span><br><span class="line">greet();</span><br></pre></td></tr></table></figure>
<h3 id="函数作用域"><a href="#函数作用域" class="headerlink" title="函数作用域"></a>函数作用域</h3><p>函数作用域也叫局部作用域，如果一个变量是在函数内部声明的它就在一个函数作用域下面。这些变量只能在函数内部访问，不能在函数以外去访问</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> greeting = <span class="string">&#x27;Hello World!&#x27;</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(greeting);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 打印 &#x27;Hello World!&#x27;</span></span><br><span class="line">greet();</span><br><span class="line"><span class="comment">// 报错： Uncaught ReferenceError: greeting is not defined</span></span><br><span class="line"><span class="built_in">console</span>.log(greeting);</span><br></pre></td></tr></table></figure>
<p>可见上述代码中在函数内部声明的变量或函数，在函数外部是无法访问的，这说明在函数内部定义的变量或者方法只是函数作用域</p>
<h3 id="块级作用域"><a href="#块级作用域" class="headerlink" title="块级作用域"></a>块级作用域</h3><p>ES6引入了<code>let</code>和<code>const</code>关键字,和<code>var</code>关键字不同，在大括号中使用<code>let</code>和<code>const</code>声明的变量存在于块级作用域中。在大括号之外不能访问这些变量</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 块级作用域中的变量</span></span><br><span class="line">  <span class="keyword">let</span> greeting = <span class="string">&#x27;Hello World!&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> lang = <span class="string">&#x27;English&#x27;</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(greeting); <span class="comment">// Prints &#x27;Hello World!&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 变量 &#x27;English&#x27;</span></span><br><span class="line"><span class="built_in">console</span>.log(lang);</span><br><span class="line"><span class="comment">// 报错：Uncaught ReferenceError: greeting is not defined</span></span><br><span class="line"><span class="built_in">console</span>.log(greeting);</span><br></pre></td></tr></table></figure>
<h2 id="二、词法作用域"><a href="#二、词法作用域" class="headerlink" title="二、词法作用域"></a>二、词法作用域</h2><p>词法作用域，又叫静态作用域，变量被创建时就确定好了，而非执行阶段确定的。也就是说我们写好代码时它的作用域就确定了，<code>JavaScript</code> 遵循的就是词法作用域</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">3</span>;</span><br><span class="line">    foo();</span><br><span class="line">&#125;</span><br><span class="line">n()</span><br></pre></td></tr></table></figure>
<p>上述代码改变成一张图</p>
<p> <img src="https://static.vue-js.com/29fab3d0-718f-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>由于<code>JavaScript</code>遵循词法作用域，相同层级的 <code>foo</code> 和 <code>bar</code> 就没有办法访问到彼此块作用域中的变量，所以输出2</p>
<h2 id="三、作用域链"><a href="#三、作用域链" class="headerlink" title="三、作用域链"></a>三、作用域链</h2><p>当在<code>Javascript</code>中使用一个变量的时候，首先<code>Javascript</code>引擎会尝试在当前作用域下去寻找该变量，如果没找到，再到它的上层作用域寻找，以此类推直到找到该变量或是已经到了全局作用域</p>
<p>如果在全局作用域里仍然找不到该变量，它就会在全局范围内隐式声明该变量(非严格模式下)或是直接报错</p>
<p>这里拿《你不知道的Javascript(上)》中的一张图解释：</p>
<p>把作用域比喻成一个建筑，这份建筑代表程序中的嵌套作用域链，第一层代表当前的执行作用域，顶层代表全局作用域</p>
<p> <img src="https://static.vue-js.com/33f9c100-718f-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>变量的引用会顺着当前楼层进行查找，如果找不到，则会往上一层找，一旦到达顶层，查找的过程都会停止</p>
<p>下面代码演示下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sex = <span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">student</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> age = <span class="number">18</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(name); <span class="comment">// 张三</span></span><br><span class="line">        <span class="built_in">console</span>.log(sex); <span class="comment">// 男 </span></span><br><span class="line">    &#125;</span><br><span class="line">    student();</span><br><span class="line">    <span class="built_in">console</span>.log(age); <span class="comment">// Uncaught ReferenceError: age is not defined</span></span><br><span class="line">&#125;</span><br><span class="line">person();</span><br></pre></td></tr></table></figure>
<p>上述代码主要主要做了以下工作：</p>
<ul>
<li><code>student</code>函数内部属于最内层作用域，找不到<code>name</code>，向上一层作用域<code>person</code>函数内部找，找到了输出“张三”</li>
<li><code>student</code>内部输出<code>sex</code>时找不到，向上一层作用域<code>person</code>函数找，还找不到继续向上一层找，即全局作用域，找到了输出“男”</li>
<li>在<code>person</code>函数内部输出<code>age</code>时找不到，向上一层作用域找，即全局作用域，还是找不到则报错</li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>scope</tag>
      </tags>
  </entry>
  <entry>
    <title>selector</title>
    <url>/archives/9692e25d.html</url>
    <content><![CDATA[<h1 id="面试官：css选择器有哪些？优先级？哪些属性可以继承？"><a href="#面试官：css选择器有哪些？优先级？哪些属性可以继承？" class="headerlink" title="面试官：css选择器有哪些？优先级？哪些属性可以继承？"></a>面试官：css选择器有哪些？优先级？哪些属性可以继承？</h1><p> <img src="https://static.vue-js.com/f7dcd330-8fe1-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、选择器"><a href="#一、选择器" class="headerlink" title="一、选择器"></a>一、选择器</h2><p>CSS选择器是CSS规则的第一部分</p>
<p>它是元素和其他部分组合起来告诉浏览器哪个HTML元素应当是被选为应用规则中的CSS属性值的方式</p>
<p>选择器所选择的元素，叫做“选择器的对象”</p>
<p>我们从一个<code>Html</code>结构开始</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;one&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;one_1&quot;</span>&gt;</span></span><br><span class="line">        &lt;/p &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;one_1&quot;</span>&gt;</span></span><br><span class="line">        &lt;/p &gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;two&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;two&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;two&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>关于<code>css</code>属性选择器常用的有：</p>
<ul>
<li><p>id选择器（#box），选择id为box的元素</p>
</li>
<li><p>类选择器（.one），选择类名为one的所有元素</p>
</li>
<li><p>标签选择器（div），选择标签为div的所有元素</p>
</li>
<li><p>后代选择器（#box div），选择id为box元素内部所有的div元素</p>
</li>
<li>子选择器（.one&gt;one_1），选择父元素为.one的所有.one_1的元素</li>
<li>相邻同胞选择器（.one+.two），选择紧接在.one之后的所有.two元素</li>
<li>群组选择器（div,p），选择div、p的所有元素</li>
</ul>
<p>还有一些使用频率相对没那么多的选择器：</p>
<ul>
<li>伪类选择器</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:link</span> ：选择未被访问的链接</span><br><span class="line"><span class="selector-pseudo">:visited</span>：选取已被访问的链接</span><br><span class="line"><span class="selector-pseudo">:active</span>：选择活动链接</span><br><span class="line"><span class="selector-pseudo">:hover</span> ：鼠标指针浮动在上面的元素</span><br><span class="line"><span class="selector-pseudo">:focus</span> ：选择具有焦点的</span><br><span class="line"><span class="selector-pseudo">:first</span>-child：父元素的首个子元素</span><br></pre></td></tr></table></figure>
<ul>
<li>伪元素选择器</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:first</span>-letter ：用于选取指定选择器的首字母</span><br><span class="line"><span class="selector-pseudo">:first</span>-line ：选取指定选择器的首行</span><br><span class="line">:before : 选择器在被选元素的内容前面插入内容</span><br><span class="line">:after : 选择器在被选元素的内容后面插入内容</span><br></pre></td></tr></table></figure>
<ul>
<li>属性选择器</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-attr">[attribute]</span> 选择带有attribute属性的元素</span><br><span class="line"><span class="selector-attr">[attribute=value]</span> 选择所有使用attribute=value的元素</span><br><span class="line"><span class="selector-attr">[attribute~=value]</span> 选择attribute属性包含value的元素</span><br><span class="line"><span class="selector-attr">[attribute|=value]</span>：选择attribute属性以value开头的元素</span><br></pre></td></tr></table></figure>
<p>在<code>CSS3</code>中新增的选择器有如下：</p>
<ul>
<li>层次选择器（p~ul），选择前面有p元素的每个ul元素</li>
<li>伪类选择器</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:first</span>-of-type 表示一组同级元素中其类型的第一个元素</span><br><span class="line"><span class="selector-pseudo">:last-of-type</span> 表示一组同级元素中其类型的最后一个元素</span><br><span class="line"><span class="selector-pseudo">:only-of-type</span> 表示没有同类型兄弟元素的元素</span><br><span class="line"><span class="selector-pseudo">:only-child</span> 表示没有任何兄弟的元素</span><br><span class="line"><span class="selector-pseudo">:nth-child</span>(n) 根据元素在一组同级中的位置匹配元素</span><br><span class="line"><span class="selector-pseudo">:nth-last-of-type</span>(n) 匹配给定类型的元素，基于它们在一组兄弟元素中的位置，从末尾开始计数</span><br><span class="line"><span class="selector-pseudo">:last-child</span> 表示一组兄弟元素中的最后一个元素</span><br><span class="line"><span class="selector-pseudo">:root</span> 设置<span class="selector-tag">HTML</span>文档</span><br><span class="line"><span class="selector-pseudo">:empty</span> 指定空的元素</span><br><span class="line"><span class="selector-pseudo">:enabled</span> 选择可用元素</span><br><span class="line"><span class="selector-pseudo">:disabled</span> 选择被禁用元素</span><br><span class="line"><span class="selector-pseudo">:checked</span> 选择选中的元素</span><br><span class="line"><span class="selector-pseudo">:not</span>(selector) 选择与 &lt;selector&gt; 不匹配的所有元素</span><br></pre></td></tr></table></figure>
<ul>
<li>属性选择器</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-attr">[attribute*=value]</span>：选择attribute属性值包含value的所有元素</span><br><span class="line"><span class="selector-attr">[attribute^=value]</span>：选择attribute属性开头为value的所有元素</span><br><span class="line"><span class="selector-attr">[attribute$=value]</span>：选择attribute属性结尾为value的所有元素</span><br></pre></td></tr></table></figure>
<h2 id="二、优先级"><a href="#二、优先级" class="headerlink" title="二、优先级"></a>二、优先级</h2><p>相信大家对<code>CSS</code>选择器的优先级都不陌生：</p>
<blockquote>
<p>内联 &gt; ID选择器 &gt; 类选择器 &gt; 标签选择器</p>
</blockquote>
<p>到具体的计算层⾯，优先级是由 A 、B、C、D 的值来决定的，其中它们的值计算规则如下：</p>
<ul>
<li><p>如果存在内联样式，那么 A = 1, 否则 A = 0</p>
</li>
<li><p>B的值等于 ID选择器出现的次数</p>
</li>
<li><p>C的值等于 类选择器 和 属性选择器 和 伪类 出现的总次数</p>
</li>
<li><p>D 的值等于 标签选择器 和 伪元素 出现的总次数</p>
</li>
</ul>
<p>这里举个例子：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#nav-global</span> &gt; <span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span> &gt; <span class="selector-tag">a</span><span class="selector-class">.nav-link</span></span><br></pre></td></tr></table></figure>
<p>套用上面的算法，依次求出 <code>A</code> <code>B</code> <code>C</code> <code>D</code> 的值：</p>
<ul>
<li><p>因为没有内联样式 ，所以 A = 0</p>
</li>
<li><p>ID选择器总共出现了1次， B = 1</p>
</li>
<li><p>类选择器出现了1次， 属性选择器出现了0次，伪类选择器出现0次，所以 C = (1 + 0 + 0) = 1</p>
</li>
<li>标签选择器出现了3次， 伪元素出现了0次，所以 D = (3 + 0) = 3</li>
</ul>
<p>上面算出的<code>A</code> 、 <code>B</code>、<code>C</code>、<code>D</code> 可以简记作：<code>(0, 1, 1, 3)</code></p>
<p>知道了优先级是如何计算之后，就来看看比较规则：</p>
<ul>
<li>从左往右依次进行比较 ，较大者优先级更高</li>
<li>如果相等，则继续往右移动一位进行比较</li>
<li>如果4位全部相等，则后面的会覆盖前面的</li>
</ul>
<p>经过上面的优先级计算规则，我们知道内联样式的优先级最高，如果外部样式需要覆盖内联样式，就需要使用<code>!important</code></p>
<h2 id="三、继承属性"><a href="#三、继承属性" class="headerlink" title="三、继承属性"></a>三、继承属性</h2><p>在<code>css</code>中，继承是指的是给父元素设置一些属性，后代元素会自动拥有这些属性</p>
<p>关于继承属性，可以分成：</p>
<ul>
<li>字体系列属性</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">font</span>:组合字体</span><br><span class="line">font-family:规定元素的字体系列</span><br><span class="line">font-weight:设置字体的粗细</span><br><span class="line">font-size:设置字体的尺寸</span><br><span class="line">font-style:定义字体的风格</span><br><span class="line">font-variant:偏大或偏小的字体</span><br></pre></td></tr></table></figure>
<ul>
<li>文本系列属性</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">text-indent</span>：文本缩进</span><br><span class="line"><span class="attribute">text-align</span>：文本水平对刘</span><br><span class="line"><span class="attribute">line-height</span>：行高</span><br><span class="line"><span class="attribute">word-spacing</span>：增加或减少单词间的空白</span><br><span class="line"><span class="attribute">letter-spacing</span>：增加或减少字符间的空白</span><br><span class="line"><span class="attribute">text-transform</span>：控制文本大小写</span><br><span class="line"><span class="attribute">direction</span>：规定文本的书写方向</span><br><span class="line"><span class="attribute">color</span>：文本颜色</span><br></pre></td></tr></table></figure>
<ul>
<li>元素可见性</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">visibility</span></span><br></pre></td></tr></table></figure>
<ul>
<li>表格布局属性</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">caption-side</span>：定位表格标题位置</span><br><span class="line"><span class="attribute">border-collapse</span>：合并表格边框</span><br><span class="line"><span class="attribute">border-spacing</span>：设置相邻单元格的边框间的距离</span><br><span class="line"><span class="attribute">empty-cells</span>：单元格的边框的出现与消失</span><br><span class="line"><span class="attribute">table-layout</span>：表格的宽度由什么决定</span><br></pre></td></tr></table></figure>
<ul>
<li>列表属性</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">list-style-type</span>：文字前面的小点点样式</span><br><span class="line"><span class="attribute">list-style-position</span>：小点点位置</span><br><span class="line"><span class="attribute">list-style</span>：以上的属性可通过这属性集合</span><br></pre></td></tr></table></figure>
<ul>
<li>引用</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">quotes</span>：设置嵌套引用的引号类型</span><br></pre></td></tr></table></figure>
<ul>
<li>光标属性</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cursor</span>：箭头可以变成需要的形状</span><br></pre></td></tr></table></figure>
<p>继承中比较特殊的几点：</p>
<ul>
<li><p>a 标签的字体颜色不能被继承</p>
</li>
<li><p>h1-h6标签字体的大下也是不能被继承的</p>
</li>
</ul>
<h3 id="无继承的属性"><a href="#无继承的属性" class="headerlink" title="无继承的属性"></a>无继承的属性</h3><ul>
<li><p>display</p>
</li>
<li><p>文本属性：vertical-align、text-decoration</p>
</li>
<li><p>盒子模型的属性：宽度、高度、内外边距、边框等</p>
</li>
<li><p>背景属性：背景图片、颜色、位置等</p>
</li>
<li><p>定位属性：浮动、清除浮动、定位position等</p>
</li>
<li><p>生成内容属性：content、counter-reset、counter-increment</p>
</li>
<li><p>轮廓样式属性：outline-style、outline-width、outline-color、outline</p>
</li>
<li><p>页面样式属性：size、page-break-before、page-break-after</p>
</li>
</ul>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://www.html.cn/qa/css3/13444.html">https://www.html.cn/qa/css3/13444.html</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Learn/CSS/Building_blocks/Selectors">https://developer.mozilla.org/zh-CN/docs/Learn/CSS/Building_blocks/Selectors</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>selector</tag>
      </tags>
  </entry>
  <entry>
    <title>single_sign</title>
    <url>/archives/7f6cf7b0.html</url>
    <content><![CDATA[<h1 id="面试官：什么是单点登录？如何实现？"><a href="#面试官：什么是单点登录？如何实现？" class="headerlink" title="面试官：什么是单点登录？如何实现？"></a>面试官：什么是单点登录？如何实现？</h1><p> <img src="https://static.vue-js.com/8a25a760-8c83-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>单点登录（Single Sign On），简称为 SSO，是目前比较流行的企业业务整合的解决方案之一</p>
<p>SSO的定义是在多个应用系统中，用户只需要登录一次就可以访问所有相互信任的应用系统</p>
<p>SSO 一般都需要一个独立的认证中心（passport），子系统的登录均得通过<code>passport</code>，子系统本身将不参与登录操作</p>
<p>当一个系统成功登录以后，<code>passport</code>将会颁发一个令牌给各个子系统，子系统可以拿着令牌会获取各自的受保护资源，为了减少频繁认证，各个子系统在被<code>passport</code>授权以后，会建立一个局部会话，在一定时间内可以无需再次向<code>passport</code>发起认证</p>
<p> <img src="https://static.vue-js.com/2b9b0e70-8c4b-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>上图有四个系统，分别是<code>Application1</code>、<code>Application2</code>、<code>Application3</code>、和<code>SSO</code>，当<code>Application1</code>、<code>Application2</code>、<code>Application3</code>需要登录时，将跳到<code>SSO</code>系统，<code>SSO</code>系统完成登录，其他的应用系统也就随之登录了</p>
<h4 id="举个例子"><a href="#举个例子" class="headerlink" title="举个例子"></a>举个例子</h4><p>淘宝、天猫都属于阿里旗下，当用户登录淘宝后，再打开天猫，系统便自动帮用户登录了天猫，这种现象就属于单点登录</p>
<h2 id="二、如何实现"><a href="#二、如何实现" class="headerlink" title="二、如何实现"></a>二、如何实现</h2><h3 id="同域名下的单点登录"><a href="#同域名下的单点登录" class="headerlink" title="同域名下的单点登录"></a>同域名下的单点登录</h3><p><code>cookie</code>的<code>domain</code>属性设置为当前域的父域，并且父域的<code>cookie</code>会被子域所共享。<code>path</code>属性默认为<code>web</code>应用的上下文路径</p>
<p>利用 <code>Cookie</code> 的这个特点，没错，我们只需要将<code>Cookie</code>的<code>domain</code>属性设置为父域的域名（主域名），同时将 <code>Cookie</code>的<code>path</code>属性设置为根路径，将 <code>Session ID</code>（或 <code>Token</code>）保存到父域中。这样所有的子域应用就都可以访问到这个<code>Cookie</code></p>
<p>不过这要求应用系统的域名需建立在一个共同的主域名之下，如 <code>tieba.baidu.com</code> 和 <code>map.baidu.com</code>，它们都建立在 <code>baidu.com</code>这个主域名之下，那么它们就可以通过这种方式来实现单点登录</p>
<h3 id="不同域名下的单点登录-一"><a href="#不同域名下的单点登录-一" class="headerlink" title="不同域名下的单点登录(一)"></a>不同域名下的单点登录(一)</h3><p>如果是不同域的情况下，<code>Cookie</code>是不共享的，这里我们可以部署一个认证中心，用于专门处理登录请求的独立的 <code>Web</code>服务</p>
<p>用户统一在认证中心进行登录，登录成功后，认证中心记录用户的登录状态，并将 <code>token</code> 写入 <code>Cookie</code>（注意这个 <code>Cookie</code>是认证中心的，应用系统是访问不到的）</p>
<p>应用系统检查当前请求有没有 <code>Token</code>，如果没有，说明用户在当前系统中尚未登录，那么就将页面跳转至认证中心</p>
<p>由于这个操作会将认证中心的 <code>Cookie</code> 自动带过去，因此，认证中心能够根据 <code>Cookie</code> 知道用户是否已经登录过了</p>
<p>如果认证中心发现用户尚未登录，则返回登录页面，等待用户登录</p>
<p>如果发现用户已经登录过了，就不会让用户再次登录了，而是会跳转回目标 <code>URL</code>，并在跳转前生成一个 <code>Token</code>，拼接在目标<code>URL</code> 的后面，回传给目标应用系统</p>
<p>应用系统拿到 <code>Token</code>之后，还需要向认证中心确认下 <code>Token</code> 的合法性，防止用户伪造。确认无误后，应用系统记录用户的登录状态，并将 <code>Token</code>写入<code>Cookie</code>，然后给本次访问放行。（注意这个 <code>Cookie</code> 是当前应用系统的）当用户再次访问当前应用系统时，就会自动带上这个 <code>Token</code>，应用系统验证 Token 发现用户已登录，于是就不会有认证中心什么事了</p>
<p>此种实现方式相对复杂，支持跨域，扩展性好，是单点登录的标准做法</p>
<h3 id="不同域名下的单点登录-二"><a href="#不同域名下的单点登录-二" class="headerlink" title="不同域名下的单点登录(二)"></a>不同域名下的单点登录(二)</h3><p>可以选择将 <code>Session ID</code> （或 <code>Token</code> ）保存到浏览器的 <code>LocalStorage</code> 中，让前端在每次向后端发送请求时，主动将<code>LocalStorage</code>的数据传递给服务端</p>
<p>这些都是由前端来控制的，后端需要做的仅仅是在用户登录成功后，将 <code>Session ID</code>（或 <code>Token</code>）放在响应体中传递给前端</p>
<p>单点登录完全可以在前端实现。前端拿到 <code>Session ID</code>（或 <code>Token</code> ）后，除了将它写入自己的 <code>LocalStorage</code> 中之外，还可以通过特殊手段将它写入多个其他域下的 <code>LocalStorage</code> 中</p>
<p>关键代码如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取 token</span></span><br><span class="line"><span class="keyword">var</span> token = result.data.token;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 动态创建一个不可见的iframe，在iframe中加载一个跨域HTML</span></span><br><span class="line"><span class="keyword">var</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">&quot;iframe&quot;</span>);</span><br><span class="line">iframe.src = <span class="string">&quot;http://app1.com/localstorage.html&quot;</span>;</span><br><span class="line"><span class="built_in">document</span>.body.append(iframe);</span><br><span class="line"><span class="comment">// 使用postMessage()方法将token传递给iframe</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    iframe.contentWindow.postMessage(token, <span class="string">&quot;http://app1.com&quot;</span>);</span><br><span class="line">&#125;, <span class="number">4000</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    iframe.remove();</span><br><span class="line">&#125;, <span class="number">6000</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 在这个iframe所加载的HTML中绑定一个事件监听器，当事件被触发时，把接收到的token数据写入localStorage</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;message&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">localStorage</span>.setItem(<span class="string">&#x27;token&#x27;</span>, event.data)</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>前端通过 <code>iframe</code>+<code>postMessage()</code> 方式，将同一份 <code>Token</code> 写入到了多个域下的 <code>LocalStorage</code> 中，前端每次在向后端发送请求之前，都会主动从 <code>LocalStorage</code> 中读取<code>Token</code>并在请求中携带，这样就实现了同一份<code>Token</code> 被多个域所共享</p>
<p>此种实现方式完全由前端控制，几乎不需要后端参与，同样支持跨域</p>
<h2 id="三、流程"><a href="#三、流程" class="headerlink" title="三、流程"></a>三、流程</h2><p>单点登录的流程图如下所示：</p>
<p> <img src="https://static.vue-js.com/2422bc40-8c84-11eb-ab90-d9ae814b240d.png" alt=""></p>
<ul>
<li><p>用户访问系统1的受保护资源，系统1发现用户未登录，跳转至sso认证中心，并将自己的地址作为参数</p>
</li>
<li><p>sso认证中心发现用户未登录，将用户引导至登录页面</p>
</li>
<li>用户输入用户名密码提交登录申请</li>
<li>sso认证中心校验用户信息，创建用户与sso认证中心之间的会话，称为全局会话，同时创建授权令牌</li>
<li>sso认证中心带着令牌跳转会最初的请求地址（系统1）</li>
<li>系统1拿到令牌，去sso认证中心校验令牌是否有效</li>
<li>sso认证中心校验令牌，返回有效，注册系统1</li>
<li>系统1使用该令牌创建与用户的会话，称为局部会话，返回受保护资源</li>
<li>用户访问系统2的受保护资源</li>
<li>系统2发现用户未登录，跳转至sso认证中心，并将自己的地址作为参数</li>
<li>sso认证中心发现用户已登录，跳转回系统2的地址，并附上令牌</li>
<li>系统2拿到令牌，去sso认证中心校验令牌是否有效</li>
<li>sso认证中心校验令牌，返回有效，注册系统2</li>
<li>系统2使用该令牌创建与用户的局部会话，返回受保护资源</li>
</ul>
<p>用户登录成功之后，会与<code>sso</code>认证中心及各个子系统建立会话，用户与<code>sso</code>认证中心建立的会话称为全局会话</p>
<p>用户与各个子系统建立的会话称为局部会话，局部会话建立之后，用户访问子系统受保护资源将不再通过<code>sso</code>认证中心</p>
<p>全局会话与局部会话有如下约束关系：</p>
<ul>
<li>局部会话存在，全局会话一定存在</li>
<li>全局会话存在，局部会话不一定存在</li>
<li>全局会话销毁，局部会话必须销毁</li>
</ul>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://blog.csdn.net/weixin_36380516/article/details/109006828">https://blog.csdn.net/weixin_36380516/article/details/109006828</a></li>
<li><a href="https://baike.baidu.com/item/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95">https://baike.baidu.com/item/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95</a></li>
<li><a href="https://juejin.cn/post/6844903664985866253">https://juejin.cn/post/6844903664985866253</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>single_sign</tag>
      </tags>
  </entry>
  <entry>
    <title>security</title>
    <url>/archives/c59bd5c1.html</url>
    <content><![CDATA[<h1 id="面试官：web常见的攻击方式有哪些？如何防御？"><a href="#面试官：web常见的攻击方式有哪些？如何防御？" class="headerlink" title="面试官：web常见的攻击方式有哪些？如何防御？"></a>面试官：web常见的攻击方式有哪些？如何防御？</h1><p> <img src="https://static.vue-js.com/d0892930-8d1d-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>Web攻击（WebAttack）是针对用户上网行为或网站服务器等设备进行攻击的行为</p>
<p>如植入恶意代码，修改网站权限，获取网站用户隐私信息等等</p>
<p>Web应用程序的安全性是任何基于Web业务的重要组成部分</p>
<p>确保Web应用程序安全十分重要，即使是代码中很小的 bug 也有可能导致隐私信息被泄露</p>
<p>站点安全就是为保护站点不受未授权的访问、使用、修改和破坏而采取的行为或实践</p>
<p>我们常见的Web攻击方式有</p>
<ul>
<li>XSS (Cross Site Scripting) 跨站脚本攻击</li>
<li>CSRF（Cross-site request forgery）跨站请求伪造</li>
<li>SQL注入攻击</li>
</ul>
<h2 id="二、XSS"><a href="#二、XSS" class="headerlink" title="二、XSS"></a>二、XSS</h2><p>XSS，跨站脚本攻击，允许攻击者将恶意代码植入到提供给其它用户使用的页面中</p>
<p><code>XSS</code>涉及到三方，即攻击者、客户端与<code>Web</code>应用</p>
<p><code>XSS</code>的攻击目标是为了盗取存储在客户端的<code>cookie</code>或者其他网站用于识别客户端身份的敏感信息。一旦获取到合法用户的信息后，攻击者甚至可以假冒合法用户与网站进行交互</p>
<p>举个例子：</p>
<p>一个搜索页面，根据<code>url</code>参数决定关键词的内容</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;%= getParameter(&quot;</span><span class="attr">keyword</span>&quot;) %&gt;</span>&quot;&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>搜索<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  您搜索的关键词是：&lt;%= getParameter(&quot;keyword&quot;) %&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里看似并没有问题，但是如果不按套路出牌呢？</p>
<p>用户输入<code>&quot;&gt;&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt;</code>，拼接到 HTML 中返回给浏览器。形成了如下的 HTML：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;XSS&#x27;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>&quot;&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>搜索<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  您搜索的关键词是：&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;XSS&#x27;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>浏览器无法分辨出 <code>&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt;</code> 是恶意代码，因而将其执行，试想一下，如果是获取<code>cookie</code>发送对黑客服务器呢？</p>
<p>根据攻击的来源，<code>XSS</code>攻击可以分成：</p>
<ul>
<li>存储型</li>
<li>反射型</li>
<li>DOM 型</li>
</ul>
<h3 id="存储型"><a href="#存储型" class="headerlink" title="存储型"></a>存储型</h3><p>存储型 XSS 的攻击步骤：</p>
<ol>
<li>攻击者将恶意代码提交到目标网站的数据库中</li>
<li>用户打开目标网站时，网站服务端将恶意代码从数据库取出，拼接在 HTML 中返回给浏览器</li>
<li>用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行</li>
<li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作</li>
</ol>
<p>这种攻击常见于带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等</p>
<h3 id="反射型-XSS"><a href="#反射型-XSS" class="headerlink" title="反射型 XSS"></a>反射型 XSS</h3><p>反射型 XSS 的攻击步骤：</p>
<ol>
<li>攻击者构造出特殊的 URL，其中包含恶意代码</li>
<li>用户打开带有恶意代码的 URL 时，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器</li>
<li>用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行</li>
<li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作</li>
</ol>
<p>反射型 XSS 跟存储型 XSS 的区别是：存储型 XSS 的恶意代码存在数据库里，反射型 XSS 的恶意代码存在 URL 里。</p>
<p>反射型 XSS 漏洞常见于通过 URL 传递参数的功能，如网站搜索、跳转等。</p>
<p>由于需要用户主动打开恶意的 URL 才能生效，攻击者往往会结合多种手段诱导用户点击。</p>
<p>POST 的内容也可以触发反射型 XSS，只不过其触发条件比较苛刻（需要构造表单提交页面，并引导用户点击），所以非常少见</p>
<h3 id="DOM-型-XSS"><a href="#DOM-型-XSS" class="headerlink" title="DOM 型 XSS"></a>DOM 型 XSS</h3><p>DOM 型 XSS 的攻击步骤：</p>
<ol>
<li>攻击者构造出特殊的 URL，其中包含恶意代码</li>
<li>用户打开带有恶意代码的 URL</li>
<li>用户浏览器接收到响应后解析执行，前端 JavaScript 取出 URL 中的恶意代码并执行</li>
<li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作</li>
</ol>
<p>DOM 型 XSS 跟前两种 XSS 的区别：DOM 型 XSS 攻击中，取出和执行恶意代码由浏览器端完成，属于前端 JavaScript 自身的安全漏洞，而其他两种 XSS 都属于服务端的安全漏洞</p>
<h3 id="XSS的预防"><a href="#XSS的预防" class="headerlink" title="XSS的预防"></a>XSS的预防</h3><p>通过前面介绍，看到<code>XSS</code>攻击的两大要素：</p>
<ul>
<li>攻击者提交而恶意代码</li>
<li>浏览器执行恶意代码</li>
</ul>
<p>针对第一个要素，我们在用户输入的过程中，过滤掉用户输入的恶劣代码，然后提交给后端，但是如果攻击者绕开前端请求，直接构造请求就不能预防了</p>
<p>而如果在后端写入数据库前，对输入进行过滤，然后把内容给前端，但是这个内容在不同地方就会有不同显示</p>
<p>例如：</p>
<p>一个正常的用户输入了 <code>5 &lt; 7</code> 这个内容，在写入数据库前，被转义，变成了 <code>5 &lt; 7</code></p>
<p>在客户端中，一旦经过了 <code>escapeHTML()</code>，客户端显示的内容就变成了乱码( <code>5 &lt; 7</code> )</p>
<p>在前端中，不同的位置所需的编码也不同。</p>
<ul>
<li>当 <code>5 &lt; 7</code> 作为 HTML 拼接页面时，可以正常显示：</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">title</span>=<span class="string">&quot;comment&quot;</span>&gt;</span>5 <span class="symbol">&amp;lt;</span> 7<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>当 <code>5 &lt; 7</code> 通过 Ajax 返回，然后赋值给 JavaScript 的变量时，前端得到的字符串就是转义后的字符。这个内容不能直接用于 Vue 等模板的展示，也不能直接用于内容长度计算。不能用于标题、alert 等</li>
</ul>
<p>可以看到，过滤并非可靠的，下面就要通过防止浏览器执行恶意代码：</p>
<p>在使用 <code>.innerHTML</code>、<code>.outerHTML</code>、<code>document.write()</code> 时要特别小心，不要把不可信的数据作为 HTML 插到页面上，而应尽量使用 <code>.textContent</code>、<code>.setAttribute()</code> 等</p>
<p>如果用 <code>Vue/React</code> 技术栈，并且不使用 <code>v-html</code>/<code>dangerouslySetInnerHTML</code> 功能，就在前端 <code>render</code> 阶段避免 <code>innerHTML</code>、<code>outerHTML</code> 的 XSS 隐患</p>
<p>DOM 中的内联事件监听器，如 <code>location</code>、<code>onclick</code>、<code>onerror</code>、<code>onload</code>、<code>onmouseover</code> 等，<code>&lt;a&gt;</code> 标签的 <code>href</code> 属性，JavaScript 的 <code>eval()</code>、<code>setTimeout()</code>、<code>setInterval()</code> 等，都能把字符串作为代码运行。如果不可信的数据拼接到字符串中传递给这些 API，很容易产生安全隐患，请务必避免</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;!-- 链接内包含恶意代码 --&gt;</span><br><span class="line">&lt; a href=<span class="string">&quot; &quot;</span>&gt;<span class="number">1</span>&lt;/ a&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="comment">// setTimeout()/setInterval() 中调用恶意代码</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="string">&quot;UNTRUSTED&quot;</span>)</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="string">&quot;UNTRUSTED&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// location 调用恶意代码</span></span><br><span class="line">location.href = <span class="string">&#x27;UNTRUSTED&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// eval() 中调用恶意代码</span></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&quot;UNTRUSTED&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="三、CSRF"><a href="#三、CSRF" class="headerlink" title="三、CSRF"></a>三、CSRF</h2><p>CSRF（Cross-site request forgery）跨站请求伪造：攻击者诱导受害者进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求</p>
<p>利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目</p>
<p>一个典型的CSRF攻击有着如下的流程：</p>
<ul>
<li>受害者登录a.com，并保留了登录凭证（Cookie）</li>
<li>攻击者引诱受害者访问了b.com</li>
<li>b.com 向 a.com 发送了一个请求：a.com/act=xx。浏览器会默认携带a.com的Cookie</li>
<li>a.com接收到请求后，对请求进行验证，并确认是受害者的凭证，误以为是受害者自己发送的请求</li>
<li>a.com以受害者的名义执行了act=xx</li>
<li>攻击完成，攻击者在受害者不知情的情况下，冒充受害者，让a.com执行了自己定义的操作</li>
</ul>
<p><code>csrf</code>可以通过<code>get</code>请求，即通过访问<code>img</code>的页面后，浏览器自动访问目标地址，发送请求</p>
<p>同样，也可以设置一个自动提交的表单发送<code>post</code>请求，如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;http://bank.example/withdraw&quot;</span> method=POST&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;account&quot;</span> <span class="attr">value</span>=<span class="string">&quot;xiaoming&quot;</span> /&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;amount&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10000&quot;</span> /&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;for&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hacker&quot;</span> /&gt;</span></span></span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"> <span class="built_in">document</span>.forms[<span class="number">0</span>].submit(); </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span> </span><br></pre></td></tr></table></figure>
<p>访问该页面后，表单会自动提交，相当于模拟用户完成了一次<code>POST</code>操作</p>
<p>还有一种为使用<code>a</code>标签的，需要用户点击链接才会触发</p>
<p>访问该页面后，表单会自动提交，相当于模拟用户完成了一次POST操作</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt; a href=&quot;http://test.com/csrf/withdraw.php?amount=1000&amp;for=hacker&quot; taget=&quot;_blank&quot;&gt;</span><br><span class="line">    重磅消息！！</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="CSRF的特点"><a href="#CSRF的特点" class="headerlink" title="CSRF的特点"></a>CSRF的特点</h3><ul>
<li>攻击一般发起在第三方网站，而不是被攻击的网站。被攻击的网站无法防止攻击发生</li>
<li>攻击利用受害者在被攻击网站的登录凭证，冒充受害者提交操作；而不是直接窃取数据</li>
<li>整个过程攻击者并不能获取到受害者的登录凭证，仅仅是“冒用”</li>
<li>跨站请求可以用各种方式：图片URL、超链接、CORS、Form提交等等。部分请求方式可以直接嵌入在第三方论坛、文章中，难以进行追踪</li>
</ul>
<h3 id="CSRF的预防"><a href="#CSRF的预防" class="headerlink" title="CSRF的预防"></a>CSRF的预防</h3><p>CSRF通常从第三方网站发起，被攻击的网站无法防止攻击发生，只能通过增强自己网站针对CSRF的防护能力来提升安全性</p>
<p>防止<code>csrf</code>常用方案如下：</p>
<ul>
<li>阻止不明外域的访问<ul>
<li>同源检测</li>
<li>Samesite Cookie</li>
</ul>
</li>
<li>提交时要求附加本域才能获取的信息<ul>
<li>CSRF Token</li>
<li>双重Cookie验证</li>
</ul>
</li>
</ul>
<p>这里主要讲讲<code>token</code>这种形式，流程如下：</p>
<ul>
<li>用户打开页面的时候，服务器需要给这个用户生成一个Token</li>
<li>对于GET请求，Token将附在请求地址之后。对于 POST 请求来说，要在 form 的最后加上</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">”hidden”</span> <span class="attr">name</span>=<span class="string">”csrftoken”</span> <span class="attr">value</span>=<span class="string">”tokenvalue”/</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>当用户从客户端得到了Token，再次提交给服务器的时候，服务器需要判断Token的有效性</li>
</ul>
<h2 id="四、SQL注入"><a href="#四、SQL注入" class="headerlink" title="四、SQL注入"></a>四、SQL注入</h2><p>Sql 注入攻击，是通过将恶意的 <code>Sql</code>查询或添加语句插入到应用的输入参数中，再在后台 <code>Sql</code>服务器上解析执行进行的攻击</p>
<p> <img src="https://static.vue-js.com/ead52fa0-8d1d-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>流程如下所示：</p>
<ul>
<li><p>找出SQL漏洞的注入点</p>
</li>
<li><p>判断数据库的类型以及版本</p>
</li>
<li>猜解用户名和密码</li>
<li>利用工具查找Web后台管理入口</li>
<li>入侵和破坏</li>
</ul>
<p>预防方式如下：</p>
<ul>
<li>严格检查输入变量的类型和格式</li>
<li>过滤和转义特殊字符</li>
<li>对访问数据库的Web应用程序采用Web应用防火墙</li>
</ul>
<p>上述只是列举了常见的<code>web</code>攻击方式，实际开发过程中还会遇到很多安全问题，对于这些问题， 切记不可忽视</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://tech.meituan.com/2018/09/27/fe-security.html">https://tech.meituan.com/2018/09/27/fe-security.html</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/learn/Server-side/First_steps/Website_security">https://developer.mozilla.org/zh-CN/docs/learn/Server-side/First_steps/Website_security</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>security</tag>
      </tags>
  </entry>
  <entry>
    <title>string_api</title>
    <url>/archives/7b268071.html</url>
    <content><![CDATA[<h1 id="面试官：JavaScript字符串的常用方法有哪些？"><a href="#面试官：JavaScript字符串的常用方法有哪些？" class="headerlink" title="面试官：JavaScript字符串的常用方法有哪些？"></a>面试官：JavaScript字符串的常用方法有哪些？</h1><p> <img src="https://static.vue-js.com/ceb6ebc0-65c1-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、操作方法"><a href="#一、操作方法" class="headerlink" title="一、操作方法"></a>一、操作方法</h2><p>我们也可将字符串常用的操作方法归纳为增、删、改、查，需要知道字符串的特点是一旦创建了，就不可变</p>
<h3 id="增"><a href="#增" class="headerlink" title="增"></a>增</h3><p>这里增的意思并不是说直接增添内容，而是创建字符串的一个副本，再进行操作</p>
<p>除了常用<code>+</code>以及<code>$&#123;&#125;</code>进行字符串拼接之外，还可通过<code>concat</code></p>
<h4 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h4><p>用于将一个或多个字符串拼接成一个新字符串</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;hello &quot;</span>;</span><br><span class="line"><span class="keyword">let</span> result = stringValue.concat(<span class="string">&quot;world&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(result); <span class="comment">// &quot;hello world&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue); <span class="comment">// &quot;hello&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="删"><a href="#删" class="headerlink" title="删"></a>删</h3><p>这里的删的意思并不是说删除原字符串的内容，而是创建字符串的一个副本，再进行操作</p>
<p>常见的有：</p>
<ul>
<li>slice()</li>
<li>substr()</li>
<li>substring()</li>
</ul>
<p>这三个方法都返回调用它们的字符串的一个子字符串，而且都接收一或两个参数。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(stringValue.slice(<span class="number">3</span>)); <span class="comment">// &quot;lo world&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substring(<span class="number">3</span>)); <span class="comment">// &quot;lo world&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substr(<span class="number">3</span>)); <span class="comment">// &quot;lo world&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.slice(<span class="number">3</span>, <span class="number">7</span>)); <span class="comment">// &quot;lo w&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substring(<span class="number">3</span>,<span class="number">7</span>)); <span class="comment">// &quot;lo w&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.substr(<span class="number">3</span>, <span class="number">7</span>)); <span class="comment">// &quot;lo worl&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="改"><a href="#改" class="headerlink" title="改"></a>改</h3><p>这里改的意思也不是改变原字符串，而是创建字符串的一个副本，再进行操作</p>
<p>常见的有：</p>
<ul>
<li><p>trim()、trimLeft()、trimRight()</p>
</li>
<li><p>repeat()</p>
</li>
<li>padStart()、padEnd()</li>
<li>toLowerCase()、 toUpperCase()</li>
</ul>
<h4 id="trim-、trimLeft-、trimRight"><a href="#trim-、trimLeft-、trimRight" class="headerlink" title="trim()、trimLeft()、trimRight()"></a>trim()、trimLeft()、trimRight()</h4><p>删除前、后或前后所有空格符，再返回新的字符串</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot; hello world &quot;</span>;</span><br><span class="line"><span class="keyword">let</span> trimmedStringValue = stringValue.trim();</span><br><span class="line"><span class="built_in">console</span>.log(stringValue); <span class="comment">// &quot; hello world &quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(trimmedStringValue); <span class="comment">// &quot;hello world&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="repeat"><a href="#repeat" class="headerlink" title="repeat()"></a>repeat()</h4><p>接收一个整数参数，表示要将字符串复制多少次，然后返回拼接所有副本后的结果</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;na &quot;</span>;</span><br><span class="line"><span class="keyword">let</span> copyResult = stringValue.repeat(<span class="number">2</span>) <span class="comment">// na na </span></span><br></pre></td></tr></table></figure>
<h4 id="padEnd"><a href="#padEnd" class="headerlink" title="padEnd()"></a>padEnd()</h4><p>复制字符串，如果小于指定长度，则在相应一边填充字符，直至满足长度条件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;foo&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(stringValue.padStart(<span class="number">6</span>)); <span class="comment">// &quot; foo&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.padStart(<span class="number">9</span>, <span class="string">&quot;.&quot;</span>)); <span class="comment">// &quot;......foo&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="toLowerCase-、-toUpperCase"><a href="#toLowerCase-、-toUpperCase" class="headerlink" title="toLowerCase()、 toUpperCase()"></a>toLowerCase()、 toUpperCase()</h3><p>大小写转化</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(stringValue.toUpperCase()); <span class="comment">// &quot;HELLO WORLD&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(stringValue.toLowerCase()); <span class="comment">// &quot;hello world&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="查"><a href="#查" class="headerlink" title="查"></a>查</h3><p>除了通过索引的方式获取字符串的值，还可通过：</p>
<ul>
<li><p>chatAt()</p>
</li>
<li><p>indexOf()</p>
</li>
<li><p>startWith()</p>
</li>
<li><p>includes()</p>
</li>
</ul>
<h4 id="charAt"><a href="#charAt" class="headerlink" title="charAt()"></a>charAt()</h4><p>返回给定索引位置的字符，由传给方法的整数参数指定</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> message = <span class="string">&quot;abcde&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(message.charAt(<span class="number">2</span>)); <span class="comment">// &quot;c&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf()"></a>indexOf()</h4><p>从字符串开头去搜索传入的字符串，并返回位置（如果没找到，则返回 -1 ）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(stringValue.indexOf(<span class="string">&quot;o&quot;</span>)); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>
<h4 id="startWith-、includes"><a href="#startWith-、includes" class="headerlink" title="startWith()、includes()"></a>startWith()、includes()</h4><p>从字符串中搜索传入的字符串，并返回一个表示是否包含的布尔值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> message = <span class="string">&quot;foobarbaz&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(message.startsWith(<span class="string">&quot;foo&quot;</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(message.startsWith(<span class="string">&quot;bar&quot;</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(message.includes(<span class="string">&quot;bar&quot;</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(message.includes(<span class="string">&quot;qux&quot;</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h2 id="二、转换方法"><a href="#二、转换方法" class="headerlink" title="二、转换方法"></a>二、转换方法</h2><h3 id="split"><a href="#split" class="headerlink" title="split"></a>split</h3><p>把字符串按照指定的分割符，拆分成数组中的每一项</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;12+23+34&quot;</span></span><br><span class="line"><span class="keyword">let</span> arr = str.split(<span class="string">&quot;+&quot;</span>) <span class="comment">// [12,23,34]</span></span><br></pre></td></tr></table></figure>
<h2 id="三、模板匹配方法"><a href="#三、模板匹配方法" class="headerlink" title="三、模板匹配方法"></a>三、模板匹配方法</h2><p>针对正则表达式，字符串设计了几个方法：</p>
<ul>
<li>match()</li>
<li>search()</li>
<li>replace()</li>
</ul>
<h3 id="match"><a href="#match" class="headerlink" title="match()"></a>match()</h3><p>接收一个参数，可以是一个正则表达式字符串，也可以是一个<code>RegExp</code>对象，返回数组</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> text = <span class="string">&quot;cat, bat, sat, fat&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> pattern = <span class="regexp">/.at/</span>;</span><br><span class="line"><span class="keyword">let</span> matches = text.match(pattern);</span><br><span class="line"><span class="built_in">console</span>.log(matches[<span class="number">0</span>]); <span class="comment">// &quot;cat&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="search"><a href="#search" class="headerlink" title="search()"></a>search()</h3><p>接收一个参数，可以是一个正则表达式字符串，也可以是一个<code>RegExp</code>对象，找到则返回匹配索引，否则返回 -1</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> text = <span class="string">&quot;cat, bat, sat, fat&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> pos = text.search(<span class="regexp">/at/</span>);</span><br><span class="line"><span class="built_in">console</span>.log(pos); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<h3 id="replace"><a href="#replace" class="headerlink" title="replace()"></a>replace()</h3><p>接收两个参数，第一个参数为匹配的内容，第二个参数为替换的元素（可用函数）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> text = <span class="string">&quot;cat, bat, sat, fat&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> result = text.replace(<span class="string">&quot;at&quot;</span>, <span class="string">&quot;ond&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(result); <span class="comment">// &quot;cond, bat, sat, fat&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js面试</tag>
        <tag>string_api</tag>
      </tags>
  </entry>
  <entry>
    <title>set_map</title>
    <url>/archives/eb05a173.html</url>
    <content><![CDATA[<h1 id="面试官：你是怎么理解ES6新增Set、Map两种数据结构的？"><a href="#面试官：你是怎么理解ES6新增Set、Map两种数据结构的？" class="headerlink" title="面试官：你是怎么理解ES6新增Set、Map两种数据结构的？"></a>面试官：你是怎么理解ES6新增Set、Map两种数据结构的？</h1><p> <img src="https://static.vue-js.com/2b947d00-560c-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>如果要用一句来描述，我们可以说</p>
<p><code>Set</code>是一种叫做集合的数据结构，<code>Map</code>是一种叫做字典的数据结构</p>
<p>什么是集合？什么又是字典？</p>
<ul>
<li><p>集合<br>是由一堆无序的、相关联的，且不重复的内存结构【数学中称为元素】组成的组合</p>
</li>
<li><p>字典<br>是一些元素的集合。每个元素有一个称作key 的域，不同元素的key 各不相同</p>
</li>
</ul>
<p>区别？</p>
<ul>
<li>共同点：集合、字典都可以存储不重复的值</li>
<li>不同点：集合是以[值，值]的形式存储元素，字典是以[键，值]的形式存储</li>
</ul>
<h2 id="一、Set"><a href="#一、Set" class="headerlink" title="一、Set"></a>一、Set</h2><p><code>Set</code>是<code>es6</code>新增的数据结构，类似于数组，但是成员的值都是唯一的，没有重复的值，我们一般称为集合</p>
<p><code>Set</code>本身是一个构造函数，用来生成 Set 数据结构</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br></pre></td></tr></table></figure>
<h3 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h3><p><code>Set</code>的实例关于增删改查的方法：</p>
<ul>
<li>add()</li>
<li><p>delete()</p>
</li>
<li><p>has()</p>
</li>
<li>clear()</li>
</ul>
<h3 id="add"><a href="#add" class="headerlink" title="add()"></a>add()</h3><p>添加某个值，返回 <code>Set</code> 结构本身</p>
<p>当添加实例中已经存在的元素，<code>set</code>不会进行处理添加</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">s.add(<span class="number">1</span>).add(<span class="number">2</span>).add(<span class="number">2</span>); <span class="comment">// 2只被添加了一次</span></span><br></pre></td></tr></table></figure>
<h3 id="delete"><a href="#delete" class="headerlink" title="delete()"></a>delete()</h3><p>删除某个值，返回一个布尔值，表示删除是否成功</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">s.delete(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="has"><a href="#has" class="headerlink" title="has()"></a>has()</h3><p>返回一个布尔值，判断该值是否为<code>Set</code>的成员</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">s.has(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3 id="clear"><a href="#clear" class="headerlink" title="clear()"></a>clear()</h3><p>清除所有成员，没有返回值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">s.clear()</span><br></pre></td></tr></table></figure>
<h3 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h3><p><code>Set</code>实例遍历的方法有如下：</p>
<p>关于遍历的方法，有如下：</p>
<ul>
<li>keys()：返回键名的遍历器</li>
<li>values()：返回键值的遍历器</li>
<li>entries()：返回键值对的遍历器</li>
<li>forEach()：使用回调函数遍历每个成员</li>
</ul>
<p><code>Set</code>的遍历顺序就是插入顺序</p>
<p><code>keys</code>方法、<code>values</code>方法、<code>entries</code>方法返回的都是遍历器对象</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> set.keys()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// red</span></span><br><span class="line"><span class="comment">// green</span></span><br><span class="line"><span class="comment">// blue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> set.values()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// red</span></span><br><span class="line"><span class="comment">// green</span></span><br><span class="line"><span class="comment">// blue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> set.entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [&quot;red&quot;, &quot;red&quot;]</span></span><br><span class="line"><span class="comment">// [&quot;green&quot;, &quot;green&quot;]</span></span><br><span class="line"><span class="comment">// [&quot;blue&quot;, &quot;blue&quot;]</span></span><br></pre></td></tr></table></figure>
<p><code>forEach()</code>用于对每个成员执行某种操作，没有返回值，键值、键名都相等，同样的<code>forEach</code>方法有第二个参数，用于绑定处理函数的<code>this</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>]);</span><br><span class="line">set.forEach(<span class="function">(<span class="params">value, key</span>) =&gt;</span> <span class="built_in">console</span>.log(key + <span class="string">&#x27; : &#x27;</span> + value))</span><br><span class="line"><span class="comment">// 1 : 1</span></span><br><span class="line"><span class="comment">// 4 : 4</span></span><br><span class="line"><span class="comment">// 9 : 9</span></span><br></pre></td></tr></table></figure>
<p>扩展运算符和<code>Set</code> 结构相结合实现数组或字符串去重</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 数组</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> unique = [...new <span class="built_in">Set</span>(arr)]; <span class="comment">// [3, 5, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;352255&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> unique = [...new <span class="built_in">Set</span>(str)].join(<span class="string">&quot;&quot;</span>); <span class="comment">// &quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>实现并集、交集、和差集</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 并集</span></span><br><span class="line"><span class="keyword">let</span> union = <span class="keyword">new</span> <span class="built_in">Set</span>([...a, ...b]);</span><br><span class="line"><span class="comment">// Set &#123;1, 2, 3, 4&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 交集</span></span><br><span class="line"><span class="keyword">let</span> intersect = <span class="keyword">new</span> <span class="built_in">Set</span>([...a].filter(<span class="function"><span class="params">x</span> =&gt;</span> b.has(x)));</span><br><span class="line"><span class="comment">// set &#123;2, 3&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// （a 相对于 b 的）差集</span></span><br><span class="line"><span class="keyword">let</span> difference = <span class="keyword">new</span> <span class="built_in">Set</span>([...a].filter(<span class="function"><span class="params">x</span> =&gt;</span> !b.has(x)));</span><br><span class="line"><span class="comment">// Set &#123;1&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="二、Map"><a href="#二、Map" class="headerlink" title="二、Map"></a>二、Map</h2><p><code>Map</code>类型是键值对的有序列表，而键和值都可以是任意类型</p>
<p><code>Map</code>本身是一个构造函数，用来生成 <code>Map</code> 数据结构</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br></pre></td></tr></table></figure>
<h3 id="增删改查-1"><a href="#增删改查-1" class="headerlink" title="增删改查"></a>增删改查</h3><p><code>Map</code> 结构的实例针对增删改查有以下属性和操作方法：</p>
<ul>
<li>size 属性</li>
<li>set()</li>
<li>get()</li>
<li>has()</li>
<li>delete()</li>
<li>clear()</li>
</ul>
<h3 id="size"><a href="#size" class="headerlink" title="size"></a>size</h3><p><code>size</code>属性返回 Map 结构的成员总数。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">map.set(<span class="string">&#x27;foo&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">map.set(<span class="string">&#x27;bar&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">map.size <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<h3 id="set"><a href="#set" class="headerlink" title="set()"></a>set()</h3><p>设置键名<code>key</code>对应的键值为<code>value</code>，然后返回整个 Map 结构</p>
<p>如果<code>key</code>已经有值，则键值会被更新，否则就新生成该键</p>
<p>同时返回的是当前<code>Map</code>对象，可采用链式写法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line">m.set(<span class="string">&#x27;edition&#x27;</span>, <span class="number">6</span>)        <span class="comment">// 键是字符串</span></span><br><span class="line">m.set(<span class="number">262</span>, <span class="string">&#x27;standard&#x27;</span>)     <span class="comment">// 键是数值</span></span><br><span class="line">m.set(<span class="literal">undefined</span>, <span class="string">&#x27;nah&#x27;</span>)    <span class="comment">// 键是 undefined</span></span><br><span class="line">m.set(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>).set(<span class="number">2</span>, <span class="string">&#x27;b&#x27;</span>).set(<span class="number">3</span>, <span class="string">&#x27;c&#x27;</span>) <span class="comment">// 链式操作</span></span><br></pre></td></tr></table></figure>
<h3 id="get"><a href="#get" class="headerlink" title="get()"></a>get()</h3><p><code>get</code>方法读取<code>key</code>对应的键值，如果找不到<code>key</code>，返回<code>undefined</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="built_in">console</span>.log(<span class="string">&#x27;hello&#x27;</span>);&#125;;</span><br><span class="line">m.set(hello, <span class="string">&#x27;Hello ES6!&#x27;</span>) <span class="comment">// 键是函数</span></span><br><span class="line"></span><br><span class="line">m.get(hello)  <span class="comment">// Hello ES6!</span></span><br></pre></td></tr></table></figure>
<h3 id="has-1"><a href="#has-1" class="headerlink" title="has()"></a>has()</h3><p><code>has</code>方法返回一个布尔值，表示某个键是否在当前 Map 对象之中</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line">m.set(<span class="string">&#x27;edition&#x27;</span>, <span class="number">6</span>);</span><br><span class="line">m.set(<span class="number">262</span>, <span class="string">&#x27;standard&#x27;</span>);</span><br><span class="line">m.set(<span class="literal">undefined</span>, <span class="string">&#x27;nah&#x27;</span>);</span><br><span class="line"></span><br><span class="line">m.has(<span class="string">&#x27;edition&#x27;</span>)     <span class="comment">// true</span></span><br><span class="line">m.has(<span class="string">&#x27;years&#x27;</span>)       <span class="comment">// false</span></span><br><span class="line">m.has(<span class="number">262</span>)           <span class="comment">// true</span></span><br><span class="line">m.has(<span class="literal">undefined</span>)     <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="delete-1"><a href="#delete-1" class="headerlink" title="delete()"></a>delete()</h3><p><code>delete</code>方法删除某个键，返回<code>true</code>。如果删除失败，返回<code>false</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">m.set(<span class="literal">undefined</span>, <span class="string">&#x27;nah&#x27;</span>);</span><br><span class="line">m.has(<span class="literal">undefined</span>)     <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">m.delete(<span class="literal">undefined</span>)</span><br><span class="line">m.has(<span class="literal">undefined</span>)       <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="clear-1"><a href="#clear-1" class="headerlink" title="clear()"></a>clear()</h3><p><code>clear</code>方法清除所有成员，没有返回值</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">map.set(<span class="string">&#x27;foo&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">map.set(<span class="string">&#x27;bar&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">map.size <span class="comment">// 2</span></span><br><span class="line">map.clear()</span><br><span class="line">map.size <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
<h3 id="遍历-1"><a href="#遍历-1" class="headerlink" title="遍历"></a>遍历</h3><p><code>Map</code>结构原生提供三个遍历器生成函数和一个遍历方法：</p>
<ul>
<li>keys()：返回键名的遍历器</li>
<li>values()：返回键值的遍历器</li>
<li>entries()：返回所有成员的遍历器</li>
<li>forEach()：遍历 Map 的所有成员</li>
</ul>
<p>遍历顺序就是插入顺序</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">  [<span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;no&#x27;</span>],</span><br><span class="line">  [<span class="string">&#x27;T&#x27;</span>,  <span class="string">&#x27;yes&#x27;</span>],</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> map.keys()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;F&quot;</span></span><br><span class="line"><span class="comment">// &quot;T&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> map.values()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;no&quot;</span></span><br><span class="line"><span class="comment">// &quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> map.entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item[<span class="number">0</span>], item[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;F&quot; &quot;no&quot;</span></span><br><span class="line"><span class="comment">// &quot;T&quot; &quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map.entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key, value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;F&quot; &quot;no&quot;</span></span><br><span class="line"><span class="comment">// &quot;T&quot; &quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于使用map.entries()</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key, value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;F&quot; &quot;no&quot;</span></span><br><span class="line"><span class="comment">// &quot;T&quot; &quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line">map.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value, key, map</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Key: %s, Value: %s&quot;</span>, key, value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="三、WeakSet-和-WeakMap"><a href="#三、WeakSet-和-WeakMap" class="headerlink" title="三、WeakSet 和 WeakMap"></a>三、WeakSet 和 WeakMap</h2><h3 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h3><p>创建<code>WeakSet</code>实例</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br></pre></td></tr></table></figure>
<p><code>WeakSet</code>可以接受一个具有 <code>Iterable</code>接口的对象作为参数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]];</span><br><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>(a);</span><br><span class="line"><span class="comment">// WeakSet &#123;[1, 2], [3, 4]&#125;</span></span><br></pre></td></tr></table></figure>
<p>在<code>API</code>中<code>WeakSet</code>与<code>Set</code>有两个区别：</p>
<ul>
<li>没有遍历操作的<code>API</code></li>
<li>没有<code>size</code>属性</li>
</ul>
<p><code>WeackSet</code>只能成员只能是引用类型，而不能是其他类型的值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> ws=<span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成员不是引用类型</span></span><br><span class="line"><span class="keyword">let</span> weakSet=<span class="keyword">new</span> <span class="built_in">WeakSet</span>([<span class="number">2</span>,<span class="number">3</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(weakSet) <span class="comment">// 报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 成员为引用类型</span></span><br><span class="line"><span class="keyword">let</span> obj1=&#123;<span class="attr">name</span>:<span class="number">1</span>&#125;</span><br><span class="line"><span class="keyword">let</span> obj2=&#123;<span class="attr">name</span>:<span class="number">1</span>&#125;</span><br><span class="line"><span class="keyword">let</span> ws=<span class="keyword">new</span> <span class="built_in">WeakSet</span>([obj1,obj2]); </span><br><span class="line"><span class="built_in">console</span>.log(ws) <span class="comment">//WeakSet &#123;&#123;…&#125;, &#123;…&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p><code>WeakSet</code>里面的引用只要在外部消失，它在 <code>WeakSet</code>里面的引用就会自动消失</p>
<h3 id="WeakMap"><a href="#WeakMap" class="headerlink" title="WeakMap"></a>WeakMap</h3><p><code>WeakMap</code>结构与<code>Map</code>结构类似，也是用于生成键值对的集合</p>
<p>在<code>API</code>中<code>WeakMap</code>与<code>Map</code>有两个区别：</p>
<ul>
<li>没有遍历操作的<code>API</code></li>
<li>没有<code>clear</code>清空方法</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// WeakMap 可以使用 set 方法添加成员</span></span><br><span class="line"><span class="keyword">const</span> wm1 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"><span class="keyword">const</span> key = &#123;<span class="attr">foo</span>: <span class="number">1</span>&#125;;</span><br><span class="line">wm1.set(key, <span class="number">2</span>);</span><br><span class="line">wm1.get(key) <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// WeakMap 也可以接受一个数组，</span></span><br><span class="line"><span class="comment">// 作为构造函数的参数</span></span><br><span class="line"><span class="keyword">const</span> k1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> k2 = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">const</span> wm2 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>([[k1, <span class="string">&#x27;foo&#x27;</span>], [k2, <span class="string">&#x27;bar&#x27;</span>]]);</span><br><span class="line">wm2.get(k2) <span class="comment">// &quot;bar&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>WeakMap</code>只接受对象作为键名（<code>null</code>除外），不接受其他类型的值作为键名</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line">map.set(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">// TypeError: 1 is not an object!</span></span><br><span class="line">map.set(<span class="built_in">Symbol</span>(), <span class="number">2</span>)</span><br><span class="line"><span class="comment">// TypeError: Invalid value used as weak map key</span></span><br><span class="line">map.set(<span class="literal">null</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">// TypeError: Invalid value used as weak map key</span></span><br></pre></td></tr></table></figure>
<p><code>WeakMap</code>的键名所指向的对象，一旦不再需要，里面的键名对象和所对应的键值对会自动消失，不用手动删除引用</p>
<p>举个场景例子：</p>
<p>在网页的 DOM 元素上添加数据，就可以使用<code>WeakMap</code>结构，当该 DOM 元素被清除，其所对应的<code>WeakMap</code>记录就会自动被移除</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;example&#x27;</span>);</span><br><span class="line"></span><br><span class="line">wm.set(element, <span class="string">&#x27;some information&#x27;</span>);</span><br><span class="line">wm.get(element) <span class="comment">// &quot;some information&quot;</span></span><br></pre></td></tr></table></figure>
<p>注意：<code>WeakMap</code> 弱引用的只是键名，而不是键值。键值依然是正常引用</p>
<p>下面代码中，键值<code>obj</code>会在<code>WeakMap</code>产生新的引用，当你修改<code>obj</code>不会影响到内部</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"><span class="keyword">let</span> key = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">foo</span>: <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line">wm.set(key, obj);</span><br><span class="line">obj = <span class="literal">null</span>;</span><br><span class="line">wm.get(key)</span><br><span class="line"><span class="comment">// Object &#123;foo: 1&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://es6.ruanyifeng.com/#docs/set-map">https://es6.ruanyifeng.com/#docs/set-map</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>es6</tag>
        <tag>set_map</tag>
      </tags>
  </entry>
  <entry>
    <title>single_multi_line</title>
    <url>/archives/f7feebc7.html</url>
    <content><![CDATA[<h1 id="面试官：如何实现单行／多行文本溢出的省略样式？"><a href="#面试官：如何实现单行／多行文本溢出的省略样式？" class="headerlink" title="面试官：如何实现单行／多行文本溢出的省略样式？"></a>面试官：如何实现单行／多行文本溢出的省略样式？</h1><p> <img src="https://static.vue-js.com/ada8d840-a0e9-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>在日常开发展示页面，如果一段文本的数量过长，受制于元素宽度的因素，有可能不能完全显示，为了提高用户的使用体验，这个时候就需要我们把溢出的文本显示成省略号</p>
<p>对于文本的溢出，我们可以分成两种形式：</p>
<ul>
<li>单行文本溢出</li>
<li>多行文本溢出</li>
</ul>
<h2 id="二、实现方式"><a href="#二、实现方式" class="headerlink" title="二、实现方式"></a>二、实现方式</h2><h3 id="单行文本溢出省略"><a href="#单行文本溢出省略" class="headerlink" title="单行文本溢出省略"></a>单行文本溢出省略</h3><p>理解也很简单，即文本在一行内显示，超出部分以省略号的形式展现</p>
<p>实现方式也很简单，涉及的<code>css</code>属性有：</p>
<ul>
<li>text-overflow：规定当文本溢出时，显示省略符号来代表被修剪的文本</li>
<li>white-space：设置文字在一行显示，不能换行</li>
<li>overflow：文字长度超出限定宽度，则隐藏超出的内容</li>
</ul>
<p><code>overflow</code>设为<code>hidden</code>，普通情况用在块级元素的外层隐藏内部溢出元素，或者配合下面两个属性实现文本溢出省略</p>
<p><code>white-space:nowrap</code>，作用是设置文本不换行，是<code>overflow:hidden</code>和<code>text-overflow：ellipsis</code>生效的基础</p>
<p><code>text-overflow</code>属性值有如下：</p>
<ul>
<li>clip：当对象内文本溢出部分裁切掉</li>
<li>ellipsis：当对象内文本溢出时显示省略标记（…）</li>
</ul>
<p><code>text-overflow</code>只有在设置了<code>overflow:hidden</code>和<code>white-space:nowrap</code>才能够生效的</p>
<p>举个例子</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">p</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">        <span class="attribute">line-height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>:<span class="number">400px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>:<span class="number">40px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">border</span>:<span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="css">        <span class="attribute">text-overflow</span>: ellipsis;</span></span><br><span class="line"><span class="css">        <span class="attribute">white-space</span>: nowrap;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> 这是一些文本这是一些文本这是一些文本这是一些文本这是一些文本这是一些文本这是一些文本这是一些文本这是一些文本这是一些文本&lt;/<span class="attr">p</span> &gt;</span></span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p> <img src="https://static.vue-js.com/bb3048e0-a0e9-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>可以看到，设置单行文本溢出较为简单，并且省略号显示的位置较好</p>
<h3 id="多行文本溢出省略"><a href="#多行文本溢出省略" class="headerlink" title="多行文本溢出省略"></a>多行文本溢出省略</h3><p>多行文本溢出的时候，我们可以分为两种情况：</p>
<ul>
<li>基于高度截断</li>
<li>基于行数截断</li>
</ul>
<h4 id="基于高度截断"><a href="#基于高度截断" class="headerlink" title="基于高度截断"></a>基于高度截断</h4><h4 id="伪元素-定位"><a href="#伪元素-定位" class="headerlink" title="伪元素 + 定位"></a>伪元素 + 定位</h4><p>核心的<code>css</code>代码结构如下：</p>
<ul>
<li>position: relative：为伪元素绝对定位</li>
<li>overflow: hidden：文本溢出限定的宽度就隐藏内容）</li>
<li>position: absolute：给省略号绝对定位</li>
<li>line-height: 20px：结合元素高度,高度固定的情况下,设定行高, 控制显示行数</li>
<li>height: 40px：设定当前元素高度</li>
<li>::after {} ：设置省略号样式</li>
</ul>
<p>代码如下所示：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.demo</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">        <span class="attribute">line-height</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.demo</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">content</span>: <span class="string">&quot;...&quot;</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">        <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20px</span> <span class="number">0</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;demo&#x27;</span>&gt;</span>这是一段很长的文本<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>实现原理很好理解，就是通过伪元素绝对定位到行尾并遮住文字，再通过 <code>overflow: hidden</code> 隐藏多余文字</p>
<p>这种实现具有以下优点：</p>
<ul>
<li>兼容性好，对各大主流浏览器有好的支持</li>
<li>响应式截断，根据不同宽度做出调整</li>
</ul>
<p>一般文本存在英文的时候，可以设置<code>word-break: break-all</code>使一个单词能够在换行时进行拆分</p>
<h4 id="基于行数截断"><a href="#基于行数截断" class="headerlink" title="基于行数截断"></a>基于行数截断</h4><p>纯<code>css</code>实现也非常简单，核心的<code>css</code>代码如下：</p>
<ul>
<li>-webkit-line-clamp: 2：用来限制在一个块元素显示的文本的行数，为了实现该效果，它需要组合其他的WebKit属性）</li>
<li>display: -webkit-box：和1结合使用，将对象作为弹性伸缩盒子模型显示 </li>
<li>-webkit-box-orient: vertical：和1结合使用 ，设置或检索伸缩盒对象的子元素的排列方式 </li>
<li>overflow: hidden：文本溢出限定的宽度就隐藏内容</li>
<li>text-overflow: ellipsis：多行文本的情况下，用省略号“…”隐藏溢出范围的文本</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">border-radius</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="css">        -webkit-line-clamp: <span class="number">2</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">display</span>: -webkit-box;</span></span><br><span class="line"><span class="css">        -webkit-box-orient: vertical;</span></span><br><span class="line"><span class="css">        <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">        <span class="attribute">text-overflow</span>: ellipsis;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    这是一些文本这是一些文本这是一些文本这是一些文本这是一些文本</span><br><span class="line">    这是一些文本这是一些文本这是一些文本这是一些文本这是一些文本</span><br><span class="line">&lt;/p &gt;</span><br></pre></td></tr></table></figure>
<p>可以看到，上述使用了<code>webkit</code>的<code>CSS</code>属性扩展，所以兼容浏览器范围是<code>PC</code>端的<code>webkit</code>内核的浏览器，由于移动端大多数是使用<code>webkit</code>，所以移动端常用该形式</p>
<p>需要注意的是，如果文本为一段很长的英文或者数字，则需要添加<code>word-wrap: break-word</code>属性</p>
<p>还能通过使用<code>javascript</code>实现配合<code>css</code>，实现代码如下所示：</p>
<p>css结构如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.p-after</span>:after&#123;</span><br><span class="line">    content: <span class="string">&quot;...&quot;</span>; </span><br><span class="line">    <span class="attribute">position</span>: absolute; </span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>; </span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>; </span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left, transparent, <span class="number">#fff</span> <span class="number">55%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(left, transparent, <span class="number">#fff</span> <span class="number">55%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(left, transparent, <span class="number">#fff</span> <span class="number">55%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, transparent, <span class="number">#fff</span> <span class="number">55%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>javascript代码如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="comment">//获取文本的行高，并获取文本的高度，假设我们规定的行数是五行，那么对超过行数的部分进行限制高度，并加上省略号</span></span><br><span class="line">   $(<span class="string">&#x27;p&#x27;</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">i, obj</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> lineHeight = <span class="built_in">parseInt</span>($(<span class="built_in">this</span>).css(<span class="string">&quot;line-height&quot;</span>));</span><br><span class="line">        <span class="keyword">var</span> height = <span class="built_in">parseInt</span>($(<span class="built_in">this</span>).height());</span><br><span class="line">        <span class="keyword">if</span>((height / lineHeight) &gt;<span class="number">3</span> )&#123;</span><br><span class="line">            $(<span class="built_in">this</span>).addClass(<span class="string">&quot;p-after&quot;</span>)</span><br><span class="line">            $(<span class="built_in">this</span>).css(<span class="string">&quot;height&quot;</span>,<span class="string">&quot;60px&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $(<span class="built_in">this</span>).removeClass(<span class="string">&quot;p-after&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><p><a href="https://www.zoo.team/article/text-overflow">https://www.zoo.team/article/text-overflow</a></p>
</li>
<li><p><a href="https://segmentfault.com/a/1190000017078153">https://segmentfault.com/a/1190000017078153</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>single_multi_line</tag>
      </tags>
  </entry>
  <entry>
    <title>triangle</title>
    <url>/archives/df976d87.html</url>
    <content><![CDATA[<h1 id="面试官：CSS如何画一个三角形？原理是什么？"><a href="#面试官：CSS如何画一个三角形？原理是什么？" class="headerlink" title="面试官：CSS如何画一个三角形？原理是什么？"></a>面试官：CSS如何画一个三角形？原理是什么？</h1><p><img src="https://static.vue-js.com/bd310120-a279-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>在前端开发的时候，我们有时候会需要用到一个三角形的形状，比如地址选择或者播放器里面播放按钮</p>
<p> <img src="https://static.vue-js.com/d6d8ff60-a279-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>通常情况下，我们会使用图片或者<code>svg</code>去完成三角形效果图，但如果单纯使用<code>css</code>如何完成一个三角形呢？</p>
<p>实现过程似乎也并不困难，通过边框就可完成</p>
<h2 id="二、实现过程"><a href="#二、实现过程" class="headerlink" title="二、实现过程"></a>二、实现过程</h2><p>在以前也讲过盒子模型，默认情况下是一个矩形，实现也很简单</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.border</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">border</span>: <span class="number">2px</span> solid;</span></span><br><span class="line"><span class="css">        <span class="attribute">border-color</span>: <span class="number">#96ceb4</span> <span class="number">#ffeead</span> <span class="number">#d9534f</span> <span class="number">#ffad60</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;border&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>效果如下图所示：</p>
<p> <img src="https://static.vue-js.com/e3f244e0-a279-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>将<code>border</code>设置<code>50px</code>，效果图如下所示：</p>
<p> <img src="https://static.vue-js.com/ee0b42b0-a279-11eb-ab90-d9ae814b240d.png" alt=""></p>
<p>白色区域则为<code>width</code>、<code>height</code>，这时候只需要你将白色区域部分宽高逐渐变小，最终变为0，则变成如下图所示：</p>
<p> <img src="https://static.vue-js.com/2afaa030-a27a-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>这时候就已经能够看到4个不同颜色的三角形，如果需要下方三角形，只需要将上、左、右边框设置为0就可以得到下方的红色三角形</p>
<p> <img src="https://static.vue-js.com/2afaa030-a27a-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>但这种方式，虽然视觉上是实现了三角形，但实际上，隐藏的部分任然占据部分高度，需要将上方的宽度去掉</p>
<p>最终实现代码如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.border</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-style</span>:solid;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">50px</span> <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent transparent <span class="number">#d9534f</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果想要实现一个只有边框是空心的三角形，由于这里不能再使用<code>border</code>属性，所以最直接的方法是利用伪类新建一个小一点的三角形定位上去</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.border</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-style</span>:solid;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">50px</span> <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent transparent <span class="number">#d9534f</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border</span>:after&#123;</span><br><span class="line">    content: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">border-style</span>:solid;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">40px</span> <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent transparent <span class="number">#96ceb4</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果图如下所示：</p>
<p> <img src="https://static.vue-js.com/59f4d720-a27a-11eb-85f6-6fac77c0c9b3.png" alt="i"></p>
<p>伪类元素定位参照对象的内容区域宽高都为0，则内容区域即可以理解成中心一点，所以伪元素相对中心这点定位</p>
<p>将元素定位进行微调以及改变颜色，就能够完成下方效果图：</p>
<p> <img src="https://static.vue-js.com/653a6e10-a27a-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>最终代码如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.border</span>:after &#123;</span><br><span class="line">    content: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">40px</span> <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent transparent <span class="number">#96ceb4</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">40px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="三、原理分析"><a href="#三、原理分析" class="headerlink" title="三、原理分析"></a>三、原理分析</h2><p>可以看到，边框是实现三角形的部分，边框实际上并不是一个直线，如果我们将四条边设置不同的颜色，将边框逐渐放大，可以得到每条边框都是一个梯形</p>
<p> <img src="https://static.vue-js.com/78d4bd90-a27a-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>当分别取消边框的时候，发现下面几种情况：</p>
<ul>
<li>取消一条边的时候，与这条边相邻的两条边的接触部分会变成直的</li>
<li>当仅有邻边时， 两个边会变成对分的三角</li>
<li><p>当保留边没有其他接触时，极限情况所有东西都会消失</p>
<p><img src="https://static.vue-js.com/84586ef0-a27a-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
</li>
</ul>
<p>通过上图的变化规则，利用旋转、隐藏，以及设置内容宽高等属性，就能够实现其他类型的三角形</p>
<p>如设置直角三角形，如上图倒数第三行实现过程，我们就能知道整个实现原理</p>
<p>实现代码如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="comment">/* 内部大小 */</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="comment">/* 边框大小 只设置两条边*/</span></span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">#4285f4</span> solid;</span><br><span class="line">    <span class="attribute">border-right</span>: transparent solid;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">85px</span>; </span><br><span class="line">    <span class="comment">/* 其他设置 */</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://www.cnblogs.com/echolun/p/11888612.html">https://www.cnblogs.com/echolun/p/11888612.html</a></li>
<li><a href="https://juejin.cn/post/6844903567795421197">https://juejin.cn/post/6844903567795421197</a></li>
<li><a href="https://vue3js.cn/interview">https://vue3js.cn/interview</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>triangle</tag>
      </tags>
  </entry>
  <entry>
    <title>That gril</title>
    <url>/archives/b7b51641.html</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">
  <script id="hbeData" type="hbeData" data-hmacdigest="9c79a012124d294112e835162f404f7ceb26e40230ddad6a55db49c7f591410c">7a13521b6242615d832816f422e7dfef21dbb4d9f9d3a719e0fe269ee1c6688a063ce89a9db64539adcc63a2e255d805be8a50d13d44687301d7c068110dd13bc9b12b514d3756ada69087b19746ca0997bd187f56a6fcf930f8f0ebdf1a353b9761de7d7f9249740d8a11c7cada2c03322db9b7ee823f0d841f029530981df64e7afb059330a0abb828f7af7d23b52dddeae783766a2d231bebc266eee729dc9f84552af63af2849002b42263f77be782d43873d94327832f017206fdd0fedfbd9bf939c6842e02eb54a0b845864b5077b890e0446a359ed7561c2fe4829ca67fc8879e2ba71360f04c46057765037a7b7362854ec29216f8b802ca946f72c695549802dc7523cb407348ba7b5f6e213e689c3c1e43a6a5c3c70345d529a401fabdb8a14e283253d5151b98d1289c5889606267704508611879bea7104069061c63d74d060d5414a8cd9d237a674960920a3ae83fb93b6f14f4b431fa6acebae36395f03ac1413df16d90b34bb44184feef736e7a1fd777d26afca49e619f34d926b65081f4f1626cb66fca7939718e2e4d661fd6a7dacc030d4d9176dd13fa7ad3951796a9416d9be6a72d688d4ecbb74396d3d0f2010538f5f877537db36640bb006b209ed371c291559e72f6ad70a11c495dbd597e70c92e706b46d7407d9afaadb07ca6c068cc86e1370487ff20c7f746643d0dce882b77289b2852f4c8dade77b168eeda134e0bc481723cd25583bcc2d16fcd6fb9c2a2bbf5d09c6aa9d2b8f0a0dd94322279c8cb59dacac0f38ed30daaa3008961fda33bccb87a401debc5b27ae3cd1b459ff14321237322d7876f0b2ad676b269417c13491681e779558e28f35e20c4ca9f4617518453e68ad502067c7d8dd0ec9eb682b2db7ce9b03710cb21032662ece0ebaaf5dfc7b230753aa4e972dfeedcf185f9972278168f685a17bb5e763382171d62e730ac1c83c050bd7a37fcad3b5443340a069657bb756c01d595d884c9704815a1431413c9337a4eff760b332a048584a2e849758586ad32eac953166ea68e18f8bf6a6b3e20076becc3d60db4558cde23c18331d1027e091f3f590a0ff17fb8efa2cca3ee7cf601e8e0e56d7fcb39312c97e09587a0c0c2f8de1573d7b15a8b3e43c059da947d0912cad1cfaabe9f01a2dfe821c272f756d0f30c69407da1c83b0f2cfdc5e4e17ec8f67e36fe5da57a23766f4cff52f9d97cf0fbfa5d1206ad56756ce81dcceb0d199848a4e5393421f33da133a6160239fceb5b44aa749db26ecbaaa373c71e5d9491a392ffb35af5f366f42c051ba20784758363d23c38b3fa317c44a2cd8644278700bc50f9924eb1d4e5b4a9f81f8a3e6f2d9d570e258b74026e7bffcc032445437a077f5caf99f51c726fbc4c1ffea4ba2f8df13b2e77bb5d384046727c5cf0b239a67b5cc1ce0b8b295b0d38cca3e00307528e64090c80b510c8d591c9eff70ca1a1b6cae652ebcfd666e8a1fb011fbec7e2a7d1c2730e2251123f479b0e0c20d0d8a99cddb5816da9480ed8ce23a858739575cfc79f2a36e63dc88fcf3cc2e7271bd62ad045e1daaceb7115dce6cf12b8d970630ddeb2c2fb6c194f3c4ee15c834ab63c6affeccfc6d134defa46a2eaa3efbcb71cbcb85bb0dffbad96bd9a32ffd62ee2914e857e003d021b5e001d5a101db3c9eefcd053cda5707ae30534ffec2cca27a9e1b503ce161c802fa300705188b4d8a3d4854eaa5f05d5ba76d99d8bb82b3ba0de1a7ce7eec43c084dc0ca99af005dc7815208e368370ea89d2d3db2e2ab128ab06b3ed8828085e67c4250567cfd39a137980a874c40cab8f641af8665747a226c2e663a8956ddd3f9e4c06a10f81cdc19f6156b99ec784b1d9429726d385c3497fa50ebc3f9a732bfdf9e6e8fb9047c47ca04e85a81a8539be2d25857d894c4f3ecb33dbdbcccac2d8b8e499ab2e685e2c57834b40512846d0cb8f3f486f89129c4d8e28fe382b43387dc244acc58be41451ba853569a07be4664ab9b8bccfcbb9347700540af5358538837b2a4d3cf2ac397fd7f251a15cad8838481fd1e3c94b5a5b25ec160ed7fc503d4f8f32bc6a54458b034f432bfc44098ad4192b3b913de5d75ce1cb78b22c93944e0841a065c574ed3058d6df096909d22e73f16e9cb69b79c171df93f7a1788881a2809eb6ae7a829c265ff3576c3b679b69a35e37aa5e1bfa9ede177194cb7a2a3facc9c610af02737af57d3526fcd3699fe1ea2f41bf45a5834bc1c229288db279cb182ebe6c0ace1d6d553c1c0f59adf9c40959277083c5effd9d5a3720b79e87b4bfa5ff9018579aa5414e2572768245e9e100e6b6c9ba4bdc4ed418dfdb18c42d45f2ab1c9642e9eda29639d24d55f14105f4b8606a06392866df245a987544023765f5e2076c7affdeaab164d3c81d6e92a3e0c83533460a595abc849b1e7b1d9bdf068c887180944287696f7eb5e7305a4541cbc63b4ff7233b9164eebf8e14ae6648e6c261760fe2182fff9f32c3b551f9d5145d167486825e7abc2a23a626900fd5d5586c7591e2d485608eea59bfa8e6b6f1cec5c28d58092d719a24786ae388327e128fd0f15850416e91fdf897bb13990ddc09b8830c5ccf94b2ed3d8560fb490c407c836800f1ce514e7078043b1ed64c85ea1a553e4e2db6f01a7de2b566673b5bc75c3795889e720132f0f99106c5944c09b35c4c8f0705eda69c0e3d86acedc60a9a8e9587b7ca8ed46713804e0dbab377daaff029a7125c2cde4d2e28da2e2404d349ba83fff20a1d1e52a2b6b89d8a54b78114cabcb6ea9abc4812d2e6e4c89c596adb6a415794e291ff2ad2523d9ee75916f2598769171e1234348ce55d28c0c8187cd9eca549cc1956f2d265a7e2c51f77c47d1d60e5f6092c37b99f9a003256627e9c4a40cc809eb58ae66a362fec64840693c3d6dc18f9f88b8023d648cc3d7e20efbbeb61f9ca1ad0b356f1247946011de7568c88ef20d765e2fab1f0d2e0841d25af78d8494283c210469fd118ddfbf27ab6be16825f33d52ed29c75768ea02f9bd33b3336efed851124a56c37d2d8f528f748bbc4e6feaae755ffb53558d962dafd13b170acf34d725f6eb038741e0b0552c4fd058f76244acf1654e11f5277dcd9a8be26341812d3e8bef5da88c7891a97dd7c75beb953b21a167a048642630f68e5627c0e391493472d0a5950e4016192ad05c1e29559662ad636ccee65a1432a90a49ef23811dab86a1dcdf002e0cefef4c53a9e6c0ad1768ea1b1ea4c8c13ccb170e2a6610473620d960ad6de09de6c33ec2ee5eba4cd58ef9be3637ac7029773947c92281ed162021e37ec0ae60fe9b88c8cdd637ed9a8b21e63f34e4889678951fe3db3a439816950bb62e167a8123ca123ff69f8661acc630b30b324376463ec9c1d37a8b472887604b95b3990637ec208d6c4e92fb0408ddcedc4abe3d1adc9339a8f43ee9859580348b5f6beb78d8dce80672a48afddfdff46c417df869ced7f20e6b41b28d38b461d665224098f88697d03d2fedae9c23413d796a32cda4e03823bec52f54fcba0dea5bf054d282e28f6bc811a27925cae6cb5376e35327b624b6c1d58256d5b08dec0bf1079fd9a3b5fde3d019bae30b238164eaa9bc1c23458a6222aa1de1fad0ae68e7fd1ac4308ceee18679c03b07cb31bf65c31d27b1ffeda38f74344b14f0bc0e026d00f50182c4ad6bcd18414c110755ca532cfa9619499cf544bfbbee5238dad14721679f25a905d954de34874550a069b76b5f3b23c1d4ca960cf5339c65141b83f39a87d64b998ce58cf7282dc9ded8fff85064b223b5b503a9bd8f62ca0233a1989ba8048b5b0cfe165b6300bafd6cb98b4669ce4e273660ec6ebf5bd5d6f13fb57d561994f55f127c1327c580ae6e67551d6cb542761da2c3857b8467aff45706ce3e7dc475312bca067ec5e442c89c9fa67e07b401d387d5f43a5f7f97da9659757289edde1e05b9c971fbcf84de12db871a24667e73ffcfcabc63e60169b61fcd0949e475b9a3b326815a08be984709e68f30ca26943745c359cfac377bb7985d8b2d07a91cc6dd8f0817ab4d4f5566da5275bddf9b050789a4bf14f2f3135ca48c0165063e6caa42e20ce94b7697ef958cd102899a08eacce7739a41cba1d4b9aa8b78554a8141a8b04e6e9a42ec1885dae8efcdf9549e6429fd3d0eea05d89dad266e9e5be5ab2385f18fe748b287993698cf42be3015c4333c9fec2ece3ce3b4c482fffbd7deb839e64bcf4d4c7b392d584ac9d46e29327364f02f6bf9e778a8b79282427e704ec67455c6a8eb867e554f2aab1120debccee483573e6e7bf0c2a63930bc9c4d17eef9e2e22220bc5a73178a48c0b54eb37633cc0c4645f870af17f306756e48d2c1ecf630f3821eae6072d11dd869f2b8d4b50afc81d2c7177199855b335b2168f615c448a40ec50f33eba455c8d234e1d394f22726921780557c8baf91ecc9b842a618c123b08f06e96fe471ae5a9e6c266dffb68e7b17c67c387d77b62f08627e5d0e1a52e399894991588f2637a04b5eca2ddfa2bc63bb63283b380eadb24e0c4c8b2434519825d4c3141ed12ff4680f629e2f3cd31d91ceb874ae562f2a142ca98acccd1e290fce7943160b18a7fe9274fa717c68dab8b5fbdd91793a7795fadb5e2121c91d1206d9fead3863b1809692cc4f57c939fadd3f4d724a2e629e96a84c5dc2c01475ab902dfa9186d0ed2b25b8f78ebf73a150a1ac01071140289bb2e70b97cbaf83b4354a05b9011af22908956e4a1262c843b98170ab05d9ec8a62e7123170a6c0dc033a16e19c42a043021cdb3280a5c629d12b759d6dec68e9574e2ef244a617d9e763df97813338890d0dc15e20c749a22d5d179877f8fe44ad1ed2c3be2afd43aebc73d130899e92ee25bebc293d440db6a1c08d5dae9759ed99f89f5a4dd649feadfc320ee49305ce37b28ca31d6838c1abbe150e6e17ba4a8f7a8e6301cb0936f22ff769e0675b12b4a07f96cf204eb1aef5ddbb3ced818e949763e251fc33da343b38f9690456cea0549e86e628f2aaa0119117de6e34b9c06775afc580bfa117d1d263f51566e486970f453c5517409e1084f55d23a25def2542ea9d4de5f2aee5f1efa79b677dad7d17c085084abf1acc390e82dca8778750ee663b0c7fc283b67e6ff341bdb75e0bbe2fe81fb32cfecbef1c9cf81a042c11498e34627e391aa8f2de21235ed1bcc3c7a150c3d6f47062a8fc3856fee6d55621a0770e4b5f9c0275b621813ee633ed603bccd43fa59bb28de825d0df9f5093b978da550a878a75088835fa2d45d58076b9cd00cf0e3dce1b32401c6c20b014f89d4111508a901caea6744d41650f2f531e453b2bd930949aafaddb6dc9bc91359df57ed25548f31a6ecbe6551ed75be59a84cf25ea399a1ae383e9f7d12e3bb31b8866a5aaf0523af83b811b05c0a9f544062f17f094d62da865a649c59b3c450344c569cf623412f76ed5ede755cf65837f6799a0293c83f04ae0297b9736a4df34754298daa3d72d73d807465171cbbf4550cac1543bec19ebef1a6227850beffbeca774b069f95d622baec01a60842df99a387c4ba52ebeef4a5b96b539384f9b65c8a697fbd68c51a25b6b7aae77060f0a418408cb9c074901c64054926db0a5e3f680d89fe7736a9b30a5c840212d6443ebe55cfbb8d5f0cc44d9f0a9b24ec05c7aeb9afbfdb31911a4a762216d80542938f8a9247338cfef5848e4601c1417ad04fc7d83b450f65ae855ce9e39704ce0b90e1e6b3411d35eaaf57b2592783131ce80ae0be7b2997b82572cdcfbcf0d60574f8fac4c3cbf67f5ae371ab20f19f16db0414e01cd7fc97313061c2011e123af0d13968dcb7631e9fe37341c68b78289fbe7819d27314270fc4a23b355bb16b1814f2f5a45f47f236660106d65deb2977a3044192d2bb8e92eda057f3d5bed61715bfb704427d4908d3b62a15f02405248687db0ce865e9db80d26eaf10d3f71b4fcddc71028b08976397aad03dc57b007589c1758a3e990c34abf75d50e750bb3a709e45706b3b7a3dc79349a1ca53398a838f60d209cb64ec71b425c259208328b8965771e7594affcc9b6430c4d2de3c7417dc1d1ddae8c13b5e11a827d4fe13017289d3ade00b670d4875cf1f5c2b7b5aeb1f9a63d22ec666b3d65ea56f141a4d6cc7cf770d2646bdb15cbee311b4ee5be4109936492ce954ac763c763287691c55b56458ac6a382d0e3b90f4857165eaa6f6a60d9c8bd76bf1dcbd9d45fff88052a7442c74a3f56ccabc283be46185daccaede8d7976c6d74c39b995a2bc8baba4d645b1fe23043167f572520b50e1c3d1847db28e72abee365d12ad562c9078b72152242c3de5aa6c21dec4e965a9e0b57252a707f078f1e8a95a2fe691ebb9a970a6b861f08d6c2838e529b848ef0d93125ae0f3dd60fcd6bd1c324fb84dc039a23723c3bfd3a6e9c43df18ea9bf1204877da3523ab1b4b500b12ac140f96f623f8d21452f1c2196ec6dcdf92f4ba0e53c28ad75937c4650be1a43a53e50e1bf57b43fea1531788c497fe2c8838f1c800c249e5709c5f26a33fd620a371f8ab77df1c19c13b95647ca0e088407d709a644517cc53ac432c2d9d8d4a96064b7c4965e1d8512d9d20a06705c331f1d710d4265e15e4a77d10d4e1a90fc0f2f2b33d307438a225ab85d320a877813ecac382114d4ecef1593ffe8d79cf1e3d79b897b28315893b2725acb121e62b2ce09e3a889c4fc43ab4779109862cf7a0f12f1e902c9e63eb4851a86f6cbc80489a8efd9ed065745e20820dd19ac297991ca358a7b7fde8e9ee853d7b2de9d9a7662d00d22085128a2c796831dfcd4bb227b36604a0cce9788f0490db64419035aaf8c7939fab38a04473b0ef0ca8d2490ba2565743b19350b19b4741aecbd2c7c804aea584a395510aab307fa77743cd001d32d3653c10d9633927f2fee08c3ca90e0c0c43674631bc61d6ee6070b9e5c769eda17e6b38c709e3bb60ec550425503b01e45e0e226ec7f40b90be347b685d9d642d7c6727d09f75ff2be1bdf33affc1766b5d15e92b1f20f4aaf474c55bcfea5b13e92982e7393506121e18c388db47433ef9dbd4234763dff83146fb849ec6255b222743c58352c11459424ea4048b09a6f6454fbdd3233b08e44f2f63450e025beb23dd122482c35d48c64446d8acdd26fd6dd9d5effbff3da6fa8b9d1842b5da09b3933bffdc36bec33604d1b05bebffb65445e2a545aff090122f63cba44b42f3a46d376ba47c58053a8e42aaf686632e90ab2b00a6e8bc9f68061ca7613b83e06efa53f99f4232e6db2ec5e66645f2f6f91af12c1210567733a368d0a0006ae1a08d8af980ac4323700505dd1ffabdadb4e905dea4651a41f13c01f57c4f6246754d2311358bdb5fde9ec72f78612d10c0e2dc810917fe26c5a139a8f5931cd8d34e9adfb294a15f01485d72c3c7695bd3b3996fbd96c8711412fae659d5c0dea2f30bf95b0ca8d4823d94ac494d9a4f47ce26a3fb7c378453695474d652953d34cfdd5d398263c33627a60e642df75b6e041318f13c8d44648099a1f3777090d4a7a1910967a1174b8a0775c8cf4d2fd916c71532129205ddf139da0ad48f5a135b94db5d757b092c2c2b09541e8bebdcfa55e01d58fe10b81a8cc2750c02daa1b46a947b31ceb2ee11da752eaa9bf7f0d5d350faf440d2c1b87eb266d32aa8d785dc3d9454f0e2b0ebbca94d78a24926aa57cdbb534c69a7200aa9f8de4b1d743c961974b3826b31b03be6bd2e6f5122644573f064ee9b0ead26336ea7dfcc9d14c8aacfb426eab780a57faf7db05a54d3bb79386e28884bfa1bc7f32f08e58dac2e8be46d3e59e03ed87b452965d4564976d15572f8c9c53ceac18fad6bf589750635d7623b20ecc59e0e6aedd8d25ff015659374e855bfe5055a187b68910062a7857d51575e473a6e64033252e5dd84d5bebdaee9a98e1f95415a4ff50e26b776ae48d6b43f32542b73c5da29a45ba024f2c29ecc1d6d68f8d4eaa86e90c6ac74b0f9e0ade1e19f1d48a21de2fb0214ab93396f90e1fbbfcc259ff47860fb7d55c376d98fce837e1d9244aaae602b1f199d9a8401c88ddf2cefb8f4fd59b853c3572da0ee7cfc490365337853e219e42648f44171d425481a6e5b5ac017d98a102fe7c1d39604f6c7daf93bf675c68be8d875c59349bbae73cf4af7dd79ea55a525498ffca2e7fa4fbc0e1833b326f3039abd8fe15fd02ac599403625329c23f5142d2ccba34b0ecf2f23924ea500acf081ebc60f16751b7051271f6725ac7b49b0b38306ca78ebeabdd9c6f1d4af90b3ee498fd9d1153360bb6e048ef56cf356c95a4df1e782d4629371a40b4863891ef02de2f89531b7cc11c181cf15a0aa32a4941b437ed63e7ae5d7608cc2311e6b18d8fa2c1cd7a3e2f3acd582e5f86dee57fdd060cd84ca07e472071390997e84fb8e68be71a12c7a8228520d993a9fae429fc85ad9438a23c1a7c6533f760683492af3c0f6602d038afcf554b50fe9b3fbb20f638e831bd59e6b67d3c2161883a3db1a319bd7f560fc20fc8a87f4ba18edeaf8c60c297350f8f436aa8fc2082f8cf8fe82a81e3b771c4991c8c418c4f26bfea2d562305a05769322331af88002f52f500de58a8bc09ceda7968fd4342ff707800198e8ac699d843ccb0d2a19cfaa7bf9c810c7c8103ff569ce642321ac5e990584242e834c3c9fffe742959743f1cf15590b4e7bdcfcba6f545151099260cc82151bb12c66ef816429005a67a5dee3d3b51348c05b56c01e75131cfa5c31b5a5594f1a1f53d5a5cdc4159258308668eeee414d92f5954db70e17e0fc5476ba094eada65c57b81ad1471a60bb596e27af2744b21792b4f8d0d2cf9690feec9e60b0524270d67bbb495e2b2c8f5eefeab5144ba994c383db85aa5dfbdfb6d53a4dc5bc44e1f03408b4dc8777fedf5cc8444188de2c1f9714c7114fed37ef6b72339d390335bf91b2bd558e858526aa0cfbc733559b97cf6bb5a56135e5c39bacc064121228f01534c0a5366a928aae7d88c209498c7bf47d446eeac349a5a69468048c9ab3c171304653be7b317b8e1cf228d4bce30f6884ecd937cffd72af2aeffc737df8491fec437ce59414c4d8946eefcdb18dc1dee393a8b0ee2ee9cb0c2e371e5f1690ff5bfb3bb9dbd21f2ea01e1d80bd35ac2bb4c6b84521cda7b9e2d19205120475767711942b44d183c75a184208792c7bb13d8556831aee3449bd4a14085ebf9f8d54d1aa1da316bfc3153b4e126e372ac0489af4c113af15e41cebc227d6d9c60981128c935aca6d8059a9cec439ee7c8c2016187db92bac07d4b470732323f2d563e475fea5234fee6d66e15fe9a6e96d9a0ba857f1870ff308d6d214cddcd4ca2a00852e6d18aaa05be6edb16658d6899ad26cb574546fbdd305a3c37066c2e0e353a4f9d0c65b9c82d5fdc4777d038badc001bca2a356113e5fa99151c9a9b6fe89137cefec5c340c2226c0473f62c6b70d74dadeb6c61fbcec17bc7add68d1bf47d8abae0e559ca5ec77e60145a00f14cdb8c5fbe5684cc74aa06eb56ace6592e87212247a8f2d2a513b9ad4a47c7af9ce15e93306d9c1f4b8c9edbb6d001c29e4335ac16a7dff9de25be10b1fff5231728a8eaf3c0dc2e95007133d47bef4c06d648e1ea881fc6a01e026d65fa8cd2a2c512716c60a0d745a4d6784222585a72d414c8283cda86ba80677032b5f50809fea288de317fe6935c40607597e3a3c1411be30cd60e4e8432f976d79785968ac8502dd1a604fc9ff07a0cd78b61b90d38972c3c35b013e1f6797a0ad7ebb02358a27537cdfc27bc22fc0cf52a68b780d16cffa45cbfe03b6e572725e62498de8564d7d440f082aefdaec87ff63a11f145b5bc8fba2fe87ef7fdfca99eacfaf180650ffb8c45a</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">想看我的秘密，需要密码呦༼ つ ◕_◕ ༽つ</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>fine</category>
      </categories>
      <tags>
        <tag>fine</tag>
        <tag>his</tag>
      </tags>
  </entry>
  <entry>
    <title>How do I understand target and currenttarget</title>
    <url>/archives/7d76407e.html</url>
    <content><![CDATA[<div class="tip bolt"><h4 id="currentTarget-和-target-的区别"><a href="#currentTarget-和-target-的区别" class="headerlink" title="currentTarget 和 target 的区别"></a>currentTarget 和 target 的区别</h4></div>
<p>event.currentTarget 和 event.target 都是 JavaScript 中处理事件的对象，它们之间的主要区别在于它们所指向的对象不同。</p>
<h4 id="event-currentTarget："><a href="#event-currentTarget：" class="headerlink" title="event.currentTarget："></a>event.currentTarget：</h4><p>event.currentTarget 代表绑定事件的元素，即事件监听器所绑定到的对象。当事件被触发时，event.currentTarget 引用的是监听器所绑定到的元素。在事件冒泡过程中，event.currentTarget 通常不会改变。</p>
<h4 id="event-target："><a href="#event-target：" class="headerlink" title="event.target："></a>event.target：</h4><p>event.target 代表触发事件的元素，在大多数情况下，event.target 和 event.currentTarget 是相同的，即事件被触发时，它们引用同一个元素对象。但在事件冒泡过程中，event.target 引用的是事件最开始触发的那个元素，而不是当前被处理的元素。在事件处理的过程中，event.target 可能会发生变化，具体取决于事件类型以及元素的结构。</p>
<p>例如，当用户在表单中输入文本时，event.currentTarget 引用的是绑定表单元素的事件监听器，而 event.target 引用的是当前发生变化的 <code>&lt;input&gt;</code> 或 <code>&lt;textarea&gt;</code> 元素。</p>
<p>而 event.currentTarget.value 和 event.target.value 的区别就在于它们所指向的对象不同，它们本质上都是表示事件对象中的一个属性。</p>
<p>event.currentTarget.value 表示当前绑定事件的元素的值，例如，如果绑定的是输入框的 change 事件，则 event.currentTarget.value 表示当前输入框中的值。</p>
<p>而 event.target.value 表示当前触发事件的元素的值，例如，如果用户在输入框中输入文本，event.target.value 表示输入框中的当前值。如果用户单击了 checkbox，event.target.value 表示 checkbox 的值（一般为 “on” 或 “off”）。</p>
<p>在实际开发中，了解 event.currentTarget 和 event.target 的区别，以及它们对应的属性，对于正确处理事件非常重要。</p>
<div class="note info simple"><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4></div>
<p>target 表示的是当前触发事件的 DOM 元素(事件触发的目标)。</p>
<p>currentTarget 表示引用事件侦听器正在侦听的 DOM 元素(事件的真实注册者)。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;ul <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;todo-list&quot;</span>&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span>Walk your dog<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;;</span><br><span class="line"><span class="keyword">const</span> list = <span class="built_in">document</span>.querySelector(<span class="string">&quot;.todo-list&quot;</span>);</span><br><span class="line"></span><br><span class="line">list.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(e.target);</span><br><span class="line">  <span class="comment">// Output: &lt;li class=&quot;item&quot;&gt;Walk your dog&lt;/li&gt;</span></span><br><span class="line">  <span class="built_in">console</span>.log(e.currentTarget);</span><br><span class="line">  <span class="comment">// Output: &lt;ul class=&quot;todo-list&quot;&gt;&lt;/ul&gt;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>chatbox</tag>
        <tag>target</tag>
        <tag>currentTarget</tag>
      </tags>
  </entry>
  <entry>
    <title>treeshaking</title>
    <url>/archives/47c3840f.html</url>
    <content><![CDATA[<h1 id="面试官：说说Vue-3-0中Treeshaking特性？举例说明一下？"><a href="#面试官：说说Vue-3-0中Treeshaking特性？举例说明一下？" class="headerlink" title="面试官：说说Vue 3.0中Treeshaking特性？举例说明一下？"></a>面试官：说说Vue 3.0中Treeshaking特性？举例说明一下？</h1><p> <img src="https://static.vue-js.com/5e8bf1d0-6097-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p><code>Tree shaking</code> 是一种通过清除多余代码方式来优化项目打包体积的技术，专业术语叫 <code>Dead code elimination</code></p>
<p>简单来讲，就是在保持代码运行结果不变的前提下，去除无用的代码</p>
<p>如果把代码打包比作制作蛋糕，传统的方式是把鸡蛋（带壳）全部丢进去搅拌，然后放入烤箱，最后把（没有用的）蛋壳全部挑选并剔除出去</p>
<p>而<code>treeshaking</code>则是一开始就把有用的蛋白蛋黄（import）放入搅拌，最后直接作出蛋糕</p>
<p>也就是说 ，<code>tree shaking</code> 其实是找出使用的代码</p>
<p>在<code>Vue2</code>中，无论我们使用什么功能，它们最终都会出现在生产代码中。主要原因是<code>Vue</code>实例在项目中是单例的，捆绑程序无法检测到该对象的哪些属性在代码中被使用到</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"> </span><br><span class="line">Vue.nextTick(<span class="function">() =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure>
<p>而<code>Vue3</code>源码引入<code>tree shaking</code>特性，将全局 API 进行分块。如果您不使用其某些功能，它们将不会包含在您的基础包中</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; nextTick, observable &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"> </span><br><span class="line">nextTick(<span class="function">() =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="二、如何做"><a href="#二、如何做" class="headerlink" title="二、如何做"></a>二、如何做</h2><p><code>Tree shaking</code>是基于<code>ES6</code>模板语法（<code>import</code>与<code>exports</code>），主要是借助<code>ES6</code>模块的静态编译思想，在编译时就能确定模块的依赖关系，以及输入和输出的变量</p>
<p><code>Tree shaking</code>无非就是做了两件事：</p>
<ul>
<li>编译阶段利用<code>ES6 Module</code>判断哪些模块已经加载</li>
<li>判断那些模块和变量未被使用或者引用，进而删除对应代码</li>
</ul>
<p>下面就来举个例子：</p>
<p>通过脚手架<code>vue-cli</code>安装<code>Vue2</code>与<code>Vue3</code>项目</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">vue create vue-demo</span><br></pre></td></tr></table></figure>
<h3 id="Vue2-项目"><a href="#Vue2-项目" class="headerlink" title="Vue2 项目"></a>Vue2 项目</h3><p>组件中使用<code>data</code>属性</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        data: () =&gt; (&#123;</span><br><span class="line">            count: 1,</span><br><span class="line">        &#125;),</span><br><span class="line">    &#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>对项目进行打包，体积如下图</p>
<p><img src="https://static.vue-js.com/6bd2aff0-6097-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>为组件设置其他属性（<code>compted</code>、<code>watch</code>）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">data</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">question</span>:<span class="string">&quot;&quot;</span>, </span><br><span class="line">        <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">computed</span>: &#123;</span><br><span class="line">        <span class="attr">double</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.count * <span class="number">2</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">watch</span>: &#123;</span><br><span class="line">        <span class="attr">question</span>: <span class="function"><span class="keyword">function</span> (<span class="params">newQuestion, oldQuestion</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.answer = <span class="string">&#x27;xxxx&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>再一次打包，发现打包出来的体积并没有变化</p>
<p><img src="https://static.vue-js.com/7c29e260-6097-11eb-ab90-d9ae814b240d.png" alt=""></p>
<h3 id="Vue3-项目"><a href="#Vue3-项目" class="headerlink" title="Vue3 项目"></a>Vue3 项目</h3><p>组件中简单使用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, defineComponent &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineComponent(&#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> state = reactive(&#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      state,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>将项目进行打包</p>
<p><img src="https://static.vue-js.com/95df0000-6097-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>在组件中引入<code>computed</code>和<code>watch</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, defineComponent, computed, watch &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineComponent(&#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> state = reactive(&#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">const</span> double = computed(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> state.count * <span class="number">2</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    watch(</span><br><span class="line">      <span class="function">() =&gt;</span> state.count,</span><br><span class="line">      <span class="function">(<span class="params">count, preCount</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(count);</span><br><span class="line">        <span class="built_in">console</span>.log(preCount);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      state,</span><br><span class="line">      double,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>再次对项目进行打包，可以看到在引入<code>computer</code>和<code>watch</code>之后，项目整体体积变大了</p>
<p> <img src="https://static.vue-js.com/b36a7a00-6097-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="三、作用"><a href="#三、作用" class="headerlink" title="三、作用"></a>三、作用</h2><p>通过<code>Tree shaking</code>，<code>Vue3</code>给我们带来的好处是：</p>
<ul>
<li>减少程序体积（更小）</li>
<li>减少程序执行时间（更快）</li>
<li>便于将来对程序架构进行优化（更友好）</li>
</ul>
]]></content>
      <categories>
        <category>vue3</category>
      </categories>
      <tags>
        <tag>vue3</tag>
        <tag>treeshaking</tag>
      </tags>
  </entry>
  <entry>
    <title>var_let_const</title>
    <url>/archives/eb05a173.html</url>
    <content><![CDATA[<h1 id="面试官：说说var、let、const之间的区别"><a href="#面试官：说说var、let、const之间的区别" class="headerlink" title="面试官：说说var、let、const之间的区别"></a>面试官：说说var、let、const之间的区别</h1><p><img src="https://static.vue-js.com/d2aba2e0-50f7-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、var"><a href="#一、var" class="headerlink" title="一、var"></a>一、var</h2><p>在ES5中，顶层对象的属性和全局变量是等价的，用<code>var</code>声明的变量既是全局变量，也是顶层变量</p>
<p>注意：顶层对象，在浏览器环境指的是<code>window</code>对象，在 <code>Node</code> 指的是<code>global</code>对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.a) <span class="comment">// 10</span></span><br></pre></td></tr></table></figure>
<p>使用<code>var</code>声明的变量存在变量提升的情况</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">20</span></span><br></pre></td></tr></table></figure>
<p>在编译阶段，编译器会将其变成以下执行</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a</span><br><span class="line"><span class="built_in">console</span>.log(a)</span><br><span class="line">a = <span class="number">20</span></span><br></pre></td></tr></table></figure>
<p>使用<code>var</code>，我们能够对一个变量进行多次声明，后面声明的变量会覆盖前面的变量声明</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">20</span> </span><br><span class="line"><span class="keyword">var</span> a = <span class="number">30</span></span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// 30</span></span><br></pre></td></tr></table></figure>
<p>在函数中使用使用<code>var</code>声明变量时候，该变量是局部的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">20</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">30</span></span><br><span class="line">&#125;</span><br><span class="line">change()</span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// 20 </span></span><br></pre></td></tr></table></figure>
<p>而如果在函数内不使用<code>var</code>，该变量是全局的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">20</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   a = <span class="number">30</span></span><br><span class="line">&#125;</span><br><span class="line">change()</span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// 30 </span></span><br></pre></td></tr></table></figure>
<h2 id="二、let"><a href="#二、let" class="headerlink" title="二、let"></a>二、let</h2><p><code>let</code>是<code>ES6</code>新增的命令，用来声明变量</p>
<p>用法类似于<code>var</code>，但是所声明的变量，只在<code>let</code>命令所在的代码块内有效</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// ReferenceError: a is not defined.</span></span><br></pre></td></tr></table></figure>
<p>不存在变量提升</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// 报错ReferenceError</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>这表示在声明它之前，变量<code>a</code>是不存在的，这时如果用到它，就会抛出一个错误</p>
<p>只要块级作用域内存在<code>let</code>命令，这个区域就不再受外部影响</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">123</span></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    a = <span class="string">&#x27;abc&#x27;</span> <span class="comment">// ReferenceError</span></span><br><span class="line">    <span class="keyword">let</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用<code>let</code>声明变量前，该变量都不可用，也就是大家常说的“暂时性死区”</p>
<p>最后，<code>let</code>不允许在相同作用域中重复声明</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">20</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">30</span></span><br><span class="line"><span class="comment">// Uncaught SyntaxError: Identifier &#x27;a&#x27; has already been declared</span></span><br></pre></td></tr></table></figure>
<p>注意的是相同作用域，下面这种情况是不会报错的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">20</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="number">30</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因此，我们不能在函数内部重新声明参数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> arg;</span><br><span class="line">&#125;</span><br><span class="line">func()</span><br><span class="line"><span class="comment">// Uncaught SyntaxError: Identifier &#x27;arg&#x27; has already been declared</span></span><br></pre></td></tr></table></figure>
<h2 id="三、const"><a href="#三、const" class="headerlink" title="三、const"></a>三、const</h2><p><code>const</code>声明一个只读的常量，一旦声明，常量的值就不能改变</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="number">1</span></span><br><span class="line">a = <span class="number">3</span></span><br><span class="line"><span class="comment">// TypeError: Assignment to constant variable.</span></span><br></pre></td></tr></table></figure>
<p>这意味着，<code>const</code>一旦声明变量，就必须立即初始化，不能留到以后赋值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a;</span><br><span class="line"><span class="comment">// SyntaxError: Missing initializer in const declaration</span></span><br></pre></td></tr></table></figure>
<p>如果之前用<code>var</code>或<code>let</code>声明过变量，再用<code>const</code>声明同样会报错</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">20</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">20</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="number">30</span></span><br><span class="line"><span class="keyword">const</span> b = <span class="number">30</span></span><br><span class="line"><span class="comment">// 都会报错</span></span><br></pre></td></tr></table></figure>
<p><code>const</code>实际上保证的并不是变量的值不得改动，而是变量指向的那个内存地址所保存的数据不得改动</p>
<p>对于简单类型的数据，值就保存在变量指向的那个内存地址，因此等同于常量</p>
<p>对于复杂类型的数据，变量指向的内存地址，保存的只是一个指向实际数据的指针，<code>const</code>只能保证这个指针是固定的，并不能确保改变量的结构不变</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为 foo 添加一个属性，可以成功</span></span><br><span class="line">foo.prop = <span class="number">123</span>;</span><br><span class="line">foo.prop <span class="comment">// 123</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将 foo 指向另一个对象，就会报错</span></span><br><span class="line">foo = &#123;&#125;; <span class="comment">// TypeError: &quot;foo&quot; is read-only</span></span><br></pre></td></tr></table></figure>
<p>其它情况，<code>const</code>与<code>let</code>一致</p>
<h2 id="四、区别"><a href="#四、区别" class="headerlink" title="四、区别"></a>四、区别</h2><p><code>var</code>、<code>let</code>、<code>const</code>三者区别可以围绕下面五点展开：</p>
<ul>
<li>变量提升</li>
<li>暂时性死区</li>
<li>块级作用域</li>
<li>重复声明</li>
<li>修改声明的变量</li>
<li>使用</li>
</ul>
<h3 id="变量提升"><a href="#变量提升" class="headerlink" title="变量提升"></a>变量提升</h3><p><code>var</code>声明的变量存在变量提升，即变量可以在声明之前调用，值为<code>undefined</code></p>
<p><code>let</code>和<code>const</code>不存在变量提升，即它们所声明的变量一定要在声明后使用，否则报错</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// var</span></span><br><span class="line"><span class="built_in">console</span>.log(a)  <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let </span></span><br><span class="line"><span class="built_in">console</span>.log(b)  <span class="comment">// Cannot access &#x27;b&#x27; before initialization</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const</span></span><br><span class="line"><span class="built_in">console</span>.log(c)  <span class="comment">// Cannot access &#x27;c&#x27; before initialization</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="number">10</span></span><br></pre></td></tr></table></figure>
<h3 id="暂时性死区"><a href="#暂时性死区" class="headerlink" title="暂时性死区"></a>暂时性死区</h3><p><code>var</code>不存在暂时性死区</p>
<p><code>let</code>和<code>const</code>存在暂时性死区，只有等到声明变量的那一行代码出现，才可以获取和使用该变量</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// var</span></span><br><span class="line"><span class="built_in">console</span>.log(a)  <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let</span></span><br><span class="line"><span class="built_in">console</span>.log(b)  <span class="comment">// Cannot access &#x27;b&#x27; before initialization</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const</span></span><br><span class="line"><span class="built_in">console</span>.log(c)  <span class="comment">// Cannot access &#x27;c&#x27; before initialization</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="number">10</span></span><br></pre></td></tr></table></figure>
<h3 id="块级作用域"><a href="#块级作用域" class="headerlink" title="块级作用域"></a>块级作用域</h3><p><code>var</code>不存在块级作用域</p>
<p><code>let</code>和<code>const</code>存在块级作用域</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// var</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(a)  <span class="comment">// 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> b = <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(b)  <span class="comment">// Uncaught ReferenceError: b is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> c = <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(c)  <span class="comment">// Uncaught ReferenceError: c is not defined</span></span><br></pre></td></tr></table></figure>
<h3 id="重复声明"><a href="#重复声明" class="headerlink" title="重复声明"></a>重复声明</h3><p><code>var</code>允许重复声明变量</p>
<p><code>let</code>和<code>const</code>在同一作用域不允许重复声明变量</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// var</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">20</span> <span class="comment">// 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">10</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">20</span> <span class="comment">// Identifier &#x27;b&#x27; has already been declared</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="number">10</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="number">20</span> <span class="comment">// Identifier &#x27;c&#x27; has already been declared</span></span><br></pre></td></tr></table></figure>
<h3 id="修改声明的变量"><a href="#修改声明的变量" class="headerlink" title="修改声明的变量"></a>修改声明的变量</h3><p><code>var</code>和<code>let</code>可以</p>
<p><code>const</code>声明一个只读的常量。一旦声明，常量的值就不能改变</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// var</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span></span><br><span class="line">a = <span class="number">20</span></span><br><span class="line"><span class="built_in">console</span>.log(a)  <span class="comment">// 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//let</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">10</span></span><br><span class="line">b = <span class="number">20</span></span><br><span class="line"><span class="built_in">console</span>.log(b)  <span class="comment">// 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="number">10</span></span><br><span class="line">c = <span class="number">20</span></span><br><span class="line"><span class="built_in">console</span>.log(c) <span class="comment">// Uncaught TypeError: Assignment to constant variable</span></span><br></pre></td></tr></table></figure>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>能用<code>const</code>的情况尽量使用<code>const</code>，其他情况下大多数使用<code>let</code>，避免使用<code>var</code></p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://es6.ruanyifeng.com/">https://es6.ruanyifeng.com/</a></li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>es6</tag>
        <tag>var_let_const</tag>
      </tags>
  </entry>
  <entry>
    <title>visual_scrolling</title>
    <url>/archives/9370d73f.html</url>
    <content><![CDATA[<h1 id="面试官：如何使用css完成视差滚动效果"><a href="#面试官：如何使用css完成视差滚动效果" class="headerlink" title="面试官：如何使用css完成视差滚动效果?"></a>面试官：如何使用css完成视差滚动效果?</h1><p> <img src="https://static.vue-js.com/1b2d33e0-a18d-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<h2 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h2><p>视差滚动（Parallax Scrolling）是指多层背景以不同的速度移动，形成立体的运动效果，带来非常出色的视觉体验</p>
<p>我们可以把网页解刨成：背景层、内容层、悬浮层</p>
<p> <img src="https://static.vue-js.com/57c942a0-a1cc-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>当滚动鼠标滑轮的时候，各个图层以不同的速度移动，形成视觉差的效果</p>
<p> <img src="https://static.vue-js.com/e57ab280-a1dd-11eb-ab90-d9ae814b240d.png" alt="image.png"></p>
<h2 id="二、实现方式"><a href="#二、实现方式" class="headerlink" title="二、实现方式"></a>二、实现方式</h2><p>使用<code>css</code>形式实现视觉差滚动效果的方式有：</p>
<ul>
<li>background-attachment</li>
<li>transform:translate3D</li>
</ul>
<h3 id="background-attachment"><a href="#background-attachment" class="headerlink" title="background-attachment"></a>background-attachment</h3><p>作用是设置背景图像是否固定或者随着页面的其余部分滚动</p>
<p>值分别有如下：</p>
<ul>
<li>scroll：默认值，背景图像会随着页面其余部分的滚动而移动</li>
<li>fixed：当页面的其余部分滚动时，背景图像不会移动</li>
<li>inherit：继承父元素background-attachment属性的值</li>
</ul>
<p>完成滚动视觉差就需要将<code>background-attachment</code>属性设置为<code>fixed</code>，让背景相对于视口固定。及时一个元素有滚动机制，背景也不会随着元素的内容而滚动</p>
<p>也就是说，背景一开始就已经被固定在初始的位置</p>
<p>核心的<code>css</code>代码如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">section</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.g-img</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">...</span>);</span><br><span class="line">    <span class="attribute">background-attachment</span>: fixed;</span><br><span class="line">    <span class="attribute">background-size</span>: cover;</span><br><span class="line">    <span class="attribute">background-position</span>: center center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>整体例子如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">7</span>);</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">line-height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">font-size</span>: <span class="number">20vh</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.a-img1</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">https://images.pexels.com/photos/1097491/pexels-photo-1097491.jpeg</span>);</span></span><br><span class="line"><span class="css">            <span class="attribute">background-attachment</span>: fixed;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-size</span>: cover;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-position</span>: center center;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.a-img2</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">https://images.pexels.com/photos/2437299/pexels-photo-2437299.jpeg</span>);</span></span><br><span class="line"><span class="css">            <span class="attribute">background-attachment</span>: fixed;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-size</span>: cover;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-position</span>: center center;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.a-img3</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">https://images.pexels.com/photos/1005417/pexels-photo-1005417.jpeg</span>);</span></span><br><span class="line"><span class="css">            <span class="attribute">background-attachment</span>: fixed;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-size</span>: cover;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-position</span>: center center;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a-text&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a-img1&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a-text&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a-img2&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a-text&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a-img3&quot;</span>&gt;</span>6<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;a-text&quot;</span>&gt;</span>7<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="transform-translate3D"><a href="#transform-translate3D" class="headerlink" title="transform:translate3D"></a>transform:translate3D</h3><p>同样，让我们先来看一下两个概念<code>transform</code>和<code>perspective</code>：</p>
<ul>
<li>transform: css3 属性，可以对元素进行变换(2d/3d)，包括平移 translate,旋转 rotate,缩放 scale,等等</li>
<li>perspective: css3 属性，当元素涉及 3d 变换时，perspective 可以定义我们眼睛看到的 3d 立体效果，即空间感</li>
</ul>
<p><code>3D</code>视角示意图如下所示：</p>
<p> <img src="https://static.vue-js.com/24f37dd0-a18d-11eb-85f6-6fac77c0c9b3.png" alt=""></p>
<p>举个例子：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">html</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100%</span></span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="comment">/* 视差元素的父级需要3D视角 */</span></span></span><br><span class="line"><span class="css">        <span class="attribute">perspective</span>: <span class="number">1px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d; </span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">overflow-y</span>: scroll;</span></span><br><span class="line"><span class="css">        <span class="attribute">overflow-x</span>: hidden;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#app</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100vw</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>:<span class="number">200vh</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>:skyblue;</span></span><br><span class="line"><span class="css">        <span class="attribute">padding-top</span>:<span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.one</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>:<span class="number">500px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>:<span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>:<span class="number">#409eff</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(<span class="number">0px</span>);</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-bottom</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.two</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>:<span class="number">500px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>:<span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>:<span class="number">#67c23a</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(-<span class="number">1px</span>);</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-bottom</span>: <span class="number">150px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.three</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>:<span class="number">500px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>:<span class="number">200px</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background</span>:<span class="number">#e6a23c</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(-<span class="number">2px</span>);</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-bottom</span>: <span class="number">150px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;one&quot;</span>&gt;</span>one<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;two&quot;</span>&gt;</span>two<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;three&quot;</span>&gt;</span>three<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>而这种方式实现视觉差动的原理如下：</p>
<ul>
<li><p>容器设置上 transform-style: preserve-3d 和 perspective: xpx，那么处于这个容器的子元素就将位于3D空间中，</p>
</li>
<li><p>子元素设置不同的 transform: translateZ()，这个时候，不同元素在 3D Z轴方向距离屏幕（我们的眼睛）的距离也就不一样</p>
</li>
<li><p>滚动滚动条，由于子元素设置了不同的 transform: translateZ()，那么他们滚动的上下距离 translateY 相对屏幕（我们的眼睛），也是不一样的，这就达到了滚动视差的效果</p>
</li>
</ul>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="https://imweb.io/topic/5b73ef73a56e07401e48729d">https://imweb.io/topic/5b73ef73a56e07401e48729d</a></li>
<li><a href="https://juejin.cn/post/6844903654458146823#heading-5">https://juejin.cn/post/6844903654458146823#heading-5</a></li>
</ul>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css面试</tag>
        <tag>visual_scrolling</tag>
      </tags>
  </entry>
  <entry>
    <title>react+ts规范化项目工程</title>
    <url>/archives/942a5c06.html</url>
    <content><![CDATA[<div class="tip warning faa-horizontal animated faa-fast"><h1 id="规范化创建-react-ts-项目工程"><a href="#规范化创建-react-ts-项目工程" class="headerlink" title="规范化创建 react+ts 项目工程"></a>规范化创建 react+ts 项目工程</h1></div>
<h2 id="01-创建应用"><a href="#01-创建应用" class="headerlink" title="01. 创建应用"></a>01. 创建应用</h2><blockquote>
<p>目标：创建支持 TypeScript 的 React 应用</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npx create-react-app geek-pc --template typescript</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install prettier</span><br></pre></td></tr></table></figure>
<h2 id="02-配置路径别名"><a href="#02-配置路径别名" class="headerlink" title="02. 配置路径别名"></a>02. 配置路径别名</h2><blockquote>
<p>目标：在支持 TypeScript 的项目中配置路径别名</p>
</blockquote>
<p>① 在应用的根目录下创建 tsconfig.paths.json 文件用于扩展 TS 配置选项，当前用于配置路径别名。</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;baseUrl&quot;</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;paths&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;@src/*&quot;</span>:[<span class="string">&quot;./src/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@shared/*&quot;</span>: [<span class="string">&quot;./src/shared/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@pages/*&quot;</span>: [<span class="string">&quot;./src/pages/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@store/*&quot;</span>:[<span class="string">&quot;./src/store/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@action_types/*&quot;</span>: [<span class="string">&quot;./src/store/types/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@actions/*&quot;</span>: [<span class="string">&quot;./src/store/actions/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@action_creators/*&quot;</span>: [<span class="string">&quot;./src/store/creators/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@reducers/*&quot;</span>: [<span class="string">&quot;./src/store/reducers/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@utils/*&quot;</span>: [<span class="string">&quot;./src/utils/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@requests/*&quot;</span>: [<span class="string">&quot;./src/requests/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@css/*&quot;</span>: [<span class="string">&quot;./src/assets/css/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;@image/*&quot;</span>: [<span class="string">&quot;./src/assets/image/*&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>② 在 tsconfig.json 文件中添加以下配置使用扩展配置文件生效</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;extends&quot;</span>: <span class="string">&quot;./tsconfig.paths.json&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③ 覆盖 CRA 默认配置使 webpack 能够支持解析路径别名 <a href="https://www.npmjs.com/package/react-app-rewired">react-app-rewired</a> <a href="https://github.com/oklas/react-app-alias">react-app-alias</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install react-app-rewired@2.2.1 react-app-alias@2.2.2 --save-dev</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// config-overrides.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; aliasWebpack &#125; = <span class="built_in">require</span>(<span class="string">&quot;react-app-alias&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">override</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> aliasWebpack()(config);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;react-app-rewired start&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;react-app-rewired build&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;react-app-rewired test&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="03-配置应用环境变量"><a href="#03-配置应用环境变量" class="headerlink" title="03. 配置应用环境变量"></a>03. 配置应用环境变量</h2><blockquote>
<p>目标：在 .env 文件中配置极客园 PC 端的 API 接口地址</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># .env.development</span></span><br><span class="line">REACT_APP_BASE_URL=http://toutiao.itheima.net/v1_0</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># .env.production</span></span><br><span class="line">REACT_APP_BASE_URL=http://toutiao.itheima.net/v1_0</span><br></pre></td></tr></table></figure>
<h2 id="04-配置-Redux-架构"><a href="#04-配置-Redux-架构" class="headerlink" title="04. 配置 Redux 架构"></a>04. 配置 Redux 架构</h2><blockquote>
<p>目标：配置 Redux 架构基础代码</p>
</blockquote>
<p>① 在项目中安装 redux、react-redux、redux-thunk、axios 以及 redux 开发者工具</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install redux@4.2.0 react-redux@8.0.4 redux-thunk@2.4.1 axios@1.1.3</span><br><span class="line">npm install @redux-devtools/extension@3.2.3 --save-dev</span><br></pre></td></tr></table></figure>
<p>② 创建用于保存用户信息的 userReducer、创建用于合并 reducer 函数的 rootReducer</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/reducers/userReducer.ts</span></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  <span class="comment">// 用于保存用户登录凭据</span></span><br><span class="line">  <span class="attr">credentials</span>: &#123;&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">userReducer</span>(<span class="params">state = initialState, action: <span class="built_in">any</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/reducers/rootReducer.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> userReducer <span class="keyword">from</span> <span class="string">&quot;@reducers/userReducer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootReducer = combineReducers(&#123; userReducer &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> rootReducer;</span><br></pre></td></tr></table></figure>
<p>③ 创建 store 对象、配置 redux-thunk、配置 redux 开发者工具</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; applyMiddleware, createStore &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; composeWithDevTools &#125; <span class="keyword">from</span> <span class="string">&quot;@redux-devtools/extension&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">&quot;@reducers/rootReducer&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> thunk, &#123; ThunkDispatch &#125; <span class="keyword">from</span> <span class="string">&quot;redux-thunk&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> middlewares = [thunk];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> enhancers =</span><br><span class="line">  process.env.NODE_ENV === <span class="string">&quot;production&quot;</span></span><br><span class="line">    ? applyMiddleware(...middlewares)</span><br><span class="line">    : composeWithDevTools(applyMiddleware(...middlewares));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Redux 状态对象的类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> AppState = ReturnType&lt;<span class="keyword">typeof</span> store.getState&gt;;</span><br><span class="line"><span class="comment">// 用于接收 Action 对象的 dispatch 方法的类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> AppDispatch = <span class="keyword">typeof</span> store.dispatch;</span><br><span class="line"><span class="comment">// 用于接收 Action 函数的 dispatch 方法的类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> AppThunkDispatch = ThunkDispatch&lt;</span><br><span class="line">  AppState,</span><br><span class="line">  <span class="built_in">any</span>,</span><br><span class="line">  Parameters&lt;AppDispatch&gt;[<span class="number">0</span>]</span><br><span class="line">&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(rootReducer, enhancers);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>
<p>④ 创建 AppStoreProvider 用于配置和 store 相关的功能</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/AppStoreProvider.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import &#123; Provider &#125; from &quot;react-redux&quot;;</span><br><span class="line">import store from &quot;@src/store&quot;;</span><br><span class="line"></span><br><span class="line">interface Props &#123;</span><br><span class="line">  children: React.ReactNode;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class AppStoreProvider extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;Provider store=&#123;store&#125;&gt;&#123;this.props.children&#125;&lt;/Provider&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/App.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import AppStoreProvider from &quot;@src/AppStoreProvider&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;AppStoreProvider&gt;Hello&lt;/AppStoreProvider&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>⑤ 配置 redux 持久化功能以持久化 userReducer</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install redux-persist@6.0.0</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/store/reducers/rootReducer.ts</span><br><span class="line">import &#123; persistReducer &#125; from &quot;redux-persist&quot;;</span><br><span class="line">import storage from &quot;redux-persist/lib/storage&quot;;</span><br><span class="line"></span><br><span class="line">const rootReducer = combineReducers(&#123;</span><br><span class="line">  userReducer: persistReducer(&#123; key: &quot;userReducer&quot;, storage &#125;, userReducer),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/AppStoreProvider.tsx</span><br><span class="line">import &#123; PersistGate &#125; from &quot;redux-persist/integration/react&quot;;</span><br><span class="line">import &#123; persistStore &#125; from &quot;redux-persist&quot;;</span><br><span class="line"></span><br><span class="line">// 调用该方法即可将 redux store 中的状态同步到目标位置</span><br><span class="line">const persistor = persistStore(store);</span><br><span class="line"></span><br><span class="line">export default class AppStoreProvider extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">        &lt;PersistGate persistor=&#123;persistor&#125;&gt;&#123;this.props.children&#125;&lt;/PersistGate&gt;</span><br><span class="line">      &lt;/Provider&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>⑥ 创建 Redux 架构中需要的其他目录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">src/store/types</span><br><span class="line">src/store/actions</span><br><span class="line">src/store/creators</span><br></pre></td></tr></table></figure>
<p>注意：由于 Git 不能跟踪空目录所以在以上文件夹中还要新建一个叫做 .gitkeep 的文件以使 git 可以跟踪以上目录。</p>
<h2 id="05-配置路由"><a href="#05-配置路由" class="headerlink" title="05. 配置路由"></a>05. 配置路由</h2><blockquote>
<p>目标：使应用程序支持路由功能</p>
</blockquote>
<p>① 下载 react-router-dom 路由库及对应的 TS 类型声明文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install react-router-dom@5.3.4</span><br><span class="line">npm install @types/react-router-dom@5.3.3 --save-dev</span><br></pre></td></tr></table></figure>
<p>② 创建登录页面组件用于测试路由功能</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/pages/loginPage/index.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default class LoginPage extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;div&gt;LoginPage works&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③ 配置登录页面组件的路由规则</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/AppRouter.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import &#123; Router, Redirect, Route, Switch &#125; from &quot;react-router-dom&quot;;</span><br><span class="line">import LoginPage from &quot;@pages/loginPage&quot;;</span><br><span class="line">import &#123; createBrowserHistory &#125; from &quot;history&quot;;</span><br><span class="line"></span><br><span class="line">export const history = createBrowserHistory();</span><br><span class="line"></span><br><span class="line">export default class AppRouter extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;Router history=&#123;history&#125;&gt;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">          &lt;Redirect from=&quot;/&quot; to=&quot;/login&quot; exact /&gt;</span><br><span class="line">          &lt;Route path=&quot;/login&quot; component=&#123;LoginPage&#125; /&gt;</span><br><span class="line">        &lt;/Switch&gt;</span><br><span class="line">      &lt;/Router&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="06-封装请求方法"><a href="#06-封装请求方法" class="headerlink" title="06. 封装请求方法"></a>06. 封装请求方法</h2><blockquote>
<p>目标：封装用于发送请求的 RequestManager 类</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios, &#123;</span><br><span class="line">  AxiosError,</span><br><span class="line">  AxiosInstance,</span><br><span class="line">  AxiosRequestConfig,</span><br><span class="line">  AxiosResponse,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@store/index&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; history &#125; <span class="keyword">from</span> <span class="string">&quot;@src/AppRouter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> requestInstance <span class="keyword">extends</span> AxiosInstance &#123;</span><br><span class="line">  request&lt;T, D&gt;(config: AxiosRequestConfig&lt;D&gt;): <span class="built_in">Promise</span>&lt;T&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestManager</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 单例对象</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> _singleton_object: <span class="literal">undefined</span> | RequestManager;</span><br><span class="line">  <span class="comment">// 用于保存 axios 实例对象的属性</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> _axios_instance: requestInstance;</span><br><span class="line">  <span class="comment">// 创建私有构造函数防止外部创建类实例</span></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 创建 axios 实例对象, 配置请求基准地址</span></span><br><span class="line">    <span class="built_in">this</span>._axios_instance = axios.create(&#123;</span><br><span class="line">      <span class="attr">baseURL</span>: process.env.REACT_APP_BASE_URL,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 请求拦截器: 身份验证</span></span><br><span class="line">    <span class="built_in">this</span>._axios_instance.interceptors.request.use(<span class="built_in">this</span>._authentication);</span><br><span class="line">    <span class="comment">// 响应拦截器: 获取服务端响应状态</span></span><br><span class="line">    <span class="built_in">this</span>._axios_instance.interceptors.response.use(</span><br><span class="line">      <span class="built_in">this</span>._getServerResponse,</span><br><span class="line">      <span class="built_in">this</span>._unauthorized</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 用于获取单例对象的静态方法</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">get</span> <span class="title">instance</span>() &#123;</span><br><span class="line">    <span class="comment">// 如果单例对象不存在</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> RequestManager._singleton_object === <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// 创建单例对象</span></span><br><span class="line">      RequestManager._singleton_object = <span class="keyword">new</span> RequestManager();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回单例对象</span></span><br><span class="line">    <span class="keyword">return</span> RequestManager._singleton_object;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 身份验证</span></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="title">_authentication</span>(<span class="params">config: AxiosRequestConfig</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 获取状态对象</span></span><br><span class="line">    <span class="keyword">const</span> state = store.getState();</span><br><span class="line">    <span class="comment">// 获取身份验证标识 token 字符串</span></span><br><span class="line">    <span class="keyword">const</span> token = state.userReducer.credentials.token;</span><br><span class="line">    <span class="comment">// 如果本地存在 token, 将 token 添加至请求头</span></span><br><span class="line">    <span class="keyword">if</span> (token &amp;&amp; config.headers)</span><br><span class="line">      config.headers.Authorization = <span class="string">`Bearer <span class="subst">$&#123;token&#125;</span>`</span>;</span><br><span class="line">    <span class="comment">// 返回配置</span></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 获取服务端响应状态</span></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="title">_getServerResponse</span>(<span class="params">response: AxiosResponse</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> response.data;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 未授权</span></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="title">_unauthorized</span>(<span class="params">error: unknown</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error <span class="keyword">instanceof</span> AxiosError) &#123;</span><br><span class="line">      <span class="keyword">if</span> (error.response?.status === <span class="number">401</span>) &#123;</span><br><span class="line">        <span class="comment">// 临时 逻辑后续补充</span></span><br><span class="line">        history.replace(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 传递错误状态</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 外部用于发送请求的方法</span></span><br><span class="line">  <span class="keyword">public</span> request&lt;T = <span class="built_in">any</span>, D = <span class="built_in">any</span>&gt;(config: AxiosRequestConfig&lt;D&gt;): <span class="built_in">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._axios_instance.request&lt;T, D&gt;(config);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>ts</tag>
        <tag>project</tag>
      </tags>
  </entry>
  <entry>
    <title>ts报错解决持续更新</title>
    <url>/archives/77971af0.html</url>
    <content><![CDATA[<div class="tip ban"><h4 id="index-ts-4-3-error-TS2584-Cannot-find-name-‘console’"><a href="#index-ts-4-3-error-TS2584-Cannot-find-name-‘console’" class="headerlink" title="index.ts:4:3 - error TS2584: Cannot find name ‘console’"></a>index.ts:4:3 - error TS2584: Cannot find name ‘console’</h4></div>
<p>Cannot find name ‘console’ 或者没有console就直接没反应</p>
<ul>
<li>原文地址: <a href="https://blog.csdn.net/weixin_50336155/article/details/120345624">https://blog.csdn.net/weixin_50336155/article/details/120345624</a></li>
</ul>
<p><img src="https://files.catbox.moe/uoz66n.png" alt=""></p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">// 1. 删掉原来的包</span><br><span class="line">npm uninstall ts-node -g</span><br><span class="line">// 2. 下载指定的包(这个版本试了是可以的)</span><br><span class="line">npm i -g ts-node@8.5.4</span><br></pre></td></tr></table></figure>
<hr>
]]></content>
      <categories>
        <category>typeScript</category>
      </categories>
      <tags>
        <tag>typeScript</tag>
        <tag>ts报错解决持续更新</tag>
      </tags>
  </entry>
  <entry>
    <title>my notes</title>
    <url>/archives/97a9ab5c.html</url>
    <content><![CDATA[<div class="tip warning faa-horizontal animated faa-fast"><p>持续更新，记录学习中的历程，愿诸位更优秀</p>
</div>
<div class="tag link"><a class="link-card" title="前往woli" href="https://www.wolai.com/freeleader/gSPp69Mq9Aqu16TUwKzHku"><div class="left"><img src="/img/header.svg"/></div><div class="right"><p class="text">前往woli</p><p class="url">https://www.wolai.com/freeleader/gSPp69Mq9Aqu16TUwKzHku</p></div></a></div>
<div class='checkbox blue checked'><input type="checkbox" checked="checked"/>
            <p>选用woli，记录学习中的笔记，更方便，效率更高</p>
            </div>
<div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>
            <p>部分截图如下</p>
            </div>
<p><a href="https://imgse.com/i/ppwc9W8"><img src="https://s1.ax1x.com/2023/03/23/ppwc9W8.png" alt="ppwc9W8.png"></a></p>
]]></content>
      <categories>
        <category>notes</category>
      </categories>
  </entry>
  <entry>
    <title>vue项目部署</title>
    <url>/archives/b51bdcfa.html</url>
    <content><![CDATA[<hr>
<div class="tip bolt"><h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4></div>
<ul>
<li><p>服务器&#x20;</p>
</li>
<li><p>完整的vue项目</p>
</li>
</ul>
<div class="tip key"><h4 id="整体流程描述"><a href="#整体流程描述" class="headerlink" title="整体流程描述"></a>整体流程描述</h4></div>
<ul>
<li><p>打包自己的vue项目，并生成dist文件，并且压缩</p>
</li>
<li><p>服务器配置好宝塔面板</p>
</li>
<li><p>配置域名泛解析（目的为了添加更多的项目）</p>
</li>
<li><p>上传至服务器</p>
</li>
<li><p>配置nginx管理</p>
</li>
<li><p>完成发布</p>
</li>
</ul>
<div class="tip warning faa-horizontal animated faa-fast"><h4 id="服务器配置宝塔"><a href="#服务器配置宝塔" class="headerlink" title="服务器配置宝塔"></a>服务器配置宝塔</h4></div>
<ul>
<li><p>如果不会打包项目，就不用向下看了</p>
<p><img src="https://s1.ax1x.com/2022/06/16/XHtMrj.png" alt=""></p>
<p><img src="https://s1.ax1x.com/2022/06/16/XHt8I0.png" alt=""></p>
<ul>
<li>宝塔地址&#x20;</li>
</ul>
<p><a href="https://www.bt.cn/new/download.html">https://www.bt.cn/new/download.html</a></p>
<p><img src="https://s1.ax1x.com/2022/06/16/XHtNzF.png" alt=""></p>
<ul>
<li><p>根据自己的服务器选择对应的命令回车</p>
</li>
<li><p>之后安装完毕之后会有账号密码，记得保存，记得保存</p>
</li>
<li><p>在地址栏输入自己的公网ip+:端口8888</p>
</li>
</ul>
<p><img src="https://s1.ax1x.com/2022/06/16/XHtgzD.png" alt=""></p>
<ul>
<li>宝塔安装完毕</li>
</ul>
</li>
</ul>
<div class="tip warning faa-parent animated-hover"><p class="faa-horizontal"> #### 域名添加泛解析记录值</p></div>
<p><img src="https://s1.ax1x.com/2022/06/16/XHtRQe.png" alt=""></p>
<p><img src="https://s1.ax1x.com/2022/06/16/XHt5dI.png" alt=""></p>
<h4 id="上传至服务器"><a href="#上传至服务器" class="headerlink" title="上传至服务器"></a>上传至服务器</h4><ul>
<li>点击网站</li>
</ul>
<p><img src="https://s1.ax1x.com/2022/06/16/XHtHW8.png" alt=""></p>
<ul>
<li><p>比如 mm.freelaeder.cn   mm就是泛解析的前缀</p>
</li>
<li><p>来到文件</p>
</li>
</ul>
<p><img src="https://s1.ax1x.com/2022/06/16/XHtXLj.png" alt=""></p>
<ul>
<li>浏览器输入如果出现这个，代表即将成功</li>
</ul>
<p><img src="https://s1.ax1x.com/2022/06/16/XHtxwn.png" alt=""></p>
<ul>
<li>接着将你的vue传到该文件夹下面</li>
</ul>
<h4 id="配置nginx"><a href="#配置nginx" class="headerlink" title="配置nginx"></a>配置nginx</h4><p><img src="https://s1.ax1x.com/2022/06/16/XHNpF0.png" alt=""></p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">location</span> / &#123; <span class="attribute">try_files</span> $uri $uri/ /index.html; &#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2022/06/16/XHNiSU.png" alt=""></p>
<h4 id="发布服务器之后，刷新页面404解决"><a href="#发布服务器之后，刷新页面404解决" class="headerlink" title="发布服务器之后，刷新页面404解决"></a>发布服务器之后，刷新页面404解决</h4><ul>
<li>刷新页面404的原因</li>
</ul>
<ul>
<li><a href="http://www.javashuo.com/article/p-gnqdvhvr-bp.html">http://www.javashuo.com/article/p-gnqdvhvr-bp.html</a></li>
<li><a href="https://blog.csdn.net/weixin_40648700/article/details/114117846?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1-114117846-blog-124570408.pc_relevant_default&amp;spm=1001.2101.3001.4242.2&amp;utm_relevant_index=4">https://blog.csdn.net/weixin_40648700/article/details/114117846?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1-114117846-blog-124570408.pc_relevant_default&amp;spm=1001.2101.3001.4242.2&amp;utm_relevant_index=4</a></li>
</ul>
]]></content>
      <categories>
        <category>vue3</category>
      </categories>
      <tags>
        <tag>vue3</tag>
        <tag>vue项目部署</tag>
      </tags>
  </entry>
  <entry>
    <title>vue</title>
    <url>/archives/c0add594.html</url>
    <content><![CDATA[<p>[tag]vue是什么[/tag]</p>
<ul>
<li>官网介绍|地址：<a href="https://cn.vuejs.org/v2/guide/">https://cn.vuejs.org/v2/guide/</a></li>
<li><strong>Vue (读音 /vjuː/，类似于 view) 是一套用于构建用户界面的渐进式框架。</strong></li>
<li>与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。</li>
<li>Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。</li>
<li>另一方面，当与现代化的工具链以及各种支持类库结合使用时，Vue 也完全能够为复杂的单页应用提供驱动。</li>
<li>视频来自官网。<br>!!!<br><video src="//freelaeder.cn//usr/themes/Mirages/images/default/video/vue.mp4" controls="controls" poster="//freelaeder.cn//usr/themes/Mirages/images/default/img/vs1.png"    playsinline></video><br>!!!</li>
</ul>
<span id="more"></span>
<p>[hint]vue全家桶[/hint]<br>[tag outline]1渐进式框架[/tag]</p>
<ul>
<li>vue是一套构建用户界面的渐进式框架，采用自底向上增量开发的设计。</li>
<li>vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整。</li>
<li>渐进式表现：声明式渲染—组件系统—客户端路由—大数据状态管理—构建工具.</li>
</ul>
<p>[tag type=”primary” outline]2、两个核心点[/tag]</p>
<ul>
<li>（1）响应式数据绑定当数据发生变化的时候，视图自动更新，即双向数据同步，</li>
<li>原理利用了ES6中的 Object.definedProperty 中的setter/getter 代理数据，监控对数据的操作。</li>
<li>（2）组合的视图组件即页面最终映射为一个组件树，采用树形数据结构进行设计，方便维护，重用。</li>
</ul>
<p>[tag type=”info” outline]3、虚拟DOM[/tag]</p>
<ul>
<li>利用在内存中生成与真实DOM与之对应的数据结构，这个在内存中生成的结构称之为虚拟DOM。</li>
<li>当数据发生变化时，能够智能的计算出重新渲染组件的最小代价并应用到DOM操作上。</li>
</ul>
<p>[tag type=”warn” outline]4、MVVM[/tag]</p>
<ul>
<li>MVVM 是 Model-View-ViewModel 的缩写，它是一种基于前端开发的架构模式;</li>
<li>其核心是提供对 View 和 ViewModel 的双向数据绑定，</li>
<li>这使得 ViewModel 的状态改变可以自动传递给 View，即所谓的数据双向绑定。</li>
<li>M：Model（数据层，也就是指数据（前端是js））</li>
<li>V：View ( 也就是指DOM层 或用户界面 )</li>
<li>VM : ViewModel (处理数据和界面的中间层，也就是指Vue)<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/mvv.png" alt="请输入图片描述"></li>
</ul>
<p>[tag type=”danger” outline]5、声明式渲染[/tag]</p>
<ul>
<li>Vue.js 的核心是一个允许采用简洁的模板语法来声明式地将数据渲染进 DOM 的系统。</li>
<li>额外补充：</li>
<li>渲染分为：命令式渲染和声明式渲染</li>
<li>命令式渲染：命令我们的程序去做什么，程序就会跟着你的命令去一步一步执行</li>
<li>声明式渲染 ：只需要告诉程序想要什么效果，其他的交给程序来做</li>
<li><p>具体区别看如下代码，执行结果一样，实现方式不同。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 命令式渲染：关心每步，关心流程，用命令去实现</span></span><br><span class="line">    <span class="keyword">var</span> newArr = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">        newArr.push(arr[i] * <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(newArr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 声明式渲染：不关心中间流程，只需要关心结果和实现条件</span></span><br><span class="line">    <span class="keyword">var</span> arr1 = arr.map(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> item*<span class="number">2</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(arr1);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>vue全家桶转自梁兴文</strong>原文地址：<a href="http://doc.liangxinghua.com/vue-family/1.html">http://doc.liangxinghua.com/vue-family/1.html</a></p>
</li>
</ul>
<p>[tag type=”success” outline=”1”]vue.js安装[/tag]</p>
<ul>
<li>1，CDN引入</li>
<li>开发环境版本，包含了有帮助的命令行警告。</li>
<li><script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script></li>
<li>生产环境版本，优化了尺寸和速度</li>
<li><script src="https://cdn.jsdelivr.net/npm/vue"></script></li>
<li>2下载和引入</li>
<li>开发环境<br>[file href=”//freelaeder.cn//usr/themes/Mirages/images/default/data/vue.js”]开发环境下载[/file]</li>
<li>生产环境<br>[file href=”//freelaeder.cn//usr/themes/Mirages/images/default/data/vue.min.js”]生产环境下载[/file]</li>
<li>3 NPM安装</li>
<li><h1 id="最新稳定版-npm-install-vue"><a href="#最新稳定版-npm-install-vue" class="headerlink" title="最新稳定版  $ npm install vue"></a>最新稳定版  $ npm install vue</h1></li>
<li><strong>vue生命周期源码</strong></li>
<li>debug开发版本|release 发布版本<br>[file href=”//freelaeder.cn//usr/themes/Mirages/images/default/data/vue-2.6.12.zip”]vue生命周期源码[/file]</li>
</ul>
<hr>
<p>[tag type=”primary”]hello vue[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">      &#123;&#123;message&#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;!-- 显示内容：你好，vue --&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;uls&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in movies&quot;</span>&gt;</span> &#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">  &lt;!-- 显示内容  &#123;&#123;message&#125;&#125;，原因：没有挂载元素--&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span>  &lt;!-- 引入文件 --&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">// 元素js做法，编程范式：命令时编程</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">// const (常量，没有作用域)；let(变量)</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">//vue 编程范式:声明式编程</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>, <span class="comment">/* 用于挂载要管理的元素 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">data</span>: &#123; <span class="comment">/* 定义数据 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">              <span class="attr">message</span>: <span class="string">&#x27;你好，vue&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">          &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">const</span> ul = <span class="keyword">new</span> Vue(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">el</span>: <span class="string">&#x27;.uls&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">data</span> :&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">              <span class="attr">movies</span>:[<span class="string">&#x27;你的婚礼&#x27;</span>,<span class="string">&#x27;大话西游&#x27;</span>,<span class="string">&#x27;盗梦空间&#x27;</span>,<span class="string">&#x27;怦然心动&#x27;</span>]</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v1.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v3.png" alt="请输入图片描述"></p>
<hr>
<p>[tag type=”info”]计数器[/tag]</p>
<ul>
<li>v-on 指令，（监听事件）</li>
<li>methods，（定义方法）<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/vues5.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/vues6.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/vues4.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/on2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/on3.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/on4.png" alt="请输入图片描述"><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>当前数量:&#123;&#123;conun&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;conun++&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;conun--&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  &lt;hr&gt;&lt;br&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;add&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;sub&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;br&gt;</span><br><span class="line">  &lt;!-- 语法糖@click-&gt;v-on:click --&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;add&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;sub&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">data</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">conun</span>: <span class="number">0</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">add</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// this 表示当前对象</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="built_in">this</span>.conun++;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="built_in">console</span>.log(<span class="string">&#x27;add执行&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">sub</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="built_in">this</span>.conun--;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="built_in">console</span>.log(<span class="string">&#x27;sub执行&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
[collapse title=”on参数问题”]<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    li &#123;</span><br><span class="line">      list-style: none;</span><br><span class="line">      width: 300px;</span><br><span class="line">      height: 40px;</span><br><span class="line">      line-height: 40px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      background: aqua;</span><br><span class="line">      margin-bottom: 10px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .active &#123;</span><br><span class="line">      color: red;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .font &#123;</span><br><span class="line">      font-size: 33px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [v-cloak] &#123;</span><br><span class="line">      display: none;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h2&gt;&#123;&#123;count&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button v-on:click=&#x27;increment&#x27;&gt;add&lt;/button&gt;</span><br><span class="line">    &lt;button v-on:click=&#x27;decrement&#x27;&gt;decr&lt;/button&gt;</span><br><span class="line">    &lt;!-- 语法糖 @ --&gt;</span><br><span class="line">    &lt;button @click=&#x27;increment&#x27;&gt;+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&#x27;decrement&#x27;&gt;-&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- v-on参数 --&gt;</span><br><span class="line">    &lt;!-- 事件调用没有参数 --&gt;</span><br><span class="line">    &lt;button @click=&#x27;btn1Click&#x27;&gt;按钮1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&#x27;btn1Click()&#x27;&gt;按钮2&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 在事件定义时，省略小括号，但方法本身需要一个参数 --&gt;</span><br><span class="line">    &lt;!-- &lt;button @click=&#x27;btn2Click(event)&#x27;&gt;按钮3&lt;/button&gt; --&gt;</span><br><span class="line">    &lt;button @click=&#x27;btn2Click&#x27;&gt;按钮3&lt;/button&gt;</span><br><span class="line">    &lt;!--btn2 MouseEvent &#123;isTrusted: true, screenX: 283, screenY: 188, clientX: 274, clientY: 52, …&#125;  --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;button @click=&#x27;btn2Click(123)&#x27;&gt;按钮3.1&lt;/button&gt;</span><br><span class="line">    &lt;!-- btn2 123 --&gt;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    &lt;button @click=&#x27;btn2Click()&#x27;&gt;按钮3.2&lt;/button&gt;</span><br><span class="line">    &lt;!-- btn2 undefined --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 我们需要参数，又需要event --&gt;</span><br><span class="line">    &lt;!-- 在调用参数时，如何手动获取浏览器参数中的event对象  ： $event --&gt;</span><br><span class="line">    &lt;button @click=&#x27;btn3Click(123,event)&#x27;&gt;按钮4.1&lt;/button&gt;</span><br><span class="line">    &lt;!--  报错&quot;event&quot; is not defined on the instance but   123  ,  undefined===event--&gt;</span><br><span class="line"></span><br><span class="line">    &lt;button @click=&#x27;btn3Click(123,$event)&#x27;&gt;按钮4.2&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;script src=&quot;./js/vue.js&quot;&gt;&lt;/script&gt; &lt;!-- 引入文件 --&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    const app = new Vue(&#123;</span><br><span class="line">      el: &#x27;#app&#x27;, /* 用于挂载要管理的元素 */</span><br><span class="line">      data: &#123; /* 定义数据 */</span><br><span class="line">        message: &#x27;你好，vue&#x27;,</span><br><span class="line">        count: 0,</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        // es6 增强写法</span><br><span class="line"></span><br><span class="line">        increment() &#123;</span><br><span class="line">          this.count++;</span><br><span class="line">        &#125;,</span><br><span class="line">        decrement() &#123;</span><br><span class="line">          this.count--;</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        btn1Click() &#123;</span><br><span class="line">          console.log(&#x27;btn1&#x27;);</span><br><span class="line">        &#125;,</span><br><span class="line">        // abc等于event对象</span><br><span class="line">        //  vue-devtools  Detected Vue v2.6.12 </span><br><span class="line">        // 3v-on基本使用.html:80 btn2 MouseEvent &#123;isTrusted: true, screenX: 280, screenY: 181, clientX: 271, clientY: 46, …&#125;</span><br><span class="line">        btn2Click(abc) &#123;</span><br><span class="line">          console.log(&#x27;btn2&#x27;, abc);</span><br><span class="line">        &#125;,</span><br><span class="line">        btn3Click(abc,event)&#123;</span><br><span class="line">          console.log(abc);</span><br><span class="line">          console.log(event);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &#125;,</span><br><span class="line">      // 计算属性（）,</span><br><span class="line">      computed: &#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
[/collapse] </li>
</ul>
<p>[tag type=”warn”]深入mvvm[/tag]</p>
<ul>
<li>废话不说，直接上图@(胜利)</li>
<li>官网图片：</li>
<li><strong>三个阶段转自梁文兴，</strong>原文地址：<a href="http://doc.liangxinghua.com/vue-family/1.3.html">http://doc.liangxinghua.com/vue-family/1.3.html</a></li>
<li>阶段一：创建和挂载</li>
<li>beforecreated：el 和 data 并未初始化</li>
<li>created：完成了 data 数据的初始化，el没有</li>
<li>beforeMount：完成了 el 和 data 初始化</li>
<li>mounted ：完成挂载</li>
<li>阶段二：更新</li>
<li>在chrome console执行以下命令：</li>
<li>app.message= ‘yes !! I do’;</li>
<li>beforeUpdate：虚拟DOM中根据data变化去更新html</li>
<li>updated：将虚拟DOM更新完成的HTML更新到页面中</li>
<li>阶段三：销毁</li>
<li>在chrome console执行以下命令：</li>
<li>app.$destroy();</li>
<li>beforeDestroy：销毁之前调用</li>
<li>destroyed：销毁之后调用，之后再执行app.me</li>
</ul>
<hr>
<ul>
<li>| <strong>阶段</strong> | <strong>方法名</strong>    | <strong>方法名</strong> |<br>| ———— | ——————- | ————— |<br>| 初始化   | beforeCreate  | created    |<br>| 挂载     | beforeMount   | mounted    |<br>| 更新     | beforeUpdate  | updated    |<br>| 销毁     | beforeDestroy | destroyed  |</li>
</ul>
<p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/lifes.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/vs2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/l5.png" alt="请输入图片描述"></p>
<hr>
<p>[tag type=”info”]axios基本使用[/tag]<br> <figure class="highlight js"><table><tr><td class="code"><pre><span class="line">axios(&#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;请求方式&#x27;</span>, <span class="comment">// get post</span></span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;请求地址&#x27;</span>,</span><br><span class="line">  <span class="attr">data</span>: &#123;    <span class="comment">// 拼接到请求体的参数,  post请求的参数</span></span><br><span class="line">    <span class="attr">xxx</span>: xxx,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">params</span>: &#123;  <span class="comment">// 拼接到请求行的参数, get请求的参数</span></span><br><span class="line">   	<span class="attr">xxx</span>: xxx </span><br><span class="line">  &#125;</span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res.data) <span class="comment">// 后台返回的结果</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(err) <span class="comment">// 后台报错返回</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<ul>
<li>_axios基本使用-全局配置 (main.js)</li>
<li>下载axios yarn add axios || npm install axios</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 配置axios</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="comment">// 基本地址</span></span><br><span class="line">axios.defaults.baseURL =<span class="string">&#x27;https://www.escook.cn&#x27;</span></span><br><span class="line">Vue.prototype.$axios =axios</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">created () &#123;</span><br><span class="line">   <span class="built_in">this</span>.$axios(&#123;</span><br><span class="line">     <span class="attr">url</span>:<span class="string">&#x27;/api/cart&#x27;</span></span><br><span class="line">   &#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(res);</span><br><span class="line">     <span class="built_in">this</span>.list = res.data.list</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="built_in">this</span>.list);</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
<p>[tag type=”danger”]v-once指令[/tag]</p>
<ul>
<li>mustanche 语法双大扩号</li>
<li>v-once 数据不会更改</li>
<li>只显示DOM第一次渲染的值·不会更改</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> &lt;h2&gt;&#123;&#123;message&#125;&#125;&lt;/h2&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-once</span>&gt;</span>&#123;&#123;message&#125;&#125;，没猜到吧！ <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">&lt;!-- 数据不会更改，v-once --&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>v-html .会将string的html解析出来并进行渲染</li>
<li>用于输出html代码</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;h2 v-html=<span class="string">&quot;url&quot;</span>&gt;&lt;/h2&gt;</span><br><span class="line">  data: &#123; <span class="comment">/* 定义数据 */</span></span><br><span class="line">               <span class="attr">message</span>: <span class="string">&#x27;你好，vue&#x27;</span>,</span><br><span class="line">               <span class="attr">url</span>: <span class="string">&#x27;&lt;a href=&quot;http://www.baidu.com&quot;&gt;百度&lt;/a&gt;&#x27;</span>,</span><br><span class="line">           &#125;,</span><br></pre></td></tr></table></figure>
<ul>
<li>v-text  不会输出h3中的文字</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-text</span>=<span class="string">&quot;message&quot;</span>&gt;</span>只有我一个<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- ：只有我一个被覆盖,不会现实 --&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>v-pre  内容不会做任何解析<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-pre</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>v-bind指令  语法糖  ：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 语法错误 mustache 内容书写--&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- &lt;img src=&quot;&#123;&#123;imgurl&#125;&#125;&quot; alt=&quot;&quot;&gt; --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-bind:src</span>=<span class="string">&quot;imgUrl&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- v-bind动态绑定属性 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">v-bind:href</span>=<span class="string">&quot;aHref&quot;</span>&gt;</span>baidu<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 语法糖写法 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">:href</span>=<span class="string">&quot;aHref&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;./js/vue.js&quot;</span>&gt;&lt;/script&gt; &lt;!-- 引入文件 --&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">//v-bind指令· 语法糖 ：</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>, <span class="comment">/* 用于挂载要管理的元素 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">data</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">              <span class="attr">aHref</span>: <span class="string">&#x27;https://www.baidu.com&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">              <span class="attr">imgUrl</span>: <span class="string">&#x27;https://img30.360buyimg.com/babel/s1180x940_jfs/t1/185487/25/2729/188978/609512cdE026eaa3e/873ee4de4f1e2a0c.jpg.webp&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            </span></span></span><br><span class="line"><span class="javascript"><span class="xml">          &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">         </span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>v-cloak 搭配css使用</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">  <span class="comment">&lt;!-- VUE解析之前，div有一个属性v-cloak --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- vue解析之后 ,div没有一个属性v-cloak--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-attr">[v-cloak]</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="comment">/* 斗篷 */</span></span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span> <span class="attr">v-cloak</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>[tag type=”success”]动态赋值class[/tag]</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">       <span class="selector-tag">img</span> &#123;</span></span><br><span class="line"><span class="css">           <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="css">           <span class="attribute">height</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="css">       &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">       <span class="selector-class">.active</span> &#123;</span></span><br><span class="line"><span class="css">           <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="css">       &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">       <span class="selector-class">.line</span> &#123;</span></span><br><span class="line"><span class="css">           <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="css">           <span class="attribute">width</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="css">           <span class="attribute">height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="css">           <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="css">           <span class="attribute">line-height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="css">           <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">           <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="css">       &#125;</span></span><br><span class="line"><span class="css">   </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- v-bind动态绑定class flase不显示。 --&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- &lt;h2 :class=&quot;&#123;类名1：ture,类名2：false&#125;&quot;&gt;&#123;&#123;message&#125;&#125;&lt;/h2&gt; --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&quot;&#123;active : isactive,line : isline&#125;&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&quot;getClass()&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&#x27;btnClick&#x27;</span>&gt;</span></span><br><span class="line">           click</span><br><span class="line">       <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                                 <span class="comment">&lt;!--没有单引号，是变量，  --&gt;</span></span><br><span class="line">                                 <span class="comment">&lt;!--有单引号，是字符串，  --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;[active,line]&quot;</span>&gt;</span>数字<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;./js/vue.js&quot;</span>&gt;&lt;/script&gt; &lt;!-- 引入文件 --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//v-bind指令· 语法糖 ：</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>, <span class="comment">/* 用于挂载要管理的元素 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">data</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">aHref</span>: <span class="string">&#x27;https://www.baidu.com&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">imgUrl</span>: <span class="string">&#x27;https://img30.360buyimg.com/babel/s1180x940_jfs/t1/185487/25/2729/188978/609512cdE026eaa3e/873ee4de4f1e2a0c.jpg.webp&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">message</span>: <span class="string">&#x27;你好哦&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">isactive</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">isline</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">active</span>:<span class="string">&#x27;aaaa&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">line</span>:<span class="string">&#x27;bbbb&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">btnClick</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    <span class="comment">// alert(&#x27;click被点击&#x27;)</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    <span class="built_in">this</span>.isactive = !<span class="built_in">this</span>.isactive;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    <span class="built_in">this</span>.isline = !<span class="built_in">this</span>.isline;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">getClass</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                        <span class="attr">active</span>: <span class="built_in">this</span>.isactive, <span class="attr">line</span>: <span class="built_in">this</span>.isline</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>[tag]动态添加style[/tag]<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">       <span class="comment">&lt;!-- &lt;h2 :style=&quot;&#123;fontSize\\font-size: finalSize+&#x27;px&#x27;,background:finaColor,&#125;&quot;&gt;&#123;&#123;messages&#125;&#125;&lt;/h2&gt; --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:style</span>=<span class="string">&quot;getActive()&quot;</span>&gt;</span>&#123;&#123;messages&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:style</span>=<span class="string">&quot;[baseStyle,baseStyles,baseStyles1]&quot;</span>&gt;</span>&#123;&#123;messages&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;../js/vue.js&quot;</span>&gt;&lt;/script&gt; &lt;!-- 引入文件 --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">data</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">movies</span>: [<span class="string">&#x27;你的婚礼&#x27;</span>, <span class="string">&#x27;钟离&#x27;</span>, <span class="string">&#x27;尤拉&#x27;</span>, <span class="string">&#x27;蜘蛛侠&#x27;</span>, <span class="string">&#x27;绿巨人&#x27;</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">messages</span>: <span class="string">&#x27;东方蜜蜂&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">finalSize</span>: <span class="number">10</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">finaColor</span>: <span class="string">&#x27;aqua&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="comment">// 默认下标为0</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">indexs</span>: <span class="number">0</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">baseStyle</span>:&#123;<span class="attr">background</span>:<span class="string">&#x27;red&#x27;</span>&#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">baseStyles</span>:&#123;<span class="attr">fontSize</span>:<span class="string">&#x27;33px&#x27;</span>&#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">baseStyles1</span>:&#123;<span class="attr">color</span>:<span class="string">&#x27;#fff&#x27;</span>&#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">clicks</span>: <span class="function"><span class="keyword">function</span> (<span class="params">index</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    <span class="built_in">this</span>.indexs = index;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    <span class="built_in">console</span>.log(index);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="attr">getActive</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                        <span class="attr">fontSize</span>: <span class="built_in">this</span>.finalSize + <span class="string">&#x27;px&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                        <span class="attr">background</span>: <span class="built_in">this</span>.finaColor,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">                &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>[tag type=”primary”]列表点击高亮[/tag]<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">list-style</span>: none;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">90px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: <span class="number">1px</span> solid gold;</span></span><br><span class="line"><span class="css">            <span class="attribute">line-height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.active</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: aqua;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        <span class="selector-attr">[v-cloak]</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span></span></span><br><span class="line"><span class="tag">             <span class="attr">v-cloak</span> <span class="attr">v-for</span>=<span class="string">&quot;(m,index) in movies&quot;</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">:class</span>=<span class="string">&#x27;indexs == index ?&quot;active&quot;:&quot;&quot;&#x27;</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">v-on:click</span>=<span class="string">&#x27;clicks(index)&#x27;</span>&gt;</span></span><br><span class="line">                &#123;&#123;m&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;../js/vue.js&quot;</span>&gt;&lt;/script&gt; &lt;!-- 引入文件 --&gt;</span><br><span class="line">   <span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">       <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="attr">data</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">               <span class="attr">movies</span>: [<span class="string">&#x27;你的婚礼&#x27;</span>, <span class="string">&#x27;钟离&#x27;</span>, <span class="string">&#x27;尤拉&#x27;</span>, <span class="string">&#x27;蜘蛛侠&#x27;</span>, <span class="string">&#x27;绿巨人&#x27;</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">               <span class="attr">finalSize</span>: <span class="number">10</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">               <span class="attr">finaColor</span>: <span class="string">&#x27;aqua&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">               <span class="comment">// 默认下标为0</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">               <span class="attr">indexs</span>: <span class="number">0</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">             </span></span></span><br><span class="line"><span class="javascript"><span class="xml">           &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">           <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">               <span class="attr">clicks</span>: <span class="function"><span class="keyword">function</span> (<span class="params">index</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                   <span class="built_in">this</span>.indexs = index;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                   <span class="built_in">console</span>.log(index);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">               &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">             </span></span></span><br><span class="line"><span class="javascript"><span class="xml">           &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">       &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">   </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>[tag type=”info”]计算属性[/tag]</p>
<ol>
<li><p>set和get方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">  &lt;!-- 计算属性调用时不需要加（） --&gt;</span><br><span class="line"> <span class="xml"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&#x27;&#123;active:true,font:true&#125;&#x27;</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">       &lt;!-- 不需要加（） --&gt;</span><br><span class="line"> <span class="xml"><span class="tag">&lt;<span class="name">h5</span> <span class="attr">v-cloak</span>&gt;</span>总价格：&#123;&#123;totalPrice&#125;&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">           <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>, <span class="comment">/* 用于挂载要管理的元素 */</span></span><br><span class="line">           <span class="attr">data</span>: &#123; <span class="comment">/* 定义数据 */</span></span><br><span class="line">               <span class="attr">message</span>: <span class="string">&#x27;你好，vue&#x27;</span>,</span><br><span class="line">               <span class="attr">firstName</span>: <span class="string">&#x27;kobe&#x27;</span>,</span><br><span class="line">               <span class="attr">lastName</span>: <span class="string">&#x27;bryant&#x27;</span>,</span><br><span class="line">             </span><br><span class="line">           &#125;,</span><br><span class="line">           <span class="attr">methods</span>: &#123;</span><br><span class="line">               <span class="function"><span class="title">getFullName</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">                   <span class="keyword">return</span> <span class="built_in">this</span>.firstName + <span class="string">&quot;  &quot;</span> + <span class="built_in">this</span>.lastName</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;,</span><br><span class="line">           <span class="comment">// 计算属性（）,</span></span><br><span class="line">           <span class="attr">computed</span>: &#123;</span><br><span class="line">               <span class="comment">// 最终版本</span></span><br><span class="line">               <span class="comment">// fullName: function () &#123;</span></span><br><span class="line">               <span class="comment">//     return this.firstName + &quot;  &quot; + this.lastName;</span></span><br><span class="line">               <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">               <span class="attr">fullName</span>: &#123;</span><br><span class="line">                   <span class="attr">set</span>: <span class="function"><span class="keyword">function</span> (<span class="params">newValue</span>) </span>&#123;</span><br><span class="line">                       <span class="built_in">console</span>.log(<span class="string">&#x27;---set&#x27;</span>, newValue);</span><br><span class="line">                       <span class="keyword">const</span> names = newValue.split(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                       <span class="built_in">console</span>.log(names);</span><br><span class="line">                       <span class="built_in">this</span>.firstName = names[<span class="number">0</span>];</span><br><span class="line">                       <span class="built_in">this</span>.lastName = names[<span class="number">1</span>];</span><br><span class="line">                   &#125;,</span><br><span class="line">                   <span class="attr">get</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                       <span class="keyword">return</span> <span class="built_in">this</span>.firstName + <span class="string">&quot;  &quot;</span> + <span class="built_in">this</span>.lastName;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;,</span><br><span class="line">               <span class="attr">totalPrice</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                   <span class="keyword">let</span> result = <span class="number">0</span>;</span><br><span class="line">                   <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.books.length; i++) &#123;</span><br><span class="line">                       result += <span class="built_in">this</span>.books[i].price</span><br><span class="line">                   &#125;</span><br><span class="line">                   <span class="keyword">return</span> result</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>methods方法特点</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- methods --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- methods 执行一次，调用一次函数。 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- &lt;h2 :class=&#x27;&#123;active:true,font:true&#125;&#x27;&gt;&#123;&#123;getFullName()&#125;&#125;&lt;/h2&gt;</span></span><br><span class="line"><span class="comment">      &lt;h2 :class=&#x27;&#123;active:true,font:true&#125;&#x27;&gt;&#123;&#123;getFullName()&#125;&#125;&lt;/h2&gt;</span></span><br><span class="line"><span class="comment">      &lt;h2 :class=&#x27;&#123;active:true,font:true&#125;&#x27;&gt;&#123;&#123;getFullName()&#125;&#125;&lt;/h2&gt;</span></span><br><span class="line"><span class="comment">      &lt;h2 :class=&#x27;&#123;active:true,font:true&#125;&#x27;&gt;&#123;&#123;getFullName()&#125;&#125;&lt;/h2&gt;</span></span><br><span class="line"><span class="comment">      &lt;h2 :class=&#x27;&#123;active:true,font:true&#125;&#x27;&gt;&#123;&#123;getFullName()&#125;&#125;&lt;/h2&gt;</span></span><br><span class="line"><span class="comment">      &lt;h2 :class=&#x27;&#123;active:true,font:true&#125;&#x27;&gt;&#123;&#123;getFullName()&#125;&#125;&lt;/h2&gt;</span></span><br><span class="line"><span class="comment">      &lt;h2 :class=&#x27;&#123;active:true,font:true&#125;&#x27;&gt;&#123;&#123;getFullName()&#125;&#125;&lt;/h2&gt; --&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">             <span class="function"><span class="title">getFullName</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">                 <span class="built_in">console</span>.log(<span class="string">&#x27;方法属性被执行&#x27;</span>)</span><br><span class="line">                 <span class="keyword">return</span> <span class="built_in">this</span>.firstName + <span class="string">&quot;  &quot;</span> + <span class="built_in">this</span>.lastName</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;,</span><br></pre></td></tr></table></figure>
<p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/computed1.png" alt="请输入图片描述"></p>
</li>
</ol>
<ul>
<li><p>computed 计算属性特点</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 计算属性调用时不需要加（） --&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- 数据若未发生变化，会储存上一次的数据，内部存在缓存 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&#x27;&#123;active:true,font:true&#125;&#x27;</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&#x27;&#123;active:true,font:true&#125;&#x27;</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&#x27;&#123;active:true,font:true&#125;&#x27;</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&#x27;&#123;active:true,font:true&#125;&#x27;</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&#x27;&#123;active:true,font:true&#125;&#x27;</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&#x27;&#123;active:true,font:true&#125;&#x27;</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&#x27;&#123;active:true,font:true&#125;&#x27;</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span> <span class="attr">:class</span>=<span class="string">&#x27;&#123;active:true,font:true&#125;&#x27;</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- 不需要加（） --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h5</span> <span class="attr">v-cloak</span>&gt;</span>总价格：&#123;&#123;totalPrice&#125;&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 计算属性（）,</span></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="attr">fullName</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;计算属性被执行&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.firstName + <span class="string">&quot;  &quot;</span> + <span class="built_in">this</span>.lastName;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">totalPrice</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.books.length; i++) &#123;</span><br><span class="line">        result += <span class="built_in">this</span>.books[i].price</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/computed2.png" alt="请输入图片描述"><br>[tag type=”warn”]vue全局安装[/tag]<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/vues1.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/vues2.png" alt="请输入图片描述"></p>
</li>
<li><h4 id="vue-cli-创建项目启动服务"><a href="#vue-cli-创建项目启动服务" class="headerlink" title="@vue/cli 创建项目启动服务"></a>@vue/cli 创建项目启动服务</h4></li>
<li>==注意: 项目名不能带大写字母, 中文和特殊符号==</li>
<li><p>vue和create是命令, vuecli-demo是文件夹名</p>
</li>
<li><p>1创建项目</p>
</li>
<li><p>vue create vuecli-demo</p>
</li>
<li><p>2.选择模板 ，ctrl+c 重来<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/cli1.png" alt="请输入图片描述"></p>
</li>
<li>3.选择用什么方式下载脚手架项目需要的依赖包<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/cli2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/cli3.png" alt="请输入图片描述"></li>
<li><p>4 进入脚手架项目下, 启动内置的热更新本地服务器</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cd vuecil-demo</span><br><span class="line"></span><br><span class="line">npm run serve</span><br><span class="line"># 或</span><br><span class="line">yarn serve</span><br></pre></td></tr></table></figure>
</li>
<li><p>5 只要看到绿色的 - 啊. 你成功了(底层node+webpack热更新服务)<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/cli4.png" alt="请输入图片描述"></p>
</li>
<li>6.打开浏览器输入上述地址<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/cli5.png" alt="请输入图片描述"></li>
</ul>
<hr>
<p>[tag type=”danger”]@vue/cli 目录和代码分析[/tag]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">vuecil-demo        # 项目目录</span><br><span class="line">    ├── node_modules # 项目依赖的第三方包</span><br><span class="line">    ├── public       # 静态文件目录</span><br><span class="line">      ├── favicon.ico# 浏览器小图标</span><br><span class="line">      └── index.html # 单页面的html文件(网页浏览的是它)</span><br><span class="line">    ├── src          # 业务文件夹</span><br><span class="line">      ├── assets     # 静态资源</span><br><span class="line">        └── logo.png # vue的logo图片</span><br><span class="line">      ├── components # 组件目录</span><br><span class="line">        └── HelloWorld.vue # 欢迎页面vue代码文件 </span><br><span class="line">      ├── App.vue    # 整个应用的根组件</span><br><span class="line">      └── main.js    # 入口js文件</span><br><span class="line">    ├── .gitignore   # git提交忽略配置</span><br><span class="line">    ├── babel.config.js  # babel配置</span><br><span class="line">    ├── package.json  # 依赖包列表</span><br><span class="line">    ├── README.md    # 项目说明</span><br><span class="line">	└── yarn.lock    # 项目包版本锁定和缓存地址</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>主要文件及含义</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">node_modules下都是下载的第三方包</span><br><span class="line">public/index.html – 浏览器运行的网页</span><br><span class="line">src/main.js – webpack打包的入口文件</span><br><span class="line">src/App.vue – vue项目入口页面</span><br><span class="line">package.json – 依赖包列表文件</span><br></pre></td></tr></table></figure>
<p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/vues10.png" alt="请输入图片描述"><br>[tag type=”success”]_@vue/cli 自定义配置[/tag]</p>
</li>
<li><p>目标：项目中没有webpack.config.js文件，因为@vue/cli用的vue.config.js</p>
</li>
<li>src并列处新建vue.config.js<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 覆盖webpack的配置 */</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">devServer</span>: &#123; <span class="comment">// 自定义服务配置</span></span><br><span class="line">    <span class="attr">open</span>: <span class="literal">true</span>, <span class="comment">// 自动打开浏览器</span></span><br><span class="line">    <span class="attr">port</span>: <span class="number">3000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/cli7.png" alt="请输入图片描述"><br>[tag outline]_@vue/cli 单vue文件讲解[/tag]</li>
<li>Vue推荐采用.vue文件来开发项目</li>
<li>template里只能有一个根标签</li>
<li>vue文件-独立模块-作用域互不影响</li>
<li>style配合scoped属性, 保证样式只针对当前template内标签生效</li>
<li><p>vue文件配合webpack, 把他们打包起来插入到index.html</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;!-- template必须, 只能有一个根标签, 影响渲染到页面的标签结构 --&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>欢迎使用vue<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- js相关 --&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="attr">name</span>: <span class="string">&#x27;App&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- 当前组件的样式, 设置scoped, 可以保证样式只对当前页面有效 --&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>最终: Vue文件配合webpack, 把他们打包起来插入到index.html, 然后在浏览器运行</strong></p>
</li>
<li>@vue/cli 欢迎界面清理</li>
<li>src/App.vue默认有很多内容, 可以全部删除留下框</li>
<li>assets 和 components 文件夹下的一切都删除掉 (不要默认的欢迎页面)</li>
<li>解决警告<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/err1.png" alt="请输入图片描述"></li>
</ul>
<p>[tag type=”primary” outline]v-if,v-else,v-show[/tag]</p>
<ul>
<li>v-show指令的作用是：根据真假值切换元素的显示状态,是响应式的</li>
<li>语法表达v-show = “ 表达式 “</li>
<li>原理是修改元素的的CSS属性(display)来决定实现显示还是隐藏</li>
<li>指令后面的内容最终都会解析为布尔值</li>
<li>值为真(true)的时候元素显示，值为假(false)的时候元素隐藏</li>
<li>v-if指令的作用：根据表达式的真假切换元素的显示状态</li>
<li>v-if = “表达式”.本质是通过操纵dom元素来进行切换显示</li>
<li>表达式的值为true的时候元素存在于dom树中，为false的时候从dom树中移除</li>
<li><h4 id="注意，v-if和v-else之间不要插入其他标签"><a href="#注意，v-if和v-else之间不要插入其他标签" class="headerlink" title="注意，v-if和v-else之间不要插入其他标签"></a>注意，v-if和v-else之间不要插入其他标签</h4><p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-if1.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-if2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v7.png" alt="请输入图片描述"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">  &lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    &lt;!-- v-<span class="keyword">if</span> == boolean --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-if</span>=<span class="string">&#x27;true&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;&#123;message&#125;&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!-- 内容不会显示 --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-if</span>=<span class="string">&#x27;false&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;&#123;message&#125;&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">v-if</span>=<span class="string">&#x27;isShow&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>阿弟1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>阿弟2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>阿弟3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>阿弟4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>阿弟5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    &lt;!-- v-<span class="keyword">else</span> 和 v-<span class="keyword">if</span> 相反 --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-else</span>&gt;</span>isShow为false时，显示我<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-if</span>=<span class="string">&#x27;score &gt;= 90&#x27;</span>&gt;</span> 优秀<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-else-if</span>=<span class="string">&#x27;score &gt;= 80&#x27;</span>&gt;</span>良好<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-else-if</span>=<span class="string">&#x27;score &gt;= 60&#x27;</span>&gt;</span>及格<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-else</span>&gt;</span>不及格<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;result&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    &lt;!-- 用户切换案列 --&gt;</span><br><span class="line">    &lt;!-- 完成需求：切换清空输入内容   输入key--&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&#x27;isUser&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>用户登录<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;用户账号&quot;</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;email&quot;</span>&gt;</span> 用户邮箱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;email&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;用户邮箱&quot;</span> <span class="attr">key</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&#x27;isUser = !isUser&#x27;</span>&gt;</span>切换类型<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- v-show --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--（切换一次） v-if当条件为false，包含v-if指令的元素，根本不会存在dom中 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-if</span>=<span class="string">&#x27;isShow&#x27;</span><span class="attr">id</span>=<span class="string">&quot;aaa&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--（频繁切换） v-show 当条件为false，v-show只是给我们的元素添加一个行内样式 ：dispaly：none --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-show</span>=<span class="string">&#x27;isShow&#x27;</span> <span class="attr">id</span>=<span class="string">&quot;bbb&quot;</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">---------------------------------------------------------------------</span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="comment">&lt;!-- 引入文件 --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>, <span class="comment">/* 用于挂载要管理的元素 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">data</span>: &#123; <span class="comment">/* 定义数据 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">message</span>: <span class="string">&#x27;你好，vue&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">isShow</span>:<span class="literal">true</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">score</span>:<span class="number">80</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">isUser</span>:<span class="literal">true</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">info</span>:&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">name</span>:<span class="string">&#x27;yanglo&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">age</span>:<span class="number">21</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">height</span>:<span class="number">188</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">hobby</span>:<span class="string">&quot;paly games&quot;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">letters</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>]</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml"> <span class="comment">// 计算属性（）,</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">computed</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="function"><span class="title">result</span>(<span class="params"></span>)</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="keyword">let</span> showMessage =<span class="string">&#x27;&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="keyword">if</span>(<span class="built_in">this</span>.score &gt;= <span class="number">90</span>)&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            showMessage = <span class="string">&#x27;优秀&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">          &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">this</span>.score &gt;= <span class="number">80</span>)&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            showMessage = <span class="string">&#x27;良好&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">          &#125;<span class="keyword">else</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            showMessage = <span class="string">&#x27;加油&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">          &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="keyword">return</span> showMessage;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>[tag type=”info” outline]数组遍历[/tag]</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">  &lt;!-- 遍历数组 --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&#x27;item in info&#x27;</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    &lt;!-- 获取value值 ，key键    index 下标--&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&#x27;(value,key,index) in info&#x27;</span>&gt;</span> &#123;&#123;key&#125;&#125;----- &#123;&#123;value&#125;&#125;-----&#123;&#123;index + 1&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    &lt;!-- key的作用只要是为了高效更新虚拟dom  key必须保持展示元素一致--&gt;</span><br><span class="line">    &lt;!-- bc之间插入f app.letters.splice(<span class="number">2</span>,<span class="number">0</span>,<span class="string">&quot;f&quot;</span>) --&gt;</span><br><span class="line">   </span><br><span class="line">    &lt;!-- <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&#x27;m in letters&#x27;</span><span class="attr">:key</span>=<span class="string">&quot;m&quot;</span>&gt;</span> &#123;&#123;m&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span> --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 那些数组方法是响应式 --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&#x27;m in letters&#x27;</span>&gt;</span> &#123;&#123;m&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&#x27;btns1Click&#x27;</span>&gt;</span>btnclick<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">----------------------------------------------</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">      <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>, <span class="comment">/* 用于挂载要管理的元素 */</span></span><br><span class="line">      <span class="attr">data</span>: &#123; <span class="comment">/* 定义数据 */</span></span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;你好，vue&#x27;</span>,</span><br><span class="line">        <span class="attr">isShow</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">score</span>:<span class="number">80</span>,</span><br><span class="line">        <span class="attr">isUser</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">info</span>:&#123;</span><br><span class="line">          <span class="attr">name</span>:<span class="string">&#x27;yanglo&#x27;</span>,</span><br><span class="line">          <span class="attr">age</span>:<span class="number">21</span>,</span><br><span class="line">          <span class="attr">height</span>:<span class="number">188</span>,</span><br><span class="line">          <span class="attr">hobby</span>:<span class="string">&quot;paly games&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">letters</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">       <span class="attr">methods</span>: &#123;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="title">btns1Click</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//  数组中可以做到响应式</span></span><br><span class="line">        <span class="comment">//  1.push 最后添加</span></span><br><span class="line">        <span class="comment">// this.letters.push(&#x27;aaa&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// unshift() 第一个添加</span></span><br><span class="line">        <span class="comment">// this.letters.unshift(&#x27;11&#x27;)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.pop() 最后删除</span></span><br><span class="line">        <span class="comment">// this.letters.pop()</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// shift()第一个删除</span></span><br><span class="line">        <span class="comment">// this.letters.shift();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// splice 删除、插入、替换</span></span><br><span class="line">        <span class="comment">// 删除元素：第二个参数表示删除几个元素(没有传，删除后面所有)</span></span><br><span class="line">        <span class="comment">// 替换元素 ，第二个参数，表示我们替换几个元素，后面是用来替换前面的元素</span></span><br><span class="line">        <span class="comment">// 插入元素：第二个参数，传入0，并且后面要跟上要插入的元素</span></span><br><span class="line">        <span class="comment">// splice(start)</span></span><br><span class="line">        <span class="comment">// this.letters.splice(3,0,&quot;qw&quot;)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// sort（）</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// reverse()翻转</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// this.letters.reverse();</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注意：通过索引值修改数组中的元素</span></span><br><span class="line">        <span class="comment">// this.letters[0] = &#x27;bbb&#x27;;</span></span><br><span class="line">        <span class="comment">// this.letters.splice(0,1,&#x27;bbb&#x27;)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// set(要修改的值，索引值，修改后的值)</span></span><br><span class="line">        <span class="comment">// 1 ====2</span></span><br><span class="line">        Vue.set(<span class="built_in">this</span>.letters,<span class="number">1</span>,<span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>
<p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/key.png" alt="请输入图片描述"><br>[tag type=”warn” outline]购物车案列[/tag]</p>
</li>
<li><p>v-if =false,隐藏有该属性的标签，true相反</p>
</li>
<li>v-else 与 v-if 的状态相反</li>
<li>.toFixed（2）保留两位小数</li>
<li>过滤器简介</li>
<li><strong>过滤器分全局过滤器和局部过滤器，下边我着重说下全局过滤器，因为全局过滤器在项目中使用频率非常高！</strong></li>
<li>局部过滤器：过滤器可以用在两个地方：双花括号插值 或 v-bind表达式。</li>
<li><p>举个栗子</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 过滤器 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;m.price | showPrice&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/guo.png" alt="请输入图片描述"></p>
</li>
<li><p>上边代码，我的需求是想把价格前面加上人民币符号（¥），后面保留两位小数，模板中文本后边需要添加管道符号（ | ）作为分隔，管道符 | 后边是文本的处理函数，处理函数的第一个参数是：管道符前边的——文本内容，如果处理函数上边传递参数，则从第二个参数依次往后是传递的参数。</p>
</li>
<li>（把输入的英文首字母大写，如果连续输入，以空格隔开）<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    //输入框</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;content&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;changeEvent&quot;</span>&gt;</span></span><br><span class="line">     //显示层，后边加一个过滤器处理函数，把英文首字母变为大写</span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;viewContent | changeCapitalLetter&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"> <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">viewContent</span>:<span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">content</span>:<span class="string">&quot;&quot;</span>    </span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">changeEvent</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.viewContent = <span class="built_in">this</span>.content;</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="attr">filters</span>:&#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">changeCapitalLetter</span>(<span class="params">value</span>)</span>&#123;<span class="comment">//value是输入框的内容，也是要显示的内容</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span>(value)&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">let</span> str = value.toString();</span></span><br><span class="line"><span class="javascript">                <span class="comment">//获取英文，以空格分组把字符串转为数组，遍历每一项，第一项转为大写字母</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">let</span> newArr = str.split(<span class="string">&quot; &quot;</span>).map(<span class="function"><span class="params">ele</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">                   <span class="keyword">return</span> ele.charAt(<span class="number">0</span>).toUpperCase() + ele.slice(<span class="number">1</span>)</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> newArr.join(<span class="string">&quot; &quot;</span>)  <span class="comment">//数组转字符串 以空格输出。。。</span></span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"> &#125;)</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>购物车案列—————————————————————</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">table</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#e9e9e9</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-collapse</span>: collapse;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-spacing</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">th</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-tag">td</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">8px</span> <span class="number">16px</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#e9e9e9</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">th</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">background</span>: <span class="number">#f7f7f7</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#5c6b77</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-weight</span>: <span class="number">600</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">h2</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">      <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&#x27;books.length&#x27;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 头部 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>书籍名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>出版日期<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>购买数量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">&#x27;(m,index) in books&#x27;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 隐藏的可以显示，但没有其他操作 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- &lt;td v-for=&#x27;value in item&#x27;&gt; &#123;&#123;value&#125;&#125;&lt;/td&gt; --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;m.id&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;m.name&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;m.data&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- toFixed(2)保留2位小数 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- &lt;td&gt;&#123;&#123;&#x27;￥&#x27;+m.price.toFixed(2)&#125;&#125;&lt;/td&gt; --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- &lt;td&gt;&#123;&#123;getFinalParice(m.price)&#125;&#125;&lt;/td&gt; --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 过滤器 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;m.price | showPrice&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!-- 动态绑定disabled 小于0，不能点击 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&#x27;increment(index)&#x27;</span> <span class="attr">:disabled</span>=<span class="string">&quot;m.count &lt;= 0&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              &#123;&#123;m.count&#125;&#125;</span><br><span class="line">              <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&#x27;decrement(index)&#x27;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">removeHandle(index)</span>&gt;</span>移除<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>总价格:&#123;&#123;totalprice | showPrice&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-else</span>&gt;</span>购物车为空 <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="comment">&lt;!-- 引入文件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>, <span class="comment">/* 用于挂载要管理的元素 */</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">data</span>: &#123; <span class="comment">/* 定义数据 */</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">books</span>: [</span></span><br><span class="line"><span class="javascript">          &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">id</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">name</span>: <span class="string">&#x27;&lt;算法导论&gt;&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">data</span>: <span class="string">&#x27;2006-9&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">price</span>: <span class="number">85.00</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">count</span>: <span class="number">1</span></span></span><br><span class="line"><span class="javascript">          &#125;,</span></span><br><span class="line"><span class="javascript">          &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">id</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">name</span>: <span class="string">&#x27;&lt;编程艺术&gt;&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">data</span>: <span class="string">&#x27;2006-9&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">price</span>: <span class="number">59.00</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">count</span>: <span class="number">1</span></span></span><br><span class="line"><span class="javascript">          &#125;,</span></span><br><span class="line"><span class="javascript">          &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">id</span>: <span class="number">3</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">name</span>: <span class="string">&#x27;&lt;编程珠玑&gt;&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">data</span>: <span class="string">&#x27;2006-9&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">price</span>: <span class="number">39.00</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">count</span>: <span class="number">1</span></span></span><br><span class="line"><span class="javascript">          &#125;,</span></span><br><span class="line"><span class="javascript">          &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">id</span>: <span class="number">4</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">name</span>: <span class="string">&#x27;&lt;代码大全&gt;&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">data</span>: <span class="string">&#x27;2006-9&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">price</span>: <span class="number">128</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">count</span>: <span class="number">1</span></span></span><br><span class="line"><span class="javascript">          &#125;,</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        ]</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">getFinalParice</span>(<span class="params">price</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="string">&quot;￥&quot;</span> + price.toFixed(<span class="number">2</span>)</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 点击加减</span></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">decrement</span>(<span class="params">index</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.books[index].count++</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">increment</span>(<span class="params">index</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.books[index].count--</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 移除属性</span></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">removeHandle</span>(<span class="params">index</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.books.splice(index, <span class="number">1</span>)</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 过滤器</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">filters</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">showPrice</span>(<span class="params">price</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="string">&quot;￥&quot;</span> + price.toFixed(<span class="number">2</span>)</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 计算属性（）,</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 计算总价格</span></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">totalprice</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="comment">// 1普通for循环</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">          <span class="comment">// let totalprice =0;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// for(let i=0; i &lt; this.books.length; i++)&#123;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">//   totalprice += this.books[i].price * this.books[i].count;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// return totalprice;</span></span></span><br><span class="line"><span class="javascript">          </span></span><br><span class="line"><span class="javascript">          <span class="comment">//2.for(let i in this.books)</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// let totalprice =0;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// for(let i in this.books)&#123;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">//   const book = this.books[i]</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">//   totalprice += book.price * book.count</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// return totalprice</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">          <span class="comment">// 3for(let i of this.books)</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// let totalprice =0;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// for(let item of this.books) &#123;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">//   totalprice += item.price * item.count</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// return totalprice;</span></span></span><br><span class="line"><span class="javascript">          </span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="built_in">this</span>.books.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">prev,book</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> prev + book.price * book.count</span></span><br><span class="line"><span class="javascript">          &#125;,<span class="number">0</span>)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>[tag type=”danger” outline]回顾插值[/tag]<br>[collapse title=”剩余插值操作”]<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-cloak</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">&quot;getClass()&quot;</span>&gt;</span>&#123;&#123; count &#125;&#125; -----我可以修改<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-once</span>&gt;</span>&#123;&#123; count &#125;&#125; ------ 我只渲染一次，不会修改<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-text</span>=<span class="string">&quot;message&quot;</span>&gt;</span>&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-pre</span>&gt;</span> &#123;&#123;count&#125;&#125; --------- 我不会有解析<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 数量改变  v-on  语法糖  @--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;add&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;inde&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;btn5&quot;</span>&gt;</span>一次加5<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;btn6&quot;</span>&gt;</span>一次减5<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;add&quot;</span>&gt;</span>add<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;inde&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- bind 语法糖 ： --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">&quot;imgUrl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">:href</span>=<span class="string">&quot;aHref&quot;</span>&gt;</span>点击我去百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 阻止去百度 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> @<span class="attr">click</span>=<span class="string">&quot;two(10,$event)&quot;</span> <span class="attr">:href</span>=<span class="string">&quot;aHref&quot;</span>&gt;</span>我不能去百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 颜色改变 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;btnClick&quot;</span> <span class="attr">class</span>=<span class="string">&quot;chs&quot;</span>&gt;</span>click<span class="tag">&lt;/<span class="name">button</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span>&gt;</span>点击更换颜色<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">v-for</span>=<span class="string">&quot;(m,index) in list&quot;</span> </span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">&quot;clicks(index)&quot;</span>  </span></span><br><span class="line"><span class="tag">      <span class="attr">:class</span>=<span class="string">&#x27;indexs == index ?&quot;actives&quot;:&quot;&quot;&#x27;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        &#123;&#123;m&#125;&#125;-----&#123;&#123; index &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;mess&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;one&quot;</span>&gt;</span>&#123;&#123;messinfo&#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- .stop 阻止该事件冒泡 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;fa&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;divClick&quot;</span>&gt;</span></span><br><span class="line">      算法开发贷款撒赛德克发</span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.stop</span>=<span class="string">&quot;sonClick&quot;</span>&gt;</span>click<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- .prevent 修饰符使用 阻止提交--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;baidu&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span> @<span class="attr">click.prevent</span>=<span class="string">&quot;submClick&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;submClick&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 监听键盘的键帽 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 只要输入就执行 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-on:keyup</span>=<span class="string">&quot;keyUp&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 只监听enter --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;keyUp1&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- once 该事件只会触发一次 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.once</span>=<span class="string">&quot;btnOnce&quot;</span>&gt;</span>按钮once<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">count</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 颜色</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">isactive</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">isline</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">message</span>: <span class="string">&quot;后面的内容不会显示&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// moives</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">list</span>: [<span class="string">&quot;我的世界&quot;</span>, <span class="string">&quot;钟离&quot;</span>, <span class="string">&quot;琴&quot;</span>, <span class="string">&quot;蜘蛛侠&quot;</span>, <span class="string">&quot;艾克&quot;</span>, <span class="string">&quot;阿斯蒂芬&quot;</span>],</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 默认下标</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">indexs</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">aHref</span>: <span class="string">&quot;https://www.baidu.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">imgUrl</span>:</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;https://img30.360buyimg.com/babel/s1180x940_jfs/t1/185487/25/2729/188978/609512cdE026eaa3e/873ee4de4f1e2a0c.jpg.webp&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">mess</span>: <span class="string">&quot;hello,world&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">messinfo</span>: <span class="string">&quot;逆转世界&quot;</span>,</span></span><br><span class="line"><span class="javascript">    &#125;;</span></span><br><span class="line"><span class="javascript">  &#125;,</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 方法属性</span></span></span><br><span class="line"><span class="javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 点击改变</span></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">add</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.count++;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">inde</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.count--;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 颜色改变</span></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">btnClick</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.isactive = !<span class="built_in">this</span>.isactive;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.isline = !<span class="built_in">this</span>.isline;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="comment">// class赋值</span></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">getClass</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">active</span>: <span class="built_in">this</span>.isactive,</span></span><br><span class="line"><span class="javascript">        <span class="attr">line</span>: <span class="built_in">this</span>.isline,</span></span><br><span class="line"><span class="javascript">      &#125;;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 列表点击高亮</span></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">clicks</span>(<span class="params">index</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// console.log(index);</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.indexs = index;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// console.log(this.indexs);</span></span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 阻止去百度</span></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">two</span>(<span class="params">num, e</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      e.preventDefault();</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(e);</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 逆转世界</span></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">one</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.mess = <span class="built_in">this</span>.mess.split(<span class="string">&quot;&quot;</span>).reverse().join(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">btn5</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.count += <span class="number">5</span>;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">btn6</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.count -= <span class="number">5</span>;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 事件冒泡</span></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">divClick</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">&quot;divclick&quot;</span>);</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">sonClick</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">&quot;sonclick&quot;</span>);</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">submClick</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">&#x27;submclick&#x27;</span>);</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">keyUp</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">&#x27;keyup&#x27;</span>);</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">     <span class="function"><span class="title">keyUp1</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">       alert(<span class="string">&#x27;enter被点击&#x27;</span>)</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">btnOnce</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">&#x27;once执行一次&#x27;</span>);</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">  &#125;,</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 计算属性</span></span></span><br><span class="line"><span class="javascript">  <span class="attr">computed</span>: &#123;&#125;,</span></span><br><span class="line"><span class="javascript">&#125;;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-attr">[v-cloak]</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.active</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.line</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">background</span>: red;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">ul</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">justify-content</span>: space-evenly;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.chs</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">width</span>: <span class="number">370px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">line-height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border</span>: <span class="number">1px</span> solid gold;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">  <span class="attribute">list-style</span>: none;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.actives</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">background</span>: aqua;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">img</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-id">#fa</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">width</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">background</span>: pink;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>[/collapse]<br>[tag type=”success” outline=”1”]v-model常用绑定[/tag]</p>
<ul>
<li>通过表单input绑定模型数据message，表单数据变化data.message也发生变化</li>
<li>然后通过Mustache表达式，将变化之后的message数据显示到视图页面上<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model1.png" alt="请输入图片描述"></li>
<li>效果<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model2.gif" alt="请输入图片描述"></li>
<li><strong>v-model实际上是一个语法糖，也就是简写，他实际上包含了两个操作：</strong></li>
<li>v-bind绑定value属性</li>
<li>v-on监听表单元素的输入事件，并改变数据</li>
<li>所以，下面的两种写法实现的效果是一致的。<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model3.png" alt="请输入图片描述"></li>
<li>第一种：input标签type=radio实现单选和type=checkbox实现的多选</li>
<li>第二种：select标签-option标签实现的单选与多选<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model4.png" alt="请输入图片描述"></li>
<li>使用radio实现单选，v-model绑定的数据应该是同一个，这样实现单选选项之间的互斥</li>
<li>使用checkbox实现多选，v-model绑定的数据应该是同一个，这样多选的数据才属于同一个数组<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model6.gif" alt="请输入图片描述"></li>
<li>怎样在单选或者多选选项显示，默认勾选一个或多个选项？只需要给定默认初始化数据即可<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model5.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model7.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model8.png" alt="请输入图片描述"></li>
<li>v-model绑定模型数据mvp，实现单选效果</li>
<li>v-model绑定模型数据allDefensiveTeam，结合multiple属性实现多选效果</li>
<li>多选选项的模型数据为数组类型</li>
<li>可以为单选及多选设置默认值，即：默认的勾选项<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model8.gif" alt="请输入图片描述"></li>
<li>v-model的修饰符<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model9.png" alt="请输入图片描述"></li>
<li>lazy修饰符：默认情况下，input输入会实时影响v-model绑定的数据</li>
<li>加上lazy修饰符，只有当输入框失去焦点会输入回车的时候，才会去改变v-model绑定的数据。</li>
<li>number修饰符：默认情况下，输入框中输入的无论是数字还是字母，都会被当做字符串处理。</li>
<li>加上number修饰符，输入内容会被当做数值类型处理。</li>
<li>trim修饰符：可以自动去掉输入内容左右两边的空格</li>
</ul>
<p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-model10.gif" alt="请输入图片描述"></p>
<ul>
<li>由上图可以看到，当第一个输入框失去焦点的时候，name：curry，才发生数据改变。</li>
<li>输入年龄31，被当作数值类型处理（默认输入是当作字符串类型。因为初始值为null，所以显示是object类型）</li>
<li>第三个输入框，输入内容前后都有空格，但是加上trim修饰符，就自动去掉了。</li>
<li><strong>v-model介绍原文作者字母哥博客</strong></li>
<li><p>原文地址：<a href="https://www.jb51.net/article/197689.htm">https://www.jb51.net/article/197689.htm</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- //输入框 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;content&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;changeEvent&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- //显示层，后边加一个过滤器处理函数，把英文首字母变为大写 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;viewContent | changeCapitalLetter&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- v-model实现的原理 双向绑定 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">:value</span>=<span class="string">&#x27;message&#x27;</span> @<span class="attr">input</span>=<span class="string">&#x27;valueChange&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">:value</span>=<span class="string">&#x27;message&#x27;</span> @<span class="attr">input</span>=<span class="string">&#x27;message = $event.target.value&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--v-model结合radio  --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 绑定v-model，input中的name值可以省略 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;male&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">id</span>=<span class="string">&quot;male&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;男&quot;</span> <span class="attr">v-model</span>=<span class="string">&#x27;sex&#x27;</span>&gt;</span> 男</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;female&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">id</span>=<span class="string">&quot;female&quot;</span> <span class="attr">value</span>=<span class="string">&quot;女&quot;</span> <span class="attr">v-model</span>=<span class="string">&#x27;sex&#x27;</span>&gt;</span> 女</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>您的性别是&#123;&#123;sex&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- v-model结合checkbox单选框 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;agree&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">id</span>=<span class="string">&quot;agree&quot;</span> <span class="attr">v-model</span>=<span class="string">&#x27;isAgree&#x27;</span>&gt;</span>同意协议</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>您选择的是&#123;&#123;isAgree&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">:disabled</span>=<span class="string">&#x27;!isAgree&#x27;</span>&gt;</span>下一步<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- checkbox多选框 数组类型--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;篮球&quot;</span>    <span class="attr">v-model</span>=<span class="string">&#x27;hobbies&#x27;</span>&gt;</span>篮球</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;游戏&quot;</span>    <span class="attr">v-model</span>=<span class="string">&#x27;hobbies&#x27;</span>&gt;</span>游戏</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;听音乐&quot;</span>    <span class="attr">v-model</span>=<span class="string">&#x27;hobbies&#x27;</span>&gt;</span>听音乐</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;跑步&quot;</span>    <span class="attr">v-model</span>=<span class="string">&#x27;hobbies&#x27;</span>&gt;</span>跑步</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;游泳&quot;</span>    <span class="attr">v-model</span>=<span class="string">&#x27;hobbies&#x27;</span>&gt;</span>游泳</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;足球&quot;</span>    <span class="attr">v-model</span>=<span class="string">&#x27;hobbies&#x27;</span>&gt;</span>足球</span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>您的爱好&#123;&#123;hobbies&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- model 与 model  --&gt;</span></span><br><span class="line">      来自:</span><br><span class="line">      <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;from&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;上海&quot;</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;上海1&quot;</span>&gt;</span>上海1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;上海2&quot;</span>&gt;</span>上海2<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;上海3&quot;</span>&gt;</span>上海3<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;上海4&quot;</span>&gt;</span>上海4<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span>&gt;</span>您来自: &#123;&#123;from&#125;&#125; <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">viewContent</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">content</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">message</span>:<span class="string">&#x27;第三季啦&#x27;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 性别 默认男</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">sex</span>:<span class="string">&#x27;男&#x27;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 是否同意</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">isAgree</span>:<span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 爱好</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">hobbies</span>:[],</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 来自</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">from</span>:<span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">changeEvent</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.viewContent = <span class="built_in">this</span>.content;</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 用户输入实时改变message的值</span></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">valueChange</span>(<span class="params">event</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.message = event.target.value;</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">filters</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">changeCapitalLetter</span>(<span class="params">value</span>)</span> &#123;<span class="comment">//value是输入框的内容，也是要显示的内容</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">if</span> (value) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> str = value.toString();</span></span><br><span class="line"><span class="javascript">            <span class="comment">//获取英文，以空格分组把字符串转为数组，遍历每一项，第一项转为大写字母</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> newArr = str.split(<span class="string">&quot; &quot;</span>).map(<span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">              <span class="keyword">return</span> ele.charAt(<span class="number">0</span>).toUpperCase() + ele.slice(<span class="number">1</span>)</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> newArr.join(<span class="string">&quot; &quot;</span>)  <span class="comment">//数组转字符串 以空格输出。。。</span></span></span><br><span class="line"><span class="javascript">          &#125;</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>vue值绑定</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 爱好 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">label</span> <span class="attr">:for</span>=<span class="string">&quot;item&quot;</span> <span class="attr">v-for</span>=<span class="string">&#x27;item in hobbies&#x27;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:value</span>=<span class="string">&#x27;item&#x27;</span> <span class="attr">:id</span>=<span class="string">&#x27;item&#x27;</span> <span class="attr">v-model</span>=<span class="string">&#x27;hobby&#x27;</span>&gt;</span> &#123;&#123;item&#125;&#125; <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">h2</span>&gt;</span> 您的爱好是 &#123;&#123;hobby&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">   <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">     <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="javascript">     <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="javascript">       <span class="attr">hobbies</span>:[<span class="string">&#x27;篮球&#x27;</span>,<span class="string">&#x27;羽毛球&#x27;</span>,<span class="string">&#x27;足球&#x27;</span>,<span class="string">&#x27;原神&#x27;</span>,<span class="string">&#x27;台球&#x27;</span>,<span class="string">&#x27;睡觉&#x27;</span>,],</span></span><br><span class="line"><span class="javascript">       <span class="attr">hobby</span>:[<span class="string">&#x27;睡觉&#x27;</span>], <span class="comment">// 多选框  爱好</span></span></span><br><span class="line"><span class="javascript">     &#125;,</span></span><br><span class="line"><span class="javascript">     <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">     &#125;,</span></span><br><span class="line"><span class="javascript">     <span class="attr">filters</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">     &#125;,</span></span><br><span class="line"><span class="javascript">   &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"> </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<p>[tag]vue组件化[/tag]<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/vue-zu1.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zu2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zu3.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zu4.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zu5.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zu6.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zu7.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zus1.png" alt="请输入图片描述"><br>[collapse title=”vue组件化”]<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- // 3、使用组件 --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 全局 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">my-cpn</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 局部 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cpn3</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 子组件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cpn2</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">my</span>&gt;</span><span class="tag">&lt;/<span class="name">my</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ms</span>&gt;</span><span class="tag">&lt;/<span class="name">ms</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- cpns2 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my2</span>&gt;</span><span class="tag">&lt;/<span class="name">my2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 组件必须在vue实列中才会有效果 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app1&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 全局 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">my-cpn</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 局部 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;cpn&gt;&lt;/cpn&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-cpn1</span>&gt;</span><span class="tag">&lt;/<span class="name">my-cpn1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- -------------------------------------- --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 抽离template --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/x-template&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cpns1&quot;</span>&gt;</span><span class="handlebars"><span class="xml"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>模板抽离<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">  </span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpns2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>模板抽离2<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- -------------------------------- --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 1.创建组件构建器对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> cpnc = Vue.extend(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>: <span class="string">`&lt;div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;h2&gt;我是标题&lt;/h2&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;p&gt;我是内容，呃呃呃呃&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;p&gt;我是内容，哈哈哈哈哈&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">    &lt;/div&gt;`</span></span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript">    <span class="comment">// </span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 局部组件</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> cpnC = Vue.extend(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>: <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="javascript">    &lt;div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;h2&gt;我是局部&lt;/h2&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;p&gt;我是局部，呃呃呃呃&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;p&gt;我是局部，哈哈哈哈哈&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">    &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">    `</span></span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建第一个组件 (子组件)</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> cpn1 = Vue.extend(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>: <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;h2&gt;梁露讷，爱喝奶茶&lt;/h2&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;h3&gt;爱磨牙，打呼噜&lt;/h3&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">     &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      </span></span></span><br><span class="line"><span class="string"><span class="javascript">      `</span></span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建第二个··组件 （父组件）</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> cpn2 = Vue.extend(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>: <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;cpn1&gt;&lt;/cpn1&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;h2&gt;我是子组件&lt;/h2&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;h2&gt;子组件啊&lt;/h2&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      `</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 组件1注册在cpn2下</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">cpn1</span>: cpn1</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 2.注册组件 (全局组件，意味着可以在多个Vue的实列下使用)</span></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">&#x27;my-cpn&#x27;</span>, cpnc)   <span class="comment">// 组件构造器 cpnc    使用组名名 my-cpn</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// vue语法糖 全局组件</span></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">&#x27;my-cpn1&#x27;</span>,&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>:<span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;h2&gt;我是全局语法糖&lt;/h2&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;p&gt;我是内容，咿咿呀呀&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;p&gt;我是内容，嘤嘤嘤&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">    &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      `</span></span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"><span class="comment">// -----------------------------------------------</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// 模板抽离</span></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">&#x27;my&#x27;</span>,&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>:<span class="string">&#x27;#cpns1&#x27;</span></span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"> <span class="comment">// 全局组件 数据存放</span></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">&#x27;ms&#x27;</span>,&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>:<span class="string">&#x27;#ms1&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">titles</span>:<span class="string">&#x27;abs&#x27;</span></span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript">    <span class="comment">// -------------------------</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 局部组件</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// cpn使用组件的标签名</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">cpn</span>: cpnC,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 子组件</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">cpn2</span>:cpn2,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 子组件语法糖</span></span></span><br><span class="line"><span class="javascript">        <span class="string">&#x27;cpn3&#x27;</span>:&#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">template</span>:</span></span><br><span class="line"><span class="javascript">          <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="javascript">          &lt;div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;h2&gt;我是局部语法糖&lt;/h2&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;p&gt;我是局部，咿咿呀呀&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">      &lt;p&gt;我是局部，嘤嘤嘤&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">    &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">          `</span></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="string">&#x27;my2&#x27;</span>:&#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">template</span>:<span class="string">&#x27;#cpns2&#x27;</span></span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">filters</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 实列2</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm1 = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">el</span>: <span class="string">&#x27;#app1&#x27;</span></span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>[/collapse]<br>[tag type=”primary”]vue的通信[/tag]<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zs1.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zs2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zs3.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zs4.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/zs5.png" alt="请输入图片描述"><br>[collapse title=”组件中的函数问题”]<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 组件实列 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cpn</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 父传子 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;cpn&gt;&lt;/cpn&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cpn1</span> <span class="attr">:cmovies</span>=<span class="string">&#x27;movies&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;my&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>我是组件</span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;count&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&#x27;increment&#x27;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&#x27;decrement&#x27;</span> <span class="attr">:disabled</span>=<span class="string">&#x27;count &lt;= 0&#x27;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpns&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&#x27;m in cmovies&#x27;</span>&gt;</span> &#123;&#123;m&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 组件全局</span></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">&#x27;cpn&#x27;</span>, &#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>: <span class="string">&#x27;#my&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">count</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// data必须是函数对象，多次调用数据互不影响</span></span></span><br><span class="line"><span class="javascript">      </span></span><br><span class="line"><span class="javascript">      <span class="comment">// 方法</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">increment</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.count++</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">decrement</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.count--</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">     </span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 父传子 props</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> cpn1 = &#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>:<span class="string">&#x27;#cpns&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">props</span>: [<span class="string">&#x27;cmovies&#x27;</span>],</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// ---------------------------------</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">movies</span>:[<span class="string">&#x27;事件&#x27;</span>,<span class="string">&#x27;时间&#x27;</span>,<span class="string">&#x27;外网&#x27;</span>,<span class="string">&#x27;暗网&#x27;</span>]</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">filters</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="javascript">        cpn1</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>[/collapse]<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-s1.png" alt="请输入图片描述"><br>[collapse title=”父传子2”]<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这里把data中的数据，传递过来 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cpn</span> <span class="attr">:cinfo</span>=<span class="string">&#x27;info&#x27;</span> <span class="attr">:child-my-message</span>=<span class="string">&#x27;message&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- ------------------------- --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 父传子模板 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 模板之中只能有一个父级元素 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;cinfo&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&#x27;(value,key,index) in cinfo&#x27;</span>&gt;</span>&#123;&#123;key&#125;&#125;--&#123;&#123;value&#125;&#125;---&#123;&#123;index&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;childMyMessage&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- ----------------------- --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> cpn = &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 传入template id</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>: <span class="string">&#x27;#cpn&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 定义cinfo 属性</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//  cInfo 不支持驼峰命名</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">cinfo</span>: &#123;</span></span><br><span class="line"><span class="javascript">          <span class="comment">// 类型  </span></span></span><br><span class="line"><span class="javascript">          <span class="attr">type</span>: <span class="built_in">Object</span>,</span></span><br><span class="line"><span class="javascript">          <span class="comment">// 默认必须是函数 ，数组，对象时</span></span></span><br><span class="line"><span class="javascript">          <span class="function"><span class="title">default</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">          &#125;</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 驼峰命名</span></span></span><br><span class="line"><span class="javascript">        <span class="attr">childMyMessage</span>: &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">type</span>:<span class="built_in">String</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">dafault</span>:<span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// ------------------------</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">info</span>: &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">name</span>: <span class="string">&#x27;why&#x27;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">age</span>: <span class="number">19</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">height</span>: <span class="number">1.87</span></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="attr">message</span>:<span class="string">&#x27;驼峰命名，--连接&#x27;</span></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">filters</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="javascript">        cpn</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>[/collapse]</p>
<hr>
<h4 id="子传父"><a href="#子传父" class="headerlink" title="子传父"></a>子传父</h4><p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-s2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-s3.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-s4.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-s5.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-s6.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-s7.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/v-s8.png" alt="请输入图片描述"><br>[collapse title=”子传父”]<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这里把子组件中的数据，传递过来 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 脚手架可以写驼峰 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cpn</span> @<span class="attr">item-click</span>=<span class="string">&#x27;cpnClick&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">cpn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- ------------------------- --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 子组件模板 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;cpn&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 模板之中只能有一个父级元素 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-for</span>=<span class="string">&#x27;item in categories&#x27;</span> @<span class="attr">click</span>=<span class="string">&#x27;btnClick(item)&#x27;</span>&gt;</span></span><br><span class="line">        &#123;&#123;item.name&#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- ----------------------- --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 子组件</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> cpn = &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 传入template id</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">template</span>: <span class="string">&#x27;#cpn&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">categories</span>: [</span></span><br><span class="line"><span class="javascript">            &#123; <span class="attr">id</span>: <span class="string">&#x27;aaa&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;热门推荐&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">            &#123; <span class="attr">id</span>: <span class="string">&#x27;bbb&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;手机数码&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">            &#123; <span class="attr">id</span>: <span class="string">&#x27;ccc&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;家具家电&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">            &#123; <span class="attr">id</span>: <span class="string">&#x27;ddd&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;电脑办公&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">          ]</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// methods 方法</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">btnClick</span>(<span class="params">item</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="comment">// console.log(item.id);</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// console.log(item.name);</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">// 发射 $emit(自定义事件)  itemClick 自定义事件名称  item 传递的参数</span></span></span><br><span class="line"><span class="javascript">          <span class="comment">//  子传父</span></span></span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.$emit(<span class="string">&#x27;item-click&#x27;</span>,item)</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// ------------------------</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">info</span>: &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">name</span>: <span class="string">&#x27;why&#x27;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">age</span>: <span class="number">19</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">height</span>: <span class="number">1.87</span></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="attr">message</span>: <span class="string">&#x27;驼峰命名，--连接&#x27;</span></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">cpnClick</span>(<span class="params">item</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">&#x27;cpnClick&#x27;</span>,item);</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(item.id);</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(item.name);</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">filters</span>: &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="javascript">        cpn</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>[/collapse]<br>[tag type=”info”]组件通信脚手架强化[/tag]<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/math.gif" alt="请输入图片描述"><br>[tabs]</p>
<p>[tab title=”App.vue”]<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>测试题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">subject</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-for</span>=<span class="string">&quot;(m, index) in list&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:sum1</span>=<span class="string">&quot;m.sum1&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:sum2</span>=<span class="string">&quot;m.sum2&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:index</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">subject</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">flag</span> <span class="attr">:list</span>=<span class="string">&quot;list&quot;</span> <span class="attr">class</span>=<span class="string">&quot;flags&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">flag</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;showList&quot;</span>&gt;</span>再来一题<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 引入subject ,flag 组件</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> subject <span class="keyword">from</span> <span class="string">&quot;./components/subject.vue&quot;</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> flag <span class="keyword">from</span> <span class="string">&quot;./components/flag.vue&quot;</span>;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">list</span>: [</span></span><br><span class="line"><span class="javascript">        &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum1</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum2</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">id</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">status</span>: <span class="string">&quot;未完成&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">bool</span>: <span class="string">&quot;true&quot;</span>,  <span class="comment">// 正确答案状态</span></span></span><br><span class="line"><span class="javascript">          <span class="attr">err</span>: <span class="string">&quot;false&quot;</span>,  <span class="comment">// 错误答案状态</span></span></span><br><span class="line"><span class="javascript">          <span class="attr">do</span>: <span class="string">&quot;true&quot;</span>,  <span class="comment">// 未完成状态  默认未true</span></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum1</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum2</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">id</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">status</span>: <span class="string">&quot;未完成&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">bool</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">err</span>: <span class="string">&quot;false&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">do</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum1</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum2</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">id</span>: <span class="number">3</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">status</span>: <span class="string">&quot;未完成&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">bool</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">err</span>: <span class="string">&quot;false&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">do</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum1</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum2</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">id</span>: <span class="number">4</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">status</span>: <span class="string">&quot;未完成&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">bool</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">err</span>: <span class="string">&quot;false&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">do</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum1</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">sum2</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">id</span>: <span class="number">5</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">status</span>: <span class="string">&quot;未完成&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">bool</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">err</span>: <span class="string">&quot;false&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">do</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">      ],</span></span><br><span class="line"><span class="javascript">    &#125;;</span></span><br><span class="line"><span class="javascript">  &#125;,</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 组件</span></span></span><br><span class="line"><span class="javascript">  <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="javascript">    subject,</span></span><br><span class="line"><span class="javascript">    flag,</span></span><br><span class="line"><span class="javascript">  &#125;,</span></span><br><span class="line"><span class="javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">showList</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.list.push(&#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">sum1</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">sum2</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">10</span> + <span class="number">1</span>)&#125;</span>`</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">id</span>: <span class="built_in">this</span>.list.length == <span class="number">0</span> ? <span class="number">1</span> : <span class="built_in">this</span>.list[<span class="built_in">this</span>.list.length - <span class="number">1</span>].id + <span class="number">1</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">status</span>: <span class="string">&quot;未完成&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">bool</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">err</span>: <span class="string">&quot;false&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">do</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="javascript">      &#125;);</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">  &#125;,</span></span><br><span class="line"><span class="javascript">&#125;;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-id">#app</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">50px</span> auto;</span></span><br><span class="line"><span class="css">  <span class="attribute">box-shadow</span>: <span class="number">3px</span> <span class="number">3px</span> <span class="number">3px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">2em</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.flags</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-wrap</span>: wrap;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><br>[/tab]</p>
<p>[tab title=”compoents-subject.vue”]<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;subject&quot;&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123; sum1 &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;span&gt;+&lt;/span&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123; sum2 &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;span&gt;=&lt;/span&gt;</span><br><span class="line">      &lt;input type=&quot;number&quot; v-model=&quot;lastSum&quot;/&gt;</span><br><span class="line">      &lt;button @click=&quot;btn&quot;&gt;提交&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import event from &#x27;../EventBus/index.js&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      lastSum: &quot;&quot;,</span><br><span class="line">      idnex:0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  props: [&quot;sum1&quot;, &quot;sum2&quot;, &quot;index&quot;, &quot;list&quot;],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    btn()&#123;</span><br><span class="line">      // 判断是否输入值</span><br><span class="line">      if(this.lastSum == &#x27;&#x27;)&#123;</span><br><span class="line">        alert(&#x27;请填写答案&#x27;)</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">      event.$emit(&#x27;send&#x27;,this.index,this.lastSum);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.subject &#123;</span><br><span class="line">  margin: 5px;</span><br><span class="line">  padding: 5px;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">&#125;</span><br><span class="line">.subject span &#123;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  text-align: center;</span><br><span class="line">  width: 20px;</span><br><span class="line">&#125;</span><br><span class="line">.subject input &#123;</span><br><span class="line">  width: 50px;</span><br><span class="line">  height: 20px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><br>[/tab]</p>
<p>[tab title=”components-flag.vue”]<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;m in dlist&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; right: m.bool, error: m.err, undo: m.do &#125;&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span>&#123;&#123; m.id &#125;&#125;: &#123;&#123; m.status &#125;&#125;&lt;/span</span><br><span class="line">      &gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 传递eventbus</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> event <span class="keyword">from</span> <span class="string">&quot;../EventBus&quot;</span>;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">dlist</span>: <span class="built_in">this</span>.list, <span class="comment">// 重新定义数据</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">dsum</span>: <span class="string">&quot;&quot;</span>, <span class="comment">//正确的值</span></span></span><br><span class="line"><span class="javascript">    &#125;;</span></span><br><span class="line"><span class="javascript">  &#125;,</span></span><br><span class="line"><span class="javascript">  <span class="attr">props</span>: [<span class="string">&quot;id&quot;</span>, <span class="string">&quot;index&quot;</span>, <span class="string">&quot;list&quot;</span>],</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    event.$on(<span class="string">&quot;send&quot;</span>, <span class="function">(<span class="params">index, value</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(index, <span class="string">&quot;----------index&quot;</span>); <span class="comment">// 下标</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(value, <span class="string">&quot;------------value&quot;</span>); <span class="comment">// v-model 传递的值</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.dsum = <span class="built_in">this</span>.dlist[index].sum1 * <span class="number">1</span> + <span class="built_in">this</span>.dlist[index].sum2 * <span class="number">1</span>; <span class="comment">// 正确的值</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// 和 dsum   index下标  value 传递的值</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (value == <span class="built_in">this</span>.dsum) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.dlist[index].status = <span class="string">&quot;正确&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.dlist[index].bool = <span class="literal">true</span>; <span class="comment">//修改当前正确的状态</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.dlist[index].err = <span class="literal">false</span>; <span class="comment">//错误</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.dlist[index].do = <span class="literal">false</span>; <span class="comment">// 未完成</span></span></span><br><span class="line"><span class="javascript">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value != <span class="built_in">this</span>.dsum) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.dlist[index].status = <span class="string">&quot;错误&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.dlist[index].bool = <span class="literal">false</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.dlist[index].err = <span class="literal">true</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.dlist[index].do = <span class="literal">false</span>;</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;);</span></span><br><span class="line"><span class="javascript">  &#125;,</span></span><br><span class="line"><span class="javascript">&#125;;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.error</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.undo</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><br>[/tab]</p>
<p>[tab title=”EventBus-index.js”]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vue();</span><br></pre></td></tr></table></figure><br>[/tab]</p>
<p>[/tabs]<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/nav.png" alt="请输入图片描述"></p>
<h3 id="1、Vue-的-nextTick-的原理是什么"><a href="#1、Vue-的-nextTick-的原理是什么" class="headerlink" title="1、Vue 的 nextTick 的原理是什么?"></a>1、Vue 的 nextTick 的原理是什么?</h3><p>​    \1. 为什么需要 nextTick ，Vue 是异步修改 DOM 的并且不鼓励开发者直接接触 DOM，但有时候业务需要必须对数据更改—刷新后的 DOM 做相应的处理，这时候就可以使用 Vue.nextTick(callback)这个 api 了。</p>
<p>​    \2. 理解原理前的准备 首先需要知道事件循环中宏任务和微任务这两个概念,常见的宏任务有 script, setTimeout, setInterval, setImmediate, I/O, UI rendering 常见的微任务有 process.nextTick(Nodejs),Promise.then(), MutationObserver;</p>
<p>​    \3. 理解 nextTick 的原理正是 vue 通过异步队列控制 DOM 更新和 nextTick 回调函数先后执行的方式。如果大家看过这部分的源码，会发现其中做了很多 isNative()的判断，因为这里还存在兼容性优雅降级的问题。可见 Vue 开发团队的深思熟虑，对性能的良苦用心。</p>
<h3 id="2、vue生命周期总共分为几个阶段？（必会）"><a href="#2、vue生命周期总共分为几个阶段？（必会）" class="headerlink" title="2、vue生命周期总共分为几个阶段？（必会）"></a>2、vue生命周期总共分为几个阶段？（必会）</h3><p>   Vue 实例从创建到销毁的过程，就是生命周期。也就是从开始创建、初始化数据、编译模板、挂载Dom→渲染、更新→渲染、卸载等一系列过程，我们称这是 Vue 的生命周期。</p>
<p><strong>1**</strong>）beforeCreate**</p>
<p>​    在实例初始化之后，数据观测 (data observer) 和 event/watcher 事件配置之前被调用。</p>
<p><strong>2**</strong>）created**</p>
<p>​    在实例创建完成后被立即调用。在这一步，实例已完成以下的配置：数据观测 (data observer)， 属性和方法的运算，watch/event 事件回调。然而，挂载阶段还没开始，$el 属性目前不可见。</p>
<p><strong>3**</strong>）beforeMount**</p>
<p>​    在挂载开始之前被调用：相关的 render 函数首次被调用。</p>
<p><strong>4**</strong>）mounted**</p>
<p>​    el 被新创建的 vm.$el 替换，并挂载到实例上去之后调用该钩子。如果 root 实例挂载了一个文档内元素，当 mounted 被调用时 vm.$el 也在文档内。</p>
<p><strong>5**</strong>）beforeUpdate**</p>
<p>​    数据更新时调用，发生在虚拟 DOM 打补丁之前。这里适合在更新之前访问现有的 DOM，比如手动移除已添加的事件监听器。该钩子在服务器端渲染期间不被调用，因为只有初次渲染会在服务端进行。</p>
<p><strong>6**</strong>）updated**</p>
<p>​    由于数据更改导致的虚拟 DOM 重新渲染和打补丁，在这之后会调用该钩子。</p>
<p><strong>7**</strong>）activated**</p>
<p>​    keep-alive 组件激活时调用。该钩子在服务器端渲染期间不被调用。</p>
<p><strong>8**</strong>）deactivated**</p>
<p>​    keep-alive 组件停用时调用。该钩子在服务器端渲染期间不被调用。</p>
<p><strong>9**</strong>）beforeDestroy**</p>
<p>​    实例销毁之前调用。在这一步，实例仍然完全可用。该钩子在服务器端渲染期间不被调用。</p>
<p><strong>10**</strong>）destroyed**</p>
<p>​    Vue 实例销毁后调用。调用后，Vue 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。该钩子在服务器端渲染期间不被调用。</p>
<p><strong>11**</strong>）errorCaptured（2.5.0+ 新增）**</p>
<p>​    当捕获一个来自子孙组件的错误时被调用。此钩子会收到三个参数：错误对象、发生错误的组件实例以及一个包含错误来源信息的字符串。此钩子可以返回 false 以阻止该错误继续向上传播。</p>
<h3 id="3、第一次加载页面会触发哪几个钩子函数？（必会）"><a href="#3、第一次加载页面会触发哪几个钩子函数？（必会）" class="headerlink" title="3、第一次加载页面会触发哪几个钩子函数？（必会）"></a>3、第一次加载页面会触发哪几个钩子函数？（必会）</h3><p>   当页面第一次页面加载时会触发 beforeCreate, created, beforeMount, mounted 这几个钩子函数</p>
<hr>
<p>[tag type=”success”]vue简答题[/tag]</p>
<h2 id="✳vue中的data为什么是一个函数"><a href="#✳vue中的data为什么是一个函数" class="headerlink" title="✳vue中的data为什么是一个函数"></a>✳vue中的data为什么是一个函数</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">组件中的 data 写成一个函数，数据以函数返回值形式定义，这样每复用一次组件，就会返回一份新的 data，类似于给每个组件实例创建一个私有的数据空间，让各个组件实例维护各自的数据。而单纯的写成对象形式，就使得所有组件实例共用了一份 data，就会造成一个变了全都会变的结果</span><br><span class="line"></span><br><span class="line">得分关键点：各个组件实例维护各自的数据</span><br></pre></td></tr></table></figure>
<h2 id="✳目前学过的vue组件通信有哪几种方式，分别是如何实现的"><a href="#✳目前学过的vue组件通信有哪几种方式，分别是如何实现的" class="headerlink" title="✳目前学过的vue组件通信有哪几种方式，分别是如何实现的"></a>✳目前学过的vue组件通信有哪几种方式，分别是如何实现的</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">三种：</span><br><span class="line">1. 父子通信</span><br><span class="line">	    通过props实现的，父组件向子组件传递数据, 子组件通过 prop接受父组件传递的数据</span><br><span class="line">2. 子父同信</span><br><span class="line">		通过给子组件传递自定义事件，在子组件用使用this.$emit去触发父组件传递的自定义事件，完成子组件向父组件通信</span><br><span class="line">3. 兄弟组件通信</span><br><span class="line">		通过事件总线实现的， 原理就是创建一个vue实例，这个Vue实例，主要负责发布订阅功能，在需要修改数据的组件中，Eventbus.$on订阅事件，在需要触发事件的组件中使用EventBus.$emit(‘事件名称’)触发事件，完成兄弟组件通信</span><br></pre></td></tr></table></figure>
<h2 id="✳Vue的生命周期方法有几大阶段，每个阶段分别有哪些钩子函数-每个钩子函数可以做哪些事情，一般在哪一步发送请求？"><a href="#✳Vue的生命周期方法有几大阶段，每个阶段分别有哪些钩子函数-每个钩子函数可以做哪些事情，一般在哪一步发送请求？" class="headerlink" title="✳Vue的生命周期方法有几大阶段，每个阶段分别有哪些钩子函数,每个钩子函数可以做哪些事情，一般在哪一步发送请求？"></a>✳Vue的生命周期方法有几大阶段，每个阶段分别有哪些钩子函数,每个钩子函数可以做哪些事情，一般在哪一步发送请求？</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">四大阶段：</span><br><span class="line">1. 创建/初始化阶段</span><br><span class="line">beforeCreate 。</span><br><span class="line">		在当前阶段 data、methods、computed 以及 watch 上的数据和方法都不能被访问</span><br><span class="line">created     </span><br><span class="line">		在当前阶段可以访问data中变量,method中的方法, 但是无法访问页面真实dom, 如果非要想与 Dom 进行交互，可以通过 vm.$nextTick 来访问 Dom</span><br><span class="line">2. 挂载阶段</span><br><span class="line">beforeMount。</span><br><span class="line">	    在当前阶段dom在内存中已经生成，但是还没有渲染到浏览器页面上</span><br><span class="line">mounted </span><br><span class="line">		在挂载完成后发生，在当前阶段，真实的 Dom 挂载完毕，数据完成双向绑定，可以访问到 Dom 节点</span><br><span class="line">3. 更新阶段</span><br><span class="line">beforeUpdate</span><br><span class="line">		 数据更新后，更新后的数据已经在内存中已经生成dom，但是还没有渲染到浏览器页面上</span><br><span class="line">updated </span><br><span class="line">		发生在更新完成之后，当前阶段组件 Dom 已完成更新。要注意的是避免在此期间更改数据，因为这可能会导致无限循环的更新，该钩子在服务器端渲染期间不被调用。</span><br><span class="line">4. 销毁阶段</span><br><span class="line">		beforeDestroy </span><br><span class="line">			实例销毁之前调用。在这一步，实例仍然完全可用。我们可以在这时进行善后收尾工作，比如清除计时器。</span><br><span class="line">		destroyed </span><br><span class="line">			Vue 实例销毁后调用。调用后，Vue 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。</span><br><span class="line"></span><br><span class="line">异步请求在哪一步发起？</span><br><span class="line">可以在钩子函数 created、beforeMount、mounted 中进行异步请求，因为在这三个钩子函数中，data 已经创建，可以将服务端端返回的数据进行赋值。</span><br><span class="line">如果异步请求不需要依赖 Dom 推荐在 created 钩子函数中调用异步请求, 否则，在mounted中发起异步请求</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="✳v-if-和-v-show-的区别和使用场景"><a href="#✳v-if-和-v-show-的区别和使用场景" class="headerlink" title="✳v-if 和 v-show 的区别和使用场景"></a>✳v-if 和 v-show 的区别和使用场景</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1、v-if 可以搭配 template 使用，而 v-show 不行</span><br><span class="line">2、v-if 有配套的 v-else-if 和 v-else，而 v-show 没有</span><br><span class="line">3、v-show 只是简单的控制元素的 display 属性，而 v-if 才是条件渲染（条件为真，元素将会被渲染，条件为假，元素会被销毁）</span><br><span class="line">使用场景：</span><br><span class="line">v-if 适用于在运行时很少改变条件，不需要频繁切换条件的场景</span><br><span class="line">v-show 适用于需要非常频繁切换条件的场景</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="✳说说常用vue的内置指令，至少4个"><a href="#✳说说常用vue的内置指令，至少4个" class="headerlink" title="✳说说常用vue的内置指令，至少4个"></a>✳说说常用vue的内置指令，至少4个</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v-once(定义它的元素或组件只渲染一次)、</span><br><span class="line">v-bind(绑定属性)</span><br><span class="line">v-on(用于监听DOM事件)</span><br><span class="line">v-html(更新元素的 innerHTML)</span><br><span class="line">v-text(更新元素的textContent)</span><br><span class="line">v-model(表单控件或者组件上创建双向绑定)</span><br><span class="line">v-if/v-else/v-else-if(条件渲染，可以配合template来使用)</span><br><span class="line">v-show(控制显示隐藏，最终通过display)</span><br><span class="line">v-for(循环指令，比v-if优先级高)</span><br><span class="line">v-pre(跳过这个元素以及子元素的编译过程)</span><br></pre></td></tr></table></figure>
<h2 id="✳怎么样理解Vue的单向数据流"><a href="#✳怎么样理解Vue的单向数据流" class="headerlink" title="✳怎么样理解Vue的单向数据流"></a>✳怎么样理解Vue的单向数据流</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">数据总是从父组件传到子组件，子组件没有权利修改父组件传过来的数据，只能请求父组件对原始数据进行修改。这样会防止从子组件意外改变父级组件的状态，从而导致你的应用的数据流向难以理解。</span><br><span class="line">如果实在要改变父组件的 prop 值 可以再 data 里面定义一个变量 并用 prop 的值初始化它 之后用$emit 通知父组件去修改</span><br></pre></td></tr></table></figure>
<h2 id="✳v-if-与-v-for-为什么不建议一起使用"><a href="#✳v-if-与-v-for-为什么不建议一起使用" class="headerlink" title="✳v-if 与 v-for 为什么不建议一起使用"></a>✳v-if 与 v-for 为什么不建议一起使用</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v-for 和 v-if 不要在同一个标签中使用,因为解析时先解析 v-for 再解析 v-if。如果遇到需要同时使用时可以考虑写成计算属性的方式。</span><br></pre></td></tr></table></figure>
<h2 id="✳computed-和-watch-的区别和运用的场景"><a href="#✳computed-和-watch-的区别和运用的场景" class="headerlink" title="✳computed 和 watch 的区别和运用的场景"></a>✳computed 和 watch 的区别和运用的场景</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">computed 是计算属性，依赖其他属性计算值，并且 computed 的值有缓存，只有当计算值变化才会返回内容，它可以设置 getter 和 setter。</span><br><span class="line">watch 监听到值的变化就会执行回调，在回调中可以进行一些逻辑操作。</span><br><span class="line">计算属性一般用在模板渲染中，某个值是依赖了其它的响应式对象甚至是计算属性计算而来；而侦听属性适用于观测某个值的变化去完成一段复杂的业务逻辑</span><br></pre></td></tr></table></figure>
<h2 id="✳什么是匿名插槽、具名插槽和作用域插槽"><a href="#✳什么是匿名插槽、具名插槽和作用域插槽" class="headerlink" title="✳什么是匿名插槽、具名插槽和作用域插槽"></a>✳什么是匿名插槽、具名插槽和作用域插槽</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">匿名插槽，我们也可以叫它单个插槽或者默认插槽。和具名插槽相对，它是不需要设置 name 属性的，它隐藏的name属性为default。</span><br><span class="line">具名插槽,顾名思义就是slot 是带有name的 ，定义： 或者使用简单缩写的定义 #header 使用：要用一个 template标签包裹。</span><br><span class="line">作用域插槽就是让插槽内容能够访问子组件中才有的数据。</span><br></pre></td></tr></table></figure>
<h2 id="✳-Vue中-key作用-为什么不能用索引"><a href="#✳-Vue中-key作用-为什么不能用索引" class="headerlink" title="✳ Vue中:key作用, 为什么不能用索引"></a>✳ Vue中:key作用, 为什么不能用索引</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">:key是给v-for循环生成标签颁发唯一标识的, 用于性能的优化</span><br><span class="line"></span><br><span class="line">因为v-for数据项的顺序改变，Vue 也不会移动 DOM 元素来匹配数据项的顺序，而是就地更新每个元素</span><br><span class="line"></span><br><span class="line">:key如果是索引, 因为索引是连续的, 如果删除其中某一个, 会导致最后一个被删除</span><br><span class="line"></span><br><span class="line">当我们再删除的时候, :key再根据数据来把新旧的dom对比时, 删除:key不存在的对应的标签(添加也是一样的插入到指定位置, 别的都不会动)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>无感登录之react</title>
    <url>/archives/f774ddf.html</url>
    <content><![CDATA[<blockquote>
<h3 id="目标：实现用户无感知自动登录功能"><a href="#目标：实现用户无感知自动登录功能" class="headerlink" title="目标：实现用户无感知自动登录功能"></a>目标：实现用户无感知自动登录功能</h3></blockquote>
<p>当用户登录凭据 (token) 失效时使用 refresh_token 置换新的用户登录凭据 (token)。</p>
<p>发送请求获取登录用户数据，由于用户登录凭据失效服务端返回 401 状态码。</p>
<p>使用 refresh_token 再次向服务端发送请求获取新的用户登录凭据。<a href="http://toutiao.itheima.net/api.html#u5237u65b0u7528u6237token0a3ca20id3du5237u65b0u7528u6237token3e203ca3e">刷新用户 token</a></p>
<p>新的用户登录凭据获取成功后再次向服务端发送请求获取登录用户数据。</p>
<blockquote>
<h3 id="请求的主入口文件"><a href="#请求的主入口文件" class="headerlink" title="请求的主入口文件"></a>请求的主入口文件</h3></blockquote>
<p><img src="https://files.catbox.moe/ygf8bg.png" alt=""></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit/query/react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppState &#125; <span class="keyword">from</span> <span class="string">&quot;@store/index&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; resetCredentials, saveCredentials &#125; <span class="keyword">from</span> <span class="string">&quot;@slice/credentials&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> request = fetchBaseQuery(&#123;</span><br><span class="line">  <span class="attr">baseUrl</span>: process.env.REACT_APP_BASE_URL,</span><br><span class="line">  <span class="attr">prepareHeaders</span>: <span class="function">(<span class="params">headers, api</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 监测是否存在token</span></span><br><span class="line">    <span class="keyword">if</span> (headers.has(<span class="string">&quot;authorization&quot;</span>)) <span class="keyword">return</span> headers;</span><br><span class="line">    <span class="comment">// // 获取token，设置请求头</span></span><br><span class="line">    <span class="keyword">const</span> token = (api.getState() <span class="keyword">as</span> AppState).credentials.token;</span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      headers.set(<span class="string">&quot;authorization&quot;</span>, <span class="string">`Bearer <span class="subst">$&#123;token&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> headers;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> apiService = createApi(&#123;</span><br><span class="line">  <span class="attr">reducerPath</span>: <span class="string">&quot;apiReducer&quot;</span>,</span><br><span class="line">  <span class="attr">baseQuery</span>: <span class="keyword">async</span> (args, api, extraOptions) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 发送请求</span></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> request(args, api, extraOptions);</span><br><span class="line">    <span class="comment">// 进入判断，发生请求错误</span></span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      <span class="keyword">typeof</span> response.error !== <span class="string">&quot;undefined&quot;</span> &amp;&amp;</span><br><span class="line">      response.error.status === <span class="number">401</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; router &#125; = <span class="built_in">require</span>(<span class="string">&quot;@router/index&quot;</span>);</span><br><span class="line">      <span class="comment">// 获取当前页面路由信息, 为跳转做准备</span></span><br><span class="line">      <span class="keyword">const</span> &#123; pathname, search, hash &#125; = router.state.location;</span><br><span class="line">      <span class="comment">//1.本地的refresh token</span></span><br><span class="line">      <span class="keyword">const</span> refresh_token = (api.getState() <span class="keyword">as</span> AppState).credentials</span><br><span class="line">        .refresh_token;</span><br><span class="line">      <span class="comment">//2.如果本地没有refresh token,跳转到登录页面</span></span><br><span class="line">      <span class="keyword">if</span> (refresh_token) &#123;</span><br><span class="line">        <span class="comment">//3.如果本地有refresh token,向服务端发送请求，获取新的toke</span></span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> request(</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/authorizations&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">              <span class="attr">authorization</span>: <span class="string">`Bearer <span class="subst">$&#123;refresh_token&#125;</span>`</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          api,</span><br><span class="line">          extraOptions</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">//4.如果新的token获取成功，将最新的token保存回本地</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> response.error === <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">          api.dispatch(</span><br><span class="line">            saveCredentials(&#123;</span><br><span class="line">              <span class="attr">token</span>: (response.data <span class="keyword">as</span> GeekResponse&lt;&#123; <span class="attr">token</span>: <span class="built_in">string</span> &#125;&gt;).data</span><br><span class="line">                .token,</span><br><span class="line">              refresh_token,</span><br><span class="line">            &#125;)</span><br><span class="line">          );</span><br><span class="line"></span><br><span class="line">          <span class="comment">// const headers = new Headers(args.headers);</span></span><br><span class="line">          <span class="comment">// if (headers.get(&#x27;authorization&#x27;)) &#123;</span></span><br><span class="line">          <span class="comment">//     const token = store.getState().credentials.token;</span></span><br><span class="line">          <span class="comment">//     if (token) &#123;</span></span><br><span class="line">          <span class="comment">//         headers.set(&#x27;authorization&#x27;, `Bearer $&#123;token&#125;`);</span></span><br><span class="line">          <span class="comment">//     &#125;</span></span><br><span class="line">          <span class="comment">// &#125;</span></span><br><span class="line">          <span class="comment">// console.log(args, &#x27;args--header--&#x27;)</span></span><br><span class="line">          <span class="comment">// console.log(headers.get(&#x27;authorization&#x27;),&#x27;headers----------------------------------------&#x27;)</span></span><br><span class="line">          <span class="comment">// const token_now = (api.getState() as AppState).credentials.token</span></span><br><span class="line">          <span class="comment">// console.log(token_now, &#x27;token-------store--------&#x27;)</span></span><br><span class="line">          <span class="comment">// 重新发送原始请求</span></span><br><span class="line">          <span class="comment">// return request(&#123; ...args, headers &#125;, api, extraOptions)</span></span><br><span class="line">          <span class="keyword">return</span> request(args, api, extraOptions);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// token 换取失败</span></span><br><span class="line">          api.dispatch(resetCredentials());</span><br><span class="line">          <span class="comment">//6.如果token换取失败，跳转到登录</span></span><br><span class="line">          router.navigate(</span><br><span class="line">            &#123; <span class="attr">pathname</span>: <span class="string">&quot;/login&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">replace</span>: <span class="literal">true</span>, <span class="attr">state</span>: &#123; <span class="attr">form</span>: pathname + search + hash &#125; &#125;</span><br><span class="line">          );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.使用新的token获取受保护资源并返回响应</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//6.如果token换取失败，跳转到登录</span></span><br><span class="line">        router.navigate(</span><br><span class="line">          &#123; <span class="attr">pathname</span>: <span class="string">&quot;/login&quot;</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">replace</span>: <span class="literal">true</span>, <span class="attr">state</span>: &#123; <span class="attr">form</span>: pathname + search + hash &#125; &#125;</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">endpoints</span>: <span class="function">() =&gt;</span> (&#123;&#125;),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="具体请求用户信息入口文件"><a href="#具体请求用户信息入口文件" class="headerlink" title="具体请求用户信息入口文件"></a>具体请求用户信息入口文件</h3></blockquote>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; apiService &#125; <span class="keyword">from</span> <span class="string">&quot;@service/index&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; store &#125; <span class="keyword">from</span> <span class="string">&quot;@store/index&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userApiService = apiService.injectEndpoints(&#123;</span><br><span class="line">  <span class="attr">endpoints</span>: <span class="function">(<span class="params">build</span>) =&gt;</span> (&#123;</span><br><span class="line">    <span class="comment">// 获取用户信息</span></span><br><span class="line">    <span class="attr">requestUser</span>: build.query&lt;UserResponse, <span class="literal">undefined</span>&gt;(&#123;</span><br><span class="line">      <span class="attr">query</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&quot;/user&quot;</span>,</span><br><span class="line">        <span class="comment">// headers: &#123;</span></span><br><span class="line">        <span class="comment">//     authorization: `Bearer $&#123;store.getState().credentials.token&#125;`,</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; useRequestUserQuery &#125; = userApiService;</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="记录我踩的坑"><a href="#记录我踩的坑" class="headerlink" title="记录我踩的坑"></a>记录我踩的坑</h3></blockquote>
<p>每次执行获取用户信息，headers 携带 store 中的 token，看起来没毛病，实际也没有毛病<br><img src="https://files.catbox.moe/r3qr8p.png" alt=""><br>马上出毛病的地方来了，为了捕获每次请求的错误，重写请求方法 <code>fetchBaseQuery</code>,也就是<code>request</code>。问题的出现:当我捕获到请求发生错误，使用<code>refresh_token</code>重新请求新的 token，保存新的 token 在 store 中，重新获取上一次的请求，此时 <code>args</code>的 <code>headers</code> 中的 token 还是上一次的 token，这就出现了，新的 token 获取到，但是请求因为错误的 <code>token</code> 没有成功，依然是失败状态。(原因：注释掉<code>requestUser</code>中的<code>headers</code>方法，因为<code>headers</code>中已经存在了<code>token</code>，就不会重新获取<code>store</code>中的<code>token</code>，而直接<code>return</code> <code>headers</code>)。既然问题找到原因，我头铁我不改，继续向下,在每次捕获到错误时，重新获取 token，再次设置 headers，覆盖 args 中的 headers 请求信息，完成。</p>
<p><img src="https://files.catbox.moe/o99fhn.png" alt=""><br>这样解决更麻烦，折腾人，但也何尝不是一种解决办法<br><img src="https://files.catbox.moe/zyqwn0.png" alt=""><br>为啥不直接获取 router，使用 import 导入,在代码执行时，store 中的代码先执行，router 还没有准备好，获取不到 router，使用<code>require</code> 导入<br><img src="https://files.catbox.moe/du3dm6.png" alt=""><br><img src="https://files.catbox.moe/4jwbtg.png" alt=""></p>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>无感登录</tag>
        <tag>toolkit</tag>
      </tags>
  </entry>
  <entry>
    <title>blog个性标签</title>
    <url>/archives/2f8b36fc.html</url>
    <content><![CDATA[<div class="tip info"><p>文章来自: <a href="https://akilar.top/posts/615e2dec/">https://akilar.top/posts/615e2dec/</a></p>
</div>
<div class="note icon simple"><i class="note-icon fab fa-cc-visa"></i><p>目的:方便书写自己的文章，需要的话请查看原文</p>
</div>
<div class="note red icon modern"><i class="note-icon fas fa-fan"></i><h4 id="文章标题tip-一"><a href="#文章标题tip-一" class="headerlink" title="文章标题tip 一"></a>文章标题tip 一</h4></div>
<div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">示例源码</button></li><li class="tab"><button type="button" data-href="#-2"><i class="fas fa-bomb"></i>样式预览</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight md"><table><tr><td class="code"><pre><span class="line">&#123;% tip %&#125;default&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip info %&#125;info&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip success %&#125;success&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip error %&#125;error&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip warning %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bolt %&#125;bolt&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban %&#125;ban&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip home %&#125;home&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip sync %&#125;sync&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip cogs %&#125;cogs&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip key %&#125;key&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bell %&#125;bell&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip fa-atom %&#125;自定义font awesome图标&#123;% endtip %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><div class="tip "><p>default</p>
</div>
<div class="tip info"><p>info</p>
</div>
<div class="tip success"><p>success</p>
</div>
<div class="tip error"><p>error</p>
</div>
<div class="tip warning"><p>warning</p>
</div>
<div class="tip bolt"><p>bolt</p>
</div>
<div class="tip ban"><p>ban</p>
</div>
<div class="tip home"><p>home</p>
</div>
<div class="tip sync"><p>sync</p>
</div>
<div class="tip cogs"><p>cogs</p>
</div>
<div class="tip key"><p>key</p>
</div>
<div class="tip bell"><p>bell</p>
</div>
<div class="tip fa-atom"><p>自定义font awesome图标</p>
</div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<hr>
<div class="note purple icon simple"><i class="note-icon far fa-hand-scissors"></i><h4 id="文章标题tip-二"><a href="#文章标题tip-二" class="headerlink" title="文章标题tip 二"></a>文章标题tip 二</h4></div>
<div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">示例源码</button></li><li class="tab"><button type="button" data-href="#-2"><i class="fas fa-bomb"></i>样式预览</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p><div class="tip home"><h5 id="simple-样式"><a href="#simple-样式" class="headerlink" title="simple 样式"></a>simple 样式</h5></div><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% note simple %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p><div class="tip home"><h5 id="modern-样式"><a href="#modern-样式" class="headerlink" title="modern 样式"></a>modern 样式</h5></div><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% note modern %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p><div class="tip home"><h5 id="flat-样式"><a href="#flat-样式" class="headerlink" title="flat 样式"></a>flat 样式</h5></div><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% note flat %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p><div class="tip home"><h5 id="disabled-样式"><a href="#disabled-样式" class="headerlink" title="disabled 样式"></a>disabled 样式</h5></div><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&#123;% note disabled %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p><div class="tip home"><h5 id="no-icon-样式"><a href="#no-icon-样式" class="headerlink" title="no-icon 样式"></a>no-icon 样式</h5></div><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><div class="tip home"><h5 id="simple-样式"><a href="#simple-样式" class="headerlink" title="simple 样式"></a>simple 样式</h5></div>
<div class="note simple"><p>默认 提示块标签</p>
</div>
<div class="note default simple"><p>default 提示块标签</p>
</div>
<div class="note primary simple"><p>primary 提示块标签</p>
</div>
<div class="note success simple"><p>success 提示块标签</p>
</div>
<div class="note info simple"><p>info 提示块标签</p>
</div>
<div class="note warning simple"><p>warning 提示块标签</p>
</div>
<div class="note danger simple"><p>danger 提示块标签</p>
</div>
<div class="tip home"><h5 id="modern-样式"><a href="#modern-样式" class="headerlink" title="modern 样式"></a>modern 样式</h5></div>
<div class="note modern"><p>默认 提示块标签</p>
</div>
<div class="note default modern"><p>default 提示块标签</p>
</div>
<div class="note primary modern"><p>primary 提示块标签</p>
</div>
<div class="note success modern"><p>success 提示块标签</p>
</div>
<div class="note info modern"><p>info 提示块标签</p>
</div>
<div class="note warning modern"><p>warning 提示块标签</p>
</div>
<div class="note danger modern"><p>danger 提示块标签</p>
</div>
<div class="tip home"><h5 id="flat-样式"><a href="#flat-样式" class="headerlink" title="flat 样式"></a>flat 样式</h5></div>
<div class="note flat"><p>默认 提示块标签</p>
</div>
<div class="note default flat"><p>default 提示块标签</p>
</div>
<div class="note primary flat"><p>primary 提示块标签</p>
</div>
<div class="note success flat"><p>success 提示块标签</p>
</div>
<div class="note info flat"><p>info 提示块标签</p>
</div>
<div class="note warning flat"><p>warning 提示块标签</p>
</div>
<div class="note danger flat"><p>danger 提示块标签</p>
</div>
<div class="tip home"><h5 id="disabled-样式"><a href="#disabled-样式" class="headerlink" title="disabled 样式"></a>disabled 样式</h5></div>
<div class="note disabled"><p>默认 提示块标签</p>
</div>
<div class="note default disabled"><p>default 提示块标签</p>
</div>
<div class="note primary disabled"><p>primary 提示块标签</p>
</div>
<div class="note success disabled"><p>success 提示块标签</p>
</div>
<div class="note info disabled"><p>info 提示块标签</p>
</div>
<div class="note warning disabled"><p>warning 提示块标签</p>
</div>
<div class="note danger disabled"><p>danger 提示块标签</p>
</div>
<div class="tip home"><h5 id="no-icon-样式"><a href="#no-icon-样式" class="headerlink" title="no-icon 样式"></a>no-icon 样式</h5></div>
<div class="note no-icon flat"><p>默认 提示块标签</p>
</div>
<div class="note default no-icon flat"><p>default 提示块标签</p>
</div>
<div class="note primary no-icon flat"><p>primary 提示块标签</p>
</div>
<div class="note success no-icon flat"><p>success 提示块标签</p>
</div>
<div class="note info no-icon flat"><p>info 提示块标签</p>
</div>
<div class="note warning no-icon flat"><p>warning 提示块标签</p>
</div>
<div class="note danger no-icon flat"><p>danger 提示块标签</p>
</div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h4 id="动态标签tip"><a href="#动态标签tip" class="headerlink" title="动态标签tip"></a>动态标签tip</h4><div class="tabs" id=""><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#-1">示例源码</button></li><li class="tab active"><button type="button" data-href="#-2">显示实列</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="-1"><p><p class='p red'>On DOM load（当页面加载时显示动画）</p><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure></p>
<p><p class='p yellow'>调整动画速度</p><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure></p>
<p><p class='p green'>On hover（当鼠标悬停时显示动画）</p><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated-hover %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated-hover %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure></p>
<p><p class='p cyan'>On parent hover（当鼠标悬停在父级元素时显示动画）</p><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% tip warning faa-parent animated-hover %&#125;&lt;p class=&quot;faa-horizontal&quot;&gt;warning&lt;/p&gt;&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-parent animated-hover %&#125;&lt;p class=&quot;faa-flash&quot;&gt;ban&lt;/p&gt;&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="-2"><p><p class='p red'>On DOM load（当页面加载时显示动画）</p></p>
<div class="tip warning faa-horizontal animated faa-fast"><p>warning</p>
</div>
<div class="tip ban faa-flash animated faa-slow"><p>ban</p>
</div>
<p class='p yellow'>调整动画速度</p>
<div class="tip warning faa-horizontal animated faa-fast"><p>warning</p>
</div>
<div class="tip ban faa-flash animated faa-slow"><p>ban</p>
</div>
<p class='p green'>On hover（当鼠标悬停时显示动画）</p>
<div class="tip warning faa-horizontal animated-hover"><p>warning</p>
</div>
<div class="tip ban faa-flash animated-hover"><p>ban</p>
</div>
<p class='p cyan'>On parent hover（当鼠标悬停在父级元素时显示动画）</p>
<div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">warning</p></div>
<div class="tip ban faa-parent animated-hover"><p class="faa-flash">ban</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<hr>
<h4 id="复选列表checkbox"><a href="#复选列表checkbox" class="headerlink" title="复选列表checkbox"></a>复选列表checkbox</h4><div class="tabs" id=""><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#-1">示例源码</button></li><li class="tab active"><button type="button" data-href="#-2">显示实列</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="-1"><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% checkbox 纯文本测试 %&#125;</span><br><span class="line">&#123;% checkbox checked, 支持简单的 [markdown](https://guides.github.com/features/mastering-markdown/) 语法 %&#125;</span><br><span class="line">&#123;% checkbox red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% checkbox green checked, 绿色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, 黄色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, 青色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox blue checked, 蓝色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, 增加 %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, 减少 %&#125;</span><br><span class="line">&#123;% checkbox times red checked, 叉 %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="-2"><div class='checkbox'><input type="checkbox" />
            <p>纯文本测试</p>
            </div>
<div class='checkbox checked'><input type="checkbox" checked="checked"/>
            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>
            </div>
<div class='checkbox red'><input type="checkbox" />
            <p>支持自定义颜色</p>
            </div>
<div class='checkbox green checked'><input type="checkbox" checked="checked"/>
            <p>绿色 + 默认选中</p>
            </div>
<div class='checkbox yellow checked'><input type="checkbox" checked="checked"/>
            <p>黄色 + 默认选中</p>
            </div>
<div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>
            <p>青色 + 默认选中</p>
            </div>
<div class='checkbox blue checked'><input type="checkbox" checked="checked"/>
            <p>蓝色 + 默认选中</p>
            </div>
<div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>
            <p>增加</p>
            </div>
<div class='checkbox minus yellow checked'><input type="checkbox" checked="checked"/>
            <p>减少</p>
            </div>
<div class='checkbox times red checked'><input type="checkbox" checked="checked"/>
            <p>叉</p>
            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h4 id="单选列表-radio"><a href="#单选列表-radio" class="headerlink" title="单选列表 radio"></a>单选列表 radio</h4><div class="tabs" id=""><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#-1">示例源码</button></li><li class="tab active"><button type="button" data-href="#-2">显示实列</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="-1"><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% radio 纯文本测试 %&#125;</span><br><span class="line">&#123;% radio checked, 支持简单的 [markdown](https://guides.github.com/features/mastering-markdown/) 语法 %&#125;</span><br><span class="line">&#123;% radio red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% radio green, 绿色 %&#125;</span><br><span class="line">&#123;% radio yellow, 黄色 %&#125;</span><br><span class="line">&#123;% radio cyan, 青色 %&#125;</span><br><span class="line">&#123;% radio blue, 蓝色 %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="-2"><div class='checkbox'><input type="radio" />
            <p>纯文本测试</p>
            </div>
<div class='checkbox checked'><input type="radio" checked="checked"/>
            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>
            </div>
<div class='checkbox red'><input type="radio" />
            <p>支持自定义颜色</p>
            </div>
<div class='checkbox green'><input type="radio" />
            <p>绿色</p>
            </div>
<div class='checkbox yellow'><input type="radio" />
            <p>黄色</p>
            </div>
<div class='checkbox cyan'><input type="radio" />
            <p>青色</p>
            </div>
<div class='checkbox blue'><input type="radio" />
            <p>蓝色</p>
            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
]]></content>
      <categories>
        <category>blog</category>
      </categories>
      <tags>
        <tag>blog个性标签</tag>
        <tag>blog</tag>
      </tags>
  </entry>
  <entry>
    <title>反问面试</title>
    <url>/archives/9f1ed84.html</url>
    <content><![CDATA[<h1 id="反向面试"><a href="#反向面试" class="headerlink" title="反向面试"></a>反向面试</h1><h2 id="预期使用方式"><a href="#预期使用方式" class="headerlink" title="预期使用方式"></a>预期使用方式</h2><ul>
<li>检查一下哪些问题你感兴趣</li>
<li>检查一下哪些是你可以自己在网上找到答案的</li>
<li>找不到的话就向面试官提问</li>
</ul>
<p>绝对不要想把这个列表里的每个问题都问一遍。（尊重面试官的时间，而且你可以通过查找已经发布的答案来显示<br>你的主动性）</p>
<p>请记住事情总是灵活的，组织的结构调整也会经常发生。拥有一个 bug 追踪系统并不会保证高效处理 bug。<br>CI/CD （持续集成系统） 也不一定保证交付时间会很短。</p>
<h1 id="职责"><a href="#职责" class="headerlink" title="职责"></a>职责</h1><ul>
<li>On-call （电话值班）的计划或者规定是什么？值班或者遇到问题加班时候有加班费吗？</li>
<li>我的日常工作是什么？</li>
<li>有给我设定的特定目标吗？</li>
<li>团队里面初级和高级工程师的比例是多少？（有计划改变吗）</li>
<li>入职培训 (onboarding) 会是什么样的？</li>
<li>每个开发者有多大的自由来做出决定？</li>
<li>在你看来，这个工作做到什么程度算成功？</li>
<li>你期望我在最初的一个月 / 三个月能够完成什么？</li>
<li>试用期结束的时候，你会怎么样衡量我的绩效？</li>
<li>自己单独的开发活动和按部就班工作的比例大概是怎样的？</li>
<li>一个典型的一天或者一周的工作是怎样安排的？</li>
<li>对我的申请你有什么疑虑么？</li>
<li>在这份工作上，我将会和谁紧密合作？</li>
<li>我的直接上级他们的上级都是什么样的管理风格？（事无巨细还是着眼宏观）</li>
<li>我在这个岗位上应该如何发展？会有哪些机会？</li>
<li>每天预期 / 核心工作时间是多少小时？</li>
<li>我入职的岗位是新增还是接替之前离职的同事？（是否有技术债需要还）？(zh)</li>
<li>入职之后在哪个项目组，项目是新成立还是已有的？(zh)</li>
</ul>
<h1 id="技术"><a href="#技术" class="headerlink" title="技术"></a>技术</h1><ul>
<li>公司常用的技术栈是什么？</li>
<li>你们怎么使用源码控制系统？</li>
<li>你们怎么测试代码？</li>
<li>你们怎么追踪 bug?</li>
<li>你们怎样监控项目？</li>
<li>你们怎么集成和部署代码改动？是使用持续集成和持续部署吗 (CI/CD)？</li>
<li>你们的基础设施搭建在版本管理系统里吗？或者是代码化的吗？</li>
<li>从计划到完成一项任务的工作流是什么样的？</li>
<li>你们如何准备故障恢复？</li>
<li>有标准的开发环境吗？是强制的吗？</li>
<li>你们需要花费多长时间来给产品搭建一个本地测试环境？（分钟 / 小时 / 天）</li>
<li>你们需要花费多长时间来响应代码或者依赖中的安全问题？</li>
<li>所有的开发者都可以使用他们电脑的本地管理员权限吗？</li>
<li>介绍一下你们的技术原则或者展望。</li>
<li>你们的代码有开发文档吗？有没有单独的供消费者阅读的文档？</li>
<li>你们有更高层次的文档吗？比如说 ER 图，数据库范式</li>
<li>你们使用静态代码分析吗？</li>
<li>你们如何管理内部和外部的数字资产？</li>
<li>你们如何管理依赖？</li>
<li>公司是否有技术分享交流活动？有的话，多久一次呢？(zh)</li>
<li>你们的数据库是怎么进行版本控制的？(zh)</li>
<li>业务需求有没有文档记录？是如何记录的？(zh)</li>
</ul>
<h1 id="团队"><a href="#团队" class="headerlink" title="团队"></a>团队</h1><ul>
<li>工作是怎么组织的？</li>
<li>团队内 / 团队间的交流通常是怎样的？</li>
<li>你们使用什么工具来做项目组织？你的实际体会是什么？</li>
<li>如果遇到不同的意见怎样处理？</li>
<li>谁来设定优先级 / 计划？</li>
<li>如果团队没能赶上预期发布日期怎么办？</li>
<li>每周都会开什么类型的会议？</li>
<li>会有定期的和上级的一对一谈话吗？</li>
<li>产品 / 服务的规划是什么样的？（n 周一发布 / 持续部署 / 多个发布流 / …)</li>
<li>生产环境发生事故了怎么办？是否有不批评人而分析问题的文化？</li>
<li>有没有一些团队正在经历还尚待解决的挑战？</li>
<li>你们如何跟踪进度？</li>
<li>预期和目标是如何设定的？谁来设定？</li>
<li>Code Review 如何实施？</li>
<li>给我介绍下团队里一个典型的 sprint</li>
<li>你们如何平衡技术和商业目标？</li>
<li>你们如何共享知识？</li>
<li>团队有多大？</li>
<li>公司技术团队的架构和人员组成？(zh)</li>
<li>团队内开发、产品、运营哪一方是需求的主要提出方？哪一方更强势？(zh)</li>
</ul>
<h1 id="问未来的同事"><a href="#问未来的同事" class="headerlink" title="问未来的同事"></a>问未来的同事</h1><ul>
<li>开发者倾向于从哪里学习？</li>
<li>你对在这里工作最满意的地方是？</li>
<li>最不满意的呢？</li>
<li>如果可以的话，你想改变哪里？</li>
<li>团队最老的成员在这里多久了？</li>
<li>在小团队中，有没有出现成员性格互相冲突的情况？最后是如何解决的？</li>
</ul>
<h1 id="公司"><a href="#公司" class="headerlink" title="公司"></a>公司</h1><ul>
<li>公司为什么在招人？（产品发展 / 新产品 / 波动…)</li>
<li>有没有会议 / 旅行预算？使用的规定是什么？</li>
<li>晋升流程是怎样的？要求 / 预期是怎样沟通的？</li>
<li>绩效评估流程是怎样的？</li>
<li>技术和管理两条职业路径是分开的吗？</li>
<li>对于多元化招聘的现状或者观点是什么？</li>
<li>有公司级别的学习资源吗？比如电子书订阅或者在线课程？</li>
<li>有获取证书的预算吗？</li>
<li>公司的成熟度如何？（早期寻找方向 / 有内容的工作 / 维护中 / …)</li>
<li>我可以为开源项目做贡献吗？是否需要审批？</li>
<li>你认为公司未来五年或者十年会发展成什么样子？</li>
<li>公司的大多数员工是如何看待整洁代码的？</li>
<li>你上次注意到有人成长是什么时候？他们在哪方面成长了？</li>
<li>在这里成功的定义是什么？如何衡量成功？</li>
<li>有体育活动或者团建么？</li>
<li>有内部的黑客马拉松活动吗？</li>
<li>公司支持开源项目吗？</li>
<li>有竞业限制或者保密协议需要签吗？</li>
<li>你们认为公司文化中的空白是什么？</li>
<li>能够跟我说一公司处于不良情况，以及如何处理的故事吗？</li>
<li>您在这工作了多久了？您觉得体验如何？(zh)</li>
<li>大家为什么会喜欢这里？(zh)</li>
<li>公司的调薪制度是如何的？(zh)</li>
</ul>
<h1 id="社会问题"><a href="#社会问题" class="headerlink" title="社会问题"></a>社会问题</h1><ul>
<li>你们关于多元化招聘什么看法？</li>
<li>你们的公司文化如何？你认为有什么空白么？</li>
<li>这里的工作生活平衡地怎么样？</li>
<li>公司对气候变化有什么态度吗？</li>
</ul>
<h1 id="冲突"><a href="#冲突" class="headerlink" title="冲突"></a>冲突</h1><ul>
<li>不同的意见如何处理？</li>
<li>如果被退回了会怎样？（“这个在预计的时间内做不完”）</li>
<li>当团队有压力并且在超负荷工作的时候怎么处理？</li>
<li>如果有人注意到了在流程或者技术等其他方面又改进的地方，怎么办？</li>
<li>当管理层的预期和工程师的绩效之间有差距的时候如何处理？</li>
<li>能给我讲一个公司深处有毒环境以及如何处理的故事吗？</li>
<li>如果在公司内你的同事因涉嫌性侵犯他人而被调查，请问你会如何处理？</li>
<li>假设我自己很不幸是在公司内被性侵的受害者，在公司内部有没有争取合法权益的渠道？</li>
</ul>
<h1 id="商业"><a href="#商业" class="headerlink" title="商业"></a>商业</h1><ul>
<li>你们现在盈利吗？</li>
<li>如果没有的话，还需要多久？</li>
<li>公司的资金来源是什么？谁影响或者制定高层计划或方向？</li>
<li>你们如何挣钱？</li>
<li>什么阻止了你们挣更多的钱？</li>
<li>公司未来一年的增长计划怎样？五年呢？</li>
<li>你们认为什么是你们的竞争优势？</li>
<li>你们的竞争优势是什么？</li>
<li>公司未来的商业规划是怎样的？有上市的计划吗？(zh)</li>
</ul>
<h1 id="远程工作"><a href="#远程工作" class="headerlink" title="远程工作"></a>远程工作</h1><ul>
<li>远程工作和办公室工作的比例是多少？</li>
<li>公司提供硬件吗？更新计划如何？</li>
<li>使用自己的硬件办公可以吗？现在有政策吗？</li>
<li>额外的附件和家具可以通过公司购买吗？这方面是否有预算？</li>
<li>有共享办公或者上网的预算吗？</li>
<li>多久需要去一次办公室？</li>
<li>公司的会议室是否一直是视频会议就绪的？</li>
</ul>
<h1 id="办公室布局"><a href="#办公室布局" class="headerlink" title="办公室布局"></a>办公室布局</h1><ul>
<li>办公室的布局如何？（开放的 / 小隔间 / 独立办公室）</li>
<li>有没有支持 / 市场 / 或者其他需要大量打电话的团队在我的团队旁边办公？</li>
</ul>
<h1 id="终极问题"><a href="#终极问题" class="headerlink" title="终极问题"></a>终极问题</h1><ul>
<li>该职位为何会空缺？</li>
<li>公司如何保证人才不流失？</li>
<li>这份工作 / 团队 / 公司最好和最坏的方面是？</li>
<li>你最开始为什么选择了这家公司？</li>
<li>你为什么留在这家公司？</li>
</ul>
<h1 id="待遇"><a href="#待遇" class="headerlink" title="待遇"></a>待遇</h1><ul>
<li>如果有奖金计划的话，奖金如何分配？</li>
<li>如果有奖金计划的话，过去的几年里通常会发百分之多少的奖金？</li>
<li>有五险一金(zh)/401k(us)或者其他退休养老金等福利吗？</li>
<li>五险一金中，补充公积金一般交多少比例？/401k一般交多少比例？我可以自己选择这一比例吗？</li>
<li>有什么医疗保险吗？如果有的话何时开始？</li>
<li>有额外商业保险吗？例如人寿保险和额外的养老/医疗保险？</li>
<li>更换工作地点，公司付费吗？</li>
</ul>
<h1 id="休假"><a href="#休假" class="headerlink" title="休假"></a>休假</h1><ul>
<li>带薪休假时间有多久？</li>
<li>病假和事假是分开的还是一起算？</li>
<li>我可以提前使用假期时间吗？也就是说应休假期是负的？</li>
<li>假期的更新策略是什么样的？也就是说未休的假期能否滚入下一周期</li>
<li>照顾小孩的政策如何？</li>
<li>无薪休假政策是什么样的？</li>
<li>学术性休假政策是怎么样的？</li>
</ul>
]]></content>
      <categories>
        <category>面试</category>
      </categories>
      <tags>
        <tag>面试</tag>
        <tag>反问面试</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack</title>
    <url>/archives/b9f20a20.html</url>
    <content><![CDATA[<h3 id="tag-webpack介绍-tag"><a href="#tag-webpack介绍-tag" class="headerlink" title="[tag]webpack介绍[/tag]"></a>[tag]webpack介绍[/tag]</h3><ul>
<li>基于NodeJS实现的模块打包工具， 就是一个第三方包</li>
<li>把很多文件打包整合到一起, 缩小项目体积, 提高加载速度</li>
<li>将多个js文件打包生成最终一个压缩后的js文件, 减少文件数量和体积，从而提升访问, </li>
<li>还可以打包任意类型的文件</li>
<li>官网地址：<a href="https://webpack.docschina.org/">https://webpack.docschina.org/</a></li>
</ul>
<hr>
<p>[file href=”//freelaeder.cn//usr/themes/Mirages/images/default/data/webpack.pdf”]webpack课件[/file]</p>
<ul>
<li><strong>课件资源来尚硅谷，原文视频地址：<a href="https://www.bilibili.com/video/BV1e7411j7T5?p=7&amp;spm_id_from=pageDriver">https://www.bilibili.com/video/BV1e7411j7T5?p=7&amp;spm_id_from=pageDriver</a></strong></li>
</ul>
<h3 id="tag-type-”primary”-webpack基本使用-tag"><a href="#tag-type-”primary”-webpack基本使用-tag" class="headerlink" title="[tag type=”primary”]webpack基本使用[/tag]"></a>[tag type=”primary”]webpack基本使用[/tag]</h3><h5 id="1-目标"><a href="#1-目标" class="headerlink" title="1.目标"></a>1.目标</h5><p><img src="//freelaeder.cn//usr/themes/Mirages/images/default/img/web1.png" alt="image-20210519092326352"></p>
<h4 id="2-实现步骤"><a href="#2-实现步骤" class="headerlink" title="2. 实现步骤"></a>2. 实现步骤</h4><ol>
<li><h5 id="初始化包环境"><a href="#初始化包环境" class="headerlink" title="初始化包环境"></a>初始化包环境</h5></li>
<li><p><img src="//freelaeder.cn//usr/themes/Mirages/images/default/img/web2.png" alt="image-20210519092306481"></p>
</li>
<li><h4 id="安装依赖包"><a href="#安装依赖包" class="headerlink" title="安装依赖包"></a>安装依赖包</h4></li>
<li><p><img src="//freelaeder.cn//usr/themes/Mirages/images/default/img/web3.png" alt="image-20210519092530768"></p>
</li>
<li><h4 id="新建src-必须是src-和js文件"><a href="#新建src-必须是src-和js文件" class="headerlink" title="新建src(必须是src)和js文件"></a>新建src(必须是src)和js文件</h4><p><img src="//freelaeder.cn//usr/themes/Mirages/images/default/img/web4.png" alt="image-20210519093142548"></p>
<p>​    <strong>src目录不要写错， 里面的必须有一个index.js</strong></p>
</li>
</ol>
<h4 id="4-运行打包命令————-npx-webpack"><a href="#4-运行打包命令————-npx-webpack" class="headerlink" title="4.  运行打包命令————    npx webpack"></a>4.  运行打包命令————    npx webpack</h4><hr>
<h4 id="tag-type-”info”-ES6模块化-tag"><a href="#tag-type-”info”-ES6模块化-tag" class="headerlink" title="[tag type=”info”] ES6模块化[/tag]"></a>[tag type=”info”] ES6模块化[/tag]</h4><ul>
<li><h5 id="导出变量"><a href="#导出变量" class="headerlink" title="导出变量"></a>导出变量</h5></li>
<li>export let/const/var  变量名 = 值     ===&gt;  import { 变量名 } from ‘文件路径’</li>
<li>export default 变量   ====&gt; import 变量名 from ‘文件路径’</li>
</ul>
<hr>
<p>[tabs]</p>
<p>[tab title=”add.js(最初版本)”]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// node</span></span><br><span class="line"><span class="comment">// function add (a,b) &#123;</span></span><br><span class="line"><span class="comment">//     return a + b;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// node 提供的模块化导出对象</span></span><br><span class="line"><span class="comment">// module.exports = &#123;</span></span><br><span class="line"><span class="comment">//     add</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// es6 模块化 导出 一个函数变量</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// function add (a,b) &#123;</span></span><br><span class="line"><span class="comment">//     return a + b;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export default add;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> add = <span class="function"><span class="keyword">function</span> (<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>[/tab]</p>
<p>[tab title=”main.js(需压缩的js文件入口)”]<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// node 引入js文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const &#123;add&#125; = require(&#x27;./add&#x27;);</span></span><br><span class="line"><span class="comment">// const &#123;sum&#125; = require(&#x27;./tool/tool&#x27;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// let r = add(12,13);</span></span><br><span class="line"><span class="comment">// console.log(r);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let su = [1,3,9,3,23]</span></span><br><span class="line"><span class="comment">// console.log(sum(su));</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// es6</span></span><br><span class="line"><span class="comment">// 有default 不需要加&#123;add&#125;</span></span><br><span class="line"><span class="comment">// import add from  &#x27;./add&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// es6 无default 需要加&#123;add&#125;</span></span><br><span class="line"><span class="comment">// import &#123;add&#125; from &#x27;./add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let r = add(2,11);</span></span><br><span class="line"><span class="comment">// console.log(r);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入jquery资源</span></span><br><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">&#x27;jquery&#x27;</span>;</span><br><span class="line">$(<span class="string">&#x27;ul li:odd&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;red&#x27;</span>),</span><br><span class="line">$(<span class="string">&#x27;ul li:even&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;green&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>[/tab]</p>
<p>[/tabs]</p>
<h3 id="3-配置webpack入口和出口"><a href="#3-配置webpack入口和出口" class="headerlink" title="3.配置webpack入口和出口"></a>3.配置webpack入口和出口</h3><h4 id="1-目标-1"><a href="#1-目标-1" class="headerlink" title="1.目标"></a>1.目标</h4><p><img src="//freelaeder.cn//usr/themes/Mirages/images/default/img/web5.png" alt="image-20210521081531029"></p>
<h4 id="2-实现步骤-1"><a href="#2-实现步骤-1" class="headerlink" title="2.实现步骤"></a>2.实现步骤</h4><p><img src="//freelaeder.cn//usr/themes/Mirages/images/default/img/web6.png" alt="image-20210521081544821"></p>
<h4 id="3-代码实现"><a href="#3-代码实现" class="headerlink" title="3.代码实现"></a>3.代码实现</h4><p><img src="//freelaeder.cn//usr/themes/Mirages/images/default/img/web7.png" alt="image-20210521081624659"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// 指定webpack打包的入口文件</span></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/main.js&#x27;</span>,</span><br><span class="line">    <span class="comment">// 配置webpack打包输出的文件夹和文件名</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="comment">// 路径</span></span><br><span class="line">        <span class="attr">path</span>: path.resolve(__dirname, <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="comment">// 文件名</span></span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;bundl.js&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="tag-type-”warn”-插件-tag"><a href="#tag-type-”warn”-插件-tag" class="headerlink" title="[tag type=”warn”]插件[/tag]"></a>[tag type=”warn”]插件[/tag]</h3><ul>
<li><h4 id="目标1-自动生成html，并且自动引入js文件"><a href="#目标1-自动生成html，并且自动引入js文件" class="headerlink" title="目标1  自动生成html，并且自动引入js文件"></a>目标1  自动生成html，并且自动引入js文件</h4></li>
<li><h4 id="目标2-引入css文件，并配置"><a href="#目标2-引入css文件，并配置" class="headerlink" title="目标2  引入css文件，并配置"></a>目标2  引入css文件，并配置</h4></li>
</ul>
<ul>
<li><h4 id="下载html-webpack-plugin插件"><a href="#下载html-webpack-plugin插件" class="headerlink" title="下载html-webpack-plugin插件"></a>下载html-webpack-plugin插件</h4></li>
<li>作用:默认会创建一个空的HTML，自动引入打包输出的所有资源（js\css）;</li>
<li>需求：<strong>需要有结构的HTML文件</strong></li>
</ul>
<ul>
<li>yarn add html-webpack-plugin -D </li>
<li>npm install html-webpack-plugin  -D</li>
</ul>
<ul>
<li>2.下载style-loader,css-loader<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">yarn add style-loader css-loader -D </span><br><span class="line">npm install style-loader css-loader -D</span><br></pre></td></tr></table></figure></li>
<li>2.1 引入css文件到入口文件<br><img src="//freelaeder.cn//usr/themes/Mirages/images/default/img/web10.png" alt="image-20210524091735083"><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入css文件</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./css/index.css&#x27;</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><h5 id="在webpack-config-js中配置"><a href="#在webpack-config-js中配置" class="headerlink" title="在webpack.config.js中配置"></a>在webpack.config.js中配置</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// 配置开发环境</span></span><br><span class="line">    <span class="comment">// mode:&#x27;development&#x27;,</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置生产环境  默认模式</span></span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/main.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.resolve(__dirname, <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;build.js&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 其他配置 自动引入html</span></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="comment">// 引入的模板文件路径</span></span><br><span class="line">            <span class="attr">template</span>: <span class="string">&#x27;./build/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 配置css--loader css文件 一起打包到js文件中</span></span><br><span class="line">    <span class="comment">// style--loader 将css文件插入dom（style）</span></span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="comment">// 配置规则  </span></span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            <span class="comment">// 一个具体的loader配置</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">                use: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/web0.png" alt="请输入图片描述"></p>
<hr>
<p>[tag type=”success”]webpack.config.js基本配置[/tag]<br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/webp.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/webp2.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/webp3.png" alt="请输入图片描述"><br><img src="https://freelaeder.cn//usr/themes/Mirages/images/default/img/webp4.png" alt="请输入图片描述"><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="comment">// 引入html插件  npm install --save-dev html-webpack-plugin</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// 配置开发环境</span></span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置生产环境  默认模式</span></span><br><span class="line">    <span class="comment">// mode: &#x27;production&#x27;,</span></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/main.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.resolve(__dirname, <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;build.js&#x27;</span>,</span><br><span class="line">        <span class="comment">// publicPath:&#x27;../dist/&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 其他配置 自动引入html</span></span><br><span class="line">    <span class="comment">// plugins 1 下载 2 引入 3 使用</span></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="comment">// 引入的模板文件路径</span></span><br><span class="line">            <span class="attr">template</span>: <span class="string">&#x27;./build/index.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 配置css-loader css文件 一起打包到js文件中</span></span><br><span class="line">    <span class="comment">// style-loader 将css文件插入dom（style）</span></span><br><span class="line">    <span class="comment">// loader 1下载  2配置 </span></span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="comment">// 配置规则  </span></span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            <span class="comment">// 一个具体的loader配置</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">                <span class="comment">// 执行顺序，从右至左        </span></span><br><span class="line">                use: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>,]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 下载 yarn add less less-loader</span></span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.less$/i</span>,</span><br><span class="line">                <span class="comment">// 执行顺序，从右至左        </span></span><br><span class="line">                use: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//处理图片资源</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">                <span class="comment">// 使用1个loader</span></span><br><span class="line">                <span class="comment">// 下载url-loader,file-loader</span></span><br><span class="line">                loader: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>: &#123;</span><br><span class="line">                    <span class="comment">// 图片小于8kb，就会被base64处理</span></span><br><span class="line">                    <span class="comment">// 优点：减少请求数量，（减轻服务器压力）</span></span><br><span class="line">                    <span class="comment">// 缺点：图片体积会更大，（文件请求速度更慢）</span></span><br><span class="line">                    <span class="attr">limit</span>: <span class="number">8</span> * <span class="number">1024</span>,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 问题：因为url-loader默认使用es6模块化解析，而html-loader引入图片是commonjs</span></span><br><span class="line">                    <span class="comment">// 解析时会出问题：[object Module]</span></span><br><span class="line">                    <span class="comment">// 解决：关闭url-loader的es6模块化，使用commonjs解析</span></span><br><span class="line">                    <span class="attr">esModule</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 下载loader   yarn add html-loader</span></span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.html$/</span>,</span><br><span class="line">                <span class="comment">// 处理html文件的img图片，（负责引入img，从而能被url-loader进行处理）</span></span><br><span class="line">                loader: <span class="string">&#x27;html-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>: &#123;</span><br><span class="line">                    <span class="attr">esModule</span>: <span class="literal">false</span>,</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// 解析字体图标</span></span><br><span class="line">            <span class="comment">// 无须下载</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(eot|svg|ttf|woff)$/i</span>,</span><br><span class="line">                <span class="comment">// 打包其他资源  排除其他资源exclude</span></span><br><span class="line">                <span class="comment">// exclude:/\.(css|js|html)$/</span></span><br><span class="line">                type: <span class="string">&#x27;asset/resource&#x27;</span>,</span><br><span class="line">                <span class="attr">generator</span>: &#123;</span><br><span class="line">                    <span class="attr">filename</span>: <span class="string">&#x27;font/[name].[hash:6][ext]&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// js降级处理</span></span><br><span class="line">            <span class="comment">// 下载loader     yarn add -D babel-loader @babel/core @babel/preset-env</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.m?js$/</span>,</span><br><span class="line">                exclude: <span class="regexp">/(node_modules|bower_components)/</span>,</span><br><span class="line">                use: &#123;</span><br><span class="line">                    <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">                    <span class="attr">options</span>: &#123;</span><br><span class="line">                        <span class="attr">presets</span>: [<span class="string">&#x27;@babel/preset-env&#x27;</span>]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 启动开发服务器</span></span><br><span class="line">    <span class="comment">// 下载 yarn add webpack-dev-server -D</span></span><br><span class="line">    <span class="attr">devServer</span>: &#123;</span><br><span class="line">        <span class="comment">// 修改端口为3000</span></span><br><span class="line">        <span class="attr">port</span>: <span class="number">3000</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
  </entry>
  <entry>
    <title>频道列表居中</title>
    <url>/archives/791e95a0.html</url>
    <content><![CDATA[<h2 id="首页-频道-滚动效果"><a href="#首页-频道-滚动效果" class="headerlink" title="首页-频道-滚动效果"></a>首页-频道-滚动效果</h2><blockquote>
<p>目标：创建频道组件并实现滚动效果</p>
</blockquote>
<p><img src="https://files.catbox.moe/lasp0h.png" alt=""></p>
<hr>
<ul>
<li>[ ] 创建频道列表组件布局和样式</li>
<li>[ ] 实现频道列表的滚动效果</li>
<li>[ ] 使用自定义钩子函数将滚动效果抽取出来以供后续逻辑使用</li>
</ul>
<hr>
<p>① 创建频道列表组件布局和样式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/pages/home/widgets/channel/index.tsx</span><br><span class="line">import styles from &quot;@pages/home/widgets/channel/styles/styles.module.less&quot;;</span><br><span class="line">import classNames from &quot;classnames&quot;;</span><br><span class="line">import GeekIcon from &quot;@shared/geekIcon&quot;;</span><br><span class="line"></span><br><span class="line">// 模拟数据</span><br><span class="line">const channels = [</span><br><span class="line">  &quot;推荐&quot;,</span><br><span class="line">  &quot;HTML&quot;,</span><br><span class="line">  &quot;开发者资讯&quot;,</span><br><span class="line">  &quot;C++&quot;,</span><br><span class="line">  &quot;CSS&quot;,</span><br><span class="line">  &quot;数据库&quot;,</span><br><span class="line">  &quot;区块链&quot;,</span><br><span class="line">  &quot;go&quot;,</span><br><span class="line">  &quot;产品&quot;,</span><br><span class="line">  &quot;后端&quot;,</span><br><span class="line">  &quot;linux&quot;,</span><br><span class="line">  &quot;人工智能&quot;,</span><br><span class="line">  &quot;php&quot;,</span><br><span class="line">  &quot;javascript&quot;,</span><br><span class="line">  &quot;架构&quot;,</span><br><span class="line">  &quot;前端&quot;,</span><br><span class="line">  &quot;python&quot;,</span><br><span class="line">  &quot;java&quot;,</span><br><span class="line">  &quot;科技动态&quot;,</span><br><span class="line">  &quot;数码产品&quot;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">export default function Channel() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&#123;styles.container&#125;&gt;</span><br><span class="line">      &lt;div className=&#123;styles.list&#125;&gt;</span><br><span class="line">        &#123;channels.map((channel) =&gt; (</span><br><span class="line">          &lt;div key=&#123;channel&#125; className=&#123;classNames(styles.item)&#125;&gt;</span><br><span class="line">            &#123;channel&#125;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        ))&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div className=&#123;styles.aside&#125;&gt;</span><br><span class="line">        &lt;div className=&#123;styles.search&#125;&gt;</span><br><span class="line">          &lt;GeekIcon type=&#123;&quot;iconbtn_search&quot;&#125; className=&#123;styles.search_icon&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div className=&#123;styles.menu&#125;&gt;</span><br><span class="line">          &lt;GeekIcon type=&#123;&quot;iconbtn_channel&quot;&#125; className=&#123;styles.channel_icon&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/pages/home/widgets/channel/styles/styles.module.less</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;@styles/color.less&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">11.73vw</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0.4vw</span> <span class="number">2vw</span> <span class="number">#f0f0f0</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="selector-class">.list</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">11.73vw</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow-x</span>: auto;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">23.73vw</span>;</span><br><span class="line">    <span class="comment">// 隐藏滚动条</span></span><br><span class="line">    <span class="selector-tag">&amp;</span>::<span class="selector-tag">-webkit-scrollbar</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: none;</span><br><span class="line">      <span class="comment">/* 解决 ios 系统滑动卡顿问题 */</span></span><br><span class="line">      -webkit-<span class="attribute">overflow-scrolling</span>: touch;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.item</span> &#123;</span><br><span class="line">      <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">3vw</span>;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">4vw</span>;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#9ea1ae</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">11.73vw</span>;</span><br><span class="line">      <span class="attribute">line-height</span>: <span class="number">11.73vw</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.active</span> &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">4.8vw</span>;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#3a3948</span>;</span><br><span class="line">      <span class="attribute">font-weight</span>: <span class="number">500</span>;</span><br><span class="line">      <span class="attribute">position</span>: relative;</span><br><span class="line">      <span class="selector-tag">&amp;</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">8vw</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">0.8vw</span>;</span><br><span class="line">        <span class="attribute">background</span>: <span class="variable">@mainColor</span>;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">transform</span>: translateX(-<span class="number">50%</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.aside</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">11.73vw</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="selector-class">.search</span> &#123;</span><br><span class="line">      <span class="attribute">position</span>: relative;</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="attribute">margin-right</span>: <span class="number">5.33vw</span>;</span><br><span class="line">      <span class="selector-class">.search_icon</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">4.8vw</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">4.8vw</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-tag">&amp;</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">5.07vw</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">left</span>: -<span class="number">5.07vw</span>;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">background</span>: linear-gradient(<span class="number">270deg</span>, <span class="number">#fff</span>, hsla(<span class="number">0</span>, <span class="number">0%</span>, <span class="number">100%</span>, <span class="number">0.3</span>));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.menu</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="attribute">margin-right</span>: <span class="number">4vw</span>;</span><br><span class="line">      <span class="selector-class">.channel_icon</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">4.53vw</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">4vw</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/pages/home/index.tsx</span><br><span class="line">import Channel from &quot;@pages/home/widgets/channel&quot;;</span><br><span class="line"></span><br><span class="line">export default function HomePage() &#123;</span><br><span class="line">  return &lt;Channel /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>② 实现频道列表的滚动效果</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/pages/home/channel/index.tsx</span><br><span class="line">import &#123; useRef, useState &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default function Channel() &#123;</span><br><span class="line">  // 用于存储滚动盒子</span><br><span class="line">  const scrollContainerRef = useRef&lt;null | HTMLDivElement&gt;(null);</span><br><span class="line"></span><br><span class="line">  // 点击事件处理函数</span><br><span class="line">  const scrollHandler = useCallback(</span><br><span class="line">    (target: HTMLDivElement) =&gt; &#123;</span><br><span class="line">      // 获取视图宽度</span><br><span class="line">      const w = window.innerWidth;</span><br><span class="line">      // 设置横向滚动距离</span><br><span class="line">      scrollContainerRef.current!.scrollTo(&#123;</span><br><span class="line">        // 横向滚动距离 = 用户点击的一级分类盒子的中心点与滚动盒子起始位置的距离 - (视图宽度 - 右侧视图宽度) / 2</span><br><span class="line"></span><br><span class="line">        // padding-right 距离</span><br><span class="line">        left: target.offsetLeft + target.offsetWidth / 2 - (w - w * 0.2373) / 2,</span><br><span class="line">        // 滚动行为: smooth 表示平滑滚动</span><br><span class="line">        behavior: &quot;smooth&quot;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    [scrollContainerRef]</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&#123;styles.list&#125; ref=&#123;scrollContainerRef&#125;&gt;</span><br><span class="line">      &#123;channels.map((channel) =&gt; (</span><br><span class="line">        &lt;div onClick=&#123;(event) =&gt; scrollHandler(event.currentTarget)&#125;&gt;</span><br><span class="line">          &#123;channel&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      ))&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③ 使用自定义钩子函数将滚动效果抽取出来以供后续逻辑使用</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useCallback, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">useChannelScroll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 用于存储滚动盒子</span></span><br><span class="line">  <span class="keyword">const</span> scrollContainerRef = useRef&lt;<span class="literal">null</span> | HTMLDivElement&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 点击事件处理函数</span></span><br><span class="line">  <span class="keyword">const</span> scrollHandler = useCallback(</span><br><span class="line">    <span class="function">(<span class="params">target: HTMLDivElement</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 获取视图宽度</span></span><br><span class="line">      <span class="keyword">const</span> w = <span class="built_in">window</span>.innerWidth;</span><br><span class="line">      <span class="comment">// 设置横向滚动距离</span></span><br><span class="line">      scrollContainerRef.current!.scrollTo(&#123;</span><br><span class="line">        <span class="comment">// 横向滚动距离 = 用户点击的一级分类盒子的中心点与滚动盒子起始位置的距离 - (视图宽度 - 右侧视图宽度) / 2</span></span><br><span class="line">        <span class="attr">left</span>: target.offsetLeft + target.offsetWidth / <span class="number">2</span> - (w - w * <span class="number">0.2373</span>) / <span class="number">2</span>,</span><br><span class="line">        <span class="comment">// 滚动行为: smooth 表示平滑滚动</span></span><br><span class="line">        <span class="attr">behavior</span>: <span class="string">&quot;smooth&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    [scrollContainerRef]</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; scrollHandler, scrollContainerRef &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/pages/home/channel/index.tsx</span><br><span class="line">import useChannelScroll from &quot;@pages/home/channel/common/scroll&quot;;</span><br><span class="line"></span><br><span class="line">export default function Channel() &#123;</span><br><span class="line">  const &#123; scrollHandler, scrollContainerRef &#125; = useChannelScroll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>react</tag>
        <tag>频道列表居中</tag>
      </tags>
  </entry>
  <entry>
    <title>如何设置文章置顶</title>
    <url>/archives/cf2f5248.html</url>
    <content><![CDATA[<div class="tip info"><p>修改</p>
</div>
<div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>
            <p>找到node_modules/hexo-generator-index/lib/generator.js这个文件。</p>
            </div>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> posts = locals.posts;</span><br></pre></td></tr></table></figure>
<div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>
            <p>下面添加</p>
            </div>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">posts.data = posts.data.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (a.top &amp;&amp; b.top) &#123;</span><br><span class="line">    <span class="comment">// 两篇文章top都有定义</span></span><br><span class="line">    <span class="keyword">if</span> (a.top == b.top)</span><br><span class="line">      <span class="keyword">return</span> b.date - a.date; <span class="comment">// 若top值一样则按照文章日期降序排</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> b.top - a.top; <span class="comment">// 否则按照top值降序排</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a.top &amp;&amp; !b.top) &#123;</span><br><span class="line">    <span class="comment">// 以下是只有一篇文章top有定义，那么将有top的排在前面（这里用异或操作居然不行233）</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!a.top &amp;&amp; b.top) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">return</span> b.date - a.date; <span class="comment">// 都没定义按照文章日期降序排</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<div class='checkbox green checked'><input type="checkbox" checked="checked"/>
            <p>ok + 完整代码</p>
            </div>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pagination = <span class="built_in">require</span>(<span class="string">&quot;hexo-pagination&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; sort &#125; = <span class="built_in">require</span>(<span class="string">&quot;timsort&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">locals</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> config = <span class="built_in">this</span>.config;</span><br><span class="line">  <span class="keyword">const</span> posts = locals.posts.sort(config.index_generator.order_by);</span><br><span class="line">  posts.data = posts.data.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a.top &amp;&amp; b.top) &#123;</span><br><span class="line">      <span class="comment">// 两篇文章top都有定义</span></span><br><span class="line">      <span class="keyword">if</span> (a.top == b.top)</span><br><span class="line">        <span class="keyword">return</span> b.date - a.date; <span class="comment">// 若top值一样则按照文章日期降序排</span></span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">return</span> b.top - a.top; <span class="comment">// 否则按照top值降序排</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a.top &amp;&amp; !b.top) &#123;</span><br><span class="line">      <span class="comment">// 以下是只有一篇文章top有定义，那么将有top的排在前面（这里用异或操作居然不行233）</span></span><br><span class="line">      <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!a.top &amp;&amp; b.top) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">return</span> b.date - a.date; <span class="comment">// 都没定义按照文章日期降序排</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// sort(posts.data, (a, b) =&gt; (b.sticky || 0) - (a.sticky || 0));</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> paginationDir = config.pagination_dir || <span class="string">&quot;page&quot;</span>;</span><br><span class="line">  <span class="keyword">const</span> path = config.index_generator.path || <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> pagination(path, posts, &#123;</span><br><span class="line">    <span class="attr">perPage</span>: config.index_generator.per_page,</span><br><span class="line">    <span class="attr">layout</span>: [<span class="string">&quot;index&quot;</span>, <span class="string">&quot;archive&quot;</span>],</span><br><span class="line">    <span class="attr">format</span>: paginationDir + <span class="string">&quot;/%d/&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">__index</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>在文章添加 top 标签可以设置置顶顺序。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 文章名</span><br><span class="line"><span class="attr">date</span>: 文章发布时间</span><br><span class="line"><span class="attr">tags</span>: 文章标签</span><br><span class="line"><span class="attr">top</span>: <span class="number">100</span>(文章置顶)</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<div class="tip bell"><p>原文地址 : <a href="https://www.jianshu.com/p/a5d85680722e">https://www.jianshu.com/p/a5d85680722e</a></p>
</div>
]]></content>
      <categories>
        <category>blog</category>
      </categories>
      <tags>
        <tag>blog</tag>
        <tag>如何设置文章置顶</tag>
      </tags>
  </entry>
  <entry>
    <title>星星落落</title>
    <url>/archives/84a91e69.html</url>
    <content><![CDATA[  <!-- header -->
  <div class="container grid-sm s-content header">
    <div class="column col-12">
      <h1 class="logo"> <i class="ico i-love"><img src="/img/love.gif" alt="">  </i> <a href="/">等你</a> </h1>
      <p class="description">
        与其说是一种记录，不如说是一种提醒手段，提醒自己时时刻刻要记得温柔和第一次见面时的憧憬。我也不知道这个页面多久才能正式投入使用，但我希望这个清单上的所有事能在有生之年全部完成。这是<a href="#"
          target="_blank">@六七</a> 与 <a href="#" target="_blank">@YY</a> 相爱的N件事。
      </p>
    </div>
  </div>
  <!-- body -->
  <div class="container grid-sm s-content posts">
    <div class="column col-12">
      <ol>
        <li class="done">
          <del>写下这份清单</del>
        </li>
        <li class="">
          <p>等你回来</p>
        </li>
        <li class="">
          <p>一起看夜景</p>
        </li>
        <li class="">
          <p>一起通宵跨年</p>
        </li>
        <li class="">
          <p>一起蹦极</p>
        </li>
        <li class="">
          <p>一起追剧</p>
        </li>
        <li class="">
          <p>把所有有意义的小物件拍照留念</p>
        </li>
        <li class="">
          <p>把对方送到家门口</p>
        </li>
        <li class="">
          <p>手牵手逛街</p>
        </li>
        <li class="">
          <p>一起看电影</p>
        </li>
        <li class="">
          <p>拥有真正的独立和自由</p>
        </li>
        <li class="">
          <p>成为更好的自己</p>
        </li>
        <li class="">
          <p>一起见证一场朋友的婚礼</p>
        </li>
        <li class="">
          <p>教对方一件你擅长的事情</p>
        </li>
        <li class="">
          <p>一起去鬼屋</p>
        </li>
        <li class="">
          <p>在生病的时候陪在对方身边</p>
        </li>
        <li class="">
          <p>耗尽心力的为对方做一件事</p>
        </li>
        <li class="">
          <p>一起期待未来的生活</p>
        </li>
        <li class="">
          <p>一起去当志愿者</p>
        </li>
        <li class="">
          <p>一起养一只宠物</p>
        </li>
        <li class="">
          <p>一起去寺庙里祈福/许愿池许愿</p>
        </li>
        <li class="">
          <p>一起坐摩天轮</p>
        </li>
        <li class="">
          <p>在沙滩上写对方的名字</p>
        </li>
        <li class="">
          <p>去对方的城市给对方一个惊喜</p>
        </li>
        <li class="">
          <p>帮对方化妆</p>
        </li>
        <li class="">
          <p>一起做一次大扫除</p>
        </li>
        <li class="">
          <p>一起组队玩一款游戏</p>
        </li>
        <li class="">
          <p>偷偷买对方想买但没舍得买的东西</p>
        </li>
        <li class="">
          <p>一起写我们的故事</p>
        </li>
        <li class="">
          <p>一起看日落</p>
        </li>
        <li class="">
          <p>一起数星星</p>
        </li>
        <li class="">
          <p>一起看日出</p>
        </li>
        <li class="">
          <p>喝同一杯奶茶</p>
        </li>
        <li class="">
          <p>一起看雪</p>
        </li>
        <li class="">
          <p>一起洗衣服</p>
        </li>
        <li class="">
          <p>去北海道看海</p>
        </li>
        <li class="">
          <p>把肩膀借给对方靠</p>
        </li>
        <li class="">
          <p>一起过我们的纪念日</p>
        </li>
        <li class="">
          <p>一起发呆</p>
        </li>
        <li class="">
          <p>告诉对方我想你</p>
        </li>
        <li class="">
          <p>为对方写篇日记</p>
        </li>
        <li class="">
          <p>在沙滩上画心写彼此的名字</p>
        </li>
        <li class="">
          <p>一起熬夜玩游戏</p>
        </li>
        <li class="">
          <p>学对方说话</p>
        </li>
        <li class="">
          <p>模仿对方喜欢的动漫人物</p>
        </li>
        <li class="">
          <p>给对方写信，然后读给对方听</p>
        </li>
        <li class="">
          <p>一起看流星并且许下心愿</p>
        </li>
        <li class="">
          <p>一起拍照片</p>
        </li>
        <li class="">
          <p>一起骑脚踏车</p>
        </li>
        <li class="">
          <p>戴同一条围巾</p>
        </li>
        <li class="">
          <p>戴同一双手套</p>
        </li>
        <li class="">
          <p>讲故事哄对方睡觉</p>
        </li>
        <li class="">
          <p>一起吃棉花糖</p>
        </li>
        <li class="">
          <p>一起录一首歌</p>
        </li>
        <li class="">
          <p>一起淋雨</p>
        </li>
        <li class="">
          <p>一起面对所有难堪</p>
        </li>
        <li class="">
          <p>一起爬山</p>
        </li>
        <li class="">
          <p>一起露营</p>
        </li>
        <li class="">
          <p>一起晨练</p>
        </li>
        <li class="">
          <p>一起在路边摊撸串</p>
        </li>
        <li class="">
          <p>一起帮助需要帮助的人</p>
        </li>
        <li class="">
          <p>穿情侣装在大街上拥抱</p>
        </li>
        <li class="">
          <p>一起存钱</p>
        </li>
        <li class="">
          <p>分享对方爱吃的食物</p>
        </li>
        <li class="">
          <p>一起手牵手压马路</p>
        </li>
        <li class="">
          <p>咬对方的脸颊</p>
        </li>
        <li class="">
          <p>每天说晚安</p>
        </li>
        <li class="">
          <p>假装当陌生人一天</p>
        </li>
        <li class="">
          <p>一起去海南的天涯海角</p>
        </li>
        <li class="">
          <p>一起买菜</p>
        </li>
        <li class="">
          <p>一起去见对方父母</p>
        </li>
        <li class="">
          <p>把朋友介绍给对方</p>
        </li>
        <li class="">
          <p>一起做鬼脸</p>
        </li>
        <li class="">
          <p>一起走遍世界</p>
        </li>
        <li class="">
          <p>一起扎气球赢奖品</p>
        </li>
        <li class="">
          <p>站在马路的两侧大喊对方的名字</p>
        </li>
        <li class="">
          <p>看你打场球赛</p>
        </li>
        <li class="">
          <p>一起看演唱会</p>
        </li>
        <li class="">
          <p>一起沿铁轨奔跑</p>
        </li>
        <li class="">
          <p>一起挤公车</p>
        </li>
        <li class="">
          <p>一起放风筝</p>
        </li>
        <li class="">
          <p>一起去普罗旺斯看花田</p>
        </li>
        <li class="">
          <p>趁睡觉偷亲对方</p>
        </li>
        <li class="">
          <p>一起放孔明灯</p>
        </li>
        <li class="">
          <p>一起钓鱼</p>
        </li>
        <li class="">
          <p>一起下棋</p>
        </li>
        <li class="">
          <p>交换一个秘密</p>
        </li>
        <li class="">
          <p>将手机屏保设置对方的照片</p>
        </li>
        <li class="">
          <p>每天给对方留言</p>
        </li>
        <li class="">
          <p>一起捏对方的脸</p>
        </li>
        <li class="">
          <p>比赛各种各样的事</p>
        </li>
        <li class="">
          <p>一起看烟火</p>
        </li>
        <li class="">
          <p>在树下埋下我们的约定</p>
        </li>
        <li class="">
          <p>一起去海边扔漂流瓶</p>
        </li>
        <li class="">
          <p>互相鼓励</p>
        </li>
        <li class="">
          <p>一起挑选结婚钻戒</p>
        </li>
        <li class="">
          <p>结婚生子</p>
        </li>
        <li class="">
          <p>拍一套婚纱照</p>
        </li>
        <li class="">
          <p>养育子女及完成人生各项大事</p>
        </li>
        <li class="">
          <p>白头偕老</p>
        </li>
      </ol>
    </div>
  </div>]]></content>
      <categories>
        <category>fine</category>
      </categories>
      <tags>
        <tag>星星</tag>
      </tags>
  </entry>
  <entry>
    <title>添加备案信息</title>
    <url>/archives/2b098523.html</url>
    <content><![CDATA[<div class="tip bell"><h3 id="添加备案信息在-blog-底部"><a href="#添加备案信息在-blog-底部" class="headerlink" title="添加备案信息在 blog 底部"></a>添加备案信息在 blog 底部</h3></div>
<p>解释说明：前者是公安的备案，后者是注册域名时的备案</p>
<p><img src="https://files.catbox.moe/ur5wj2.png" alt=""></p>
<div class='checkbox red'><input type="radio" />
            <h4 id="看清自己的主题，然后在进行配置"><a href="#看清自己的主题，然后在进行配置" class="headerlink" title="看清自己的主题，然后在进行配置"></a>看清自己的主题，然后在进行配置</h4>
            </div>
<div class='checkbox'><input type="checkbox" />
            <p>以 Butterfly 演示</p>
            </div>
<p>首先找到 <code>~~~\themes\butterfly\_config.yml</code>主题配置文件，搜索<code>Footer Settings</code>,大概在 400 行左右，custom_text，就是你需要添加备案信息的地方</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a href=&quot;https://beian.miit.gov.cn/#/Integrated/index&quot;  style=&quot;color:#f72b07&quot; target=&quot;_blank&quot;&gt;陇ICP备2021001042号&lt;/a&gt;</span><br><span class="line">   &lt;br&gt;</span><br><span class="line">   &lt;img src=&quot;/img/beian.png&quot; style=&quot;vertical-align:text-bottom&quot;&gt;</span><br><span class="line">   &lt;a href=&quot;https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=62102402000145&quot;  style=&quot;color:#f72b07&quot; target=&quot;_blank&quot;&gt;甘公网安备 62102402000145号&lt;/a&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://files.catbox.moe/m1eqef.png" alt=""></p>
]]></content>
      <categories>
        <category>blog</category>
      </categories>
      <tags>
        <tag>备案</tag>
        <tag>icp</tag>
      </tags>
  </entry>
  <entry>
    <title>封装复选框组件</title>
    <url>/archives/88d3d46f.html</url>
    <content><![CDATA[<h3 id="gt-目标：实现管理员退出登录功能"><a href="#gt-目标：实现管理员退出登录功能" class="headerlink" title="&gt; 目标：实现管理员退出登录功能"></a>&gt; 目标：实现管理员退出登录功能</h3><h4 id="①-封装可复用的确认框组件"><a href="#①-封装可复用的确认框组件" class="headerlink" title="① 封装可复用的确认框组件"></a>① 封装可复用的确认框组件</h4><p><a href="https://imgse.com/i/ppTEBIP"><img src="https://s1.ax1x.com/2023/04/07/ppTEBIP.png" alt="ppTEBIP.png"></a></p>
<p>(1) 创建确认框组件并拷贝布局和样式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/shared/confirm/index.tsx</span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default class confirm extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;modal is-active&quot;&gt;</span><br><span class="line">        &lt;div</span><br><span class="line">          className=&quot;modal-background&quot;</span><br><span class="line">          style=&#123;&#123; backgroundColor: &quot;rgba(0,0,0,0.5)&quot; &#125;&#125;</span><br><span class="line">        &gt;&lt;/div&gt;</span><br><span class="line">        &lt;div className=&quot;modal-card&quot;&gt;</span><br><span class="line">          &lt;header className=&quot;modal-card-head&quot;&gt;</span><br><span class="line">            &lt;p className=&quot;modal-card-title&quot;&gt;温馨提示&lt;/p&gt;</span><br><span class="line">            &lt;button className=&quot;delete&quot;&gt;&lt;/button&gt;</span><br><span class="line">          &lt;/header&gt;</span><br><span class="line">          &lt;section className=&quot;modal-card-body&quot;&gt;您确定要退出登录吗&lt;/section&gt;</span><br><span class="line">          &lt;footer className=&quot;modal-card-foot&quot;&gt;</span><br><span class="line">            &lt;button className=&quot;button is-success&quot;&gt;确定&lt;/button&gt;</span><br><span class="line">            &lt;button className=&quot;button is-info&quot;&gt;取消&lt;/button&gt;</span><br><span class="line">          &lt;/footer&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>(2) 封装可复用的确认框组件</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- public/index.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;modal-root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/shared/confirm/index.tsx</span><br><span class="line">import React, &#123; ReactNode &#125; from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">interface Props &#123;</span><br><span class="line">  // 控制弹框是否渲染</span><br><span class="line">  isOpen: boolean;</span><br><span class="line">  // 弹框标题</span><br><span class="line">  title: string;</span><br><span class="line">  // 弹框提示内容</span><br><span class="line">  children: ReactNode;</span><br><span class="line">  // 关闭弹框的方法</span><br><span class="line">  close: () =&gt; void;</span><br><span class="line">  // 点击取消按钮时执行的方法</span><br><span class="line">  onCancelButtonClicked: () =&gt; void;</span><br><span class="line">  // 点击确定按钮时执行的方法</span><br><span class="line">  onSureButtonClicked: () =&gt; void;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class Confirm extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  // 默认值</span><br><span class="line">  static defaultProps = &#123;</span><br><span class="line">    title: &quot;温馨提示&quot;,</span><br><span class="line">    onCancelButtonClicked: () =&gt; &#123;&#125;,</span><br><span class="line">    onSureButtonClicked: () =&gt; &#123;&#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123;</span><br><span class="line">      title,</span><br><span class="line">      children,</span><br><span class="line">      isOpen,</span><br><span class="line">      close,</span><br><span class="line">      onCancelButtonClicked,</span><br><span class="line">      onSureButtonClicked,</span><br><span class="line">    &#125; = this.props;</span><br><span class="line">    return (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &#123;isOpen &amp;&amp; (</span><br><span class="line">          &lt;div className=&quot;modal is-active&quot;&gt;</span><br><span class="line">            &lt;div</span><br><span class="line">              className=&quot;modal-background&quot;</span><br><span class="line">              style=&#123;&#123; backgroundColor: &quot;rgba(0,0,0,0.5)&quot; &#125;&#125;</span><br><span class="line">            &gt;&lt;/div&gt;</span><br><span class="line">            &lt;div className=&quot;modal-card&quot;&gt;</span><br><span class="line">              &lt;header className=&quot;modal-card-head&quot;&gt;</span><br><span class="line">                &lt;p className=&quot;modal-card-title&quot;&gt;&#123;title&#125;&lt;/p&gt;</span><br><span class="line">                &lt;button</span><br><span class="line">                  onClick=&#123;() =&gt; &#123;</span><br><span class="line">                    close();</span><br><span class="line">                    onCancelButtonClicked();</span><br><span class="line">                  &#125;&#125;</span><br><span class="line">                  className=&quot;delete&quot;</span><br><span class="line">                &gt;&lt;/button&gt;</span><br><span class="line">              &lt;/header&gt;</span><br><span class="line">              &lt;section className=&quot;modal-card-body&quot;&gt;&#123;children&#125;&lt;/section&gt;</span><br><span class="line">              &lt;footer</span><br><span class="line">                className=&quot;modal-card-foot&quot;</span><br><span class="line">                style=&#123;&#123; display: &quot;flex&quot;, justifyContent: &quot;end&quot; &#125;&#125;</span><br><span class="line">              &gt;</span><br><span class="line">                &lt;button</span><br><span class="line">                  onClick=&#123;() =&gt; &#123;</span><br><span class="line">                    close();</span><br><span class="line">                    onSureButtonClicked();</span><br><span class="line">                  &#125;&#125;</span><br><span class="line">                  className=&quot;button is-success&quot;</span><br><span class="line">                &gt;</span><br><span class="line">                  确定</span><br><span class="line">                &lt;/button&gt;</span><br><span class="line">                &lt;button</span><br><span class="line">                  onClick=&#123;() =&gt; &#123;</span><br><span class="line">                    close();</span><br><span class="line">                    onCancelButtonClicked();</span><br><span class="line">                  &#125;&#125;</span><br><span class="line">                  className=&quot;button is-info&quot;</span><br><span class="line">                &gt;</span><br><span class="line">                  取消</span><br><span class="line">                &lt;/button&gt;</span><br><span class="line">              &lt;/footer&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        )&#125;</span><br><span class="line">      &lt;/&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="②-控制退出登录确认框的渲染和销毁"><a href="#②-控制退出登录确认框的渲染和销毁" class="headerlink" title="② 控制退出登录确认框的渲染和销毁"></a>② 控制退出登录确认框的渲染和销毁</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/shared/confirm/index.tsx</span><br><span class="line">import Confirm from &quot;@shared/confirm&quot;;</span><br><span class="line"></span><br><span class="line">// 组件状态类型</span><br><span class="line">interface States &#123;</span><br><span class="line">  // 控制退出登录弹窗是否渲染</span><br><span class="line">  isOpen: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Header extends React.Component&lt;Props, States&gt; &#123;</span><br><span class="line">  // 构造函数</span><br><span class="line">  constructor(props: Props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    // 组件状态</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      // 控制退出登录弹窗是否渲染</span><br><span class="line">      isOpen: false,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  // 渲染用户信息</span><br><span class="line">  userInfo() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; this.setState(&#123; isOpen: true &#125;)&#125;&gt;退出&lt;/button&gt;</span><br><span class="line">        &lt;Confirm</span><br><span class="line">          isOpen=&#123;this.state.isOpen&#125;</span><br><span class="line">          close=&#123;() =&gt; this.setState(&#123; isOpen: false &#125;)&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          您确定要退出登录吗?</span><br><span class="line">        &lt;/Confirm&gt;</span><br><span class="line">      &lt;/&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="③-实现退出登录功能-清空用户登录凭证、清空用户信息"><a href="#③-实现退出登录功能-清空用户登录凭证、清空用户信息" class="headerlink" title="③ 实现退出登录功能(清空用户登录凭证、清空用户信息)"></a>③ 实现退出登录功能(清空用户登录凭证、清空用户信息)</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建用于实现清空用户信息的 action type</span></span><br><span class="line"><span class="comment">// src/store/types/userTypes.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="built_in">enum</span> UserTypes &#123;</span><br><span class="line">  CLEAR_USER = <span class="string">&quot;用户/清空用户信息&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建用于实现清空用户信息的 action 类型</span></span><br><span class="line"><span class="comment">// src/store/actions/userActions.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">namespace</span> UserActions &#123;</span><br><span class="line">  <span class="comment">// 清空用户信息</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> ClearUser &#123;</span><br><span class="line">    <span class="attr">type</span>: UserTypes.CLEAR_USER;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// User Actions</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">type</span> Actions = ... | ClearUser;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建用于实现清空用户信息的 action creator</span></span><br><span class="line"><span class="comment">// src/store/creators/userCreators.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">namespace</span> UserCreators &#123;</span><br><span class="line">  <span class="comment">// 清空用户信息</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">const</span> clearUser = (): UserActions.ClearUser =&gt; (&#123;</span><br><span class="line">    <span class="attr">type</span>: UserTypes.CLEAR_USER,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在 userReducer 函数中接收清空用户信息的 action type 并清空用户信息</span></span><br><span class="line"><span class="comment">// src/store/reducers/userReducer.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">userReducer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="comment">// 清空用户信息</span></span><br><span class="line">    <span class="keyword">case</span> UserTypes.CLEAR_USER:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">credentials</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">user</span>: &#123;</span><br><span class="line">          ...state.user,</span><br><span class="line">          <span class="attr">status</span>: <span class="string">&quot;idle&quot;</span>,</span><br><span class="line">          <span class="attr">error</span>: <span class="literal">null</span>,</span><br><span class="line">          <span class="attr">result</span>: &#123;&#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/shared/header/index.tsx</span><br><span class="line">import &#123; history &#125; from &quot;@src/AppRouter&quot;;</span><br><span class="line"></span><br><span class="line">interface DispatchProps &#123;</span><br><span class="line">  // 清空用户信息</span><br><span class="line">  clearUser: () =&gt; UserActions.ClearUser;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Header extends React.Component&lt;Props, States&gt; &#123;</span><br><span class="line">  // 渲染用户信息</span><br><span class="line">  userInfo() &#123;</span><br><span class="line">    // 获取用户状态</span><br><span class="line">    const &#123; clearUser &#125; = this.props;</span><br><span class="line">    // 渲染用户信息</span><br><span class="line">    return (</span><br><span class="line">      &lt;Confirm</span><br><span class="line">        onSureButtonClicked=&#123;() =&gt; &#123;</span><br><span class="line">          // 清空用户信息</span><br><span class="line">          clearUser();</span><br><span class="line">          // 跳转到登录页</span><br><span class="line">          history.replace(&quot;/login&quot;);</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        您确定要退出登录吗?</span><br><span class="line">      &lt;/Confirm&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const mapDispatchToProps: MapDispatchToPropsParam&lt;DispatchProps, OwnProps&gt; = (</span><br><span class="line">  dispatch: AppThunkDispatch</span><br><span class="line">) =&gt; (&#123;</span><br><span class="line">  // 清空用户信息</span><br><span class="line">  clearUser: () =&gt; dispatch(UserCreators.clearUser()),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>react</category>
        <category>ts</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>ts</tag>
      </tags>
  </entry>
  <entry>
    <title>面试问题集锦</title>
    <url>/archives/9417ce47.html</url>
    <content><![CDATA[<h1 id="面试问题集锦"><a href="#面试问题集锦" class="headerlink" title="面试问题集锦"></a>面试问题集锦</h1><h2 id="请做一下自我介绍"><a href="#请做一下自我介绍" class="headerlink" title="请做一下自我介绍"></a>请做一下自我介绍</h2><p><strong>回答提示：</strong> 一般人回答这个问题过于平常，只说姓名、年龄、工作经验，这些在简历上都有。其实，企业最希望知道的是求职者能否胜任工作，包括：最强的技能、最深入研究的知识领域、个性中最积极的部分、做过的最成功的事，主要的成就等，要突出积极的个性和做事的能力，说的合情合理企业才会相信。</p>
<h2 id="你最大的优点是什么？"><a href="#你最大的优点是什么？" class="headerlink" title="你最大的优点是什么？"></a>你最大的优点是什么？</h2><p><strong>回答提示：</strong> 沉着冷静、条理清楚、立场坚定、乐于助人等，加上例子如：我在XX经过一到两年的培训及项目实战，加上实习工作，我想我适合这份工作。</p>
<h2 id="说说你最大的缺点？"><a href="#说说你最大的缺点？" class="headerlink" title="说说你最大的缺点？"></a>说说你最大的缺点？</h2><p><strong>回答提示：</strong> 这个问题企业问的概率很大，通常不希望听到直接回答的缺点是什么等，如果求职者说自己小心眼、非常懒、工作效率低，企业肯定不会录用你。要从自己的优点说起，中间加一些小缺点，最后再把问答转回到优点上，突出优点的部分。</p>
<h2 id="说说你对加班的看法？"><a href="#说说你对加班的看法？" class="headerlink" title="说说你对加班的看法？"></a>说说你对加班的看法？</h2><p><strong>回答提示：</strong> 实际上好多公司问这个问题，并不证明一定要加班，只是想测试你是否愿意为公司奉献。</p>
<p><strong>回答样本：</strong> 如果是工作需要我会义不容辞加班，我现在单身，没有任何家庭负担，可以全身心的投入工作。但同时，我也会提高工作效率，减少不必要的加班。</p>
<h2 id="说说你对薪资的要求？"><a href="#说说你对薪资的要求？" class="headerlink" title="说说你对薪资的要求？"></a>说说你对薪资的要求？</h2><p><strong>回答提示：</strong> 如果你对薪资的要求太低，那显然贬低自己的能力；如果你对薪资的要求太高，那又会显得你分量过重，公司受用不起。一些雇主通常都事先对求聘的职位定下开支预算，因而他们第一次提出的价钱往往是他们所能给予的最高价钱，他们问你只不过想证实一下这笔钱是否足以引起你对该工作的兴趣。</p>
<p><strong>回答样本：</strong> </p>
<p>①我对工资没有硬性要求，我相信贵公司会友善合理。我注重的是找到工作机会，所以只要条件公平，我则不会计较太多。</p>
<p>②我受过系统的软件编程的训练，不需要进行大量的培训，而且我本人也对编程特别感兴趣。因此，我希望公司能根据我的情况和市场标准的水平，给我合理的薪水。</p>
<p>③如果你必须自己说出具体数目，请不要说一个宽泛的范围，那样你将只能得到最低限度的数字。最好给出一个具体的数字，这样表明你已经对当今的人才市场做了调查，知道像自己这样学历的雇员有什么样的价值。</p>
<h2 id="在五年内，你的职业规划？"><a href="#在五年内，你的职业规划？" class="headerlink" title="在五年内，你的职业规划？"></a>在五年内，你的职业规划？</h2><p><strong>回答提示：</strong> 这是每一个应聘者都不希望被问到的问题，但是几乎每个人都会被问到，比较多的答案是“管理者”。当然，说出其他一些你感兴趣的职位也是可以的。要知道，考官总是喜欢有进取心的应聘者，此时如果说“不知道”，或许就会使你丧失一个好机会。最普通的回答应该是“我准备在技术领域有所作为”或“我希望能按照公司的管理思路发展”。</p>
<h2 id="你朋友对你的评价"><a href="#你朋友对你的评价" class="headerlink" title="你朋友对你的评价?"></a>你朋友对你的评价?</h2><p><strong>回答提示：</strong> 想从侧面了解一下你的性格及与人相处的问题。</p>
<p><strong>回答样本：</strong> </p>
<p>①我朋友都说我是一个可以信赖的人。因为，我一旦答应别人的事情，就一定会做到。如果我做不到，我就不会轻易许诺。</p>
<p>②我觉的我是一个比较随和的人，与不同的人都可以友好相处。在我与人相处时，我总是能站在别人的角度考虑问题。</p>
<h2 id="你还有什么问题要问吗"><a href="#你还有什么问题要问吗" class="headerlink" title="你还有什么问题要问吗?"></a>你还有什么问题要问吗?</h2><p><strong>回答提示：</strong> 企业的这个问题看上去可有可无，其实很关键，企业不喜欢说“没问题”的人，因为其很注重员工的个性和创新能力。企业不喜欢求职者问个人福利之类的问题，如果有人这样问：贵公司对新入公司的员工有没有什么培训项目，我可以参加吗？或者说贵公司的晋升机制是什么样的？企业将很欢迎，因为体现出你对学习的热情和对公司的忠诚度以及你的上进心。</p>
<h2 id="录用后发现不适合这个职位，怎么办"><a href="#录用后发现不适合这个职位，怎么办" class="headerlink" title="录用后发现不适合这个职位，怎么办?"></a>录用后发现不适合这个职位，怎么办?</h2><p><strong>回答提示：</strong> 工作一段时间发现工作不适合，有两种情况：①如果你确实热爱这个职业，那就要不断学习，虚心向领导和同事学习业务知识和处事经验，了解这个职业的精神内涵和职业要求，力争减少差距；②你觉得这个职业可有可无，那还是趁早换个职业，去发现适合你的，你热爱的职业，那样你的发展前途也会大点，对单位和个人都有好处。</p>
<h2 id="工作时跟领导意见不同怎么办"><a href="#工作时跟领导意见不同怎么办" class="headerlink" title="工作时跟领导意见不同怎么办?"></a>工作时跟领导意见不同怎么办?</h2><p><strong>回答样本：</strong> ①原则上我会尊重和服从领导的工作安排，同时私底下找机会以请教的口吻，婉转地表达自己的想法，看看领导是否能改变想法。②如果领导没有采纳我的建议，我也同样会按领导的要求认真地去完成这项工作。③还有一种情况，假如领导要求的方式违背原则，我会坚决提出反对意见，如领导仍固执己见，我会毫不犹豫地再向上级领导反映。</p>
<h2 id="工作出现失误并造成损失，你会怎么做"><a href="#工作出现失误并造成损失，你会怎么做" class="headerlink" title="工作出现失误并造成损失，你会怎么做?"></a>工作出现失误并造成损失，你会怎么做?</h2><p><strong>回答样本：</strong> ①我本意是为公司努力工作，如果造成经济损失，我认为首要的问题是想方设法去弥补或挽回经济损失。如果我无能力负责，希望单位帮助解决。</p>
<p>②分清责任，各负其责，如果是我的责任，我甘愿受罚；如果是一个我负责的团队中别人的失误，也不能幸灾乐祸，作为一个团队，需要互相提携共同成工作，安慰同事并且帮助同事查找原因总结经验。</p>
<p>③个人的一生不可能不犯错误，重要的是能从自己的或者是别人的错误中吸取经验教训，要检讨自己的工作方法、分析问题的深度和力度。</p>
<h2 id="谈谈你对跳槽的看法"><a href="#谈谈你对跳槽的看法" class="headerlink" title="谈谈你对跳槽的看法?"></a>谈谈你对跳槽的看法?</h2><p><strong>回答样本：</strong> ①正常的“跳槽”能够促进人才合理流动，应该支持。②频繁的跳槽对单位和个人双方都不利，应该反对。</p>
<h2 id="和同事、上司难以相处，你怎么办"><a href="#和同事、上司难以相处，你怎么办" class="headerlink" title="和同事、上司难以相处，你怎么办?"></a>和同事、上司难以相处，你怎么办?</h2><p><strong>回答样本：</strong> ①我会服从领导的指挥，配合同事的工作。②我会从自身找原因，仔细分析是不是自己工作做得不好。还要看看是不是为人处世方面做得不好，如果是这样的话我会努力改正。③如果我找不到原因，我会找机会跟他们沟通，请他们指出我的不足，及时改正。④作为优秀的员工，应该时刻以大局为重，即使在一段时间内，领导和同事对我不理解，我也会做好本职工作，虚心向他们学习，我相信，他们会看见我的努力。</p>
<h2 id="上级领导抢了你的功劳怎么办"><a href="#上级领导抢了你的功劳怎么办" class="headerlink" title="上级领导抢了你的功劳怎么办?"></a>上级领导抢了你的功劳怎么办?</h2><p> <strong>回答样本：</strong> 首先我不会找那位上级领导说明这事，我会主动找我的主管领导来沟通，因为沟通是解决人际关系的最好办法，但结果会有两种：①我的主管领导认识到自己的错误，我想我会视具体情况决定是否原谅他。②他更加变本加厉的来威胁我，那我会毫不犹豫地找我的上级领导反映此事，因为他这样做会造成负面影响，对今后的工作不利。</p>
<h2 id="同事孤立你，你怎么办"><a href="#同事孤立你，你怎么办" class="headerlink" title="同事孤立你，你怎么办?"></a>同事孤立你，你怎么办?</h2><p><strong>回答样本：</strong> ①检讨一下自己是不是对工作的热心度超过同事间交往的热心了，加强同事间的交往及共同的兴趣爱好。②工作中，切勿伤害别人的自尊心。③不在领导前拨弄是非。</p>
<h2 id="你最近是否参加了培训课程"><a href="#你最近是否参加了培训课程" class="headerlink" title="你最近是否参加了培训课程?"></a>你最近是否参加了培训课程?</h2><p><strong>回答提示：</strong> 自费参加，就是XX的培训课程（可以多谈谈自己学的技术）。</p>
<h2 id="你对于我们公司了解多少"><a href="#你对于我们公司了解多少" class="headerlink" title="你对于我们公司了解多少?"></a>你对于我们公司了解多少?</h2><p><strong>回答提示：</strong> 在去公司面试前上网查一下该公司主营业务。可类似回答：贵公司有意改变策略，加强与国外大厂的OEM合作，自有品牌的部分则透过海外经销商。</p>
<h2 id="你最擅长的技术方向是什么"><a href="#你最擅长的技术方向是什么" class="headerlink" title="你最擅长的技术方向是什么?"></a>你最擅长的技术方向是什么?</h2><p><strong>回答提示：</strong> 说和你要应聘的职位相关的技术，表现一下自己的热诚没有什么坏处。</p>
<h2 id="请说出你选择这份工作的动机"><a href="#请说出你选择这份工作的动机" class="headerlink" title="请说出你选择这份工作的动机?"></a>请说出你选择这份工作的动机?</h2><p><strong>回答提示：</strong> 这是想知道面试者对这份工作的热忱及理解度，并筛选因一时兴起而来应试的人，如果是无经验者，可以强调“就算职种不同，也希望有机会发挥之前的经验”。</p>
<p><strong>回答样本：</strong> 因为我很热爱这个工作，很想从事这方面的工作。</p>
<h2 id="你能为我们公司带来什么呢"><a href="#你能为我们公司带来什么呢" class="headerlink" title="你能为我们公司带来什么呢?"></a>你能为我们公司带来什么呢?</h2><p><strong>回答提示：</strong> ①假如你可以的话，试着告诉他们你可以减低他们的费用“我已经接受过XX近两年专业的培训，立刻就可以上岗工作”。②企业很想知道未来的员工能为企业做什么，求职者应再次重复自己的优势，然后表示：“就我的能力，我可以做一个优秀的员工在组织中发挥能力，给组织带来高效率和更多的收益”。企业喜欢求职者就申请的职位表明自己的能力，比如申请营销之类的职位，可以说：“我可以开发大量的新客户，同时，对老客户做更全面周到的服务，开发老客户的新需求和消费。” 等等。</p>
<h2 id="最能概括你自己的三个词"><a href="#最能概括你自己的三个词" class="headerlink" title="最能概括你自己的三个词?"></a>最能概括你自己的三个词?</h2><p><strong>回答样本：</strong> 我经常用的三个词是：适应能力强，有责任心和做事有始终，并结合具体例子向主考官解释。</p>
<h2 id="作为被面试者给我打一下分"><a href="#作为被面试者给我打一下分" class="headerlink" title="作为被面试者给我打一下分?"></a>作为被面试者给我打一下分?</h2><p><strong>回答提示：</strong> 试着列出四个优点和一个非常非常非常小的缺点（可以抱怨一下设施，没有明确责任人的缺点是不会有人介意的）。</p>
<h2 id="你怎么理解你应聘的职位"><a href="#你怎么理解你应聘的职位" class="headerlink" title="你怎么理解你应聘的职位?"></a>你怎么理解你应聘的职位?</h2><p><strong>回答提示：</strong> 可以把岗位职责和任务及工作态度阐述下。</p>
<h2 id="喜欢这份工作的哪一点"><a href="#喜欢这份工作的哪一点" class="headerlink" title="喜欢这份工作的哪一点?"></a>喜欢这份工作的哪一点?</h2><p><strong>回答提示：</strong> 在回答面试官这个问题时不能太直接就把自己心理的话说出来，尤其是薪资方面的问题，不过一些无伤大雅的回答是不错的考虑，如交通方便，工作性质及内容颇能符合自己的兴趣等等都是不错的答案，不过如果这时自己能仔细思考出这份工作的与众不同之处，相信在面试上会大大加分。</p>
<h2 id="为什么要离职"><a href="#为什么要离职" class="headerlink" title="为什么要离职?"></a>为什么要离职?</h2><p><strong>回答提示：</strong> ①回答这个问题时一定要小心，就算在前一个工作受到再大的委屈，对公司有多少的怨言都千万不要表现出来，尤其要避免对公司本身主管的批评，避免面试官的负面情绪及印象。建议此时最好的回答方式是将问题归咎在自己身上，例如觉得工作没有学习发展的空间，自己想在面试工作的相关产业中多加学习，或是前一份工作与自己的生涯规划不合等等，回答的答案最好是积极正面的。②我希望能获得一份更好的工作，如果机会来临，我会抓住。我觉得目前的工作，已经达到顶峰，即没有升迁机会。</p>
<h2 id="说说你对行业、技术发展趋势的看法"><a href="#说说你对行业、技术发展趋势的看法" class="headerlink" title="说说你对行业、技术发展趋势的看法?"></a>说说你对行业、技术发展趋势的看法?</h2><p><strong>回答提示：</strong> 企业对这个问题很感兴趣，只有有备而来的求职者能够过关。求职者可以直接在网上查找对你所申请的行业部门的信息，只有深入了解才能产生独特的见解。企业认为最聪明的求职者是对所面试的公司预先了解很多，包括公司各个部门，发展情况，在面试回答问题的时候可以提到所了解的情况，企业欢迎进入企业的人是“知己”，而不是“盲人”。</p>
<h2 id="对工作的期望与目标何在"><a href="#对工作的期望与目标何在" class="headerlink" title="对工作的期望与目标何在?"></a>对工作的期望与目标何在?</h2><p><strong>回答提示：</strong> 这是面试者用来评断求职者是否对自己有一定程度的期望、对这份工作是否了解的问题。<br>对于工作有确实学习目标的人通常学习较快，对于新工作自然较容易进入状况，这时建议你，最好针对工作的性质找出一个确实的答案，如业务员的工作可以这样回答：“我的目标是能成为一个超级业务员，将公司的产品广泛的推销出去，达到最好的业绩成效；为达到这个目标，我一定会努力学习，而我相信以我认真负责的态度，一定可以达到这个目标。” 其他类的工作也可以比照这个方式回答，只要在目标方面稍微修改一下就可以了。</p>
<h2 id="谈谈你的家庭"><a href="#谈谈你的家庭" class="headerlink" title="谈谈你的家庭?"></a>谈谈你的家庭?</h2><p><strong>回答提示：</strong> 企业面试时询问家庭问题不是非要知道求职者家庭的情况，而是要了解家庭背景对求职者的塑造和影响。企业希望听到的重点也在于家庭对求职者的积极影响。</p>
<p><strong>回答样本：</strong> 我很爱我的家庭，我们家一向很和睦，虽然我的父亲和母亲都是普通人，但是从小，我就看到我父亲起早贪黑，每天工作特别勤劳，他的行动无形中培养了我认真负责的态度和勤劳的精神。我母亲为人善良，对人热情，特别乐于助人，所以在单位人缘很好，她的一言一行也一直在教导我做人的道理。</p>
<h2 id="你认为自己申请这个职位还欠缺什么"><a href="#你认为自己申请这个职位还欠缺什么" class="headerlink" title="你认为自己申请这个职位还欠缺什么?"></a>你认为自己申请这个职位还欠缺什么?</h2><p><strong>回答提示：</strong> 企业喜欢问求职者弱点，但精明的求职者一般不直接回答。</p>
<p><strong>回答样本：</strong> 继续重复自己的优势，然后说：“对于这个职位和我的能力来说，我相信自己是可以胜任的，只是缺乏经验，这个问题可以进入公司以后以最短的时间来解决，我的学习能力很强，我相信可以很快融入公司的企业文化，进入工作状态。</p>
<h2 id="你欣赏哪种性格的人"><a href="#你欣赏哪种性格的人" class="headerlink" title="你欣赏哪种性格的人?"></a>你欣赏哪种性格的人?</h2><p><strong>回答提示：</strong> 诚实、不死板而且容易相处的人、有实际行动的人，加上具体例子。</p>
<h2 id="你通常如何处理别人的批评"><a href="#你通常如何处理别人的批评" class="headerlink" title="你通常如何处理别人的批评?"></a>你通常如何处理别人的批评?</h2><p><strong>回答提示：</strong> ①沈默是金，不必说什么，否则情况更糟，不过我会接受建设性的批评。②我会等大家冷静下来再讨论。</p>
<h2 id="怎样对待自己的失败"><a href="#怎样对待自己的失败" class="headerlink" title="怎样对待自己的失败?"></a>怎样对待自己的失败?</h2><p><strong>回答提示：</strong> 大意：我们生来都不是十全十美的，我相信我有第二个机会改正我的错误。</p>
<h2 id="什么会让你有成就感"><a href="#什么会让你有成就感" class="headerlink" title="什么会让你有成就感?"></a>什么会让你有成就感?</h2><p><strong>回答提示：</strong> 为贵公司竭力效劳，尽我所能，完成一个项目。</p>
<h2 id="眼下你生活中最重要的是什么"><a href="#眼下你生活中最重要的是什么" class="headerlink" title="眼下你生活中最重要的是什么?"></a>眼下你生活中最重要的是什么?</h2><p><strong>回答提示：</strong> 对我来说，能在这个领域找到工作是最重要的，能在贵公司任职对我说最重要。</p>
<h2 id="你为什么愿意到我们公司来工作"><a href="#你为什么愿意到我们公司来工作" class="headerlink" title="你为什么愿意到我们公司来工作?"></a>你为什么愿意到我们公司来工作?</h2><p><strong>回答提示：</strong> 对于这个问题，你要格外小心，如果你已经对该单位作了研究，你可以回答一些详细的原因。</p>
<p><strong>回答样本：</strong> ①公司本身高技术开发环境很吸引我我同公司出生在同样的时代，我希望能够进入一家与我共同成长的公司。②你们公司一直都稳定发展，在近几年来在市场上有竞争力。我认为贵公司能够给我提供一个与众不同的发展道路。</p>
<h2 id="你和别人发生过争执吗"><a href="#你和别人发生过争执吗" class="headerlink" title="你和别人发生过争执吗?"></a>你和别人发生过争执吗?</h2><p><strong>回答提示：</strong> 这是面试中最险恶的问题，其实是考官布下的一个陷阱，成功解决矛盾是一个协作团体中成员所必备的能力。假如你工作在一个服务行业，这个问题简直成了最重要的个环节。你是否能获得这份工作，将取决于这个问题的回答。考官希望看到你是成熟且乐于奉献的。他们通过这个问题了解你的成熟度和处世能力。在没有外界干涉的情况下，通过妥协的方式来解决才是正确答案。</p>
<h2 id="你做过的哪件事最令自己感到骄傲"><a href="#你做过的哪件事最令自己感到骄傲" class="headerlink" title="你做过的哪件事最令自己感到骄傲?"></a>你做过的哪件事最令自己感到骄傲?</h2><p><strong>回答提示：</strong> 这是考官给你的一个机会，让你展示自己把握命运的能力。这会体现你潜在的领导能力以及你被提升的可能性。假如你应聘于一个服务性质的单位，你很可能会被邀请去餐。记住：你的前途取决于你的知识、你的社交能力和综合表现。</p>
<h2 id="对这项工作，你有哪些可预见的困难"><a href="#对这项工作，你有哪些可预见的困难" class="headerlink" title="对这项工作，你有哪些可预见的困难?"></a>对这项工作，你有哪些可预见的困难?</h2><p><strong>回答提示：</strong> ①不宜直接说出具体的困难，否则可能令对方怀疑应聘者不行。②可以尝试迂回战术，说出应聘者对困难所持有的态度工作中出现一些困难是正常的，也是难免的，但是只要有坚忍不拔的毅力、良好的合作精神以及事前周密而充分的准备，任何困难都是可以克服。</p>
<h2 id="录用后你将怎样开展工作"><a href="#录用后你将怎样开展工作" class="headerlink" title="录用后你将怎样开展工作?"></a>录用后你将怎样开展工作?</h2><p><strong>回答提示：</strong> ①如果应聘者对于应聘的职位缺乏足够的了解，最好不要直接说出自己开展工作的具体办法。②可以尝试采用迂回战术来回答，如“首先听取领导的指示和要求，然后就有关情况进行了解和熟悉，接下来制定一份近期的工作计划并报领导批准，最后根据计划开展工作。”。</p>
<h2 id="你希望与什么样的上级共事"><a href="#你希望与什么样的上级共事" class="headerlink" title="你希望与什么样的上级共事?"></a>你希望与什么样的上级共事?</h2><p><strong>回答提示：</strong> ①通过应聘者对上级的“希望”可以判断出应聘者对自我要求的意识，这既上一个陷阱，又是一次机会。②最好回避对上级具体的希望，多谈对自己的要求。如“做为刚步入社会的新人，我应该多要求自己尽快熟悉环境、适应环境，而不应该对环境提出什么要求，只要能发挥我的专长就可以了。</p>
<h2 id="你工作经验欠缺，如何能胜任这项工作"><a href="#你工作经验欠缺，如何能胜任这项工作" class="headerlink" title="你工作经验欠缺，如何能胜任这项工作?"></a>你工作经验欠缺，如何能胜任这项工作?</h2><p><strong>回答提示：</strong> ①如果招聘单位对应届毕业生的应聘者提出这个问题，说明招聘公司并不真正在乎经验，关键看应聘者怎样回答。②对这个问题的回答最好要体现出应聘者的诚恳、机智、果敢及敬业。</p>
<p><strong>回答样本：</strong> 作为应届毕业生，在工作经验方面的确会有所欠缺，因此在读书期间我一直利用各种机会在这个行业里做兼职。我也发现，实际工作远比书本知识丰富、复杂。但我有较强的责任心、适应能力和学习能力，而且比较勤奋，所以在兼职中均能圆满完成各项工作，从中获取的经验也令我受益非浅。请贵公司放心，学校所学及兼职的工作经验使我一定能胜任这个职位。</p>
<h2 id="你会怎样获得同事的帮助"><a href="#你会怎样获得同事的帮助" class="headerlink" title="你会怎样获得同事的帮助?"></a>你会怎样获得同事的帮助?</h2><p><strong>回答提示：</strong> 每个公司都在不断变化发展的过程中，你当然希望你的员工也是这样。你希望得到那些希望并欢迎变化的人，因为这些明白，为了公司的发展，变化是公司日常生活中重要组成部分。这样的员工往往很容易适应公司的变化，并会对变化做出积极的响应。</p>
<h2 id="如果你没被录用，你怎么打算"><a href="#如果你没被录用，你怎么打算" class="headerlink" title="如果你没被录用，你怎么打算?"></a>如果你没被录用，你怎么打算?</h2><p><strong>回答样本：</strong> 现在的社会是一个竞争的社会，从这次面试中也可看出这一点，有竞争就必然有优劣，有成功必定就会有失败。往往成功的背后有许多的困难和挫折，如果这次失败了也仅仅是一次而已，只有经过经验经历的积累才能塑造出一个完全的成功者。我会从以下几个方面来正确看待这次失败：①要敢于面对，面对这次失败不气馁，接受已经失去了这次机会就不会回头这个现实，从心理意志和现出对这次失败的抵抗力。要有自信，相信自己经历了这次之后经过努力一定能行，能够超越自我。②善于反思，对于这次面试经验要认真总结，思考剖析，能够从自身的角度找差距正确对自己，实事求是地评价自己，辩证的看待自己的长短得失，做一个明白人。③走出阴影，克服这一次失败带给自己的心理压力，时刻牢记自己弱点，防患于未然，加强学习，提高自身素质。④认真工作，回到原单位岗位上后，要实实在在、踏踏实实地工作，三十六行行行出状元，争取在本岗位上做出一定的成绩。⑤再接再厉，以后如果有机会我仍然后再次参加竞争。</p>
<h2 id="最令你沮丧的事情"><a href="#最令你沮丧的事情" class="headerlink" title="最令你沮丧的事情?"></a>最令你沮丧的事情?</h2><p><strong>回答样本：</strong> 曾经接触过一个客户，原本就有耳闻他以挑剔出名，所以事前的准备功夫做得十分充分，也投入了相当多的时间与精力，最后客户虽然并没有照单全收，但是接受的程度已经出乎我们意料之外了。原以为从此可以合作愉快，却得知客户最后因为预算关系选择了另一家代理商，之前的努力因而付诸流水。尽管如此，我还是从这次的经验学到很多，如对该产业的了解，整个team的默契也更好了。</p>
<h2 id="想过创业吗"><a href="#想过创业吗" class="headerlink" title="想过创业吗?"></a>想过创业吗?</h2><p><strong>回答提示：</strong> 这个问题可以显示你的冲劲，但如果你的回答是“有”的话，千万小心，下一个问题可能就是：那么为什么你不这样做呢?</p>
<h2 id="为什么我们要在众多的面试者中选择你"><a href="#为什么我们要在众多的面试者中选择你" class="headerlink" title="为什么我们要在众多的面试者中选择你?"></a>为什么我们要在众多的面试者中选择你?</h2><p><strong>回答提示：</strong> 别过度吹嘘自己的能力，或信口开河地乱开支票，例如一定会为该公司带来多少钱的业务等，这样很容易给人一种爱说大话、不切实际的感觉。</p>
<p><strong>回答样本：</strong> 根据我对贵公司的了解，以及我在这份工作上所累积的专业、经验及人脉，相信正是贵公司所找寻的人才。而我在工作态度、EQ上，也有圆融、成熟的一面，和主管、同事都能合作愉快。</p>
<h2 id="除了本公司外，还应聘了哪些公司"><a href="#除了本公司外，还应聘了哪些公司" class="headerlink" title="除了本公司外，还应聘了哪些公司?"></a>除了本公司外，还应聘了哪些公司?</h2><p><strong>回答提示：</strong> 这是相当多公司会问的问题，其用意是要概略知道应征者的求职志向，所以这并非绝对是负面答案，就算不便说出公司名称，也应回答“销售同种产品的公司”，如果应聘的其他公司是不同业界，容易让人产生无法信任的感觉。</p>
<h2 id="你并非毕业于名牌院校"><a href="#你并非毕业于名牌院校" class="headerlink" title="你并非毕业于名牌院校?"></a>你并非毕业于名牌院校?</h2><p><strong>回答样本：</strong> 是否毕业于名牌院校不重要，重要的是有能力完成您交给我的工作，我接受了XX的职业培训，掌握的技能完全可以胜任贵公司现在工作，而且我比一些名牌院校的应届毕业生的动手能力还要强，我想我更适合贵公司这个职位。</p>
<h2 id="怎样看待学历和能力"><a href="#怎样看待学历和能力" class="headerlink" title="怎样看待学历和能力?"></a>怎样看待学历和能力?</h2><p><strong>回答样本：</strong> 学历我想只要是大学专科的学历，就表明觉得我具备了根本的学习能力。剩下的，你是学士也好，还是博士也好，对于这一点的讨论，不是看你学了多少知识，而是看你在这个领域上发挥了什么，也就是所说的能力问题。一个人工作能力的高低直接决定其职场命运，而学历的高低只是进入一个企业的敲门砖，如果公司把学历卡在博士上我就无法进入贵公司，当然这不一定只是我个人的损失，如果一个专科生都能完成的工作，您又何必非要招聘一位博士生呢?</p>
<h2 id="谈谈如何适应办公室工作的新环境"><a href="#谈谈如何适应办公室工作的新环境" class="headerlink" title="谈谈如何适应办公室工作的新环境?"></a>谈谈如何适应办公室工作的新环境?</h2><p><strong>回答样本：</strong> ①办公室里每个人都有各自的岗位与职责，不得擅离岗位。②根据领导指示和工作安排，制定工作计划，提前预备，并按计划完成。③多请示并及时汇报，遇到不明白的要虚心请教。④抓间隙时间，多学习，努力提高自己的政治素质和业务水平。</p>
<h2 id="谈谈对这个职务的期许"><a href="#谈谈对这个职务的期许" class="headerlink" title="谈谈对这个职务的期许?"></a>谈谈对这个职务的期许?</h2><p><strong>回答提示：</strong> 回答前不妨先询问公司对这项职务的责任认定及归属，因为每一家公司的状况不尽相同，以免说了一堆理想抱负却发现牛头不对马嘴。</p>
<p><strong>回答样本：</strong> 希望能借此发挥我的所学及专长，同时也吸收贵公司在这方面的经验，就公司、我个人而言，缔造双赢的局面。</p>
<h2 id="何时可以到职"><a href="#何时可以到职" class="headerlink" title="何时可以到职?"></a>何时可以到职?</h2><p><strong>回答提示：</strong> 大多数企业会关心就职时间，最好是回答：“如果被录用的话，到职日可以按公司规定上班”，但是如果还未辞去上一个工作、上班时间又太近，似乎有些强人所难，因为交接至少要一个月的时间，应进一步说明原因，录取公司应该会通融的。</p>
]]></content>
      <categories>
        <category>面试</category>
      </categories>
      <tags>
        <tag>面试</tag>
        <tag>面试问题集锦</tag>
      </tags>
  </entry>
  <entry>
    <title>项目优化上线</title>
    <url>/archives/4311e35c.html</url>
    <content><![CDATA[<div class="note default no-icon flat"><h4 id="项目优化上线"><a href="#项目优化上线" class="headerlink" title="项目优化上线"></a>项目优化上线</h4></div>
<h2 id="项目构建"><a href="#项目构建" class="headerlink" title="项目构建"></a>项目构建</h2><blockquote>
<p>目标：能够通过命令对项目进行打包</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在本地开启一个服务器运行构建之后的项目代码</span></span><br><span class="line">npm install serve@14.0.1</span><br><span class="line">npx serve -s build</span><br></pre></td></tr></table></figure>
<p><a href="https://imgse.com/i/ppOzFZn"><img src="https://s1.ax1x.com/2023/04/12/ppOzFZn.png" alt="ppOzFZn.png"></a></p>
<h2 id="构建结果分析"><a href="#构建结果分析" class="headerlink" title="构建结果分析"></a>构建结果分析</h2><blockquote>
<p>目标：能够通过工具分析出构建之后的项目文件谁比较大</p>
</blockquote>
<p>① 下载 source-map-explorer</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install source-map-explorer@2.5.3 --save-dev</span><br></pre></td></tr></table></figure>
<p>② 在 package.json 文件中添加分析命令</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;analyze&quot;</span>: <span class="string">&quot;source-map-explorer &#x27;build/static/js/*.js&#x27;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③ 通过执行命令查看分析结果</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run analyze</span><br></pre></td></tr></table></figure>
<p><a href="https://imgse.com/i/ppOzZGT"><img src="https://s1.ax1x.com/2023/04/12/ppOzZGT.png" alt="ppOzZGT.png"></a></p>
<h2 id="路由懒加载"><a href="#路由懒加载" class="headerlink" title="路由懒加载"></a>路由懒加载</h2><blockquote>
<p>目标：通过路由懒加载分割项目文件以减少初次加载的文件体积</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// src/AppRouter.tsx</span><br><span class="line">const ArticlePage = lazy(() =&gt; import(&quot;@pages/articlePage&quot;));</span><br><span class="line">const PublishPage = lazy(() =&gt; import(&quot;@pages/publishPage&quot;));</span><br><span class="line">const LoginPage = lazy(() =&gt; import(&quot;@pages/loginPage&quot;));</span><br><span class="line">const DashboardPage = lazy(() =&gt; import(&quot;@pages/dashboardPage&quot;));</span><br><span class="line"></span><br><span class="line">export default class AppRouter extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;Router history=&#123;history&#125;&gt;</span><br><span class="line">        &lt;Suspense fallback=&#123;&lt;Loading /&gt;&#125;&gt;</span><br><span class="line">          &lt;Switch&gt;</span><br><span class="line">            &lt;Redirect from=&quot;/&quot; to=&quot;/login&quot; exact /&gt;</span><br><span class="line">            &lt;Route path=&quot;/login&quot; component=&#123;LoginPage&#125;&gt;&lt;/Route&gt;</span><br><span class="line">            &lt;Route path=&quot;/admin&quot;&gt;</span><br><span class="line">              &lt;RouteGuard</span><br><span class="line">                guards=&#123;[isLogin]&#125;</span><br><span class="line">                onRejected=&#123;() =&gt; &lt;Redirect to=&quot;/login&quot; push=&#123;false&#125; /&gt;&#125;</span><br><span class="line">              &gt;</span><br><span class="line">                &lt;Layout&gt;</span><br><span class="line">                  &lt;Suspense fallback=&#123;&lt;Loading /&gt;&#125;&gt;</span><br><span class="line">                    &lt;Switch&gt;</span><br><span class="line">                      &lt;Redirect from=&quot;/admin&quot; to=&quot;/admin/dashboard&quot; exact /&gt;</span><br><span class="line">                      &lt;Route</span><br><span class="line">                        path=&quot;/admin/dashboard&quot;</span><br><span class="line">                        component=&#123;DashboardPage&#125;</span><br><span class="line">                      /&gt;</span><br><span class="line">                      &lt;Route path=&quot;/admin/article&quot; component=&#123;ArticlePage&#125; /&gt;</span><br><span class="line">                      &lt;Route</span><br><span class="line">                        path=&quot;/admin/publish/:id&quot;</span><br><span class="line">                        component=&#123;PublishPage&#125;</span><br><span class="line">                      /&gt;</span><br><span class="line">                      &lt;Route path=&quot;/admin/publish&quot; component=&#123;PublishPage&#125; /&gt;</span><br><span class="line">                    &lt;/Switch&gt;</span><br><span class="line">                  &lt;/Suspense&gt;</span><br><span class="line">                &lt;/Layout&gt;</span><br><span class="line">              &lt;/RouteGuard&gt;</span><br><span class="line">            &lt;/Route&gt;</span><br><span class="line">          &lt;/Switch&gt;</span><br><span class="line">        &lt;/Suspense&gt;</span><br><span class="line">      &lt;/Router&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Loading extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;justify-content align-items&quot;&gt;</span><br><span class="line">        &lt;i className=&quot;fas fa-spinner fa-pulse&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://imgse.com/i/ppOzML9"><img src="https://s1.ax1x.com/2023/04/12/ppOzML9.png" alt="ppOzML9.png"></a></p>
<h2 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h2><blockquote>
<p>目标：使用 cdn 减少构建之后的文件体积</p>
</blockquote>
<p><a href="https://www.bootcdn.cn/">BootCDN</a> <a href="https://www.jsdelivr.com/">JSDelivr</a> <a href="https://www.unpkg.com/">UNPKG</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install react-app-rewire-html-webpack-plugin@1.1.0 --save-dev</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// config-overrides.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; aliasWebpack &#125; = <span class="built_in">require</span>(<span class="string">&quot;react-app-alias&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> rewireHtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;react-app-rewire-html-webpack-plugin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">override</span>(<span class="params">config, env</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 配置路径别名</span></span><br><span class="line">  <span class="keyword">const</span> aliasConfig = aliasWebpack()(config);</span><br><span class="line">  <span class="keyword">const</span> htmlWebpackPluginConfig = rewireHtmlWebpackPlugin(config, env, &#123;</span><br><span class="line">    <span class="attr">cdn</span>: &#123;</span><br><span class="line">      <span class="attr">js</span>: [</span><br><span class="line">        <span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/react/18.2.0/umd/react.production.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/redux/4.2.0/redux.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/react-redux/8.0.4/react-redux.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://unpkg.com/redux-thunk@2.4.2/dist/redux-thunk.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://unpkg.com/redux-persist@5.10.0/dist/redux-persist.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://unpkg.com/history@4.10.1/umd/history.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://unpkg.com/react-router@5.3.4/umd/react-router.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://unpkg.com/react-router-dom@5.3.4/umd/react-router-dom.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://unpkg.com/axios@1.1.3/dist/axios.min.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/classnames/2.3.2/index.min.js&quot;</span>,</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">css</span>: [</span><br><span class="line">        <span class="string">&quot;https://www.unpkg.com/bulma@0.9.4/css/bulma.min.css&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://unpkg.com/@fortawesome/fontawesome-free@5.15.2/css/all.min.css&quot;</span>,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...config,</span><br><span class="line">    ...aliasConfig,</span><br><span class="line">    ...htmlWebpackPluginConfig,</span><br><span class="line">    <span class="attr">externals</span>: &#123;</span><br><span class="line">      <span class="attr">react</span>: <span class="string">&quot;React&quot;</span>,</span><br><span class="line">      <span class="string">&quot;react-dom&quot;</span>: <span class="string">&quot;ReactDOM&quot;</span>,</span><br><span class="line">      <span class="attr">redux</span>: <span class="string">&quot;Redux&quot;</span>,</span><br><span class="line">      <span class="string">&quot;react-redux&quot;</span>: <span class="string">&quot;ReactRedux&quot;</span>,</span><br><span class="line">      <span class="string">&quot;redux-thunk&quot;</span>: <span class="string">&quot;ReduxThunk&quot;</span>,</span><br><span class="line">      <span class="string">&quot;redux-persist&quot;</span>: <span class="string">&quot;ReduxPersist&quot;</span>,</span><br><span class="line">      <span class="string">&quot;react-router-dom&quot;</span>: <span class="string">&quot;ReactRouterDOM&quot;</span>,</span><br><span class="line">      <span class="attr">axios</span>: <span class="string">&quot;axios&quot;</span>,</span><br><span class="line">      <span class="attr">classNames</span>: <span class="string">&quot;classNames&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- public/index.html --&gt;</span><br><span class="line">&lt;% htmlWebpackPlugin.options.cdn &amp;&amp; htmlWebpackPlugin.options.cdn.css.forEach(url =&gt; &#123; %&gt;</span><br><span class="line">	&lt;link rel=&quot;stylesheet&quot; href=&quot;&lt;%= url %&gt;&quot;/&gt;</span><br><span class="line">&lt;% &#125;) %&gt;</span><br><span class="line">&lt;% htmlWebpackPlugin.options.cdn &amp;&amp; htmlWebpackPlugin.options.cdn.js.forEach(url =&gt; &#123; %&gt;</span><br><span class="line">	&lt;script src=&quot;&lt;%= url %&gt;&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;% &#125;) %&gt;</span><br></pre></td></tr></table></figure>
<h2 id="跨域代理"><a href="#跨域代理" class="headerlink" title="跨域代理"></a>跨域代理</h2><blockquote>
<p>目标：能够通过配置代理解决开发阶段中遇到的跨域问题</p>
</blockquote>
<p><a href="https://create-react-app.dev/docs/proxying-api-requests-in-development/#configuring-the-proxy-manually">Configuring the Proxy Manually</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i http-proxy-middleware@2.0.6 --save-dev</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/setupProxy.js</span></span><br><span class="line"><span class="comment">// 注意: 该文件不需要在项目的任何地方被导入, 当启动开发服务器时它会被自动注册</span></span><br><span class="line"><span class="keyword">const</span> &#123; createProxyMiddleware &#125; = <span class="built_in">require</span>(<span class="string">&quot;http-proxy-middleware&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">app</span>) </span>&#123;</span><br><span class="line">  app.use(</span><br><span class="line">    <span class="string">&quot;/api&quot;</span>,</span><br><span class="line">    createProxyMiddleware(&#123;</span><br><span class="line">      <span class="attr">target</span>: <span class="string">&quot;http://localhost:8080&quot;</span>,</span><br><span class="line">      <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.tsx</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// http://localhost:8080/api/msg</span></span><br><span class="line">axios.get(<span class="string">&quot;/api/msg&quot;</span>).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(response.data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="发布项目到静态服务器-netlify"><a href="#发布项目到静态服务器-netlify" class="headerlink" title="发布项目到静态服务器 netlify"></a>发布项目到静态服务器 netlify</h2><p>需要注意：发布之后，会自动生成一个访问的域名 https 协议</p>
<p>netlify 地址 <code>https://app.netlify.com/sites/bright-elf-20823c/overview</code><br><img src="https://files.catbox.moe/52mj2o.png" alt=""></p>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>上线</tag>
      </tags>
  </entry>
</search>
